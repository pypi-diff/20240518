# Comparing `tmp/pyunifiprotect-5.2.0.tar.gz` & `tmp/pyunifiprotect-6.0.0.tar.gz`

## Comparing `pyunifiprotect-5.2.0.tar` & `pyunifiprotect-6.0.0.tar`

### file list

```diff
@@ -1,36 +1,39 @@
--rw-r--r--   0        0        0      317 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/__init__.py
--rw-r--r--   0        0        0      476 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/__main__.py
--rw-r--r--   0        0        0    65682 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/api.py
--rw-r--r--   0        0        0     1007 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/exceptions.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/py.typed
--rw-r--r--   0        0        0     4977 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/stream.py
--rw-r--r--   0        0        0    17948 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/utils.py
--rw-r--r--   0        0        0     7297 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/websocket.py
--rw-r--r--   0        0        0     8863 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/__init__.py
--rw-r--r--   0        0        0    36594 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/backup.py
--rw-r--r--   0        0        0     7649 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/base.py
--rw-r--r--   0        0        0    17030 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/cameras.py
--rw-r--r--   0        0        0     5366 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/chimes.py
--rw-r--r--   0        0        0     3559 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/doorlocks.py
--rw-r--r--   0        0        0     7244 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/events.py
--rw-r--r--   0        0        0     3354 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/lights.py
--rw-r--r--   0        0        0     1899 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/liveviews.py
--rw-r--r--   0        0        0     4281 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/nvr.py
--rw-r--r--   0        0        0     8211 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/sensors.py
--rw-r--r--   0        0        0     2207 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/cli/viewers.py
--rw-r--r--   0        0        0     3090 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/__init__.py
--rw-r--r--   0        0        0    37567 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/base.py
--rw-r--r--   0        0        0    21842 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/bootstrap.py
--rw-r--r--   0        0        0     2169 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/convert.py
--rw-r--r--   0        0        0   113370 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/devices.py
--rw-r--r--   0        0        0    47904 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/nvr.py
--rw-r--r--   0        0        0    15445 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/types.py
--rw-r--r--   0        0        0     7095 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/user.py
--rw-r--r--   0        0        0     6145 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/data/websocket.py
--rw-r--r--   0        0        0    18755 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/test_util/__init__.py
--rw-r--r--   0        0        0     8497 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyunifiprotect/test_util/anonymize.py
--rw-r--r--   0        0        0     2407 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/.gitignore
--rw-r--r--   0        0        0     1068 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/LICENSE
--rw-r--r--   0        0        0     7617 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/README.md
--rw-r--r--   0        0        0     5910 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/pyproject.toml
--rw-r--r--   0        0        0    11241 2020-02-02 00:00:00.000000 pyunifiprotect-5.2.0/PKG-INFO
+-rw-r--r--   0        0        0      317 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/__init__.py
+-rw-r--r--   0        0        0      476 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/__main__.py
+-rw-r--r--   0        0        0    58131 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/api.py
+-rw-r--r--   0        0        0     1007 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/exceptions.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/py.typed
+-rw-r--r--   0        0        0     1704 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/pydantic_compat.py
+-rw-r--r--   0        0        0    16548 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/session.py
+-rw-r--r--   0        0        0     4977 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/stream.py
+-rw-r--r--   0        0        0    17956 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/utils.py
+-rw-r--r--   0        0        0     7297 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/websocket.py
+-rw-r--r--   0        0        0     8864 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/__init__.py
+-rw-r--r--   0        0        0    36592 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/backup.py
+-rw-r--r--   0        0        0     7668 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/base.py
+-rw-r--r--   0        0        0    17030 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/cameras.py
+-rw-r--r--   0        0        0     5366 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/chimes.py
+-rw-r--r--   0        0        0     3559 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/doorlocks.py
+-rw-r--r--   0        0        0     7244 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/events.py
+-rw-r--r--   0        0        0     3354 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/lights.py
+-rw-r--r--   0        0        0     1899 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/liveviews.py
+-rw-r--r--   0        0        0     4964 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/nvr.py
+-rw-r--r--   0        0        0     8211 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/sensors.py
+-rw-r--r--   0        0        0     2207 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/cli/viewers.py
+-rw-r--r--   0        0        0     3170 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/__init__.py
+-rw-r--r--   0        0        0    38398 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/base.py
+-rw-r--r--   0        0        0    21861 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/bootstrap.py
+-rw-r--r--   0        0        0     2169 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/convert.py
+-rw-r--r--   0        0        0   115090 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/devices.py
+-rw-r--r--   0        0        0    50086 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/nvr.py
+-rw-r--r--   0        0        0    15717 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/types.py
+-rw-r--r--   0        0        0     7139 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/user.py
+-rw-r--r--   0        0        0     6145 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/data/websocket.py
+-rw-r--r--   0        0        0    18755 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/test_util/__init__.py
+-rw-r--r--   0        0        0     8497 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyunifiprotect/test_util/anonymize.py
+-rw-r--r--   0        0        0     2419 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/.gitignore
+-rw-r--r--   0        0        0     2797 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/LICENSE
+-rw-r--r--   0        0        0     1036 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/LICENSE.CHANGE
+-rw-r--r--   0        0        0     7617 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/README.md
+-rw-r--r--   0        0        0     5868 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/pyproject.toml
+-rw-r--r--   0        0        0    14466 2020-02-02 00:00:00.000000 pyunifiprotect-6.0.0/PKG-INFO
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/api.py` & `pyunifiprotect-6.0.0/pyunifiprotect/api.py`

 * *Files 6% similar despite different names*

```diff
@@ -2,33 +2,30 @@
 
 from __future__ import annotations
 
 import asyncio
 from collections.abc import Callable
 import contextlib
 from datetime import datetime, timedelta
-import hashlib
-from http.cookies import Morsel, SimpleCookie
+from http.cookies import Morsel
 from ipaddress import IPv4Address, IPv6Address
 import logging
+import mimetypes
 from pathlib import Path
-import re
 import sys
 import time
 from typing import Any, Literal, Optional, Union, cast
 from urllib.parse import urljoin
 from uuid import UUID
 
 import aiofiles
-from aiofiles import os as aos
 import aiohttp
-from aiohttp import CookieJar, client_exceptions
+from aiohttp import client_exceptions
 import orjson
-from platformdirs import user_cache_dir, user_config_dir
-from yarl import URL
+from platformdirs import user_cache_dir
 
 from pyunifiprotect.data import (
     NVR,
     Bootstrap,
     Bridge,
     Camera,
     Doorlock,
@@ -36,37 +33,32 @@
     EventCategories,
     EventType,
     Light,
     Liveview,
     ModelType,
     ProtectAdoptableDeviceModel,
     ProtectModel,
+    PTZPatrol,
     PTZPosition,
     PTZPreset,
     Sensor,
     SmartDetectObjectType,
     SmartDetectTrack,
     Version,
     Viewer,
     WSPacket,
     WSSubscriptionMessage,
     create_from_unifi_dict,
 )
 from pyunifiprotect.data.base import ProtectModelWithId
 from pyunifiprotect.data.devices import Chime
 from pyunifiprotect.data.types import IteratorCallback, ProgressCallback, RecordingMode
-from pyunifiprotect.exceptions import BadRequest, NotAuthorized, NvrError
-from pyunifiprotect.utils import (
-    decode_token_cookie,
-    get_response_reason,
-    ip_from_host,
-    set_debug,
-    to_js_time,
-    utc_now,
-)
+from pyunifiprotect.exceptions import BadRequest, NvrError
+from pyunifiprotect.session import STORAGE_DIRECTORY, UnifiOSClient
+from pyunifiprotect.utils import ip_from_host, set_debug, to_js_time, utc_now
 from pyunifiprotect.websocket import Websocket
 
 TOKEN_COOKIE_MAX_EXP_SECONDS = 60
 
 NEVER_RAN = -1000
 # how many seconds before the bootstrap is refreshed from Protect
 DEVICE_UPDATE_INTERVAL = 900
@@ -78,15 +70,15 @@
 ]
 TYPES_BUG_MESSAGE = """There is currently a bug in UniFi Protect that makes `start` / `end` not work if `types` is not provided. This means pyunifiprotect has to iterate over all of the events matching the filters provided to return values.
 
 If your Protect instance has a lot of events, this request will take much longer then expected. It is recommended adding additional filters to speed the request up."""
 
 
 _LOGGER = logging.getLogger(__name__)
-_COOKIE_RE = re.compile(r"^set-cookie: ", re.IGNORECASE)
+
 
 # TODO: Urls to still support
 # Backups
 # * GET /backups - list backends
 # * POST /backups/import - import backup
 # * POST /backups - create backup
 # * GET /backups/{id} - download backup
@@ -136,250 +128,133 @@
 # Sensors
 # POST /sensors/{id}/locate
 #
 # Timeline
 # GET /timeline
 
 
-def get_user_hash(host: str, username: str) -> str:
-    session = hashlib.sha256()
-    session.update(host.encode("utf8"))
-    session.update(username.encode("utf8"))
-    return session.hexdigest()
-
-
 class BaseApiClient:
-    _host: str
-    _port: int
-    _username: str
-    _password: str
-    _verify_ssl: bool
     _ws_timeout: int
+    _os: UnifiOSClient
 
-    _is_authenticated: bool = False
     _last_update: float = NEVER_RAN
     _last_ws_status: bool = False
     _last_token_cookie: Morsel[str] | None = None
     _last_token_cookie_decode: Optional[dict[str, Any]] = None
-    _session: Optional[aiohttp.ClientSession] = None
-    _loaded_session: bool = False
 
-    headers: Optional[dict[str, str]] = None
     _websocket: Optional[Websocket] = None
 
     api_path: str = "/proxy/protect/api/"
     ws_path: str = "/proxy/protect/ws/updates"
-
     cache_dir: Path
-    config_dir: Path
-    store_sessions: bool
 
     def __init__(
         self,
         host: str,
         port: int,
         username: str,
         password: str,
         verify_ssl: bool = True,
         session: Optional[aiohttp.ClientSession] = None,
         ws_timeout: int = 30,
         cache_dir: Optional[Path] = None,
-        config_dir: Optional[Path] = None,
         store_sessions: bool = True,
     ) -> None:
         self._auth_lock = asyncio.Lock()
-        self._host = host
-        self._port = port
-
-        self._username = username
-        self._password = password
-        self._verify_ssl = verify_ssl
+        self._os = UnifiOSClient(
+            host=host,
+            port=port,
+            username=username,
+            password=password,
+            verify_ssl=verify_ssl,
+            session=session,
+            cache_dir=cache_dir,
+            store_sessions=store_sessions,
+        )
         self._ws_timeout = ws_timeout
-        self._loaded_session = False
+        self.cache_dir = cache_dir or (Path(user_cache_dir()) / STORAGE_DIRECTORY)
 
-        self.config_dir = config_dir or (Path(user_config_dir()) / "ufp")
-        self.cache_dir = cache_dir or (Path(user_cache_dir()) / "ufp_cache")
-        self.store_sessions = store_sessions
-
-        if session is not None:
-            self._session = session
+    @property
+    def os_client(self) -> UnifiOSClient:
+        """Get UniFi OS client."""
 
-        self._update_url()
+        return self._os
 
-    def _update_url(self) -> None:
-        """Updates the url after changing _host or _port."""
-        if self._port != 443:
-            self._url = URL(f"https://{self._host}:{self._port}")
-        else:
-            self._url = URL(f"https://{self._host}")
+    @property
+    def protect_url(self) -> str:
+        """Base Protect URL."""
 
-        self.base_url = str(self._url)
+        return f"{self._os.base_url}/protect"
 
     @property
     def ws_url(self) -> str:
-        url = f"wss://{self._host}"
-        if self._port != 443:
-            url += f":{self._port}"
-
+        url = self._os.base_url.replace("https", "wss")
         url += self.ws_path
         last_update_id = self._get_last_update_id()
         if last_update_id is None:
             return url
         return f"{url}?lastUpdateId={last_update_id}"
 
-    @property
-    def config_file(self) -> Path:
-        return self.config_dir / "unifi_protect.json"
-
     async def get_session(self) -> aiohttp.ClientSession:
         """Gets or creates current client session"""
 
-        if self._session is None or self._session.closed:
-            if self._session is not None and self._session.closed:
-                _LOGGER.debug("Session was closed, creating a new one")
-            # need unsafe to access httponly cookies
-            self._session = aiohttp.ClientSession(cookie_jar=CookieJar(unsafe=True))
-
-        return self._session
+        return await self._os.get_session()
 
     async def get_websocket(self) -> Websocket:
         """Gets or creates current Websocket."""
 
         async def _auth(force: bool) -> Optional[dict[str, str]]:
             if force:
-                if self._session is not None:
-                    self._session.cookie_jar.clear()
-                self.set_header("cookie", None)
-                self.set_header("x-csrf-token", None)
+                await self._os.clear_auth()
 
-            await self.ensure_authenticated()
-            return self.headers
+            await self._os.ensure_authenticated()
+            return self._os.headers
 
         if self._websocket is None:
             self._websocket = Websocket(
                 self.ws_url,
                 _auth,
-                verify=self._verify_ssl,
+                verify=self._os.verify_ssl,
                 timeout=self._ws_timeout,
             )
             self._websocket.subscribe(self._process_ws_message)
 
         return self._websocket
 
     async def close_session(self) -> None:
         """Closing and delets client session"""
 
-        if self._session is not None:
-            await self._session.close()
-            self._session = None
-            self._loaded_session = False
-
-    def set_header(self, key: str, value: str | None) -> None:
-        """Set header."""
-
-        self.headers = self.headers or {}
-        if value is None:
-            self.headers.pop(key, None)
-        else:
-            self.headers[key] = value
-
-    async def request(
-        self,
-        method: str,
-        url: str,
-        require_auth: bool = False,
-        auto_close: bool = True,
-        **kwargs: Any,
-    ) -> aiohttp.ClientResponse:
-        """Make a request to UniFi Protect"""
-
-        if require_auth:
-            await self.ensure_authenticated()
-
-        request_url = self._url.joinpath(url[1:])
-        headers = kwargs.get("headers") or self.headers
-        _LOGGER.debug("Request url: %s", request_url)
-        if not self._verify_ssl:
-            kwargs["ssl"] = False
-        session = await self.get_session()
-
-        for attempt in range(2):
-            try:
-                req_context = session.request(
-                    method,
-                    request_url,
-                    headers=headers,
-                    **kwargs,
-                )
-                response = await req_context.__aenter__()  # noqa: PLC2801
-
-                await self._update_last_token_cookie(response)
-                if auto_close:
-                    try:
-                        _LOGGER.debug(
-                            "%s %s %s",
-                            response.status,
-                            response.content_type,
-                            response,
-                        )
-                        response.release()
-                    except Exception:
-                        # make sure response is released
-                        response.release()
-                        # re-raise exception
-                        raise
-
-                return response
-            except aiohttp.ServerDisconnectedError as err:
-                # If the server disconnected, try again
-                # since HTTP/1.1 allows the server to disconnect
-                # at any time
-                if attempt == 0:
-                    continue
-                raise NvrError(
-                    f"Error requesting data from {self._host}: {err}",
-                ) from err
-            except client_exceptions.ClientError as err:
-                raise NvrError(
-                    f"Error requesting data from {self._host}: {err}",
-                ) from err
-
-        # should never happen
-        raise NvrError(f"Error requesting data from {self._host}")
+        await self._os.close_session()
 
     async def api_request_raw(
         self,
         url: str,
         method: str = "get",
         require_auth: bool = True,
         raise_exception: bool = True,
         **kwargs: Any,
     ) -> Optional[bytes]:
         """Make a request to UniFi Protect API"""
 
         url = urljoin(self.api_path, url)
-        response = await self.request(
+        response = await self._os.request(
             method,
             url,
             require_auth=require_auth,
             auto_close=False,
             **kwargs,
         )
 
         try:
-            if response.status != 200:
-                reason = await get_response_reason(response)
-                msg = "Request failed: %s - Status: %s - Reason: %s"
+            try:
+                await self._os.verify_response(url, response)
+            except NvrError as ex:
                 if raise_exception:
-                    if response.status in {401, 403}:
-                        raise NotAuthorized(msg % (url, response.status, reason))
-                    if response.status >= 400 and response.status < 500:
-                        raise BadRequest(msg % (url, response.status, reason))
-                    raise NvrError(msg % (url, response.status, reason))
-                _LOGGER.debug(msg, url, response.status, reason)
+                    raise
+                _LOGGER.debug(str(ex))
                 return None
 
             data: Optional[bytes] = await response.read()
             response.release()
 
             return data
         except Exception:
@@ -400,15 +275,15 @@
             url=url,
             method=method,
             require_auth=require_auth,
             raise_exception=raise_exception,
             **kwargs,
         )
 
-        if data is not None:
+        if data:
             json_data: Union[list[Any], dict[str, Any]] = orjson.loads(data)
             return json_data
         return None
 
     async def api_request_obj(
         self,
         url: str,
@@ -447,175 +322,14 @@
         )
 
         if not isinstance(data, list):
             raise NvrError(f"Could not decode list from {url}")
 
         return data
 
-    async def ensure_authenticated(self) -> None:
-        """Ensure we are authenticated."""
-
-        await self._load_session()
-        if self.is_authenticated() is False:
-            await self.authenticate()
-
-    async def authenticate(self) -> None:
-        """Authenticate and get a token."""
-        if self._auth_lock.locked():
-            # If an auth is already in progress
-            # do not start another one
-            async with self._auth_lock:
-                return
-
-        async with self._auth_lock:
-            url = "/api/auth/login"
-
-            if self._session is not None:
-                self._session.cookie_jar.clear()
-                self.set_header("cookie", None)
-
-            auth = {
-                "username": self._username,
-                "password": self._password,
-                "rememberMe": self.store_sessions,
-            }
-
-            response = await self.request("post", url=url, json=auth)
-            self.set_header("cookie", response.headers.get("set-cookie", ""))
-            self._is_authenticated = True
-            await self._update_last_token_cookie(response)
-            _LOGGER.debug("Authenticated successfully!")
-
-    async def _update_last_token_cookie(self, response: aiohttp.ClientResponse) -> None:
-        """Update the last token cookie."""
-
-        csrf_token = response.headers.get("x-csrf-token")
-        if (
-            csrf_token is not None
-            and self.headers
-            and csrf_token != self.headers.get("x-csrf-token")
-        ):
-            self.set_header("x-csrf-token", csrf_token)
-            await self._update_last_token_cookie(response)
-
-        if (
-            token_cookie := response.cookies.get("TOKEN")
-        ) and token_cookie != self._last_token_cookie:
-            self._last_token_cookie = token_cookie
-            if self.store_sessions:
-                await self._update_auth_config(self._last_token_cookie)
-            self._last_token_cookie_decode = None
-
-    async def _update_auth_config(self, cookie: Morsel[str]) -> None:
-        """Updates auth cookie on disk for persistent sessions."""
-
-        if self._last_token_cookie is None:
-            return
-
-        await aos.makedirs(self.config_dir, exist_ok=True)
-
-        config: dict[str, Any] = {}
-        session_hash = get_user_hash(str(self._url), self._username)
-        try:
-            async with aiofiles.open(self.config_file, "rb") as f:
-                config_data = await f.read()
-                if config_data:
-                    try:
-                        config = orjson.loads(config_data)
-                    except Exception:
-                        _LOGGER.warning("Invalid config file, ignoring.")
-        except FileNotFoundError:
-            pass
-
-        config["sessions"] = config.get("sessions", {})
-        config["sessions"][session_hash] = {
-            "metadata": dict(cookie),
-            "value": cookie.value,
-            "csrf": self.headers.get("x-csrf-token") if self.headers else None,
-        }
-
-        async with aiofiles.open(self.config_file, "wb") as f:
-            await f.write(orjson.dumps(config, option=orjson.OPT_INDENT_2))
-
-    async def _load_session(self) -> None:
-        if self._session is None:
-            await self.get_session()
-            assert self._session is not None
-
-        if not self._loaded_session and self.store_sessions:
-            session_cookie = await self._read_auth_config()
-            self._loaded_session = True
-            if session_cookie:
-                _LOGGER.debug("Successfully loaded session from config")
-                self._session.cookie_jar.update_cookies(session_cookie)
-
-    async def _read_auth_config(self) -> SimpleCookie | None:
-        """Read auth cookie from config."""
-
-        try:
-            async with aiofiles.open(self.config_file, "rb") as f:
-                config_data = await f.read()
-                if config_data:
-                    try:
-                        config = orjson.loads(config_data)
-                    except Exception:
-                        _LOGGER.warning("Invalid config file, ignoring.")
-                        return None
-        except FileNotFoundError:
-            _LOGGER.debug("no config file, not loading session")
-            return None
-
-        session_hash = get_user_hash(str(self._url), self._username)
-        session = config.get("sessions", {}).get(session_hash)
-        if not session:
-            _LOGGER.debug("No existing session for %s", session_hash)
-            return None
-
-        cookie = SimpleCookie()
-        cookie["TOKEN"] = session.get("value")
-        for key, value in session.get("metadata", {}).items():
-            cookie["TOKEN"][key] = value
-
-        cookie_value = _COOKIE_RE.sub("", str(cookie["TOKEN"]))
-        self._last_token_cookie = cookie["TOKEN"]
-        self._last_token_cookie_decode = None
-        self._is_authenticated = True
-        self.set_header("cookie", cookie_value)
-        if session.get("csrf"):
-            self.set_header("x-csrf-token", session["csrf"])
-        return cookie
-
-    def is_authenticated(self) -> bool:
-        """Check to see if we are already authenticated."""
-        if self._session is None:
-            return False
-
-        if self._is_authenticated is False:
-            return False
-
-        if self._last_token_cookie is None:
-            return False
-
-        # Lazy decode the token cookie
-        if self._last_token_cookie and self._last_token_cookie_decode is None:
-            self._last_token_cookie_decode = decode_token_cookie(
-                self._last_token_cookie,
-            )
-
-        if (
-            self._last_token_cookie_decode is None
-            or "exp" not in self._last_token_cookie_decode
-        ):
-            return False
-
-        token_expires_at = cast(int, self._last_token_cookie_decode["exp"])
-        max_expire_time = time.time() + TOKEN_COOKIE_MAX_EXP_SECONDS
-
-        return token_expires_at >= max_expire_time
-
     async def async_connect_ws(self, force: bool) -> None:
         """Connect to Websocket."""
 
         if force and self._websocket is not None:
             await self._websocket.disconnect()
             self._websocket = None
 
@@ -689,35 +403,36 @@
         override_connection_host: Use `host` as your `connection_host` for RTSP stream instead of using the one provided by UniFi Protect.
         minimum_score: minimum score for events (default: `0`)
         subscribed_models: Model types you want to filter events for WS. You will need to manually check the bootstrap for updates for events that not subscibred.
         ignore_stats: Ignore storage, system, etc. stats/metrics from NVR and cameras (default: false)
         debug: Use full type validation (default: false)
     """
 
+    _host: str
     _minimum_score: int
     _subscribed_models: set[ModelType]
     _ignore_stats: bool
     _ws_subscriptions: list[Callable[[WSSubscriptionMessage], None]]
+    _connection_host: IPv4Address | IPv6Address | str | None = None
+
     _bootstrap: Optional[Bootstrap] = None
     _last_update_dt: Optional[datetime] = None
-    _connection_host: Optional[Union[IPv4Address, IPv6Address, str]] = None
 
     ignore_unadopted: bool
 
     def __init__(
         self,
         host: str,
         port: int,
         username: str,
         password: str,
         verify_ssl: bool = True,
         session: Optional[aiohttp.ClientSession] = None,
         ws_timeout: int = 30,
         cache_dir: Optional[Path] = None,
-        config_dir: Optional[Path] = None,
         store_sessions: bool = True,
         override_connection_host: bool = False,
         minimum_score: int = 0,
         subscribed_models: Optional[set[ModelType]] = None,
         ignore_stats: bool = False,
         ignore_unadopted: bool = True,
         debug: bool = False,
@@ -727,26 +442,26 @@
             port=port,
             username=username,
             password=password,
             verify_ssl=verify_ssl,
             session=session,
             ws_timeout=ws_timeout,
             cache_dir=cache_dir,
-            config_dir=config_dir,
             store_sessions=store_sessions,
         )
 
+        self._host = host
         self._minimum_score = minimum_score
         self._subscribed_models = subscribed_models or set()
         self._ignore_stats = ignore_stats
         self._ws_subscriptions = []
         self.ignore_unadopted = ignore_unadopted
 
         if override_connection_host:
-            self._connection_host = ip_from_host(self._host)
+            self._connection_host = ip_from_host(host)
 
         if debug:
             set_debug()
 
     @property
     def is_ready(self) -> bool:
         return self._bootstrap is not None
@@ -754,31 +469,42 @@
     @property
     def bootstrap(self) -> Bootstrap:
         if self._bootstrap is None:
             raise BadRequest("Client not initalized, run `update` first")
 
         return self._bootstrap
 
+    def _update_connection_host(self) -> None:
+
+        index = 0
+        try:
+            # check if user supplied host is available
+            index = self.bootstrap.nvr.hosts.index(self._host)
+        except ValueError:
+            # check if IP of user supplied host is available
+            ip_address = ip_from_host(self._host)
+            with contextlib.suppress(ValueError):
+                index = self.bootstrap.nvr.hosts.index(ip_address)
+
+        self._connection_host = self.bootstrap.nvr.hosts[index]
+
+    def set_url(self, host: str, port: int) -> None:
+        """Set base URL."""
+
+        self._os.set_url(host, port)
+        self._host = host
+        self._update_connection_host()
+
     @property
     def connection_host(self) -> Union[IPv4Address, IPv6Address, str]:
         """Connection host to use for generating RTSP URLs"""
 
         if self._connection_host is None:
-            # fallback if cannot find user supplied host
-            index = 0
-            try:
-                # check if user supplied host is avaiable
-                index = self.bootstrap.nvr.hosts.index(self._host)
-            except ValueError:
-                # check if IP of user supplied host is avaiable
-                host = ip_from_host(self._host)
-                with contextlib.suppress(ValueError):
-                    index = self.bootstrap.nvr.hosts.index(host)
-
-            self._connection_host = self.bootstrap.nvr.hosts[index]
+            self._update_connection_host()
+            assert self._connection_host is not None
 
         return self._connection_host
 
     async def update(self, force: bool = False) -> Optional[Bootstrap]:
         """Updates the state of devices, initalizes `.bootstrap` and
         connects to UFP Websocket for real time updates
 
@@ -1479,15 +1205,15 @@
         ):
             return await self.api_request_raw(
                 path,
                 params=params,
                 raise_exception=False,
             )
 
-        r = await self.request(
+        r = await self._os.request(
             "get",
             urljoin(self.api_path, path),
             auto_close=False,
             timeout=0,
             params=params,
         )
         if output_file is not None:
@@ -1939,7 +1665,96 @@
         """Set PTZ home preset (-1) to current position."""
 
         preset = await self.api_request_obj(
             f"cameras/{device_id}/ptz/home",
             method="post",
         )
         return PTZPreset(**preset)
+
+    async def create_patrol_ptz_camera(
+        self,
+        device_id: str,
+        *,
+        name: str,
+        preset_slots: list[int],
+        duration: int = 10,
+    ) -> PTZPatrol:
+        """Create PTZ Patrol.
+
+        Duration is how long camera waits at each preset in seconds. Must be between 10 and 60.
+        """
+
+        data = {
+            "name": name,
+            "presets": preset_slots,
+            "presetDurationSeconds": duration,
+        }
+
+        patrol = await self.api_request_obj(
+            f"cameras/{device_id}/ptz/patrol",
+            method="post",
+            json=data,
+        )
+
+        return PTZPatrol.from_unifi_dict(api=self, **patrol)
+
+    async def get_patrols_ptz_camera(self, device_id: str) -> list[PTZPatrol]:
+        """Get PTZ Patrols."""
+
+        patrols = await self.api_request_list(f"cameras/{device_id}/ptz/patrol")
+
+        return [PTZPatrol.from_unifi_dict(api=self, **p) for p in patrols]
+
+    async def delete_patrol_ptz_camera(self, device_id: str, slot: int) -> None:
+        """Delete PTZ Patrol."""
+
+        await self.api_request(
+            f"cameras/{device_id}/ptz/patrol/{slot}",
+            method="delete",
+        )
+
+    async def get_active_ptz_patrol(self, device_id: str) -> PTZPatrol | None:
+        """Get active PTZ Patrol."""
+
+        try:
+            patrol = await self.api_request_obj(
+                f"cameras/{device_id}/ptz/patrol/active",
+            )
+        except BadRequest as ex:
+            if "404" in ex.args[0]:
+                return None
+            raise
+
+        return PTZPatrol.from_unifi_dict(api=self, **patrol)
+
+    async def start_patrol_ptz_camera(self, device_id: str, slot: int) -> None:
+        """Start a PTZ Patrol."""
+
+        await self.api_request(
+            f"cameras/{device_id}/ptz/patrol/start/{slot}",
+            method="post",
+        )
+
+    async def upload_animation(self, image_path: Path) -> None:
+        """Upload image file to use with doorbells with color LCD screens."""
+
+        data = aiohttp.FormData()
+        async with aiofiles.open(image_path, mode="rb") as f:
+            contents = await f.read()
+
+        content_type, _ = mimetypes.guess_type(image_path)
+        data.add_field(
+            name="file",
+            value=contents,
+            filename=image_path.name,
+            content_type=content_type,
+        )
+        await self.api_request_raw("files/animations", method="post", data=data)
+
+    async def delete_animation(self, sprite: str) -> None:
+        """Delete image file for doorbells."""
+
+        await self.api_request(
+            f"files/animations/{sprite}",
+            method="delete",
+            params={"ignoreFileExtension": "true"},
+        )
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/exceptions.py` & `pyunifiprotect-6.0.0/pyunifiprotect/exceptions.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/stream.py` & `pyunifiprotect-6.0.0/pyunifiprotect/stream.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/utils.py` & `pyunifiprotect-6.0.0/pyunifiprotect/utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,25 +24,30 @@
 import time
 from typing import TYPE_CHECKING, Any, Optional, TypeVar, Union, overload
 from uuid import UUID
 import zoneinfo
 
 from aiohttp import ClientResponse
 import jwt
-from pydantic.v1.fields import SHAPE_DICT, SHAPE_LIST, SHAPE_SET, ModelField
-from pydantic.v1.utils import to_camel
 
 from pyunifiprotect.data.types import (
     Color,
     SmartDetectAudioType,
     SmartDetectObjectType,
     Version,
     VideoMode,
 )
 from pyunifiprotect.exceptions import NvrError
+from pyunifiprotect.pydantic_compat import (
+    SHAPE_DICT,
+    SHAPE_LIST,
+    SHAPE_SET,
+    ModelField,
+    to_camel,
+)
 
 if TYPE_CHECKING:
     from pyunifiprotect.api import ProtectApiClient
     from pyunifiprotect.data import CoordType, Event
     from pyunifiprotect.data.bootstrap import WSStat
 
 if sys.version_info[:2] < (3, 11):
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/websocket.py` & `pyunifiprotect-6.0.0/pyunifiprotect/websocket.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/__init__.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -313,8 +313,9 @@
 
     _setup_logger()
 
     versions = run_async(callback())
     output = orjson.dumps(sorted([str(v) for v in versions]))
 
     Path(RELEASE_CACHE).write_bytes(output)
+
     typer.echo(output.decode("utf-8"))
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/backup.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/backup.py`

 * *Files 1% similar despite different names*

```diff
@@ -167,18 +167,18 @@
         if self._context is None:
             camera = ctx.protect.bootstrap.get_device_from_mac(self.camera_mac)  # type: ignore[arg-type]
             camera_slug = ""
             display_name = ""
             length = timedelta(seconds=0)
             if camera is not None:
                 camera_slug = (
-                    camera.display_name.lower().replace(" ", ctx.seperator)
+                    camera.device_name.lower().replace(" ", ctx.seperator)
                     + ctx.seperator
                 )
-                display_name = camera.display_name
+                display_name = camera.device_name
             if self.end is not None:
                 length = self.end - self.start
 
             event_type = str(self.event_type)
             event_type_pretty = f"{event_type.title()} Event"
             if event_type in {
                 d.EventType.SMART_DETECT.value,
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/base.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/base.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,20 +2,20 @@
 
 from collections.abc import Callable, Coroutine, Mapping, Sequence
 from dataclasses import dataclass
 from enum import Enum
 from typing import Any, Optional, TypeVar
 
 import orjson
-from pydantic.v1 import ValidationError
 import typer
 
 from pyunifiprotect.api import ProtectApiClient
 from pyunifiprotect.data import NVR, ProtectAdoptableDeviceModel, ProtectBaseObject
 from pyunifiprotect.exceptions import BadRequest, NvrError, StreamError
+from pyunifiprotect.pydantic_compat import ValidationError
 from pyunifiprotect.utils import run_async
 
 T = TypeVar("T")
 
 OPTION_FORCE = typer.Option(False, "-f", "--force", help="Skip confirmation prompt")
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/cameras.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/cameras.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/chimes.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/chimes.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/doorlocks.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/doorlocks.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/events.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/events.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/lights.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/lights.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/liveviews.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/liveviews.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/nvr.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/nvr.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 from __future__ import annotations
 
 from dataclasses import dataclass
 from datetime import timedelta
+from pathlib import Path
 
 import orjson
 import typer
 
 from pyunifiprotect.cli import base
 from pyunifiprotect.data import NVR, AnalyticsOption
 
@@ -155,7 +156,33 @@
 
     async def callback() -> None:
         if enable_smart:
             await nvr.set_smart_detections(True)
         await nvr.set_license_plate_recognition(value)
 
     base.run(ctx, callback())
+
+
+@app.command()
+def upload_doorbell_image(ctx: typer.Context, image_path: Path) -> None:
+    """Upload image to use with doorbells that have color LCD screens."""
+
+    nvr: NVR = ctx.obj.device
+
+    async def callback() -> None:
+        await nvr.api.upload_animation(image_path)
+
+    base.run(ctx, callback())
+
+
+@app.command()
+def delete_doorbell_image(ctx: typer.Context, image_sprite: str) -> None:
+    """Delete doorbell image.
+
+    image_sprite is the value from `nvr.doorbellSettings.customImages`"""
+
+    nvr: NVR = ctx.obj.device
+
+    async def callback() -> None:
+        await nvr.api.delete_animation(image_sprite)
+
+    base.run(ctx, callback())
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/sensors.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/sensors.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/cli/viewers.py` & `pyunifiprotect-6.0.0/pyunifiprotect/cli/viewers.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/__init__.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -2,14 +2,15 @@
 
 from pyunifiprotect.data.base import (
     ProtectAdoptableDeviceModel,
     ProtectBaseObject,
     ProtectDeviceModel,
     ProtectModel,
     ProtectModelWithId,
+    PTZPatrol,
 )
 from pyunifiprotect.data.bootstrap import Bootstrap
 from pyunifiprotect.data.convert import create_from_unifi_dict
 from pyunifiprotect.data.devices import (
     Bridge,
     Camera,
     CameraChannel,
@@ -54,14 +55,15 @@
     ModelType,
     MountType,
     Percent,
     PermissionNode,
     ProtectWSPayloadFormat,
     PTZPosition,
     PTZPreset,
+    PTZPresetDuration,
     RecordingMode,
     SensorStatusType,
     SensorType,
     SmartDetectAudioType,
     SmartDetectObjectType,
     StateType,
     StorageType,
@@ -115,16 +117,18 @@
     "LightModeEnableType",
     "LightModeType",
     "Liveview",
     "LockStatusType",
     "ModelType",
     "MountType",
     "NVRLocation",
+    "PTZPatrol",
     "PTZPosition",
     "PTZPreset",
+    "PTZPresetDuration",
     "Percent",
     "Permission",
     "PermissionNode",
     "ProtectAdoptableDeviceModel",
     "ProtectBaseObject",
     "ProtectDeviceModel",
     "ProtectModel",
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/base.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/base.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,50 +7,54 @@
 from datetime import datetime, timedelta
 from functools import cache
 from ipaddress import IPv4Address
 import logging
 from typing import TYPE_CHECKING, Any, ClassVar, Optional, TypeVar, Union
 from uuid import UUID
 
-from pydantic.v1 import BaseModel
-from pydantic.v1.fields import SHAPE_DICT, SHAPE_LIST, PrivateAttr
-
 from pyunifiprotect.data.types import (
     ModelType,
     PercentFloat,
     PermissionNode,
     ProtectWSPayloadFormat,
+    PTZPresetDuration,
     StateType,
 )
 from pyunifiprotect.data.websocket import (
     WSJSONPacketFrame,
     WSPacket,
     WSPacketFrameHeader,
 )
 from pyunifiprotect.exceptions import BadRequest, ClientError, NotAuthorized
+from pyunifiprotect.pydantic_compat import (
+    SHAPE_DICT,
+    SHAPE_LIST,
+    BaseModel,
+    PrivateAttr,
+)
 from pyunifiprotect.utils import (
     asyncio_timeout,
     convert_unifi_data,
     dict_diff,
     is_debug,
     process_datetime,
     serialize_unifi_obj,
     to_snake_case,
 )
 
 if TYPE_CHECKING:
     from asyncio.events import TimerHandle
 
-    from pydantic.v1.typing import DictStrAny, SetStr
     from typing_extensions import Self  # requires Python 3.11+
 
     from pyunifiprotect.api import ProtectApiClient
-    from pyunifiprotect.data.devices import Bridge
+    from pyunifiprotect.data.devices import Bridge, Camera
     from pyunifiprotect.data.nvr import Event
     from pyunifiprotect.data.user import User
+    from pyunifiprotect.pydantic_compat import DictStrAny, SetStr
 
 
 ProtectObject = TypeVar("ProtectObject", bound="ProtectBaseObject")
 RECENT_EVENT_MAX = timedelta(seconds=30)
 EVENT_PING_INTERVAL = timedelta(seconds=3)
 _LOGGER = logging.getLogger(__name__)
 
@@ -186,15 +190,15 @@
         """
 
         if cls._to_unifi_remaps is None:
             cls._to_unifi_remaps = {
                 to_key: from_key for from_key, to_key in cls._get_unifi_remaps().items()
             }
 
-        return cls._to_unifi_remaps
+        return cls._to_unifi_remaps  # type: ignore[no-any-return]
 
     @classmethod
     def _set_protect_subtypes(cls) -> None:
         """Helper method to detect attrs of current class that are UFP Objects themselves"""
 
         cls._protect_objs = {}
         cls._protect_lists = {}
@@ -223,15 +227,15 @@
 
     @classmethod
     def _get_protect_objs_set(cls) -> set[str]:
         """Helper method to get all child UFP objects"""
         if cls._protect_objs_set is None:
             cls._protect_objs_set = set(cls._get_protect_objs().keys())
 
-        return cls._protect_objs_set
+        return cls._protect_objs_set  # type: ignore[no-any-return]
 
     @classmethod
     def _get_protect_lists(cls) -> dict[str, type[ProtectBaseObject]]:
         """Helper method to get all child of UFP objects (lists)"""
         if cls._protect_lists is not None:
             return cls._protect_lists
 
@@ -240,15 +244,15 @@
 
     @classmethod
     def _get_protect_lists_set(cls) -> set[str]:
         """Helper method to get all child UFP objects"""
         if cls._protect_lists_set is None:
             cls._protect_lists_set = set(cls._get_protect_lists().keys())
 
-        return cls._protect_lists_set
+        return cls._protect_lists_set  # type: ignore[no-any-return]
 
     @classmethod
     def _get_protect_dicts(cls) -> dict[str, type[ProtectBaseObject]]:
         """Helper method to get all child of UFP objects (dicts)"""
         if cls._protect_dicts is not None:
             return cls._protect_dicts
 
@@ -257,15 +261,15 @@
 
     @classmethod
     def _get_protect_dicts_set(cls) -> set[str]:
         """Helper method to get all child UFP objects"""
         if cls._protect_dicts_set is None:
             cls._protect_dicts_set = set(cls._get_protect_dicts().keys())
 
-        return cls._protect_dicts_set
+        return cls._protect_dicts_set  # type: ignore[no-any-return]
 
     @classmethod
     def _get_api(cls, api: Optional[ProtectApiClient]) -> Optional[ProtectApiClient]:
         """Helper method to try to find and the current ProjtectAPIClient instance from given data"""
         if api is None and isinstance(cls, ProtectBaseObject) and hasattr(cls, "_api"):
             api = cls._api
 
@@ -586,14 +590,38 @@
 
         if "modelKey" in data and data["modelKey"] is None:
             del data["modelKey"]
 
         return data
 
 
+class PTZPatrol(ProtectModel):
+    name: str
+    slot: int
+    presets: list[int]
+    preset_movement_speed: Optional[Any]
+    preset_duration_seconds: PTZPresetDuration
+    camera_id: str
+    id: str
+
+    @classmethod
+    @cache
+    def _get_unifi_remaps(cls) -> dict[str, str]:
+        return {**super()._get_unifi_remaps(), "camera": "cameraId"}
+
+    @property
+    def camera(self) -> Camera:
+        """Paired Camera will always be none if no camera is paired"""
+
+        if self.camera_id is None:
+            return None
+
+        return self.api.bootstrap.cameras[self.camera_id]
+
+
 class ProtectModelWithId(ProtectModel):
     id: str
 
     _update_lock: asyncio.Lock = PrivateAttr(...)
     _update_queue: asyncio.Queue[Callable[[], None]] = PrivateAttr(...)
     _update_event: asyncio.Event = PrivateAttr(...)
 
@@ -813,14 +841,16 @@
     up_since: Optional[datetime]
     uptime: Optional[timedelta]
     last_seen: Optional[datetime]
     hardware_revision: Optional[str]
     firmware_version: Optional[str]
     is_updating: bool
     is_ssh_enabled: bool
+    # 4.0.7+
+    display_name: Optional[str] = None
 
     _callback_ping: Optional[TimerHandle] = PrivateAttr(None)
 
     @classmethod
     @cache
     def _get_read_only_fields(cls) -> set[str]:
         return super()._get_read_only_fields() | {
@@ -989,16 +1019,16 @@
     def unifi_dict_to_dict(cls, data: dict[str, Any]) -> dict[str, Any]:
         if "lastDisconnect" in data and data["lastDisconnect"] is not None:
             data["lastDisconnect"] = process_datetime(data, "lastDisconnect")
 
         return super().unifi_dict_to_dict(data)
 
     @property
-    def display_name(self) -> str:
-        return self.name or self.market_name or self.type
+    def device_name(self) -> str:
+        return self.display_name or self.name or self.market_name or self.type
 
     @property
     def is_wired(self) -> bool:
         return self.wired_connection_state is not None
 
     @property
     def is_wifi(self) -> bool:
@@ -1015,15 +1045,15 @@
 
         return self.api.bootstrap.bridges[self.bridge_id]
 
     @property
     def protect_url(self) -> str:
         """UFP Web app URL for this device"""
 
-        return f"{self.api.base_url}/protect/devices/{self.id}"
+        return f"{self.api.protect_url}/devices/{self.id}"
 
     @property
     def is_adopted_by_us(self) -> bool:
         """Verifies device is adopted and controlled by this NVR."""
 
         return self.is_adopted and not self.is_adopted_by_other
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/bootstrap.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/bootstrap.py`

 * *Files 1% similar despite different names*

```diff
@@ -7,15 +7,14 @@
 from dataclasses import dataclass
 from datetime import datetime
 import logging
 from typing import Any, Optional, cast
 from uuid import UUID
 
 from aiohttp.client_exceptions import ServerDisconnectedError
-from pydantic.v1 import PrivateAttr, ValidationError
 
 from pyunifiprotect.data.base import (
     RECENT_EVENT_MAX,
     ProtectBaseObject,
     ProtectModel,
     ProtectModelWithId,
 )
@@ -36,14 +35,15 @@
 from pyunifiprotect.data.websocket import (
     WSAction,
     WSJSONPacketFrame,
     WSPacket,
     WSSubscriptionMessage,
 )
 from pyunifiprotect.exceptions import ClientError
+from pyunifiprotect.pydantic_compat import PrivateAttr, ValidationError
 from pyunifiprotect.utils import utc_now
 
 _LOGGER = logging.getLogger(__name__)
 
 MAX_SUPPORTED_CAMERAS = 256
 MAX_EVENT_HISTORY_IN_STATE_MACHINE = MAX_SUPPORTED_CAMERAS * 2
 STATS_KEYS = {
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/convert.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/convert.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/devices.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/devices.py`

 * *Files 2% similar despite different names*

```diff
@@ -16,7071 +16,7179 @@
 000000f0: 7468 6c69 6220 696d 706f 7274 2050 6174  thlib import Pat
 00000100: 680a 6672 6f6d 2074 7970 696e 6720 696d  h.from typing im
 00000110: 706f 7274 2054 5950 455f 4348 4543 4b49  port TYPE_CHECKI
 00000120: 4e47 2c20 416e 792c 204c 6974 6572 616c  NG, Any, Literal
 00000130: 2c20 4f70 7469 6f6e 616c 2c20 556e 696f  , Optional, Unio
 00000140: 6e2c 2063 6173 740a 696d 706f 7274 2077  n, cast.import w
 00000150: 6172 6e69 6e67 730a 0a66 726f 6d20 7079  arnings..from py
-00000160: 6461 6e74 6963 2e76 312e 6669 656c 6473  dantic.v1.fields
-00000170: 2069 6d70 6f72 7420 5072 6976 6174 6541   import PrivateA
-00000180: 7474 720a 0a66 726f 6d20 7079 756e 6966  ttr..from pyunif
-00000190: 6970 726f 7465 6374 2e64 6174 612e 6261  iprotect.data.ba
-000001a0: 7365 2069 6d70 6f72 7420 280a 2020 2020  se import (.    
-000001b0: 4556 454e 545f 5049 4e47 5f49 4e54 4552  EVENT_PING_INTER
-000001c0: 5641 4c2c 0a20 2020 2050 726f 7465 6374  VAL,.    Protect
-000001d0: 4164 6f70 7461 626c 6544 6576 6963 654d  AdoptableDeviceM
-000001e0: 6f64 656c 2c0a 2020 2020 5072 6f74 6563  odel,.    Protec
-000001f0: 7442 6173 654f 626a 6563 742c 0a20 2020  tBaseObject,.   
-00000200: 2050 726f 7465 6374 4d6f 7469 6f6e 4465   ProtectMotionDe
-00000210: 7669 6365 4d6f 6465 6c2c 0a29 0a66 726f  viceModel,.).fro
-00000220: 6d20 7079 756e 6966 6970 726f 7465 6374  m pyunifiprotect
-00000230: 2e64 6174 612e 7479 7065 7320 696d 706f  .data.types impo
-00000240: 7274 2028 0a20 2020 2044 4546 4155 4c54  rt (.    DEFAULT
-00000250: 2c0a 2020 2020 4445 4641 554c 545f 5459  ,.    DEFAULT_TY
-00000260: 5045 2c0a 2020 2020 4175 6469 6f43 6f64  PE,.    AudioCod
-00000270: 6563 732c 0a20 2020 2041 7564 696f 5374  ecs,.    AudioSt
-00000280: 796c 652c 0a20 2020 2041 7574 6f45 7870  yle,.    AutoExp
-00000290: 6f73 7572 654d 6f64 652c 0a20 2020 2043  osureMode,.    C
-000002a0: 6869 6d65 5479 7065 2c0a 2020 2020 436f  himeType,.    Co
-000002b0: 6c6f 722c 0a20 2020 2044 6f6f 7262 656c  lor,.    Doorbel
-000002c0: 6c4d 6573 7361 6765 5479 7065 2c0a 2020  lMessageType,.  
-000002d0: 2020 466f 6375 734d 6f64 652c 0a20 2020    FocusMode,.   
-000002e0: 2047 656f 6665 6e63 696e 6753 6574 7469   GeofencingSetti
-000002f0: 6e67 2c0a 2020 2020 4844 524d 6f64 652c  ng,.    HDRMode,
-00000300: 0a20 2020 2049 4352 4375 7374 6f6d 5661  .    ICRCustomVa
-00000310: 6c75 652c 0a20 2020 2049 4352 4c75 7856  lue,.    ICRLuxV
-00000320: 616c 7565 2c0a 2020 2020 4943 5253 656e  alue,.    ICRSen
-00000330: 7369 7469 7669 7479 2c0a 2020 2020 4952  sitivity,.    IR
-00000340: 4c45 444d 6f64 652c 0a20 2020 2049 7465  LEDMode,.    Ite
-00000350: 7261 746f 7243 616c 6c62 6163 6b2c 0a20  ratorCallback,. 
-00000360: 2020 204c 4544 4c65 7665 6c2c 0a20 2020     LEDLevel,.   
-00000370: 204c 656e 7354 7970 652c 0a20 2020 204c   LensType,.    L
-00000380: 6967 6874 4d6f 6465 456e 6162 6c65 5479  ightModeEnableTy
-00000390: 7065 2c0a 2020 2020 4c69 6768 744d 6f64  pe,.    LightMod
-000003a0: 6554 7970 652c 0a20 2020 204c 6f63 6b53  eType,.    LockS
-000003b0: 7461 7475 7354 7970 652c 0a20 2020 204c  tatusType,.    L
-000003c0: 6f77 4d65 6448 6967 682c 0a20 2020 204d  owMedHigh,.    M
-000003d0: 6f64 656c 5479 7065 2c0a 2020 2020 4d6f  odelType,.    Mo
-000003e0: 7469 6f6e 416c 676f 7269 7468 6d2c 0a20  tionAlgorithm,. 
-000003f0: 2020 204d 6f75 6e74 506f 7369 7469 6f6e     MountPosition
-00000400: 2c0a 2020 2020 4d6f 756e 7454 7970 652c  ,.    MountType,
-00000410: 0a20 2020 2050 6572 6365 6e74 2c0a 2020  .    Percent,.  
-00000420: 2020 5065 7263 656e 7449 6e74 2c0a 2020    PercentInt,.  
-00000430: 2020 5065 726d 6973 7369 6f6e 4e6f 6465    PermissionNode
-00000440: 2c0a 2020 2020 5072 6f67 7265 7373 4361  ,.    ProgressCa
-00000450: 6c6c 6261 636b 2c0a 2020 2020 5054 5a50  llback,.    PTZP
-00000460: 6f73 6974 696f 6e2c 0a20 2020 2050 545a  osition,.    PTZ
-00000470: 5072 6573 6574 2c0a 2020 2020 5265 636f  Preset,.    Reco
-00000480: 7264 696e 674d 6f64 652c 0a20 2020 2052  rdingMode,.    R
-00000490: 6570 6561 7454 696d 6573 2c0a 2020 2020  epeatTimes,.    
-000004a0: 5365 6e73 6f72 5374 6174 7573 5479 7065  SensorStatusType
-000004b0: 2c0a 2020 2020 536d 6172 7444 6574 6563  ,.    SmartDetec
-000004c0: 7441 7564 696f 5479 7065 2c0a 2020 2020  tAudioType,.    
-000004d0: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
-000004e0: 7454 7970 652c 0a20 2020 2054 776f 4279  tType,.    TwoBy
-000004f0: 7465 496e 742c 0a20 2020 2056 6964 656f  teInt,.    Video
-00000500: 4d6f 6465 2c0a 2020 2020 5744 524c 6576  Mode,.    WDRLev
-00000510: 656c 2c0a 290a 6672 6f6d 2070 7975 6e69  el,.).from pyuni
-00000520: 6669 7072 6f74 6563 742e 6461 7461 2e75  fiprotect.data.u
-00000530: 7365 7220 696d 706f 7274 2055 7365 720a  ser import User.
-00000540: 6672 6f6d 2070 7975 6e69 6669 7072 6f74  from pyunifiprot
-00000550: 6563 742e 6578 6365 7074 696f 6e73 2069  ect.exceptions i
-00000560: 6d70 6f72 7420 4261 6452 6571 7565 7374  mport BadRequest
-00000570: 2c20 4e6f 7441 7574 686f 7269 7a65 642c  , NotAuthorized,
-00000580: 2053 7472 6561 6d45 7272 6f72 0a66 726f   StreamError.fro
-00000590: 6d20 7079 756e 6966 6970 726f 7465 6374  m pyunifiprotect
-000005a0: 2e73 7472 6561 6d20 696d 706f 7274 2054  .stream import T
-000005b0: 616c 6b62 6163 6b53 7472 6561 6d0a 6672  alkbackStream.fr
-000005c0: 6f6d 2070 7975 6e69 6669 7072 6f74 6563  om pyunifiprotec
-000005d0: 742e 7574 696c 7320 696d 706f 7274 2028  t.utils import (
-000005e0: 0a20 2020 2063 6c61 6d70 5f76 616c 7565  .    clamp_value
-000005f0: 2c0a 2020 2020 636f 6e76 6572 745f 736d  ,.    convert_sm
-00000600: 6172 745f 6175 6469 6f5f 7479 7065 732c  art_audio_types,
-00000610: 0a20 2020 2063 6f6e 7665 7274 5f73 6d61  .    convert_sma
-00000620: 7274 5f74 7970 6573 2c0a 2020 2020 636f  rt_types,.    co
-00000630: 6e76 6572 745f 7669 6465 6f5f 6d6f 6465  nvert_video_mode
-00000640: 732c 0a20 2020 2066 726f 6d5f 6a73 5f74  s,.    from_js_t
-00000650: 696d 652c 0a20 2020 2070 726f 6365 7373  ime,.    process
-00000660: 5f64 6174 6574 696d 652c 0a20 2020 2073  _datetime,.    s
-00000670: 6572 6961 6c69 7a65 5f70 6f69 6e74 2c0a  erialize_point,.
-00000680: 2020 2020 746f 5f6a 735f 7469 6d65 2c0a      to_js_time,.
-00000690: 2020 2020 7574 635f 6e6f 772c 0a29 0a0a      utc_now,.)..
-000006a0: 6966 2054 5950 455f 4348 4543 4b49 4e47  if TYPE_CHECKING
-000006b0: 3a0a 2020 2020 6672 6f6d 2070 7975 6e69  :.    from pyuni
-000006c0: 6669 7072 6f74 6563 742e 6461 7461 2e6e  fiprotect.data.n
-000006d0: 7672 2069 6d70 6f72 7420 4576 656e 742c  vr import Event,
-000006e0: 204c 6976 6576 6965 770a 0a50 5249 5641   Liveview..PRIVA
-000006f0: 4359 5f5a 4f4e 455f 4e41 4d45 203d 2022  CY_ZONE_NAME = "
-00000700: 7079 7566 705f 7072 6976 6163 795f 7a6f  pyufp_privacy_zo
-00000710: 6e65 220a 4c55 585f 4d41 5050 494e 475f  ne".LUX_MAPPING_
-00000720: 5641 4c55 4553 203d 205b 0a20 2020 2033  VALUES = [.    3
-00000730: 302c 0a20 2020 2032 352c 0a20 2020 2032  0,.    25,.    2
-00000740: 302c 0a20 2020 2031 352c 0a20 2020 2031  0,.    15,.    1
-00000750: 322c 0a20 2020 2031 302c 0a20 2020 2037  2,.    10,.    7
-00000760: 2c0a 2020 2020 352c 0a20 2020 2033 2c0a  ,.    5,.    3,.
-00000770: 2020 2020 312c 0a5d 0a0a 5f4c 4f47 4745      1,.].._LOGGE
-00000780: 5220 3d20 6c6f 6767 696e 672e 6765 744c  R = logging.getL
-00000790: 6f67 6765 7228 5f5f 6e61 6d65 5f5f 290a  ogger(__name__).
-000007a0: 0a0a 636c 6173 7320 4c69 6768 7444 6576  ..class LightDev
-000007b0: 6963 6553 6574 7469 6e67 7328 5072 6f74  iceSettings(Prot
-000007c0: 6563 7442 6173 654f 626a 6563 7429 3a0a  ectBaseObject):.
-000007d0: 2020 2020 2320 5374 6174 7573 204c 4544      # Status LED
-000007e0: 0a20 2020 2069 735f 696e 6469 6361 746f  .    is_indicato
-000007f0: 725f 656e 6162 6c65 643a 2062 6f6f 6c0a  r_enabled: bool.
-00000800: 2020 2020 2320 4272 6967 6874 6e65 7373      # Brightness
-00000810: 0a20 2020 206c 6564 5f6c 6576 656c 3a20  .    led_level: 
-00000820: 4c45 444c 6576 656c 0a20 2020 206c 7578  LEDLevel.    lux
-00000830: 5f73 656e 7369 7469 7669 7479 3a20 4c6f  _sensitivity: Lo
-00000840: 774d 6564 4869 6768 0a20 2020 2070 6972  wMedHigh.    pir
-00000850: 5f64 7572 6174 696f 6e3a 2074 696d 6564  _duration: timed
-00000860: 656c 7461 0a20 2020 2070 6972 5f73 656e  elta.    pir_sen
-00000870: 7369 7469 7669 7479 3a20 5065 7263 656e  sitivity: Percen
-00000880: 7449 6e74 0a0a 2020 2020 4063 6c61 7373  tInt..    @class
-00000890: 6d65 7468 6f64 0a20 2020 2064 6566 2075  method.    def u
-000008a0: 6e69 6669 5f64 6963 745f 746f 5f64 6963  nifi_dict_to_dic
-000008b0: 7428 636c 732c 2064 6174 613a 2064 6963  t(cls, data: dic
-000008c0: 745b 7374 722c 2041 6e79 5d29 202d 3e20  t[str, Any]) -> 
-000008d0: 6469 6374 5b73 7472 2c20 416e 795d 3a0a  dict[str, Any]:.
-000008e0: 2020 2020 2020 2020 6966 2022 7069 7244          if "pirD
-000008f0: 7572 6174 696f 6e22 2069 6e20 6461 7461  uration" in data
-00000900: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-00000910: 6e63 6528 6461 7461 5b22 7069 7244 7572  nce(data["pirDur
-00000920: 6174 696f 6e22 5d2c 2074 696d 6564 656c  ation"], timedel
-00000930: 7461 293a 0a20 2020 2020 2020 2020 2020  ta):.           
-00000940: 2064 6174 615b 2270 6972 4475 7261 7469   data["pirDurati
-00000950: 6f6e 225d 203d 2074 696d 6564 656c 7461  on"] = timedelta
-00000960: 286d 696c 6c69 7365 636f 6e64 733d 6461  (milliseconds=da
-00000970: 7461 5b22 7069 7244 7572 6174 696f 6e22  ta["pirDuration"
-00000980: 5d29 0a0a 2020 2020 2020 2020 7265 7475  ])..        retu
-00000990: 726e 2073 7570 6572 2829 2e75 6e69 6669  rn super().unifi
-000009a0: 5f64 6963 745f 746f 5f64 6963 7428 6461  _dict_to_dict(da
-000009b0: 7461 290a 0a0a 636c 6173 7320 4c69 6768  ta)...class Ligh
-000009c0: 744f 6e53 6574 7469 6e67 7328 5072 6f74  tOnSettings(Prot
-000009d0: 6563 7442 6173 654f 626a 6563 7429 3a0a  ectBaseObject):.
-000009e0: 2020 2020 2320 4d61 6e75 616c 2074 6f67      # Manual tog
-000009f0: 676c 6520 696e 2055 490a 2020 2020 6973  gle in UI.    is
-00000a00: 5f6c 6564 5f66 6f72 6365 5f6f 6e3a 2062  _led_force_on: b
-00000a10: 6f6f 6c0a 0a0a 636c 6173 7320 4c69 6768  ool...class Ligh
-00000a20: 744d 6f64 6553 6574 7469 6e67 7328 5072  tModeSettings(Pr
-00000a30: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
-00000a40: 3a0a 2020 2020 2320 6d61 696e 2022 4c69  :.    # main "Li
-00000a50: 6768 7469 6e67 2220 7365 7474 696e 6773  ghting" settings
-00000a60: 0a20 2020 206d 6f64 653a 204c 6967 6874  .    mode: Light
-00000a70: 4d6f 6465 5479 7065 0a20 2020 2065 6e61  ModeType.    ena
-00000a80: 626c 655f 6174 3a20 4c69 6768 744d 6f64  ble_at: LightMod
-00000a90: 6545 6e61 626c 6554 7970 650a 0a0a 636c  eEnableType...cl
-00000aa0: 6173 7320 4c69 6768 7428 5072 6f74 6563  ass Light(Protec
-00000ab0: 744d 6f74 696f 6e44 6576 6963 654d 6f64  tMotionDeviceMod
-00000ac0: 656c 293a 0a20 2020 2069 735f 7069 725f  el):.    is_pir_
-00000ad0: 6d6f 7469 6f6e 5f64 6574 6563 7465 643a  motion_detected:
-00000ae0: 2062 6f6f 6c0a 2020 2020 6973 5f6c 6967   bool.    is_lig
-00000af0: 6874 5f6f 6e3a 2062 6f6f 6c0a 2020 2020  ht_on: bool.    
-00000b00: 6973 5f6c 6f63 6174 696e 673a 2062 6f6f  is_locating: boo
-00000b10: 6c0a 2020 2020 6c69 6768 745f 6465 7669  l.    light_devi
-00000b20: 6365 5f73 6574 7469 6e67 733a 204c 6967  ce_settings: Lig
-00000b30: 6874 4465 7669 6365 5365 7474 696e 6773  htDeviceSettings
-00000b40: 0a20 2020 206c 6967 6874 5f6f 6e5f 7365  .    light_on_se
-00000b50: 7474 696e 6773 3a20 4c69 6768 744f 6e53  ttings: LightOnS
-00000b60: 6574 7469 6e67 730a 2020 2020 6c69 6768  ettings.    ligh
-00000b70: 745f 6d6f 6465 5f73 6574 7469 6e67 733a  t_mode_settings:
-00000b80: 204c 6967 6874 4d6f 6465 5365 7474 696e   LightModeSettin
-00000b90: 6773 0a20 2020 2063 616d 6572 615f 6964  gs.    camera_id
-00000ba0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d0a  : Optional[str].
-00000bb0: 2020 2020 6973 5f63 616d 6572 615f 7061      is_camera_pa
-00000bc0: 6972 6564 3a20 626f 6f6c 0a0a 2020 2020  ired: bool..    
-00000bd0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-00000be0: 2040 6361 6368 650a 2020 2020 6465 6620   @cache.    def 
-00000bf0: 5f67 6574 5f75 6e69 6669 5f72 656d 6170  _get_unifi_remap
-00000c00: 7328 636c 7329 202d 3e20 6469 6374 5b73  s(cls) -> dict[s
-00000c10: 7472 2c20 7374 725d 3a0a 2020 2020 2020  tr, str]:.      
-00000c20: 2020 7265 7475 726e 207b 2a2a 7375 7065    return {**supe
-00000c30: 7228 292e 5f67 6574 5f75 6e69 6669 5f72  r()._get_unifi_r
-00000c40: 656d 6170 7328 292c 2022 6361 6d65 7261  emaps(), "camera
-00000c50: 223a 2022 6361 6d65 7261 4964 227d 0a0a  ": "cameraId"}..
-00000c60: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00000c70: 0a20 2020 2040 6361 6368 650a 2020 2020  .    @cache.    
-00000c80: 6465 6620 5f67 6574 5f72 6561 645f 6f6e  def _get_read_on
-00000c90: 6c79 5f66 6965 6c64 7328 636c 7329 202d  ly_fields(cls) -
-00000ca0: 3e20 7365 745b 7374 725d 3a0a 2020 2020  > set[str]:.    
-00000cb0: 2020 2020 7265 7475 726e 2073 7570 6572      return super
-00000cc0: 2829 2e5f 6765 745f 7265 6164 5f6f 6e6c  ()._get_read_onl
-00000cd0: 795f 6669 656c 6473 2829 207c 207b 0a20  y_fields() | {. 
-00000ce0: 2020 2020 2020 2020 2020 2022 6973 5069             "isPi
-00000cf0: 724d 6f74 696f 6e44 6574 6563 7465 6422  rMotionDetected"
-00000d00: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
-00000d10: 734c 6967 6874 4f6e 222c 0a20 2020 2020  sLightOn",.     
-00000d20: 2020 2020 2020 2022 6973 4c6f 6361 7469         "isLocati
-00000d30: 6e67 222c 0a20 2020 2020 2020 207d 0a0a  ng",.        }..
-00000d40: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00000d50: 2020 6465 6620 6361 6d65 7261 2873 656c    def camera(sel
-00000d60: 6629 202d 3e20 4f70 7469 6f6e 616c 5b43  f) -> Optional[C
-00000d70: 616d 6572 615d 3a0a 2020 2020 2020 2020  amera]:.        
-00000d80: 2222 2250 6169 7265 6420 4361 6d65 7261  """Paired Camera
-00000d90: 2077 696c 6c20 616c 7761 7973 2062 6520   will always be 
-00000da0: 6e6f 6e65 2069 6620 6e6f 2063 616d 6572  none if no camer
-00000db0: 6120 6973 2070 6169 7265 6422 2222 0a0a  a is paired"""..
-00000dc0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00000dd0: 6361 6d65 7261 5f69 6420 6973 204e 6f6e  camera_id is Non
-00000de0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00000df0: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
-00000e00: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00000e10: 6170 692e 626f 6f74 7374 7261 702e 6361  api.bootstrap.ca
-00000e20: 6d65 7261 735b 7365 6c66 2e63 616d 6572  meras[self.camer
-00000e30: 615f 6964 5d0a 0a20 2020 2061 7379 6e63  a_id]..    async
-00000e40: 2064 6566 2073 6574 5f70 6169 7265 645f   def set_paired_
-00000e50: 6361 6d65 7261 2873 656c 662c 2063 616d  camera(self, cam
-00000e60: 6572 613a 204f 7074 696f 6e61 6c5b 4361  era: Optional[Ca
-00000e70: 6d65 7261 5d29 202d 3e20 4e6f 6e65 3a0a  mera]) -> None:.
-00000e80: 2020 2020 2020 2020 2222 2253 6574 7320          """Sets 
-00000e90: 7468 6520 6361 6d65 7261 2070 6169 7265  the camera paire
-00000ea0: 6420 7769 7468 2074 6865 206c 6967 6874  d with the light
-00000eb0: 2222 220a 0a20 2020 2020 2020 2061 7379  """..        asy
-00000ec0: 6e63 2077 6974 6820 7365 6c66 2e5f 7570  nc with self._up
-00000ed0: 6461 7465 5f6c 6f63 6b3a 0a20 2020 2020  date_lock:.     
-00000ee0: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
-00000ef0: 6e63 696f 2e73 6c65 6570 280a 2020 2020  ncio.sleep(.    
-00000f00: 2020 2020 2020 2020 2020 2020 302c 0a20              0,. 
-00000f10: 2020 2020 2020 2020 2020 2029 2020 2320             )  # 
-00000f20: 7969 656c 6420 746f 2074 6865 2065 7665  yield to the eve
-00000f30: 6e74 206c 6f6f 7020 6f6e 6365 2077 6520  nt loop once we 
-00000f40: 6861 7665 2074 6865 206c 6f63 6b20 746f  have the lock to
-00000f50: 2070 726f 6365 7373 2061 6e79 2070 656e   process any pen
-00000f60: 6469 6e67 2075 7064 6174 6573 0a20 2020  ding updates.   
-00000f70: 2020 2020 2020 2020 2064 6174 615f 6265           data_be
-00000f80: 666f 7265 5f63 6861 6e67 6573 203d 2073  fore_changes = s
-00000f90: 656c 662e 6469 6374 5f77 6974 685f 6578  elf.dict_with_ex
-00000fa0: 636c 7564 6573 2829 0a20 2020 2020 2020  cludes().       
-00000fb0: 2020 2020 2069 6620 6361 6d65 7261 2069       if camera i
-00000fc0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00000fd0: 2020 2020 2020 2020 7365 6c66 2e63 616d          self.cam
-00000fe0: 6572 615f 6964 203d 204e 6f6e 650a 2020  era_id = None.  
-00000ff0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00001000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001010: 7365 6c66 2e63 616d 6572 615f 6964 203d  self.camera_id =
-00001020: 2063 616d 6572 612e 6964 0a20 2020 2020   camera.id.     
-00001030: 2020 2020 2020 2061 7761 6974 2073 656c         await sel
-00001040: 662e 7361 7665 5f64 6576 6963 6528 6461  f.save_device(da
-00001050: 7461 5f62 6566 6f72 655f 6368 616e 6765  ta_before_change
-00001060: 732c 2066 6f72 6365 5f65 6d69 743d 5472  s, force_emit=Tr
-00001070: 7565 290a 0a20 2020 2061 7379 6e63 2064  ue)..    async d
-00001080: 6566 2073 6574 5f73 7461 7475 735f 6c69  ef set_status_li
-00001090: 6768 7428 7365 6c66 2c20 656e 6162 6c65  ght(self, enable
-000010a0: 643a 2062 6f6f 6c29 202d 3e20 4e6f 6e65  d: bool) -> None
-000010b0: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
-000010c0: 7320 7468 6520 7374 6174 7573 2069 6e64  s the status ind
-000010d0: 6963 6174 6f72 206c 6967 6874 2066 6f72  icator light for
-000010e0: 2074 6865 206c 6967 6874 2222 220a 0a20   the light""".. 
-000010f0: 2020 2020 2020 2064 6566 2063 616c 6c62         def callb
-00001100: 6163 6b28 2920 2d3e 204e 6f6e 653a 0a20  ack() -> None:. 
-00001110: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00001120: 6c69 6768 745f 6465 7669 6365 5f73 6574  light_device_set
-00001130: 7469 6e67 732e 6973 5f69 6e64 6963 6174  tings.is_indicat
-00001140: 6f72 5f65 6e61 626c 6564 203d 2065 6e61  or_enabled = ena
-00001150: 626c 6564 0a0a 2020 2020 2020 2020 6177  bled..        aw
-00001160: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
-00001170: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
-00001180: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
-00001190: 6574 5f6c 6564 5f6c 6576 656c 2873 656c  et_led_level(sel
-000011a0: 662c 206c 6564 5f6c 6576 656c 3a20 696e  f, led_level: in
-000011b0: 7429 202d 3e20 4e6f 6e65 3a0a 2020 2020  t) -> None:.    
-000011c0: 2020 2020 2222 2253 6574 7320 7468 6520      """Sets the 
-000011d0: 4c45 4420 6c65 7665 6c20 666f 7220 7468  LED level for th
-000011e0: 6520 6c69 6768 7422 2222 0a0a 2020 2020  e light"""..    
-000011f0: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
-00001200: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
-00001210: 2020 2020 2020 2020 7365 6c66 2e6c 6967          self.lig
-00001220: 6874 5f64 6576 6963 655f 7365 7474 696e  ht_device_settin
-00001230: 6773 2e6c 6564 5f6c 6576 656c 203d 204c  gs.led_level = L
-00001240: 4544 4c65 7665 6c28 6c65 645f 6c65 7665  EDLevel(led_leve
-00001250: 6c29 0a0a 2020 2020 2020 2020 6177 6169  l)..        awai
-00001260: 7420 7365 6c66 2e71 7565 7565 5f75 7064  t self.queue_upd
-00001270: 6174 6528 6361 6c6c 6261 636b 290a 0a20  ate(callback).. 
-00001280: 2020 2061 7379 6e63 2064 6566 2073 6574     async def set
-00001290: 5f6c 6967 6874 2873 656c 662c 2065 6e61  _light(self, ena
-000012a0: 626c 6564 3a20 626f 6f6c 2c20 6c65 645f  bled: bool, led_
-000012b0: 6c65 7665 6c3a 204f 7074 696f 6e61 6c5b  level: Optional[
-000012c0: 696e 745d 203d 204e 6f6e 6529 202d 3e20  int] = None) -> 
-000012d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-000012e0: 2246 6f72 6365 2074 7572 6e73 206f 6e2f  "Force turns on/
-000012f0: 6f66 6620 7468 6520 6c69 6768 7422 2222  off the light"""
-00001300: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
-00001310: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
-00001320: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00001330: 6c66 2e6c 6967 6874 5f6f 6e5f 7365 7474  lf.light_on_sett
-00001340: 696e 6773 2e69 735f 6c65 645f 666f 7263  ings.is_led_forc
-00001350: 655f 6f6e 203d 2065 6e61 626c 6564 0a20  e_on = enabled. 
-00001360: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00001370: 645f 6c65 7665 6c20 6973 206e 6f74 204e  d_level is not N
-00001380: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00001390: 2020 2020 2073 656c 662e 6c69 6768 745f       self.light_
-000013a0: 6465 7669 6365 5f73 6574 7469 6e67 732e  device_settings.
-000013b0: 6c65 645f 6c65 7665 6c20 3d20 4c45 444c  led_level = LEDL
-000013c0: 6576 656c 286c 6564 5f6c 6576 656c 290a  evel(led_level).
-000013d0: 0a20 2020 2020 2020 2061 7761 6974 2073  .        await s
-000013e0: 656c 662e 7175 6575 655f 7570 6461 7465  elf.queue_update
-000013f0: 2863 616c 6c62 6163 6b29 0a0a 2020 2020  (callback)..    
-00001400: 6173 796e 6320 6465 6620 7365 745f 7365  async def set_se
-00001410: 6e73 6974 6976 6974 7928 7365 6c66 2c20  nsitivity(self, 
-00001420: 7365 6e73 6974 6976 6974 793a 2069 6e74  sensitivity: int
-00001430: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00001440: 2020 2022 2222 5365 7473 206d 6f74 696f     """Sets motio
-00001450: 6e20 7365 6e73 6974 6976 6974 7922 2222  n sensitivity"""
-00001460: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
-00001470: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
-00001480: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00001490: 6c66 2e6c 6967 6874 5f64 6576 6963 655f  lf.light_device_
-000014a0: 7365 7474 696e 6773 2e70 6972 5f73 656e  settings.pir_sen
-000014b0: 7369 7469 7669 7479 203d 2050 6572 6365  sitivity = Perce
-000014c0: 6e74 496e 7428 7365 6e73 6974 6976 6974  ntInt(sensitivit
-000014d0: 7929 0a0a 2020 2020 2020 2020 6177 6169  y)..        awai
-000014e0: 7420 7365 6c66 2e71 7565 7565 5f75 7064  t self.queue_upd
-000014f0: 6174 6528 6361 6c6c 6261 636b 290a 0a20  ate(callback).. 
-00001500: 2020 2061 7379 6e63 2064 6566 2073 6574     async def set
-00001510: 5f64 7572 6174 696f 6e28 7365 6c66 2c20  _duration(self, 
-00001520: 6475 7261 7469 6f6e 3a20 7469 6d65 6465  duration: timede
-00001530: 6c74 6129 202d 3e20 4e6f 6e65 3a0a 2020  lta) -> None:.  
-00001540: 2020 2020 2020 2222 2253 6574 7320 6d6f        """Sets mo
-00001550: 7469 6f6e 2073 656e 7369 7469 7669 7479  tion sensitivity
-00001560: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00001570: 6475 7261 7469 6f6e 2e74 6f74 616c 5f73  duration.total_s
-00001580: 6563 6f6e 6473 2829 203c 2031 3520 6f72  econds() < 15 or
-00001590: 2064 7572 6174 696f 6e2e 746f 7461 6c5f   duration.total_
-000015a0: 7365 636f 6e64 7328 2920 3e20 3930 303a  seconds() > 900:
-000015b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000015c0: 7365 2042 6164 5265 7175 6573 7428 2244  se BadRequest("D
-000015d0: 7572 6174 696f 6e20 6f75 7473 6964 6520  uration outside 
-000015e0: 6f66 2031 3573 2074 6f20 3930 3073 2072  of 15s to 900s r
-000015f0: 616e 6765 2229 0a0a 2020 2020 2020 2020  ange")..        
-00001600: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
-00001610: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00001620: 2020 2020 7365 6c66 2e6c 6967 6874 5f64      self.light_d
-00001630: 6576 6963 655f 7365 7474 696e 6773 2e70  evice_settings.p
-00001640: 6972 5f64 7572 6174 696f 6e20 3d20 6475  ir_duration = du
-00001650: 7261 7469 6f6e 0a0a 2020 2020 2020 2020  ration..        
-00001660: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
-00001670: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
-00001680: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
-00001690: 2073 6574 5f6c 6967 6874 5f73 6574 7469   set_light_setti
-000016a0: 6e67 7328 0a20 2020 2020 2020 2073 656c  ngs(.        sel
-000016b0: 662c 0a20 2020 2020 2020 206d 6f64 653a  f,.        mode:
-000016c0: 204c 6967 6874 4d6f 6465 5479 7065 2c0a   LightModeType,.
-000016d0: 2020 2020 2020 2020 656e 6162 6c65 5f61          enable_a
-000016e0: 743a 204f 7074 696f 6e61 6c5b 4c69 6768  t: Optional[Ligh
-000016f0: 744d 6f64 6545 6e61 626c 6554 7970 655d  tModeEnableType]
-00001700: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00001710: 2064 7572 6174 696f 6e3a 204f 7074 696f   duration: Optio
-00001720: 6e61 6c5b 7469 6d65 6465 6c74 615d 203d  nal[timedelta] =
-00001730: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-00001740: 656e 7369 7469 7669 7479 3a20 4f70 7469  ensitivity: Opti
-00001750: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
-00001760: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-00001770: 0a20 2020 2020 2020 2022 2222 5570 6461  .        """Upda
-00001780: 7465 7320 7661 7269 6f75 7320 4c69 6768  tes various Ligh
-00001790: 7420 7365 7474 696e 6773 2e0a 0a20 2020  t settings...   
-000017a0: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-000017b0: 2020 202d 2d2d 2d0a 2020 2020 2020 2020     ----.        
-000017c0: 2020 2020 6d6f 6465 3a20 4c69 6768 7420      mode: Light 
-000017d0: 7472 6967 6765 7220 6d6f 6465 0a20 2020  trigger mode.   
-000017e0: 2020 2020 2020 2020 2065 6e61 626c 655f           enable_
-000017f0: 6174 3a20 5468 656e 2074 6865 206c 6967  at: Then the lig
-00001800: 6874 2061 7574 6f6d 6174 6963 616c 6c79  ht automatically
-00001810: 2074 7572 6e73 206f 6e20 6279 2069 7473   turns on by its
-00001820: 656c 660a 2020 2020 2020 2020 2020 2020  elf.            
-00001830: 6475 7261 7469 6f6e 3a20 486f 7720 6c6f  duration: How lo
-00001840: 6e67 2074 6865 206c 6967 6874 2073 686f  ng the light sho
-00001850: 756c 6420 7265 6d61 696e 206f 6e20 6166  uld remain on af
-00001860: 7465 7220 6d6f 7469 6f6e 2c20 6d75 7374  ter motion, must
-00001870: 2062 6520 7469 6d65 6465 6c74 6120 6265   be timedelta be
-00001880: 7477 6565 6e20 3135 7320 616e 6420 3930  tween 15s and 90
-00001890: 3073 0a20 2020 2020 2020 2020 2020 2073  0s.            s
-000018a0: 656e 7369 7469 7669 7479 3a20 5049 5220  ensitivity: PIR 
-000018b0: 4d6f 7469 6f6e 2073 656e 7369 7469 7669  Motion sensitivi
-000018c0: 7479 0a20 2020 2020 2020 2022 2222 0a0a  ty.        """..
-000018d0: 2020 2020 2020 2020 6966 2064 7572 6174          if durat
-000018e0: 696f 6e20 6973 206e 6f74 204e 6f6e 6520  ion is not None 
-000018f0: 616e 6420 280a 2020 2020 2020 2020 2020  and (.          
-00001900: 2020 6475 7261 7469 6f6e 2e74 6f74 616c    duration.total
-00001910: 5f73 6563 6f6e 6473 2829 203c 2031 3520  _seconds() < 15 
-00001920: 6f72 2064 7572 6174 696f 6e2e 746f 7461  or duration.tota
-00001930: 6c5f 7365 636f 6e64 7328 2920 3e20 3930  l_seconds() > 90
-00001940: 300a 2020 2020 2020 2020 293a 0a20 2020  0.        ):.   
-00001950: 2020 2020 2020 2020 2072 6169 7365 2042           raise B
-00001960: 6164 5265 7175 6573 7428 2244 7572 6174  adRequest("Durat
-00001970: 696f 6e20 6f75 7473 6964 6520 6f66 2031  ion outside of 1
-00001980: 3573 2074 6f20 3930 3073 2072 616e 6765  5s to 900s range
-00001990: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
-000019a0: 6361 6c6c 6261 636b 2829 202d 3e20 4e6f  callback() -> No
-000019b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000019c0: 7365 6c66 2e6c 6967 6874 5f6d 6f64 655f  self.light_mode_
-000019d0: 7365 7474 696e 6773 2e6d 6f64 6520 3d20  settings.mode = 
-000019e0: 6d6f 6465 0a20 2020 2020 2020 2020 2020  mode.           
-000019f0: 2069 6620 656e 6162 6c65 5f61 7420 6973   if enable_at is
-00001a00: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00001a10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00001a20: 6c69 6768 745f 6d6f 6465 5f73 6574 7469  light_mode_setti
-00001a30: 6e67 732e 656e 6162 6c65 5f61 7420 3d20  ngs.enable_at = 
-00001a40: 656e 6162 6c65 5f61 740a 2020 2020 2020  enable_at.      
-00001a50: 2020 2020 2020 6966 2064 7572 6174 696f        if duratio
-00001a60: 6e20 6973 206e 6f74 204e 6f6e 653a 0a20  n is not None:. 
-00001a70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00001a80: 656c 662e 6c69 6768 745f 6465 7669 6365  elf.light_device
-00001a90: 5f73 6574 7469 6e67 732e 7069 725f 6475  _settings.pir_du
-00001aa0: 7261 7469 6f6e 203d 2064 7572 6174 696f  ration = duratio
-00001ab0: 6e0a 2020 2020 2020 2020 2020 2020 6966  n.            if
-00001ac0: 2073 656e 7369 7469 7669 7479 2069 7320   sensitivity is 
-00001ad0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00001ae0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00001af0: 6967 6874 5f64 6576 6963 655f 7365 7474  ight_device_sett
-00001b00: 696e 6773 2e70 6972 5f73 656e 7369 7469  ings.pir_sensiti
-00001b10: 7669 7479 203d 2050 6572 6365 6e74 496e  vity = PercentIn
-00001b20: 7428 7365 6e73 6974 6976 6974 7929 0a0a  t(sensitivity)..
-00001b30: 2020 2020 2020 2020 6177 6169 7420 7365          await se
-00001b40: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
-00001b50: 6361 6c6c 6261 636b 290a 0a0a 636c 6173  callback)...clas
-00001b60: 7320 4361 6d65 7261 4368 616e 6e65 6c28  s CameraChannel(
-00001b70: 5072 6f74 6563 7442 6173 654f 626a 6563  ProtectBaseObjec
-00001b80: 7429 3a0a 2020 2020 6964 3a20 696e 7420  t):.    id: int 
-00001b90: 2023 2072 6561 6420 6f6e 6c79 0a20 2020   # read only.   
-00001ba0: 2076 6964 656f 5f69 643a 2073 7472 2020   video_id: str  
-00001bb0: 2320 7265 6164 206f 6e6c 790a 2020 2020  # read only.    
-00001bc0: 6e61 6d65 3a20 7374 7220 2023 2072 6561  name: str  # rea
-00001bd0: 6420 6f6e 6c79 0a20 2020 2065 6e61 626c  d only.    enabl
-00001be0: 6564 3a20 626f 6f6c 2020 2320 7265 6164  ed: bool  # read
-00001bf0: 206f 6e6c 790a 2020 2020 6973 5f72 7473   only.    is_rts
-00001c00: 705f 656e 6162 6c65 643a 2062 6f6f 6c0a  p_enabled: bool.
-00001c10: 2020 2020 7274 7370 5f61 6c69 6173 3a20      rtsp_alias: 
-00001c20: 4f70 7469 6f6e 616c 5b73 7472 5d20 2023  Optional[str]  #
-00001c30: 2072 6561 6420 6f6e 6c79 0a20 2020 2077   read only.    w
-00001c40: 6964 7468 3a20 696e 740a 2020 2020 6865  idth: int.    he
-00001c50: 6967 6874 3a20 696e 740a 2020 2020 6670  ight: int.    fp
-00001c60: 733a 2069 6e74 0a20 2020 2062 6974 7261  s: int.    bitra
-00001c70: 7465 3a20 696e 740a 2020 2020 6d69 6e5f  te: int.    min_
-00001c80: 6269 7472 6174 653a 2069 6e74 2020 2320  bitrate: int  # 
-00001c90: 7265 6164 206f 6e6c 790a 2020 2020 6d61  read only.    ma
-00001ca0: 785f 6269 7472 6174 653a 2069 6e74 2020  x_bitrate: int  
-00001cb0: 2320 7265 6164 206f 6e6c 790a 2020 2020  # read only.    
-00001cc0: 6d69 6e5f 636c 6965 6e74 5f61 6461 7074  min_client_adapt
-00001cd0: 6976 655f 6269 745f 7261 7465 3a20 4f70  ive_bit_rate: Op
-00001ce0: 7469 6f6e 616c 5b69 6e74 5d20 2023 2072  tional[int]  # r
-00001cf0: 6561 6420 6f6e 6c79 0a20 2020 206d 696e  ead only.    min
-00001d00: 5f6d 6f74 696f 6e5f 6164 6170 7469 7665  _motion_adaptive
-00001d10: 5f62 6974 5f72 6174 653a 204f 7074 696f  _bit_rate: Optio
-00001d20: 6e61 6c5b 696e 745d 2020 2320 7265 6164  nal[int]  # read
-00001d30: 206f 6e6c 790a 2020 2020 6670 735f 7661   only.    fps_va
-00001d40: 6c75 6573 3a20 6c69 7374 5b69 6e74 5d20  lues: list[int] 
-00001d50: 2023 2072 6561 6420 6f6e 6c79 0a20 2020   # read only.   
-00001d60: 2069 6472 5f69 6e74 6572 7661 6c3a 2069   idr_interval: i
-00001d70: 6e74 0a20 2020 2023 2033 2e30 2e32 322b  nt.    # 3.0.22+
-00001d80: 0a20 2020 2061 7574 6f5f 6269 7472 6174  .    auto_bitrat
-00001d90: 653a 204f 7074 696f 6e61 6c5b 626f 6f6c  e: Optional[bool
-00001da0: 5d20 3d20 4e6f 6e65 0a20 2020 2061 7574  ] = None.    aut
-00001db0: 6f5f 6670 733a 204f 7074 696f 6e61 6c5b  o_fps: Optional[
-00001dc0: 626f 6f6c 5d20 3d20 4e6f 6e65 0a0a 2020  bool] = None..  
-00001dd0: 2020 5f72 7473 705f 7572 6c3a 204f 7074    _rtsp_url: Opt
-00001de0: 696f 6e61 6c5b 7374 725d 203d 2050 7269  ional[str] = Pri
-00001df0: 7661 7465 4174 7472 284e 6f6e 6529 0a20  vateAttr(None). 
-00001e00: 2020 205f 7274 7370 735f 7572 6c3a 204f     _rtsps_url: O
-00001e10: 7074 696f 6e61 6c5b 7374 725d 203d 2050  ptional[str] = P
-00001e20: 7269 7661 7465 4174 7472 284e 6f6e 6529  rivateAttr(None)
-00001e30: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00001e40: 2020 2020 6465 6620 7274 7370 5f75 726c      def rtsp_url
-00001e50: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
-00001e60: 616c 5b73 7472 5d3a 0a20 2020 2020 2020  al[str]:.       
-00001e70: 2069 6620 6e6f 7420 7365 6c66 2e69 735f   if not self.is_
-00001e80: 7274 7370 5f65 6e61 626c 6564 206f 7220  rtsp_enabled or 
-00001e90: 7365 6c66 2e72 7473 705f 616c 6961 7320  self.rtsp_alias 
-00001ea0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00001eb0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-00001ec0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00001ed0: 662e 5f72 7473 705f 7572 6c20 6973 206e  f._rtsp_url is n
-00001ee0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00001ef0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00001f00: 2e5f 7274 7370 5f75 726c 0a20 2020 2020  ._rtsp_url.     
-00001f10: 2020 2073 656c 662e 5f72 7473 705f 7572     self._rtsp_ur
-00001f20: 6c20 3d20 6622 7274 7370 3a2f 2f7b 7365  l = f"rtsp://{se
-00001f30: 6c66 2e61 7069 2e63 6f6e 6e65 6374 696f  lf.api.connectio
-00001f40: 6e5f 686f 7374 7d3a 7b73 656c 662e 6170  n_host}:{self.ap
-00001f50: 692e 626f 6f74 7374 7261 702e 6e76 722e  i.bootstrap.nvr.
-00001f60: 706f 7274 732e 7274 7370 7d2f 7b73 656c  ports.rtsp}/{sel
-00001f70: 662e 7274 7370 5f61 6c69 6173 7d22 0a20  f.rtsp_alias}". 
-00001f80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00001f90: 6c66 2e5f 7274 7370 5f75 726c 0a0a 2020  lf._rtsp_url..  
-00001fa0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00001fb0: 6465 6620 7274 7370 735f 7572 6c28 7365  def rtsps_url(se
-00001fc0: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-00001fd0: 7374 725d 3a0a 2020 2020 2020 2020 6966  str]:.        if
-00001fe0: 206e 6f74 2073 656c 662e 6973 5f72 7473   not self.is_rts
-00001ff0: 705f 656e 6162 6c65 6420 6f72 2073 656c  p_enabled or sel
-00002000: 662e 7274 7370 5f61 6c69 6173 2069 7320  f.rtsp_alias is 
-00002010: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00002020: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
-00002030: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00002040: 7274 7370 735f 7572 6c20 6973 206e 6f74  rtsps_url is not
-00002050: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00002060: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00002070: 7274 7370 735f 7572 6c0a 2020 2020 2020  rtsps_url.      
-00002080: 2020 7365 6c66 2e5f 7274 7370 735f 7572    self._rtsps_ur
-00002090: 6c20 3d20 6622 7274 7370 733a 2f2f 7b73  l = f"rtsps://{s
-000020a0: 656c 662e 6170 692e 636f 6e6e 6563 7469  elf.api.connecti
-000020b0: 6f6e 5f68 6f73 747d 3a7b 7365 6c66 2e61  on_host}:{self.a
-000020c0: 7069 2e62 6f6f 7473 7472 6170 2e6e 7672  pi.bootstrap.nvr
-000020d0: 2e70 6f72 7473 2e72 7473 7073 7d2f 7b73  .ports.rtsps}/{s
-000020e0: 656c 662e 7274 7370 5f61 6c69 6173 7d3f  elf.rtsp_alias}?
-000020f0: 656e 6162 6c65 5372 7470 220a 2020 2020  enableSrtp".    
-00002100: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00002110: 5f72 7473 7073 5f75 726c 0a0a 2020 2020  _rtsps_url..    
-00002120: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00002130: 6620 6973 5f70 6163 6b61 6765 2873 656c  f is_package(sel
-00002140: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-00002150: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00002160: 6670 7320 3c3d 2032 0a0a 0a63 6c61 7373  fps <= 2...class
-00002170: 2049 5350 5365 7474 696e 6773 2850 726f   ISPSettings(Pro
-00002180: 7465 6374 4261 7365 4f62 6a65 6374 293a  tectBaseObject):
-00002190: 0a20 2020 2061 655f 6d6f 6465 3a20 4175  .    ae_mode: Au
-000021a0: 746f 4578 706f 7375 7265 4d6f 6465 0a20  toExposureMode. 
-000021b0: 2020 2069 725f 6c65 645f 6d6f 6465 3a20     ir_led_mode: 
-000021c0: 4952 4c45 444d 6f64 650a 2020 2020 6972  IRLEDMode.    ir
-000021d0: 5f6c 6564 5f6c 6576 656c 3a20 5477 6f42  _led_level: TwoB
-000021e0: 7974 6549 6e74 0a20 2020 2077 6472 3a20  yteInt.    wdr: 
-000021f0: 5744 524c 6576 656c 0a20 2020 2069 6372  WDRLevel.    icr
-00002200: 5f73 656e 7369 7469 7669 7479 3a20 4943  _sensitivity: IC
-00002210: 5253 656e 7369 7469 7669 7479 0a20 2020  RSensitivity.   
-00002220: 2062 7269 6768 746e 6573 733a 2069 6e74   brightness: int
-00002230: 0a20 2020 2063 6f6e 7472 6173 743a 2069  .    contrast: i
-00002240: 6e74 0a20 2020 2068 7565 3a20 696e 740a  nt.    hue: int.
-00002250: 2020 2020 7361 7475 7261 7469 6f6e 3a20      saturation: 
-00002260: 696e 740a 2020 2020 7368 6172 706e 6573  int.    sharpnes
-00002270: 733a 2069 6e74 0a20 2020 2064 656e 6f69  s: int.    denoi
-00002280: 7365 3a20 696e 740a 2020 2020 6973 5f66  se: int.    is_f
-00002290: 6c69 7070 6564 5f76 6572 7469 6361 6c3a  lipped_vertical:
-000022a0: 2062 6f6f 6c0a 2020 2020 6973 5f66 6c69   bool.    is_fli
-000022b0: 7070 6564 5f68 6f72 697a 6f6e 7461 6c3a  pped_horizontal:
-000022c0: 2062 6f6f 6c0a 2020 2020 6973 5f61 7574   bool.    is_aut
-000022d0: 6f5f 726f 7461 7465 5f65 6e61 626c 6564  o_rotate_enabled
-000022e0: 3a20 626f 6f6c 0a20 2020 2069 735f 6c64  : bool.    is_ld
-000022f0: 635f 656e 6162 6c65 643a 2062 6f6f 6c0a  c_enabled: bool.
-00002300: 2020 2020 6973 5f33 646e 725f 656e 6162      is_3dnr_enab
+00000160: 756e 6966 6970 726f 7465 6374 2e64 6174  unifiprotect.dat
+00000170: 612e 6261 7365 2069 6d70 6f72 7420 280a  a.base import (.
+00000180: 2020 2020 4556 454e 545f 5049 4e47 5f49      EVENT_PING_I
+00000190: 4e54 4552 5641 4c2c 0a20 2020 2050 726f  NTERVAL,.    Pro
+000001a0: 7465 6374 4164 6f70 7461 626c 6544 6576  tectAdoptableDev
+000001b0: 6963 654d 6f64 656c 2c0a 2020 2020 5072  iceModel,.    Pr
+000001c0: 6f74 6563 7442 6173 654f 626a 6563 742c  otectBaseObject,
+000001d0: 0a20 2020 2050 726f 7465 6374 4d6f 7469  .    ProtectMoti
+000001e0: 6f6e 4465 7669 6365 4d6f 6465 6c2c 0a20  onDeviceModel,. 
+000001f0: 2020 2050 545a 5061 7472 6f6c 2c0a 290a     PTZPatrol,.).
+00000200: 6672 6f6d 2070 7975 6e69 6669 7072 6f74  from pyunifiprot
+00000210: 6563 742e 6461 7461 2e74 7970 6573 2069  ect.data.types i
+00000220: 6d70 6f72 7420 280a 2020 2020 4445 4641  mport (.    DEFA
+00000230: 554c 542c 0a20 2020 2044 4546 4155 4c54  ULT,.    DEFAULT
+00000240: 5f54 5950 452c 0a20 2020 2041 7564 696f  _TYPE,.    Audio
+00000250: 436f 6465 6373 2c0a 2020 2020 4175 6469  Codecs,.    Audi
+00000260: 6f53 7479 6c65 2c0a 2020 2020 4175 746f  oStyle,.    Auto
+00000270: 4578 706f 7375 7265 4d6f 6465 2c0a 2020  ExposureMode,.  
+00000280: 2020 4368 696d 6554 7970 652c 0a20 2020    ChimeType,.   
+00000290: 2043 6f6c 6f72 2c0a 2020 2020 446f 6f72   Color,.    Door
+000002a0: 6265 6c6c 4d65 7373 6167 6554 7970 652c  bellMessageType,
+000002b0: 0a20 2020 2046 6f63 7573 4d6f 6465 2c0a  .    FocusMode,.
+000002c0: 2020 2020 4765 6f66 656e 6369 6e67 5365      GeofencingSe
+000002d0: 7474 696e 672c 0a20 2020 2048 4452 4d6f  tting,.    HDRMo
+000002e0: 6465 2c0a 2020 2020 4943 5243 7573 746f  de,.    ICRCusto
+000002f0: 6d56 616c 7565 2c0a 2020 2020 4943 524c  mValue,.    ICRL
+00000300: 7578 5661 6c75 652c 0a20 2020 2049 4352  uxValue,.    ICR
+00000310: 5365 6e73 6974 6976 6974 792c 0a20 2020  Sensitivity,.   
+00000320: 2049 524c 4544 4d6f 6465 2c0a 2020 2020   IRLEDMode,.    
+00000330: 4974 6572 6174 6f72 4361 6c6c 6261 636b  IteratorCallback
+00000340: 2c0a 2020 2020 4c45 444c 6576 656c 2c0a  ,.    LEDLevel,.
+00000350: 2020 2020 4c65 6e73 5479 7065 2c0a 2020      LensType,.  
+00000360: 2020 4c69 6768 744d 6f64 6545 6e61 626c    LightModeEnabl
+00000370: 6554 7970 652c 0a20 2020 204c 6967 6874  eType,.    Light
+00000380: 4d6f 6465 5479 7065 2c0a 2020 2020 4c6f  ModeType,.    Lo
+00000390: 636b 5374 6174 7573 5479 7065 2c0a 2020  ckStatusType,.  
+000003a0: 2020 4c6f 774d 6564 4869 6768 2c0a 2020    LowMedHigh,.  
+000003b0: 2020 4d6f 6465 6c54 7970 652c 0a20 2020    ModelType,.   
+000003c0: 204d 6f74 696f 6e41 6c67 6f72 6974 686d   MotionAlgorithm
+000003d0: 2c0a 2020 2020 4d6f 756e 7450 6f73 6974  ,.    MountPosit
+000003e0: 696f 6e2c 0a20 2020 204d 6f75 6e74 5479  ion,.    MountTy
+000003f0: 7065 2c0a 2020 2020 5065 7263 656e 742c  pe,.    Percent,
+00000400: 0a20 2020 2050 6572 6365 6e74 496e 742c  .    PercentInt,
+00000410: 0a20 2020 2050 6572 6d69 7373 696f 6e4e  .    PermissionN
+00000420: 6f64 652c 0a20 2020 2050 726f 6772 6573  ode,.    Progres
+00000430: 7343 616c 6c62 6163 6b2c 0a20 2020 2050  sCallback,.    P
+00000440: 545a 506f 7369 7469 6f6e 2c0a 2020 2020  TZPosition,.    
+00000450: 5054 5a50 7265 7365 742c 0a20 2020 2052  PTZPreset,.    R
+00000460: 6563 6f72 6469 6e67 4d6f 6465 2c0a 2020  ecordingMode,.  
+00000470: 2020 5265 7065 6174 5469 6d65 732c 0a20    RepeatTimes,. 
+00000480: 2020 2053 656e 736f 7253 7461 7475 7354     SensorStatusT
+00000490: 7970 652c 0a20 2020 2053 6d61 7274 4465  ype,.    SmartDe
+000004a0: 7465 6374 4175 6469 6f54 7970 652c 0a20  tectAudioType,. 
+000004b0: 2020 2053 6d61 7274 4465 7465 6374 4f62     SmartDetectOb
+000004c0: 6a65 6374 5479 7065 2c0a 2020 2020 5477  jectType,.    Tw
+000004d0: 6f42 7974 6549 6e74 2c0a 2020 2020 5669  oByteInt,.    Vi
+000004e0: 6465 6f4d 6f64 652c 0a20 2020 2057 4452  deoMode,.    WDR
+000004f0: 4c65 7665 6c2c 0a29 0a66 726f 6d20 7079  Level,.).from py
+00000500: 756e 6966 6970 726f 7465 6374 2e64 6174  unifiprotect.dat
+00000510: 612e 7573 6572 2069 6d70 6f72 7420 5573  a.user import Us
+00000520: 6572 0a66 726f 6d20 7079 756e 6966 6970  er.from pyunifip
+00000530: 726f 7465 6374 2e65 7863 6570 7469 6f6e  rotect.exception
+00000540: 7320 696d 706f 7274 2042 6164 5265 7175  s import BadRequ
+00000550: 6573 742c 204e 6f74 4175 7468 6f72 697a  est, NotAuthoriz
+00000560: 6564 2c20 5374 7265 616d 4572 726f 720a  ed, StreamError.
+00000570: 6672 6f6d 2070 7975 6e69 6669 7072 6f74  from pyunifiprot
+00000580: 6563 742e 7079 6461 6e74 6963 5f63 6f6d  ect.pydantic_com
+00000590: 7061 7420 696d 706f 7274 2050 7269 7661  pat import Priva
+000005a0: 7465 4174 7472 0a66 726f 6d20 7079 756e  teAttr.from pyun
+000005b0: 6966 6970 726f 7465 6374 2e73 7472 6561  ifiprotect.strea
+000005c0: 6d20 696d 706f 7274 2054 616c 6b62 6163  m import Talkbac
+000005d0: 6b53 7472 6561 6d0a 6672 6f6d 2070 7975  kStream.from pyu
+000005e0: 6e69 6669 7072 6f74 6563 742e 7574 696c  nifiprotect.util
+000005f0: 7320 696d 706f 7274 2028 0a20 2020 2063  s import (.    c
+00000600: 6c61 6d70 5f76 616c 7565 2c0a 2020 2020  lamp_value,.    
+00000610: 636f 6e76 6572 745f 736d 6172 745f 6175  convert_smart_au
+00000620: 6469 6f5f 7479 7065 732c 0a20 2020 2063  dio_types,.    c
+00000630: 6f6e 7665 7274 5f73 6d61 7274 5f74 7970  onvert_smart_typ
+00000640: 6573 2c0a 2020 2020 636f 6e76 6572 745f  es,.    convert_
+00000650: 7669 6465 6f5f 6d6f 6465 732c 0a20 2020  video_modes,.   
+00000660: 2066 726f 6d5f 6a73 5f74 696d 652c 0a20   from_js_time,. 
+00000670: 2020 2070 726f 6365 7373 5f64 6174 6574     process_datet
+00000680: 696d 652c 0a20 2020 2073 6572 6961 6c69  ime,.    seriali
+00000690: 7a65 5f70 6f69 6e74 2c0a 2020 2020 746f  ze_point,.    to
+000006a0: 5f6a 735f 7469 6d65 2c0a 2020 2020 7574  _js_time,.    ut
+000006b0: 635f 6e6f 772c 0a29 0a0a 6966 2054 5950  c_now,.)..if TYP
+000006c0: 455f 4348 4543 4b49 4e47 3a0a 2020 2020  E_CHECKING:.    
+000006d0: 6672 6f6d 2070 7975 6e69 6669 7072 6f74  from pyunifiprot
+000006e0: 6563 742e 6461 7461 2e6e 7672 2069 6d70  ect.data.nvr imp
+000006f0: 6f72 7420 4576 656e 742c 204c 6976 6576  ort Event, Livev
+00000700: 6965 770a 0a50 5249 5641 4359 5f5a 4f4e  iew..PRIVACY_ZON
+00000710: 455f 4e41 4d45 203d 2022 7079 7566 705f  E_NAME = "pyufp_
+00000720: 7072 6976 6163 795f 7a6f 6e65 220a 4c55  privacy_zone".LU
+00000730: 585f 4d41 5050 494e 475f 5641 4c55 4553  X_MAPPING_VALUES
+00000740: 203d 205b 0a20 2020 2033 302c 0a20 2020   = [.    30,.   
+00000750: 2032 352c 0a20 2020 2032 302c 0a20 2020   25,.    20,.   
+00000760: 2031 352c 0a20 2020 2031 322c 0a20 2020   15,.    12,.   
+00000770: 2031 302c 0a20 2020 2037 2c0a 2020 2020   10,.    7,.    
+00000780: 352c 0a20 2020 2033 2c0a 2020 2020 312c  5,.    3,.    1,
+00000790: 0a5d 0a0a 5f4c 4f47 4745 5220 3d20 6c6f  .].._LOGGER = lo
+000007a0: 6767 696e 672e 6765 744c 6f67 6765 7228  gging.getLogger(
+000007b0: 5f5f 6e61 6d65 5f5f 290a 0a0a 636c 6173  __name__)...clas
+000007c0: 7320 4c69 6768 7444 6576 6963 6553 6574  s LightDeviceSet
+000007d0: 7469 6e67 7328 5072 6f74 6563 7442 6173  tings(ProtectBas
+000007e0: 654f 626a 6563 7429 3a0a 2020 2020 2320  eObject):.    # 
+000007f0: 5374 6174 7573 204c 4544 0a20 2020 2069  Status LED.    i
+00000800: 735f 696e 6469 6361 746f 725f 656e 6162  s_indicator_enab
+00000810: 6c65 643a 2062 6f6f 6c0a 2020 2020 2320  led: bool.    # 
+00000820: 4272 6967 6874 6e65 7373 0a20 2020 206c  Brightness.    l
+00000830: 6564 5f6c 6576 656c 3a20 4c45 444c 6576  ed_level: LEDLev
+00000840: 656c 0a20 2020 206c 7578 5f73 656e 7369  el.    lux_sensi
+00000850: 7469 7669 7479 3a20 4c6f 774d 6564 4869  tivity: LowMedHi
+00000860: 6768 0a20 2020 2070 6972 5f64 7572 6174  gh.    pir_durat
+00000870: 696f 6e3a 2074 696d 6564 656c 7461 0a20  ion: timedelta. 
+00000880: 2020 2070 6972 5f73 656e 7369 7469 7669     pir_sensitivi
+00000890: 7479 3a20 5065 7263 656e 7449 6e74 0a0a  ty: PercentInt..
+000008a0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+000008b0: 0a20 2020 2064 6566 2075 6e69 6669 5f64  .    def unifi_d
+000008c0: 6963 745f 746f 5f64 6963 7428 636c 732c  ict_to_dict(cls,
+000008d0: 2064 6174 613a 2064 6963 745b 7374 722c   data: dict[str,
+000008e0: 2041 6e79 5d29 202d 3e20 6469 6374 5b73   Any]) -> dict[s
+000008f0: 7472 2c20 416e 795d 3a0a 2020 2020 2020  tr, Any]:.      
+00000900: 2020 6966 2022 7069 7244 7572 6174 696f    if "pirDuratio
+00000910: 6e22 2069 6e20 6461 7461 2061 6e64 206e  n" in data and n
+00000920: 6f74 2069 7369 6e73 7461 6e63 6528 6461  ot isinstance(da
+00000930: 7461 5b22 7069 7244 7572 6174 696f 6e22  ta["pirDuration"
+00000940: 5d2c 2074 696d 6564 656c 7461 293a 0a20  ], timedelta):. 
+00000950: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+00000960: 2270 6972 4475 7261 7469 6f6e 225d 203d  "pirDuration"] =
+00000970: 2074 696d 6564 656c 7461 286d 696c 6c69   timedelta(milli
+00000980: 7365 636f 6e64 733d 6461 7461 5b22 7069  seconds=data["pi
+00000990: 7244 7572 6174 696f 6e22 5d29 0a0a 2020  rDuration"])..  
+000009a0: 2020 2020 2020 7265 7475 726e 2073 7570        return sup
+000009b0: 6572 2829 2e75 6e69 6669 5f64 6963 745f  er().unifi_dict_
+000009c0: 746f 5f64 6963 7428 6461 7461 290a 0a0a  to_dict(data)...
+000009d0: 636c 6173 7320 4c69 6768 744f 6e53 6574  class LightOnSet
+000009e0: 7469 6e67 7328 5072 6f74 6563 7442 6173  tings(ProtectBas
+000009f0: 654f 626a 6563 7429 3a0a 2020 2020 2320  eObject):.    # 
+00000a00: 4d61 6e75 616c 2074 6f67 676c 6520 696e  Manual toggle in
+00000a10: 2055 490a 2020 2020 6973 5f6c 6564 5f66   UI.    is_led_f
+00000a20: 6f72 6365 5f6f 6e3a 2062 6f6f 6c0a 0a0a  orce_on: bool...
+00000a30: 636c 6173 7320 4c69 6768 744d 6f64 6553  class LightModeS
+00000a40: 6574 7469 6e67 7328 5072 6f74 6563 7442  ettings(ProtectB
+00000a50: 6173 654f 626a 6563 7429 3a0a 2020 2020  aseObject):.    
+00000a60: 2320 6d61 696e 2022 4c69 6768 7469 6e67  # main "Lighting
+00000a70: 2220 7365 7474 696e 6773 0a20 2020 206d  " settings.    m
+00000a80: 6f64 653a 204c 6967 6874 4d6f 6465 5479  ode: LightModeTy
+00000a90: 7065 0a20 2020 2065 6e61 626c 655f 6174  pe.    enable_at
+00000aa0: 3a20 4c69 6768 744d 6f64 6545 6e61 626c  : LightModeEnabl
+00000ab0: 6554 7970 650a 0a0a 636c 6173 7320 4c69  eType...class Li
+00000ac0: 6768 7428 5072 6f74 6563 744d 6f74 696f  ght(ProtectMotio
+00000ad0: 6e44 6576 6963 654d 6f64 656c 293a 0a20  nDeviceModel):. 
+00000ae0: 2020 2069 735f 7069 725f 6d6f 7469 6f6e     is_pir_motion
+00000af0: 5f64 6574 6563 7465 643a 2062 6f6f 6c0a  _detected: bool.
+00000b00: 2020 2020 6973 5f6c 6967 6874 5f6f 6e3a      is_light_on:
+00000b10: 2062 6f6f 6c0a 2020 2020 6973 5f6c 6f63   bool.    is_loc
+00000b20: 6174 696e 673a 2062 6f6f 6c0a 2020 2020  ating: bool.    
+00000b30: 6c69 6768 745f 6465 7669 6365 5f73 6574  light_device_set
+00000b40: 7469 6e67 733a 204c 6967 6874 4465 7669  tings: LightDevi
+00000b50: 6365 5365 7474 696e 6773 0a20 2020 206c  ceSettings.    l
+00000b60: 6967 6874 5f6f 6e5f 7365 7474 696e 6773  ight_on_settings
+00000b70: 3a20 4c69 6768 744f 6e53 6574 7469 6e67  : LightOnSetting
+00000b80: 730a 2020 2020 6c69 6768 745f 6d6f 6465  s.    light_mode
+00000b90: 5f73 6574 7469 6e67 733a 204c 6967 6874  _settings: Light
+00000ba0: 4d6f 6465 5365 7474 696e 6773 0a20 2020  ModeSettings.   
+00000bb0: 2063 616d 6572 615f 6964 3a20 4f70 7469   camera_id: Opti
+00000bc0: 6f6e 616c 5b73 7472 5d0a 2020 2020 6973  onal[str].    is
+00000bd0: 5f63 616d 6572 615f 7061 6972 6564 3a20  _camera_paired: 
+00000be0: 626f 6f6c 0a0a 2020 2020 4063 6c61 7373  bool..    @class
+00000bf0: 6d65 7468 6f64 0a20 2020 2040 6361 6368  method.    @cach
+00000c00: 650a 2020 2020 6465 6620 5f67 6574 5f75  e.    def _get_u
+00000c10: 6e69 6669 5f72 656d 6170 7328 636c 7329  nifi_remaps(cls)
+00000c20: 202d 3e20 6469 6374 5b73 7472 2c20 7374   -> dict[str, st
+00000c30: 725d 3a0a 2020 2020 2020 2020 7265 7475  r]:.        retu
+00000c40: 726e 207b 2a2a 7375 7065 7228 292e 5f67  rn {**super()._g
+00000c50: 6574 5f75 6e69 6669 5f72 656d 6170 7328  et_unifi_remaps(
+00000c60: 292c 2022 6361 6d65 7261 223a 2022 6361  ), "camera": "ca
+00000c70: 6d65 7261 4964 227d 0a0a 2020 2020 4063  meraId"}..    @c
+00000c80: 6c61 7373 6d65 7468 6f64 0a20 2020 2040  lassmethod.    @
+00000c90: 6361 6368 650a 2020 2020 6465 6620 5f67  cache.    def _g
+00000ca0: 6574 5f72 6561 645f 6f6e 6c79 5f66 6965  et_read_only_fie
+00000cb0: 6c64 7328 636c 7329 202d 3e20 7365 745b  lds(cls) -> set[
+00000cc0: 7374 725d 3a0a 2020 2020 2020 2020 7265  str]:.        re
+00000cd0: 7475 726e 2073 7570 6572 2829 2e5f 6765  turn super()._ge
+00000ce0: 745f 7265 6164 5f6f 6e6c 795f 6669 656c  t_read_only_fiel
+00000cf0: 6473 2829 207c 207b 0a20 2020 2020 2020  ds() | {.       
+00000d00: 2020 2020 2022 6973 5069 724d 6f74 696f       "isPirMotio
+00000d10: 6e44 6574 6563 7465 6422 2c0a 2020 2020  nDetected",.    
+00000d20: 2020 2020 2020 2020 2269 734c 6967 6874          "isLight
+00000d30: 4f6e 222c 0a20 2020 2020 2020 2020 2020  On",.           
+00000d40: 2022 6973 4c6f 6361 7469 6e67 222c 0a20   "isLocating",. 
+00000d50: 2020 2020 2020 207d 0a0a 2020 2020 4070         }..    @p
+00000d60: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00000d70: 6361 6d65 7261 2873 656c 6629 202d 3e20  camera(self) -> 
+00000d80: 4f70 7469 6f6e 616c 5b43 616d 6572 615d  Optional[Camera]
+00000d90: 3a0a 2020 2020 2020 2020 2222 2250 6169  :.        """Pai
+00000da0: 7265 6420 4361 6d65 7261 2077 696c 6c20  red Camera will 
+00000db0: 616c 7761 7973 2062 6520 6e6f 6e65 2069  always be none i
+00000dc0: 6620 6e6f 2063 616d 6572 6120 6973 2070  f no camera is p
+00000dd0: 6169 7265 6422 2222 0a0a 2020 2020 2020  aired"""..      
+00000de0: 2020 6966 2073 656c 662e 6361 6d65 7261    if self.camera
+00000df0: 5f69 6420 6973 204e 6f6e 653a 0a20 2020  _id is None:.   
+00000e00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00000e10: 4e6f 6e65 0a0a 2020 2020 2020 2020 7265  None..        re
+00000e20: 7475 726e 2073 656c 662e 6170 692e 626f  turn self.api.bo
+00000e30: 6f74 7374 7261 702e 6361 6d65 7261 735b  otstrap.cameras[
+00000e40: 7365 6c66 2e63 616d 6572 615f 6964 5d0a  self.camera_id].
+00000e50: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
+00000e60: 6574 5f70 6169 7265 645f 6361 6d65 7261  et_paired_camera
+00000e70: 2873 656c 662c 2063 616d 6572 613a 204f  (self, camera: O
+00000e80: 7074 696f 6e61 6c5b 4361 6d65 7261 5d29  ptional[Camera])
+00000e90: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00000ea0: 2020 2222 2253 6574 7320 7468 6520 6361    """Sets the ca
+00000eb0: 6d65 7261 2070 6169 7265 6420 7769 7468  mera paired with
+00000ec0: 2074 6865 206c 6967 6874 2222 220a 0a20   the light""".. 
+00000ed0: 2020 2020 2020 2061 7379 6e63 2077 6974         async wit
+00000ee0: 6820 7365 6c66 2e5f 7570 6461 7465 5f6c  h self._update_l
+00000ef0: 6f63 6b3a 0a20 2020 2020 2020 2020 2020  ock:.           
+00000f00: 2061 7761 6974 2061 7379 6e63 696f 2e73   await asyncio.s
+00000f10: 6c65 6570 280a 2020 2020 2020 2020 2020  leep(.          
+00000f20: 2020 2020 2020 302c 0a20 2020 2020 2020        0,.       
+00000f30: 2020 2020 2029 2020 2320 7969 656c 6420       )  # yield 
+00000f40: 746f 2074 6865 2065 7665 6e74 206c 6f6f  to the event loo
+00000f50: 7020 6f6e 6365 2077 6520 6861 7665 2074  p once we have t
+00000f60: 6865 206c 6f63 6b20 746f 2070 726f 6365  he lock to proce
+00000f70: 7373 2061 6e79 2070 656e 6469 6e67 2075  ss any pending u
+00000f80: 7064 6174 6573 0a20 2020 2020 2020 2020  pdates.         
+00000f90: 2020 2064 6174 615f 6265 666f 7265 5f63     data_before_c
+00000fa0: 6861 6e67 6573 203d 2073 656c 662e 6469  hanges = self.di
+00000fb0: 6374 5f77 6974 685f 6578 636c 7564 6573  ct_with_excludes
+00000fc0: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+00000fd0: 6620 6361 6d65 7261 2069 7320 4e6f 6e65  f camera is None
+00000fe0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00000ff0: 2020 7365 6c66 2e63 616d 6572 615f 6964    self.camera_id
+00001000: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00001010: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00001020: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+00001030: 616d 6572 615f 6964 203d 2063 616d 6572  amera_id = camer
+00001040: 612e 6964 0a20 2020 2020 2020 2020 2020  a.id.           
+00001050: 2061 7761 6974 2073 656c 662e 7361 7665   await self.save
+00001060: 5f64 6576 6963 6528 6461 7461 5f62 6566  _device(data_bef
+00001070: 6f72 655f 6368 616e 6765 732c 2066 6f72  ore_changes, for
+00001080: 6365 5f65 6d69 743d 5472 7565 290a 0a20  ce_emit=True).. 
+00001090: 2020 2061 7379 6e63 2064 6566 2073 6574     async def set
+000010a0: 5f73 7461 7475 735f 6c69 6768 7428 7365  _status_light(se
+000010b0: 6c66 2c20 656e 6162 6c65 643a 2062 6f6f  lf, enabled: boo
+000010c0: 6c29 202d 3e20 4e6f 6e65 3a0a 2020 2020  l) -> None:.    
+000010d0: 2020 2020 2222 2253 6574 7320 7468 6520      """Sets the 
+000010e0: 7374 6174 7573 2069 6e64 6963 6174 6f72  status indicator
+000010f0: 206c 6967 6874 2066 6f72 2074 6865 206c   light for the l
+00001100: 6967 6874 2222 220a 0a20 2020 2020 2020  ight"""..       
+00001110: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+00001120: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00001130: 2020 2020 2073 656c 662e 6c69 6768 745f       self.light_
+00001140: 6465 7669 6365 5f73 6574 7469 6e67 732e  device_settings.
+00001150: 6973 5f69 6e64 6963 6174 6f72 5f65 6e61  is_indicator_ena
+00001160: 626c 6564 203d 2065 6e61 626c 6564 0a0a  bled = enabled..
+00001170: 2020 2020 2020 2020 6177 6169 7420 7365          await se
+00001180: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
+00001190: 6361 6c6c 6261 636b 290a 0a20 2020 2061  callback)..    a
+000011a0: 7379 6e63 2064 6566 2073 6574 5f6c 6564  sync def set_led
+000011b0: 5f6c 6576 656c 2873 656c 662c 206c 6564  _level(self, led
+000011c0: 5f6c 6576 656c 3a20 696e 7429 202d 3e20  _level: int) -> 
+000011d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+000011e0: 2253 6574 7320 7468 6520 4c45 4420 6c65  "Sets the LED le
+000011f0: 7665 6c20 666f 7220 7468 6520 6c69 6768  vel for the ligh
+00001200: 7422 2222 0a0a 2020 2020 2020 2020 6465  t"""..        de
+00001210: 6620 6361 6c6c 6261 636b 2829 202d 3e20  f callback() -> 
+00001220: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00001230: 2020 7365 6c66 2e6c 6967 6874 5f64 6576    self.light_dev
+00001240: 6963 655f 7365 7474 696e 6773 2e6c 6564  ice_settings.led
+00001250: 5f6c 6576 656c 203d 204c 4544 4c65 7665  _level = LEDLeve
+00001260: 6c28 6c65 645f 6c65 7665 6c29 0a0a 2020  l(led_level)..  
+00001270: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+00001280: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
+00001290: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
+000012a0: 6e63 2064 6566 2073 6574 5f6c 6967 6874  nc def set_light
+000012b0: 2873 656c 662c 2065 6e61 626c 6564 3a20  (self, enabled: 
+000012c0: 626f 6f6c 2c20 6c65 645f 6c65 7665 6c3a  bool, led_level:
+000012d0: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+000012e0: 204e 6f6e 6529 202d 3e20 4e6f 6e65 3a0a   None) -> None:.
+000012f0: 2020 2020 2020 2020 2222 2246 6f72 6365          """Force
+00001300: 2074 7572 6e73 206f 6e2f 6f66 6620 7468   turns on/off th
+00001310: 6520 6c69 6768 7422 2222 0a0a 2020 2020  e light"""..    
+00001320: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
+00001330: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
+00001340: 2020 2020 2020 2020 7365 6c66 2e6c 6967          self.lig
+00001350: 6874 5f6f 6e5f 7365 7474 696e 6773 2e69  ht_on_settings.i
+00001360: 735f 6c65 645f 666f 7263 655f 6f6e 203d  s_led_force_on =
+00001370: 2065 6e61 626c 6564 0a20 2020 2020 2020   enabled.       
+00001380: 2020 2020 2069 6620 6c65 645f 6c65 7665       if led_leve
+00001390: 6c20 6973 206e 6f74 204e 6f6e 653a 0a20  l is not None:. 
+000013a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000013b0: 656c 662e 6c69 6768 745f 6465 7669 6365  elf.light_device
+000013c0: 5f73 6574 7469 6e67 732e 6c65 645f 6c65  _settings.led_le
+000013d0: 7665 6c20 3d20 4c45 444c 6576 656c 286c  vel = LEDLevel(l
+000013e0: 6564 5f6c 6576 656c 290a 0a20 2020 2020  ed_level)..     
+000013f0: 2020 2061 7761 6974 2073 656c 662e 7175     await self.qu
+00001400: 6575 655f 7570 6461 7465 2863 616c 6c62  eue_update(callb
+00001410: 6163 6b29 0a0a 2020 2020 6173 796e 6320  ack)..    async 
+00001420: 6465 6620 7365 745f 7365 6e73 6974 6976  def set_sensitiv
+00001430: 6974 7928 7365 6c66 2c20 7365 6e73 6974  ity(self, sensit
+00001440: 6976 6974 793a 2069 6e74 2920 2d3e 204e  ivity: int) -> N
+00001450: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+00001460: 5365 7473 206d 6f74 696f 6e20 7365 6e73  Sets motion sens
+00001470: 6974 6976 6974 7922 2222 0a0a 2020 2020  itivity"""..    
+00001480: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
+00001490: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
+000014a0: 2020 2020 2020 2020 7365 6c66 2e6c 6967          self.lig
+000014b0: 6874 5f64 6576 6963 655f 7365 7474 696e  ht_device_settin
+000014c0: 6773 2e70 6972 5f73 656e 7369 7469 7669  gs.pir_sensitivi
+000014d0: 7479 203d 2050 6572 6365 6e74 496e 7428  ty = PercentInt(
+000014e0: 7365 6e73 6974 6976 6974 7929 0a0a 2020  sensitivity)..  
+000014f0: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+00001500: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
+00001510: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
+00001520: 6e63 2064 6566 2073 6574 5f64 7572 6174  nc def set_durat
+00001530: 696f 6e28 7365 6c66 2c20 6475 7261 7469  ion(self, durati
+00001540: 6f6e 3a20 7469 6d65 6465 6c74 6129 202d  on: timedelta) -
+00001550: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00001560: 2222 2253 6574 7320 6d6f 7469 6f6e 2073  """Sets motion s
+00001570: 656e 7369 7469 7669 7479 2222 220a 0a20  ensitivity""".. 
+00001580: 2020 2020 2020 2069 6620 6475 7261 7469         if durati
+00001590: 6f6e 2e74 6f74 616c 5f73 6563 6f6e 6473  on.total_seconds
+000015a0: 2829 203c 2031 3520 6f72 2064 7572 6174  () < 15 or durat
+000015b0: 696f 6e2e 746f 7461 6c5f 7365 636f 6e64  ion.total_second
+000015c0: 7328 2920 3e20 3930 303a 0a20 2020 2020  s() > 900:.     
+000015d0: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
+000015e0: 5265 7175 6573 7428 2244 7572 6174 696f  Request("Duratio
+000015f0: 6e20 6f75 7473 6964 6520 6f66 2031 3573  n outside of 15s
+00001600: 2074 6f20 3930 3073 2072 616e 6765 2229   to 900s range")
+00001610: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
+00001620: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
+00001630: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00001640: 6c66 2e6c 6967 6874 5f64 6576 6963 655f  lf.light_device_
+00001650: 7365 7474 696e 6773 2e70 6972 5f64 7572  settings.pir_dur
+00001660: 6174 696f 6e20 3d20 6475 7261 7469 6f6e  ation = duration
+00001670: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+00001680: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+00001690: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+000016a0: 2061 7379 6e63 2064 6566 2073 6574 5f6c   async def set_l
+000016b0: 6967 6874 5f73 6574 7469 6e67 7328 0a20  ight_settings(. 
+000016c0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000016d0: 2020 2020 206d 6f64 653a 204c 6967 6874       mode: Light
+000016e0: 4d6f 6465 5479 7065 2c0a 2020 2020 2020  ModeType,.      
+000016f0: 2020 656e 6162 6c65 5f61 743a 204f 7074    enable_at: Opt
+00001700: 696f 6e61 6c5b 4c69 6768 744d 6f64 6545  ional[LightModeE
+00001710: 6e61 626c 6554 7970 655d 203d 204e 6f6e  nableType] = Non
+00001720: 652c 0a20 2020 2020 2020 2064 7572 6174  e,.        durat
+00001730: 696f 6e3a 204f 7074 696f 6e61 6c5b 7469  ion: Optional[ti
+00001740: 6d65 6465 6c74 615d 203d 204e 6f6e 652c  medelta] = None,
+00001750: 0a20 2020 2020 2020 2073 656e 7369 7469  .        sensiti
+00001760: 7669 7479 3a20 4f70 7469 6f6e 616c 5b69  vity: Optional[i
+00001770: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+00001780: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00001790: 2020 2022 2222 5570 6461 7465 7320 7661     """Updates va
+000017a0: 7269 6f75 7320 4c69 6768 7420 7365 7474  rious Light sett
+000017b0: 696e 6773 2e0a 0a20 2020 2020 2020 2041  ings...        A
+000017c0: 7267 733a 0a20 2020 2020 2020 202d 2d2d  rgs:.        ---
+000017d0: 2d0a 2020 2020 2020 2020 2020 2020 6d6f  -.            mo
+000017e0: 6465 3a20 4c69 6768 7420 7472 6967 6765  de: Light trigge
+000017f0: 7220 6d6f 6465 0a20 2020 2020 2020 2020  r mode.         
+00001800: 2020 2065 6e61 626c 655f 6174 3a20 5468     enable_at: Th
+00001810: 656e 2074 6865 206c 6967 6874 2061 7574  en the light aut
+00001820: 6f6d 6174 6963 616c 6c79 2074 7572 6e73  omatically turns
+00001830: 206f 6e20 6279 2069 7473 656c 660a 2020   on by itself.  
+00001840: 2020 2020 2020 2020 2020 6475 7261 7469            durati
+00001850: 6f6e 3a20 486f 7720 6c6f 6e67 2074 6865  on: How long the
+00001860: 206c 6967 6874 2073 686f 756c 6420 7265   light should re
+00001870: 6d61 696e 206f 6e20 6166 7465 7220 6d6f  main on after mo
+00001880: 7469 6f6e 2c20 6d75 7374 2062 6520 7469  tion, must be ti
+00001890: 6d65 6465 6c74 6120 6265 7477 6565 6e20  medelta between 
+000018a0: 3135 7320 616e 6420 3930 3073 0a20 2020  15s and 900s.   
+000018b0: 2020 2020 2020 2020 2073 656e 7369 7469           sensiti
+000018c0: 7669 7479 3a20 5049 5220 4d6f 7469 6f6e  vity: PIR Motion
+000018d0: 2073 656e 7369 7469 7669 7479 0a20 2020   sensitivity.   
+000018e0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+000018f0: 2020 6966 2064 7572 6174 696f 6e20 6973    if duration is
+00001900: 206e 6f74 204e 6f6e 6520 616e 6420 280a   not None and (.
+00001910: 2020 2020 2020 2020 2020 2020 6475 7261              dura
+00001920: 7469 6f6e 2e74 6f74 616c 5f73 6563 6f6e  tion.total_secon
+00001930: 6473 2829 203c 2031 3520 6f72 2064 7572  ds() < 15 or dur
+00001940: 6174 696f 6e2e 746f 7461 6c5f 7365 636f  ation.total_seco
+00001950: 6e64 7328 2920 3e20 3930 300a 2020 2020  nds() > 900.    
+00001960: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00001970: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
+00001980: 6573 7428 2244 7572 6174 696f 6e20 6f75  est("Duration ou
+00001990: 7473 6964 6520 6f66 2031 3573 2074 6f20  tside of 15s to 
+000019a0: 3930 3073 2072 616e 6765 2229 0a0a 2020  900s range")..  
+000019b0: 2020 2020 2020 6465 6620 6361 6c6c 6261        def callba
+000019c0: 636b 2829 202d 3e20 4e6f 6e65 3a0a 2020  ck() -> None:.  
+000019d0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+000019e0: 6967 6874 5f6d 6f64 655f 7365 7474 696e  ight_mode_settin
+000019f0: 6773 2e6d 6f64 6520 3d20 6d6f 6465 0a20  gs.mode = mode. 
+00001a00: 2020 2020 2020 2020 2020 2069 6620 656e             if en
+00001a10: 6162 6c65 5f61 7420 6973 206e 6f74 204e  able_at is not N
+00001a20: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00001a30: 2020 2020 2073 656c 662e 6c69 6768 745f       self.light_
+00001a40: 6d6f 6465 5f73 6574 7469 6e67 732e 656e  mode_settings.en
+00001a50: 6162 6c65 5f61 7420 3d20 656e 6162 6c65  able_at = enable
+00001a60: 5f61 740a 2020 2020 2020 2020 2020 2020  _at.            
+00001a70: 6966 2064 7572 6174 696f 6e20 6973 206e  if duration is n
+00001a80: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00001a90: 2020 2020 2020 2020 2073 656c 662e 6c69           self.li
+00001aa0: 6768 745f 6465 7669 6365 5f73 6574 7469  ght_device_setti
+00001ab0: 6e67 732e 7069 725f 6475 7261 7469 6f6e  ngs.pir_duration
+00001ac0: 203d 2064 7572 6174 696f 6e0a 2020 2020   = duration.    
+00001ad0: 2020 2020 2020 2020 6966 2073 656e 7369          if sensi
+00001ae0: 7469 7669 7479 2069 7320 6e6f 7420 4e6f  tivity is not No
+00001af0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00001b00: 2020 2020 7365 6c66 2e6c 6967 6874 5f64      self.light_d
+00001b10: 6576 6963 655f 7365 7474 696e 6773 2e70  evice_settings.p
+00001b20: 6972 5f73 656e 7369 7469 7669 7479 203d  ir_sensitivity =
+00001b30: 2050 6572 6365 6e74 496e 7428 7365 6e73   PercentInt(sens
+00001b40: 6974 6976 6974 7929 0a0a 2020 2020 2020  itivity)..      
+00001b50: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
+00001b60: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
+00001b70: 636b 290a 0a0a 636c 6173 7320 4361 6d65  ck)...class Came
+00001b80: 7261 4368 616e 6e65 6c28 5072 6f74 6563  raChannel(Protec
+00001b90: 7442 6173 654f 626a 6563 7429 3a0a 2020  tBaseObject):.  
+00001ba0: 2020 6964 3a20 696e 7420 2023 2072 6561    id: int  # rea
+00001bb0: 6420 6f6e 6c79 0a20 2020 2076 6964 656f  d only.    video
+00001bc0: 5f69 643a 2073 7472 2020 2320 7265 6164  _id: str  # read
+00001bd0: 206f 6e6c 790a 2020 2020 6e61 6d65 3a20   only.    name: 
+00001be0: 7374 7220 2023 2072 6561 6420 6f6e 6c79  str  # read only
+00001bf0: 0a20 2020 2065 6e61 626c 6564 3a20 626f  .    enabled: bo
+00001c00: 6f6c 2020 2320 7265 6164 206f 6e6c 790a  ol  # read only.
+00001c10: 2020 2020 6973 5f72 7473 705f 656e 6162      is_rtsp_enab
+00001c20: 6c65 643a 2062 6f6f 6c0a 2020 2020 7274  led: bool.    rt
+00001c30: 7370 5f61 6c69 6173 3a20 4f70 7469 6f6e  sp_alias: Option
+00001c40: 616c 5b73 7472 5d20 2023 2072 6561 6420  al[str]  # read 
+00001c50: 6f6e 6c79 0a20 2020 2077 6964 7468 3a20  only.    width: 
+00001c60: 696e 740a 2020 2020 6865 6967 6874 3a20  int.    height: 
+00001c70: 696e 740a 2020 2020 6670 733a 2069 6e74  int.    fps: int
+00001c80: 0a20 2020 2062 6974 7261 7465 3a20 696e  .    bitrate: in
+00001c90: 740a 2020 2020 6d69 6e5f 6269 7472 6174  t.    min_bitrat
+00001ca0: 653a 2069 6e74 2020 2320 7265 6164 206f  e: int  # read o
+00001cb0: 6e6c 790a 2020 2020 6d61 785f 6269 7472  nly.    max_bitr
+00001cc0: 6174 653a 2069 6e74 2020 2320 7265 6164  ate: int  # read
+00001cd0: 206f 6e6c 790a 2020 2020 6d69 6e5f 636c   only.    min_cl
+00001ce0: 6965 6e74 5f61 6461 7074 6976 655f 6269  ient_adaptive_bi
+00001cf0: 745f 7261 7465 3a20 4f70 7469 6f6e 616c  t_rate: Optional
+00001d00: 5b69 6e74 5d20 2023 2072 6561 6420 6f6e  [int]  # read on
+00001d10: 6c79 0a20 2020 206d 696e 5f6d 6f74 696f  ly.    min_motio
+00001d20: 6e5f 6164 6170 7469 7665 5f62 6974 5f72  n_adaptive_bit_r
+00001d30: 6174 653a 204f 7074 696f 6e61 6c5b 696e  ate: Optional[in
+00001d40: 745d 2020 2320 7265 6164 206f 6e6c 790a  t]  # read only.
+00001d50: 2020 2020 6670 735f 7661 6c75 6573 3a20      fps_values: 
+00001d60: 6c69 7374 5b69 6e74 5d20 2023 2072 6561  list[int]  # rea
+00001d70: 6420 6f6e 6c79 0a20 2020 2069 6472 5f69  d only.    idr_i
+00001d80: 6e74 6572 7661 6c3a 2069 6e74 0a20 2020  nterval: int.   
+00001d90: 2023 2033 2e30 2e32 322b 0a20 2020 2061   # 3.0.22+.    a
+00001da0: 7574 6f5f 6269 7472 6174 653a 204f 7074  uto_bitrate: Opt
+00001db0: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
+00001dc0: 6e65 0a20 2020 2061 7574 6f5f 6670 733a  ne.    auto_fps:
+00001dd0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00001de0: 3d20 4e6f 6e65 0a0a 2020 2020 5f72 7473  = None..    _rts
+00001df0: 705f 7572 6c3a 204f 7074 696f 6e61 6c5b  p_url: Optional[
+00001e00: 7374 725d 203d 2050 7269 7661 7465 4174  str] = PrivateAt
+00001e10: 7472 284e 6f6e 6529 0a20 2020 205f 7274  tr(None).    _rt
+00001e20: 7370 735f 7572 6c3a 204f 7074 696f 6e61  sps_url: Optiona
+00001e30: 6c5b 7374 725d 203d 2050 7269 7661 7465  l[str] = Private
+00001e40: 4174 7472 284e 6f6e 6529 0a0a 2020 2020  Attr(None)..    
+00001e50: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00001e60: 6620 7274 7370 5f75 726c 2873 656c 6629  f rtsp_url(self)
+00001e70: 202d 3e20 4f70 7469 6f6e 616c 5b73 7472   -> Optional[str
+00001e80: 5d3a 0a20 2020 2020 2020 2069 6620 6e6f  ]:.        if no
+00001e90: 7420 7365 6c66 2e69 735f 7274 7370 5f65  t self.is_rtsp_e
+00001ea0: 6e61 626c 6564 206f 7220 7365 6c66 2e72  nabled or self.r
+00001eb0: 7473 705f 616c 6961 7320 6973 204e 6f6e  tsp_alias is Non
+00001ec0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00001ed0: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
+00001ee0: 2020 2020 6966 2073 656c 662e 5f72 7473      if self._rts
+00001ef0: 705f 7572 6c20 6973 206e 6f74 204e 6f6e  p_url is not Non
+00001f00: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00001f10: 6574 7572 6e20 7365 6c66 2e5f 7274 7370  eturn self._rtsp
+00001f20: 5f75 726c 0a20 2020 2020 2020 2073 656c  _url.        sel
+00001f30: 662e 5f72 7473 705f 7572 6c20 3d20 6622  f._rtsp_url = f"
+00001f40: 7274 7370 3a2f 2f7b 7365 6c66 2e61 7069  rtsp://{self.api
+00001f50: 2e63 6f6e 6e65 6374 696f 6e5f 686f 7374  .connection_host
+00001f60: 7d3a 7b73 656c 662e 6170 692e 626f 6f74  }:{self.api.boot
+00001f70: 7374 7261 702e 6e76 722e 706f 7274 732e  strap.nvr.ports.
+00001f80: 7274 7370 7d2f 7b73 656c 662e 7274 7370  rtsp}/{self.rtsp
+00001f90: 5f61 6c69 6173 7d22 0a20 2020 2020 2020  _alias}".       
+00001fa0: 2072 6574 7572 6e20 7365 6c66 2e5f 7274   return self._rt
+00001fb0: 7370 5f75 726c 0a0a 2020 2020 4070 726f  sp_url..    @pro
+00001fc0: 7065 7274 790a 2020 2020 6465 6620 7274  perty.    def rt
+00001fd0: 7370 735f 7572 6c28 7365 6c66 2920 2d3e  sps_url(self) ->
+00001fe0: 204f 7074 696f 6e61 6c5b 7374 725d 3a0a   Optional[str]:.
+00001ff0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00002000: 656c 662e 6973 5f72 7473 705f 656e 6162  elf.is_rtsp_enab
+00002010: 6c65 6420 6f72 2073 656c 662e 7274 7370  led or self.rtsp
+00002020: 5f61 6c69 6173 2069 7320 4e6f 6e65 3a0a  _alias is None:.
+00002030: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00002040: 726e 204e 6f6e 650a 0a20 2020 2020 2020  rn None..       
+00002050: 2069 6620 7365 6c66 2e5f 7274 7370 735f   if self._rtsps_
+00002060: 7572 6c20 6973 206e 6f74 204e 6f6e 653a  url is not None:
+00002070: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00002080: 7572 6e20 7365 6c66 2e5f 7274 7370 735f  urn self._rtsps_
+00002090: 7572 6c0a 2020 2020 2020 2020 7365 6c66  url.        self
+000020a0: 2e5f 7274 7370 735f 7572 6c20 3d20 6622  ._rtsps_url = f"
+000020b0: 7274 7370 733a 2f2f 7b73 656c 662e 6170  rtsps://{self.ap
+000020c0: 692e 636f 6e6e 6563 7469 6f6e 5f68 6f73  i.connection_hos
+000020d0: 747d 3a7b 7365 6c66 2e61 7069 2e62 6f6f  t}:{self.api.boo
+000020e0: 7473 7472 6170 2e6e 7672 2e70 6f72 7473  tstrap.nvr.ports
+000020f0: 2e72 7473 7073 7d2f 7b73 656c 662e 7274  .rtsps}/{self.rt
+00002100: 7370 5f61 6c69 6173 7d3f 656e 6162 6c65  sp_alias}?enable
+00002110: 5372 7470 220a 2020 2020 2020 2020 7265  Srtp".        re
+00002120: 7475 726e 2073 656c 662e 5f72 7473 7073  turn self._rtsps
+00002130: 5f75 726c 0a0a 2020 2020 4070 726f 7065  _url..    @prope
+00002140: 7274 790a 2020 2020 6465 6620 6973 5f70  rty.    def is_p
+00002150: 6163 6b61 6765 2873 656c 6629 202d 3e20  ackage(self) -> 
+00002160: 626f 6f6c 3a0a 2020 2020 2020 2020 7265  bool:.        re
+00002170: 7475 726e 2073 656c 662e 6670 7320 3c3d  turn self.fps <=
+00002180: 2032 0a0a 0a63 6c61 7373 2049 5350 5365   2...class ISPSe
+00002190: 7474 696e 6773 2850 726f 7465 6374 4261  ttings(ProtectBa
+000021a0: 7365 4f62 6a65 6374 293a 0a20 2020 2061  seObject):.    a
+000021b0: 655f 6d6f 6465 3a20 4175 746f 4578 706f  e_mode: AutoExpo
+000021c0: 7375 7265 4d6f 6465 0a20 2020 2069 725f  sureMode.    ir_
+000021d0: 6c65 645f 6d6f 6465 3a20 4952 4c45 444d  led_mode: IRLEDM
+000021e0: 6f64 650a 2020 2020 6972 5f6c 6564 5f6c  ode.    ir_led_l
+000021f0: 6576 656c 3a20 5477 6f42 7974 6549 6e74  evel: TwoByteInt
+00002200: 0a20 2020 2077 6472 3a20 5744 524c 6576  .    wdr: WDRLev
+00002210: 656c 0a20 2020 2069 6372 5f73 656e 7369  el.    icr_sensi
+00002220: 7469 7669 7479 3a20 4943 5253 656e 7369  tivity: ICRSensi
+00002230: 7469 7669 7479 0a20 2020 2062 7269 6768  tivity.    brigh
+00002240: 746e 6573 733a 2069 6e74 0a20 2020 2063  tness: int.    c
+00002250: 6f6e 7472 6173 743a 2069 6e74 0a20 2020  ontrast: int.   
+00002260: 2068 7565 3a20 696e 740a 2020 2020 7361   hue: int.    sa
+00002270: 7475 7261 7469 6f6e 3a20 696e 740a 2020  turation: int.  
+00002280: 2020 7368 6172 706e 6573 733a 2069 6e74    sharpness: int
+00002290: 0a20 2020 2064 656e 6f69 7365 3a20 696e  .    denoise: in
+000022a0: 740a 2020 2020 6973 5f66 6c69 7070 6564  t.    is_flipped
+000022b0: 5f76 6572 7469 6361 6c3a 2062 6f6f 6c0a  _vertical: bool.
+000022c0: 2020 2020 6973 5f66 6c69 7070 6564 5f68      is_flipped_h
+000022d0: 6f72 697a 6f6e 7461 6c3a 2062 6f6f 6c0a  orizontal: bool.
+000022e0: 2020 2020 6973 5f61 7574 6f5f 726f 7461      is_auto_rota
+000022f0: 7465 5f65 6e61 626c 6564 3a20 626f 6f6c  te_enabled: bool
+00002300: 0a20 2020 2069 735f 6c64 635f 656e 6162  .    is_ldc_enab
 00002310: 6c65 643a 2062 6f6f 6c0a 2020 2020 6973  led: bool.    is
-00002320: 5f65 7874 6572 6e61 6c5f 6972 5f65 6e61  _external_ir_ena
-00002330: 626c 6564 3a20 626f 6f6c 0a20 2020 2069  bled: bool.    i
-00002340: 735f 6167 6772 6573 7369 7665 5f61 6e74  s_aggressive_ant
-00002350: 695f 666c 6963 6b65 725f 656e 6162 6c65  i_flicker_enable
-00002360: 643a 2062 6f6f 6c0a 2020 2020 6973 5f70  d: bool.    is_p
-00002370: 6175 7365 5f6d 6f74 696f 6e5f 656e 6162  ause_motion_enab
-00002380: 6c65 643a 2062 6f6f 6c0a 2020 2020 645f  led: bool.    d_
-00002390: 7a6f 6f6d 5f63 656e 7465 725f 783a 2069  zoom_center_x: i
-000023a0: 6e74 0a20 2020 2064 5f7a 6f6f 6d5f 6365  nt.    d_zoom_ce
-000023b0: 6e74 6572 5f79 3a20 696e 740a 2020 2020  nter_y: int.    
-000023c0: 645f 7a6f 6f6d 5f73 6361 6c65 3a20 696e  d_zoom_scale: in
-000023d0: 740a 2020 2020 645f 7a6f 6f6d 5f73 7472  t.    d_zoom_str
-000023e0: 6561 6d5f 6964 3a20 696e 740a 2020 2020  eam_id: int.    
-000023f0: 666f 6375 735f 6d6f 6465 3a20 4f70 7469  focus_mode: Opti
-00002400: 6f6e 616c 5b46 6f63 7573 4d6f 6465 5d20  onal[FocusMode] 
-00002410: 3d20 4e6f 6e65 0a20 2020 2066 6f63 7573  = None.    focus
-00002420: 5f70 6f73 6974 696f 6e3a 2069 6e74 0a20  _position: int. 
-00002430: 2020 2074 6f75 6368 5f66 6f63 7573 5f78     touch_focus_x
-00002440: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d0a  : Optional[int].
-00002450: 2020 2020 746f 7563 685f 666f 6375 735f      touch_focus_
-00002460: 793a 204f 7074 696f 6e61 6c5b 696e 745d  y: Optional[int]
-00002470: 0a20 2020 207a 6f6f 6d5f 706f 7369 7469  .    zoom_positi
-00002480: 6f6e 3a20 5065 7263 656e 7449 6e74 0a20  on: PercentInt. 
-00002490: 2020 206d 6f75 6e74 5f70 6f73 6974 696f     mount_positio
-000024a0: 6e3a 204f 7074 696f 6e61 6c5b 4d6f 756e  n: Optional[Moun
-000024b0: 7450 6f73 6974 696f 6e5d 203d 204e 6f6e  tPosition] = Non
-000024c0: 650a 2020 2020 2320 7265 7175 6972 6573  e.    # requires
-000024d0: 2032 2e38 2e31 342b 0a20 2020 2069 735f   2.8.14+.    is_
-000024e0: 636f 6c6f 725f 6e69 6768 745f 7669 7369  color_night_visi
-000024f0: 6f6e 5f65 6e61 626c 6564 3a20 4f70 7469  on_enabled: Opti
-00002500: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-00002510: 650a 2020 2020 2320 332e 302e 3232 2b0a  e.    # 3.0.22+.
-00002520: 2020 2020 6864 725f 6d6f 6465 3a20 4f70      hdr_mode: Op
-00002530: 7469 6f6e 616c 5b48 4452 4d6f 6465 5d20  tional[HDRMode] 
-00002540: 3d20 4e6f 6e65 0a20 2020 2069 6372 5f63  = None.    icr_c
-00002550: 7573 746f 6d5f 7661 6c75 653a 204f 7074  ustom_value: Opt
-00002560: 696f 6e61 6c5b 4943 5243 7573 746f 6d56  ional[ICRCustomV
-00002570: 616c 7565 5d20 3d20 4e6f 6e65 0a20 2020  alue] = None.   
-00002580: 2069 6372 5f73 7769 7463 685f 6d6f 6465   icr_switch_mode
-00002590: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-000025a0: 3d20 4e6f 6e65 0a20 2020 2073 706f 746c  = None.    spotl
-000025b0: 6967 6874 5f64 7572 6174 696f 6e3a 204f  ight_duration: O
-000025c0: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
-000025d0: 6f6e 650a 0a20 2020 2064 6566 2075 6e69  one..    def uni
-000025e0: 6669 5f64 6963 7428 0a20 2020 2020 2020  fi_dict(.       
-000025f0: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
-00002600: 6174 613a 204f 7074 696f 6e61 6c5b 6469  ata: Optional[di
-00002610: 6374 5b73 7472 2c20 416e 795d 5d20 3d20  ct[str, Any]] = 
-00002620: 4e6f 6e65 2c0a 2020 2020 2020 2020 6578  None,.        ex
-00002630: 636c 7564 653a 204f 7074 696f 6e61 6c5b  clude: Optional[
-00002640: 7365 745b 7374 725d 5d20 3d20 4e6f 6e65  set[str]] = None
-00002650: 2c0a 2020 2020 2920 2d3e 2064 6963 745b  ,.    ) -> dict[
-00002660: 7374 722c 2041 6e79 5d3a 0a20 2020 2020  str, Any]:.     
-00002670: 2020 2064 6174 6120 3d20 7375 7065 7228     data = super(
-00002680: 292e 756e 6966 695f 6469 6374 2864 6174  ).unifi_dict(dat
-00002690: 613d 6461 7461 2c20 6578 636c 7564 653d  a=data, exclude=
-000026a0: 6578 636c 7564 6529 0a0a 2020 2020 2020  exclude)..      
-000026b0: 2020 6966 2022 666f 6375 734d 6f64 6522    if "focusMode"
-000026c0: 2069 6e20 6461 7461 2061 6e64 2064 6174   in data and dat
-000026d0: 615b 2266 6f63 7573 4d6f 6465 225d 2069  a["focusMode"] i
-000026e0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-000026f0: 2020 2020 6465 6c20 6461 7461 5b22 666f      del data["fo
-00002700: 6375 734d 6f64 6522 5d0a 0a20 2020 2020  cusMode"]..     
-00002710: 2020 2072 6574 7572 6e20 6461 7461 0a0a     return data..
-00002720: 0a63 6c61 7373 204f 5344 5365 7474 696e  .class OSDSettin
-00002730: 6773 2850 726f 7465 6374 4261 7365 4f62  gs(ProtectBaseOb
-00002740: 6a65 6374 293a 0a20 2020 2023 204f 7665  ject):.    # Ove
-00002750: 726c 6179 2049 6e66 6f72 6d61 7469 6f6e  rlay Information
-00002760: 0a20 2020 2069 735f 6e61 6d65 5f65 6e61  .    is_name_ena
-00002770: 626c 6564 3a20 626f 6f6c 0a20 2020 2069  bled: bool.    i
-00002780: 735f 6461 7465 5f65 6e61 626c 6564 3a20  s_date_enabled: 
-00002790: 626f 6f6c 0a20 2020 2069 735f 6c6f 676f  bool.    is_logo
+00002320: 5f33 646e 725f 656e 6162 6c65 643a 2062  _3dnr_enabled: b
+00002330: 6f6f 6c0a 2020 2020 6973 5f65 7874 6572  ool.    is_exter
+00002340: 6e61 6c5f 6972 5f65 6e61 626c 6564 3a20  nal_ir_enabled: 
+00002350: 626f 6f6c 0a20 2020 2069 735f 6167 6772  bool.    is_aggr
+00002360: 6573 7369 7665 5f61 6e74 695f 666c 6963  essive_anti_flic
+00002370: 6b65 725f 656e 6162 6c65 643a 2062 6f6f  ker_enabled: boo
+00002380: 6c0a 2020 2020 6973 5f70 6175 7365 5f6d  l.    is_pause_m
+00002390: 6f74 696f 6e5f 656e 6162 6c65 643a 2062  otion_enabled: b
+000023a0: 6f6f 6c0a 2020 2020 645f 7a6f 6f6d 5f63  ool.    d_zoom_c
+000023b0: 656e 7465 725f 783a 2069 6e74 0a20 2020  enter_x: int.   
+000023c0: 2064 5f7a 6f6f 6d5f 6365 6e74 6572 5f79   d_zoom_center_y
+000023d0: 3a20 696e 740a 2020 2020 645f 7a6f 6f6d  : int.    d_zoom
+000023e0: 5f73 6361 6c65 3a20 696e 740a 2020 2020  _scale: int.    
+000023f0: 645f 7a6f 6f6d 5f73 7472 6561 6d5f 6964  d_zoom_stream_id
+00002400: 3a20 696e 740a 2020 2020 666f 6375 735f  : int.    focus_
+00002410: 6d6f 6465 3a20 4f70 7469 6f6e 616c 5b46  mode: Optional[F
+00002420: 6f63 7573 4d6f 6465 5d20 3d20 4e6f 6e65  ocusMode] = None
+00002430: 0a20 2020 2066 6f63 7573 5f70 6f73 6974  .    focus_posit
+00002440: 696f 6e3a 2069 6e74 0a20 2020 2074 6f75  ion: int.    tou
+00002450: 6368 5f66 6f63 7573 5f78 3a20 4f70 7469  ch_focus_x: Opti
+00002460: 6f6e 616c 5b69 6e74 5d0a 2020 2020 746f  onal[int].    to
+00002470: 7563 685f 666f 6375 735f 793a 204f 7074  uch_focus_y: Opt
+00002480: 696f 6e61 6c5b 696e 745d 0a20 2020 207a  ional[int].    z
+00002490: 6f6f 6d5f 706f 7369 7469 6f6e 3a20 5065  oom_position: Pe
+000024a0: 7263 656e 7449 6e74 0a20 2020 206d 6f75  rcentInt.    mou
+000024b0: 6e74 5f70 6f73 6974 696f 6e3a 204f 7074  nt_position: Opt
+000024c0: 696f 6e61 6c5b 4d6f 756e 7450 6f73 6974  ional[MountPosit
+000024d0: 696f 6e5d 203d 204e 6f6e 650a 2020 2020  ion] = None.    
+000024e0: 2320 7265 7175 6972 6573 2032 2e38 2e31  # requires 2.8.1
+000024f0: 342b 0a20 2020 2069 735f 636f 6c6f 725f  4+.    is_color_
+00002500: 6e69 6768 745f 7669 7369 6f6e 5f65 6e61  night_vision_ena
+00002510: 626c 6564 3a20 4f70 7469 6f6e 616c 5b62  bled: Optional[b
+00002520: 6f6f 6c5d 203d 204e 6f6e 650a 2020 2020  ool] = None.    
+00002530: 2320 332e 302e 3232 2b0a 2020 2020 6864  # 3.0.22+.    hd
+00002540: 725f 6d6f 6465 3a20 4f70 7469 6f6e 616c  r_mode: Optional
+00002550: 5b48 4452 4d6f 6465 5d20 3d20 4e6f 6e65  [HDRMode] = None
+00002560: 0a20 2020 2069 6372 5f63 7573 746f 6d5f  .    icr_custom_
+00002570: 7661 6c75 653a 204f 7074 696f 6e61 6c5b  value: Optional[
+00002580: 4943 5243 7573 746f 6d56 616c 7565 5d20  ICRCustomValue] 
+00002590: 3d20 4e6f 6e65 0a20 2020 2069 6372 5f73  = None.    icr_s
+000025a0: 7769 7463 685f 6d6f 6465 3a20 4f70 7469  witch_mode: Opti
+000025b0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+000025c0: 0a20 2020 2073 706f 746c 6967 6874 5f64  .    spotlight_d
+000025d0: 7572 6174 696f 6e3a 204f 7074 696f 6e61  uration: Optiona
+000025e0: 6c5b 696e 745d 203d 204e 6f6e 650a 0a20  l[int] = None.. 
+000025f0: 2020 2064 6566 2075 6e69 6669 5f64 6963     def unifi_dic
+00002600: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00002610: 0a20 2020 2020 2020 2064 6174 613a 204f  .        data: O
+00002620: 7074 696f 6e61 6c5b 6469 6374 5b73 7472  ptional[dict[str
+00002630: 2c20 416e 795d 5d20 3d20 4e6f 6e65 2c0a  , Any]] = None,.
+00002640: 2020 2020 2020 2020 6578 636c 7564 653a          exclude:
+00002650: 204f 7074 696f 6e61 6c5b 7365 745b 7374   Optional[set[st
+00002660: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
+00002670: 2920 2d3e 2064 6963 745b 7374 722c 2041  ) -> dict[str, A
+00002680: 6e79 5d3a 0a20 2020 2020 2020 2064 6174  ny]:.        dat
+00002690: 6120 3d20 7375 7065 7228 292e 756e 6966  a = super().unif
+000026a0: 695f 6469 6374 2864 6174 613d 6461 7461  i_dict(data=data
+000026b0: 2c20 6578 636c 7564 653d 6578 636c 7564  , exclude=exclud
+000026c0: 6529 0a0a 2020 2020 2020 2020 6966 2022  e)..        if "
+000026d0: 666f 6375 734d 6f64 6522 2069 6e20 6461  focusMode" in da
+000026e0: 7461 2061 6e64 2064 6174 615b 2266 6f63  ta and data["foc
+000026f0: 7573 4d6f 6465 225d 2069 7320 4e6f 6e65  usMode"] is None
+00002700: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+00002710: 6c20 6461 7461 5b22 666f 6375 734d 6f64  l data["focusMod
+00002720: 6522 5d0a 0a20 2020 2020 2020 2072 6574  e"]..        ret
+00002730: 7572 6e20 6461 7461 0a0a 0a63 6c61 7373  urn data...class
+00002740: 204f 5344 5365 7474 696e 6773 2850 726f   OSDSettings(Pro
+00002750: 7465 6374 4261 7365 4f62 6a65 6374 293a  tectBaseObject):
+00002760: 0a20 2020 2023 204f 7665 726c 6179 2049  .    # Overlay I
+00002770: 6e66 6f72 6d61 7469 6f6e 0a20 2020 2069  nformation.    i
+00002780: 735f 6e61 6d65 5f65 6e61 626c 6564 3a20  s_name_enabled: 
+00002790: 626f 6f6c 0a20 2020 2069 735f 6461 7465  bool.    is_date
 000027a0: 5f65 6e61 626c 6564 3a20 626f 6f6c 0a20  _enabled: bool. 
-000027b0: 2020 2069 735f 6465 6275 675f 656e 6162     is_debug_enab
-000027c0: 6c65 643a 2062 6f6f 6c0a 0a0a 636c 6173  led: bool...clas
-000027d0: 7320 4c45 4453 6574 7469 6e67 7328 5072  s LEDSettings(Pr
-000027e0: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
-000027f0: 3a0a 2020 2020 2320 5374 6174 7573 204c  :.    # Status L
-00002800: 6967 6874 0a20 2020 2069 735f 656e 6162  ight.    is_enab
-00002810: 6c65 643a 2062 6f6f 6c0a 2020 2020 626c  led: bool.    bl
-00002820: 696e 6b5f 7261 7465 3a20 696e 7420 2023  ink_rate: int  #
-00002830: 2069 6e20 6d69 6c6c 6973 6563 6f6e 6473   in milliseconds
-00002840: 2062 6574 7765 6565 6e20 626c 696e 6b73   betweeen blinks
-00002850: 2c20 3020 3d20 736f 6c69 640a 0a0a 636c  , 0 = solid...cl
-00002860: 6173 7320 5370 6561 6b65 7253 6574 7469  ass SpeakerSetti
-00002870: 6e67 7328 5072 6f74 6563 7442 6173 654f  ngs(ProtectBaseO
-00002880: 626a 6563 7429 3a0a 2020 2020 6973 5f65  bject):.    is_e
-00002890: 6e61 626c 6564 3a20 626f 6f6c 0a20 2020  nabled: bool.   
-000028a0: 2023 2053 7461 7475 7320 536f 756e 6473   # Status Sounds
-000028b0: 0a20 2020 2061 7265 5f73 7973 7465 6d5f  .    are_system_
-000028c0: 736f 756e 6473 5f65 6e61 626c 6564 3a20  sounds_enabled: 
-000028d0: 626f 6f6c 0a20 2020 2076 6f6c 756d 653a  bool.    volume:
-000028e0: 2050 6572 6365 6e74 496e 740a 0a0a 636c   PercentInt...cl
-000028f0: 6173 7320 5265 636f 7264 696e 6753 6574  ass RecordingSet
-00002900: 7469 6e67 7328 5072 6f74 6563 7442 6173  tings(ProtectBas
-00002910: 654f 626a 6563 7429 3a0a 2020 2020 2320  eObject):.    # 
-00002920: 5365 636f 6e64 7320 746f 2072 6563 6f72  Seconds to recor
-00002930: 6420 6265 666f 7265 204d 6f74 696f 6e0a  d before Motion.
-00002940: 2020 2020 7072 655f 7061 6464 696e 673a      pre_padding:
-00002950: 2074 696d 6564 656c 7461 0a20 2020 2023   timedelta.    #
-00002960: 2053 6563 6f6e 6473 2074 6f20 7265 636f   Seconds to reco
-00002970: 7264 2061 6674 6572 204d 6f74 696f 6e0a  rd after Motion.
-00002980: 2020 2020 706f 7374 5f70 6164 6469 6e67      post_padding
-00002990: 3a20 7469 6d65 6465 6c74 610a 2020 2020  : timedelta.    
-000029a0: 2320 5365 636f 6e64 7320 6f66 204d 6f74  # Seconds of Mot
-000029b0: 696f 6e20 4e65 6564 6564 0a20 2020 206d  ion Needed.    m
-000029c0: 696e 5f6d 6f74 696f 6e5f 6576 656e 745f  in_motion_event_
-000029d0: 7472 6967 6765 723a 2074 696d 6564 656c  trigger: timedel
-000029e0: 7461 0a20 2020 2065 6e64 5f6d 6f74 696f  ta.    end_motio
-000029f0: 6e5f 6576 656e 745f 6465 6c61 793a 2074  n_event_delay: t
-00002a00: 696d 6564 656c 7461 0a20 2020 2073 7570  imedelta.    sup
-00002a10: 7072 6573 735f 696c 6c75 6d69 6e61 7469  press_illuminati
-00002a20: 6f6e 5f73 7572 6765 3a20 626f 6f6c 0a20  on_surge: bool. 
-00002a30: 2020 2023 2048 6967 6820 4672 616d 6520     # High Frame 
-00002a40: 5261 7465 204d 6f64 650a 2020 2020 6d6f  Rate Mode.    mo
-00002a50: 6465 3a20 5265 636f 7264 696e 674d 6f64  de: RecordingMod
-00002a60: 650a 2020 2020 6765 6f66 656e 6369 6e67  e.    geofencing
-00002a70: 3a20 4765 6f66 656e 6369 6e67 5365 7474  : GeofencingSett
-00002a80: 696e 670a 2020 2020 6d6f 7469 6f6e 5f61  ing.    motion_a
-00002a90: 6c67 6f72 6974 686d 3a20 4d6f 7469 6f6e  lgorithm: Motion
-00002aa0: 416c 676f 7269 7468 6d0a 2020 2020 656e  Algorithm.    en
-00002ab0: 6162 6c65 5f6d 6f74 696f 6e5f 6465 7465  able_motion_dete
-00002ac0: 6374 696f 6e3a 204f 7074 696f 6e61 6c5b  ction: Optional[
-00002ad0: 626f 6f6c 5d20 3d20 4e6f 6e65 0a20 2020  bool] = None.   
-00002ae0: 2075 7365 5f6e 6577 5f6d 6f74 696f 6e5f   use_new_motion_
-00002af0: 616c 676f 7269 7468 6d3a 2062 6f6f 6c0a  algorithm: bool.
-00002b00: 2020 2020 2320 7265 7175 6972 6573 2032      # requires 2
-00002b10: 2e39 2e32 302b 0a20 2020 2069 6e5f 7363  .9.20+.    in_sc
-00002b20: 6865 6475 6c65 5f6d 6f64 653a 204f 7074  hedule_mode: Opt
-00002b30: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00002b40: 650a 2020 2020 6f75 745f 7363 6865 6475  e.    out_schedu
-00002b50: 6c65 5f6d 6f64 653a 204f 7074 696f 6e61  le_mode: Optiona
-00002b60: 6c5b 7374 725d 203d 204e 6f6e 650a 2020  l[str] = None.  
-00002b70: 2020 2320 322e 3131 2e31 332b 0a20 2020    # 2.11.13+.   
-00002b80: 2072 6574 656e 7469 6f6e 5f64 7572 6174   retention_durat
-00002b90: 696f 6e3a 204f 7074 696f 6e61 6c5b 6461  ion: Optional[da
-00002ba0: 7465 7469 6d65 5d20 3d20 4e6f 6e65 0a20  tetime] = None. 
-00002bb0: 2020 2073 6d61 7274 5f64 6574 6563 745f     smart_detect_
-00002bc0: 706f 7374 5f70 6164 6469 6e67 3a20 4f70  post_padding: Op
-00002bd0: 7469 6f6e 616c 5b74 696d 6564 656c 7461  tional[timedelta
-00002be0: 5d20 3d20 4e6f 6e65 0a20 2020 2073 6d61  ] = None.    sma
-00002bf0: 7274 5f64 6574 6563 745f 7072 655f 7061  rt_detect_pre_pa
-00002c00: 6464 696e 673a 204f 7074 696f 6e61 6c5b  dding: Optional[
-00002c10: 7469 6d65 6465 6c74 615d 203d 204e 6f6e  timedelta] = Non
-00002c20: 650a 0a20 2020 2040 636c 6173 736d 6574  e..    @classmet
-00002c30: 686f 640a 2020 2020 4063 6163 6865 0a20  hod.    @cache. 
-00002c40: 2020 2064 6566 205f 6765 745f 756e 6966     def _get_unif
-00002c50: 695f 7265 6d61 7073 2863 6c73 2920 2d3e  i_remaps(cls) ->
-00002c60: 2064 6963 745b 7374 722c 2073 7472 5d3a   dict[str, str]:
-00002c70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00002c80: 7b0a 2020 2020 2020 2020 2020 2020 2a2a  {.            **
-00002c90: 7375 7065 7228 292e 5f67 6574 5f75 6e69  super()._get_uni
-00002ca0: 6669 5f72 656d 6170 7328 292c 0a20 2020  fi_remaps(),.   
-00002cb0: 2020 2020 2020 2020 2022 7265 7465 6e74           "retent
-00002cc0: 696f 6e44 7572 6174 696f 6e4d 7322 3a20  ionDurationMs": 
-00002cd0: 2272 6574 656e 7469 6f6e 4475 7261 7469  "retentionDurati
-00002ce0: 6f6e 222c 0a20 2020 2020 2020 207d 0a0a  on",.        }..
-00002cf0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00002d00: 0a20 2020 2064 6566 2075 6e69 6669 5f64  .    def unifi_d
-00002d10: 6963 745f 746f 5f64 6963 7428 636c 732c  ict_to_dict(cls,
-00002d20: 2064 6174 613a 2064 6963 745b 7374 722c   data: dict[str,
-00002d30: 2041 6e79 5d29 202d 3e20 6469 6374 5b73   Any]) -> dict[s
-00002d40: 7472 2c20 416e 795d 3a0a 2020 2020 2020  tr, Any]:.      
-00002d50: 2020 6966 2022 7072 6550 6164 6469 6e67    if "prePadding
-00002d60: 5365 6373 2220 696e 2064 6174 613a 0a20  Secs" in data:. 
-00002d70: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-00002d80: 2270 7265 5061 6464 696e 6722 5d20 3d20  "prePadding"] = 
-00002d90: 7469 6d65 6465 6c74 6128 7365 636f 6e64  timedelta(second
-00002da0: 733d 6461 7461 2e70 6f70 2822 7072 6550  s=data.pop("preP
-00002db0: 6164 6469 6e67 5365 6373 2229 290a 2020  addingSecs")).  
-00002dc0: 2020 2020 2020 6966 2022 706f 7374 5061        if "postPa
-00002dd0: 6464 696e 6753 6563 7322 2069 6e20 6461  ddingSecs" in da
-00002de0: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
-00002df0: 6461 7461 5b22 706f 7374 5061 6464 696e  data["postPaddin
-00002e00: 6722 5d20 3d20 7469 6d65 6465 6c74 6128  g"] = timedelta(
-00002e10: 7365 636f 6e64 733d 6461 7461 2e70 6f70  seconds=data.pop
-00002e20: 2822 706f 7374 5061 6464 696e 6753 6563  ("postPaddingSec
-00002e30: 7322 2929 0a20 2020 2020 2020 2069 6620  s")).        if 
-00002e40: 2273 6d61 7274 4465 7465 6374 5072 6550  "smartDetectPreP
-00002e50: 6164 6469 6e67 5365 6373 2220 696e 2064  addingSecs" in d
-00002e60: 6174 613a 0a20 2020 2020 2020 2020 2020  ata:.           
-00002e70: 2064 6174 615b 2273 6d61 7274 4465 7465   data["smartDete
-00002e80: 6374 5072 6550 6164 6469 6e67 225d 203d  ctPrePadding"] =
-00002e90: 2074 696d 6564 656c 7461 280a 2020 2020   timedelta(.    
-00002ea0: 2020 2020 2020 2020 2020 2020 7365 636f              seco
-00002eb0: 6e64 733d 6461 7461 2e70 6f70 2822 736d  nds=data.pop("sm
-00002ec0: 6172 7444 6574 6563 7450 7265 5061 6464  artDetectPrePadd
-00002ed0: 696e 6753 6563 7322 292c 0a20 2020 2020  ingSecs"),.     
-00002ee0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00002ef0: 2069 6620 2273 6d61 7274 4465 7465 6374   if "smartDetect
-00002f00: 506f 7374 5061 6464 696e 6753 6563 7322  PostPaddingSecs"
-00002f10: 2069 6e20 6461 7461 3a0a 2020 2020 2020   in data:.      
-00002f20: 2020 2020 2020 6461 7461 5b22 736d 6172        data["smar
-00002f30: 7444 6574 6563 7450 6f73 7450 6164 6469  tDetectPostPaddi
-00002f40: 6e67 225d 203d 2074 696d 6564 656c 7461  ng"] = timedelta
-00002f50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00002f60: 2020 7365 636f 6e64 733d 6461 7461 2e70    seconds=data.p
-00002f70: 6f70 2822 736d 6172 7444 6574 6563 7450  op("smartDetectP
-00002f80: 6f73 7450 6164 6469 6e67 5365 6373 2229  ostPaddingSecs")
-00002f90: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00002fa0: 2020 2020 2020 2020 6966 2022 6d69 6e4d          if "minM
-00002fb0: 6f74 696f 6e45 7665 6e74 5472 6967 6765  otionEventTrigge
-00002fc0: 7222 2069 6e20 6461 7461 2061 6e64 206e  r" in data and n
-00002fd0: 6f74 2069 7369 6e73 7461 6e63 6528 0a20  ot isinstance(. 
-00002fe0: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-00002ff0: 226d 696e 4d6f 7469 6f6e 4576 656e 7454  "minMotionEventT
-00003000: 7269 6767 6572 225d 2c0a 2020 2020 2020  rigger"],.      
-00003010: 2020 2020 2020 7469 6d65 6465 6c74 612c        timedelta,
-00003020: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-00003030: 2020 2020 2020 2020 6461 7461 5b22 6d69          data["mi
-00003040: 6e4d 6f74 696f 6e45 7665 6e74 5472 6967  nMotionEventTrig
-00003050: 6765 7222 5d20 3d20 7469 6d65 6465 6c74  ger"] = timedelt
-00003060: 6128 0a20 2020 2020 2020 2020 2020 2020  a(.             
-00003070: 2020 2073 6563 6f6e 6473 3d64 6174 615b     seconds=data[
-00003080: 226d 696e 4d6f 7469 6f6e 4576 656e 7454  "minMotionEventT
-00003090: 7269 6767 6572 225d 2c0a 2020 2020 2020  rigger"],.      
-000030a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000030b0: 6966 2022 656e 644d 6f74 696f 6e45 7665  if "endMotionEve
-000030c0: 6e74 4465 6c61 7922 2069 6e20 6461 7461  ntDelay" in data
-000030d0: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-000030e0: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
-000030f0: 2064 6174 615b 2265 6e64 4d6f 7469 6f6e   data["endMotion
-00003100: 4576 656e 7444 656c 6179 225d 2c0a 2020  EventDelay"],.  
-00003110: 2020 2020 2020 2020 2020 7469 6d65 6465            timede
-00003120: 6c74 612c 0a20 2020 2020 2020 2029 3a0a  lta,.        ):.
-00003130: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00003140: 5b22 656e 644d 6f74 696f 6e45 7665 6e74  ["endMotionEvent
-00003150: 4465 6c61 7922 5d20 3d20 7469 6d65 6465  Delay"] = timede
-00003160: 6c74 6128 7365 636f 6e64 733d 6461 7461  lta(seconds=data
-00003170: 5b22 656e 644d 6f74 696f 6e45 7665 6e74  ["endMotionEvent
-00003180: 4465 6c61 7922 5d29 0a0a 2020 2020 2020  Delay"])..      
-00003190: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
-000031a0: 2e75 6e69 6669 5f64 6963 745f 746f 5f64  .unifi_dict_to_d
-000031b0: 6963 7428 6461 7461 290a 0a20 2020 2064  ict(data)..    d
-000031c0: 6566 2075 6e69 6669 5f64 6963 7428 0a20  ef unifi_dict(. 
-000031d0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000031e0: 2020 2020 2064 6174 613a 204f 7074 696f       data: Optio
-000031f0: 6e61 6c5b 6469 6374 5b73 7472 2c20 416e  nal[dict[str, An
-00003200: 795d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  y]] = None,.    
-00003210: 2020 2020 6578 636c 7564 653a 204f 7074      exclude: Opt
-00003220: 696f 6e61 6c5b 7365 745b 7374 725d 5d20  ional[set[str]] 
-00003230: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
-00003240: 2064 6963 745b 7374 722c 2041 6e79 5d3a   dict[str, Any]:
-00003250: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00003260: 7375 7065 7228 292e 756e 6966 695f 6469  super().unifi_di
-00003270: 6374 2864 6174 613d 6461 7461 2c20 6578  ct(data=data, ex
-00003280: 636c 7564 653d 6578 636c 7564 6529 0a0a  clude=exclude)..
-00003290: 2020 2020 2020 2020 6966 2022 7072 6550          if "preP
-000032a0: 6164 6469 6e67 2220 696e 2064 6174 613a  adding" in data:
-000032b0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000032c0: 615b 2270 7265 5061 6464 696e 6753 6563  a["prePaddingSec
-000032d0: 7322 5d20 3d20 6461 7461 2e70 6f70 2822  s"] = data.pop("
-000032e0: 7072 6550 6164 6469 6e67 2229 202f 2f20  prePadding") // 
-000032f0: 3130 3030 0a20 2020 2020 2020 2069 6620  1000.        if 
-00003300: 2270 6f73 7450 6164 6469 6e67 2220 696e  "postPadding" in
-00003310: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
-00003320: 2020 2064 6174 615b 2270 6f73 7450 6164     data["postPad
-00003330: 6469 6e67 5365 6373 225d 203d 2064 6174  dingSecs"] = dat
-00003340: 612e 706f 7028 2270 6f73 7450 6164 6469  a.pop("postPaddi
-00003350: 6e67 2229 202f 2f20 3130 3030 0a20 2020  ng") // 1000.   
-00003360: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-00003370: 2020 2020 2020 2273 6d61 7274 4465 7465        "smartDete
-00003380: 6374 5072 6550 6164 6469 6e67 2220 696e  ctPrePadding" in
-00003390: 2064 6174 610a 2020 2020 2020 2020 2020   data.          
-000033a0: 2020 616e 6420 6461 7461 5b22 736d 6172    and data["smar
-000033b0: 7444 6574 6563 7450 7265 5061 6464 696e  tDetectPrePaddin
-000033c0: 6722 5d20 6973 206e 6f74 204e 6f6e 650a  g"] is not None.
-000033d0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-000033e0: 2020 2020 2020 2064 6174 615b 2273 6d61         data["sma
-000033f0: 7274 4465 7465 6374 5072 6550 6164 6469  rtDetectPrePaddi
-00003400: 6e67 5365 6373 225d 203d 2028 0a20 2020  ngSecs"] = (.   
-00003410: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00003420: 612e 706f 7028 2273 6d61 7274 4465 7465  a.pop("smartDete
-00003430: 6374 5072 6550 6164 6469 6e67 2229 202f  ctPrePadding") /
-00003440: 2f20 3130 3030 0a20 2020 2020 2020 2020  / 1000.         
-00003450: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-00003460: 280a 2020 2020 2020 2020 2020 2020 2273  (.            "s
-00003470: 6d61 7274 4465 7465 6374 506f 7374 5061  martDetectPostPa
-00003480: 6464 696e 6722 2069 6e20 6461 7461 0a20  dding" in data. 
-00003490: 2020 2020 2020 2020 2020 2061 6e64 2064             and d
-000034a0: 6174 615b 2273 6d61 7274 4465 7465 6374  ata["smartDetect
-000034b0: 506f 7374 5061 6464 696e 6722 5d20 6973  PostPadding"] is
-000034c0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
-000034d0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-000034e0: 2064 6174 615b 2273 6d61 7274 4465 7465   data["smartDete
-000034f0: 6374 506f 7374 5061 6464 696e 6753 6563  ctPostPaddingSec
-00003500: 7322 5d20 3d20 280a 2020 2020 2020 2020  s"] = (.        
-00003510: 2020 2020 2020 2020 6461 7461 2e70 6f70          data.pop
-00003520: 2822 736d 6172 7444 6574 6563 7450 6f73  ("smartDetectPos
-00003530: 7450 6164 6469 6e67 2229 202f 2f20 3130  tPadding") // 10
-00003540: 3030 0a20 2020 2020 2020 2020 2020 2029  00.            )
-00003550: 0a20 2020 2020 2020 2069 6620 226d 696e  .        if "min
-00003560: 4d6f 7469 6f6e 4576 656e 7454 7269 6767  MotionEventTrigg
-00003570: 6572 2220 696e 2064 6174 613a 0a20 2020  er" in data:.   
-00003580: 2020 2020 2020 2020 2064 6174 615b 226d           data["m
-00003590: 696e 4d6f 7469 6f6e 4576 656e 7454 7269  inMotionEventTri
-000035a0: 6767 6572 225d 203d 2064 6174 612e 706f  gger"] = data.po
-000035b0: 7028 226d 696e 4d6f 7469 6f6e 4576 656e  p("minMotionEven
-000035c0: 7454 7269 6767 6572 2229 202f 2f20 3130  tTrigger") // 10
-000035d0: 3030 0a20 2020 2020 2020 2069 6620 2265  00.        if "e
-000035e0: 6e64 4d6f 7469 6f6e 4576 656e 7444 656c  ndMotionEventDel
-000035f0: 6179 2220 696e 2064 6174 613a 0a20 2020  ay" in data:.   
-00003600: 2020 2020 2020 2020 2064 6174 615b 2265           data["e
-00003610: 6e64 4d6f 7469 6f6e 4576 656e 7444 656c  ndMotionEventDel
-00003620: 6179 225d 203d 2064 6174 612e 706f 7028  ay"] = data.pop(
-00003630: 2265 6e64 4d6f 7469 6f6e 4576 656e 7444  "endMotionEventD
-00003640: 656c 6179 2229 202f 2f20 3130 3030 0a0a  elay") // 1000..
-00003650: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00003660: 6174 610a 0a0a 636c 6173 7320 536d 6172  ata...class Smar
-00003670: 7444 6574 6563 7453 6574 7469 6e67 7328  tDetectSettings(
-00003680: 5072 6f74 6563 7442 6173 654f 626a 6563  ProtectBaseObjec
-00003690: 7429 3a0a 2020 2020 6f62 6a65 6374 5f74  t):.    object_t
-000036a0: 7970 6573 3a20 6c69 7374 5b53 6d61 7274  ypes: list[Smart
-000036b0: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
-000036c0: 5d0a 2020 2020 6175 6469 6f5f 7479 7065  ].    audio_type
-000036d0: 733a 204f 7074 696f 6e61 6c5b 6c69 7374  s: Optional[list
-000036e0: 5b53 6d61 7274 4465 7465 6374 4175 6469  [SmartDetectAudi
-000036f0: 6f54 7970 655d 5d20 3d20 4e6f 6e65 0a20  oType]] = None. 
-00003700: 2020 2023 2072 6571 7569 7265 7320 322e     # requires 2.
-00003710: 382e 3232 2b0a 2020 2020 6175 746f 5f74  8.22+.    auto_t
-00003720: 7261 636b 696e 675f 6f62 6a65 6374 5f74  racking_object_t
-00003730: 7970 6573 3a20 4f70 7469 6f6e 616c 5b6c  ypes: Optional[l
-00003740: 6973 745b 536d 6172 7444 6574 6563 744f  ist[SmartDetectO
-00003750: 626a 6563 7454 7970 655d 5d20 3d20 4e6f  bjectType]] = No
-00003760: 6e65 0a0a 2020 2020 4063 6c61 7373 6d65  ne..    @classme
-00003770: 7468 6f64 0a20 2020 2064 6566 2075 6e69  thod.    def uni
-00003780: 6669 5f64 6963 745f 746f 5f64 6963 7428  fi_dict_to_dict(
-00003790: 636c 732c 2064 6174 613a 2064 6963 745b  cls, data: dict[
-000037a0: 7374 722c 2041 6e79 5d29 202d 3e20 6469  str, Any]) -> di
-000037b0: 6374 5b73 7472 2c20 416e 795d 3a0a 2020  ct[str, Any]:.  
-000037c0: 2020 2020 2020 6966 2022 6f62 6a65 6374        if "object
-000037d0: 5479 7065 7322 2069 6e20 6461 7461 3a0a  Types" in data:.
-000037e0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000037f0: 5b22 6f62 6a65 6374 5479 7065 7322 5d20  ["objectTypes"] 
-00003800: 3d20 636f 6e76 6572 745f 736d 6172 745f  = convert_smart_
-00003810: 7479 7065 7328 6461 7461 2e70 6f70 2822  types(data.pop("
-00003820: 6f62 6a65 6374 5479 7065 7322 2929 0a20  objectTypes")). 
-00003830: 2020 2020 2020 2069 6620 2261 7564 696f         if "audio
-00003840: 5479 7065 7322 2069 6e20 6461 7461 3a0a  Types" in data:.
-00003850: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00003860: 5b22 6175 6469 6f54 7970 6573 225d 203d  ["audioTypes"] =
-00003870: 2063 6f6e 7665 7274 5f73 6d61 7274 5f61   convert_smart_a
-00003880: 7564 696f 5f74 7970 6573 2864 6174 612e  udio_types(data.
-00003890: 706f 7028 2261 7564 696f 5479 7065 7322  pop("audioTypes"
-000038a0: 2929 0a20 2020 2020 2020 2069 6620 2261  )).        if "a
-000038b0: 7574 6f54 7261 636b 696e 674f 626a 6563  utoTrackingObjec
-000038c0: 7454 7970 6573 2220 696e 2064 6174 613a  tTypes" in data:
-000038d0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000038e0: 615b 2261 7574 6f54 7261 636b 696e 674f  a["autoTrackingO
-000038f0: 626a 6563 7454 7970 6573 225d 203d 2063  bjectTypes"] = c
-00003900: 6f6e 7665 7274 5f73 6d61 7274 5f74 7970  onvert_smart_typ
-00003910: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-00003920: 2020 2020 6461 7461 2e70 6f70 2822 6175      data.pop("au
-00003930: 746f 5472 6163 6b69 6e67 4f62 6a65 6374  toTrackingObject
-00003940: 5479 7065 7322 292c 0a20 2020 2020 2020  Types"),.       
-00003950: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00003960: 7265 7475 726e 2073 7570 6572 2829 2e75  return super().u
-00003970: 6e69 6669 5f64 6963 745f 746f 5f64 6963  nifi_dict_to_dic
-00003980: 7428 6461 7461 290a 0a0a 636c 6173 7320  t(data)...class 
-00003990: 4c43 444d 6573 7361 6765 2850 726f 7465  LCDMessage(Prote
-000039a0: 6374 4261 7365 4f62 6a65 6374 293a 0a20  ctBaseObject):. 
-000039b0: 2020 2074 7970 653a 2044 6f6f 7262 656c     type: Doorbel
-000039c0: 6c4d 6573 7361 6765 5479 7065 0a20 2020  lMessageType.   
-000039d0: 2074 6578 743a 2073 7472 0a20 2020 2072   text: str.    r
-000039e0: 6573 6574 5f61 743a 204f 7074 696f 6e61  eset_at: Optiona
-000039f0: 6c5b 6461 7465 7469 6d65 5d20 3d20 4e6f  l[datetime] = No
-00003a00: 6e65 0a0a 2020 2020 4063 6c61 7373 6d65  ne..    @classme
-00003a10: 7468 6f64 0a20 2020 2064 6566 2075 6e69  thod.    def uni
-00003a20: 6669 5f64 6963 745f 746f 5f64 6963 7428  fi_dict_to_dict(
-00003a30: 636c 732c 2064 6174 613a 2064 6963 745b  cls, data: dict[
-00003a40: 7374 722c 2041 6e79 5d29 202d 3e20 6469  str, Any]) -> di
-00003a50: 6374 5b73 7472 2c20 416e 795d 3a0a 2020  ct[str, Any]:.  
-00003a60: 2020 2020 2020 6966 2022 7265 7365 7441        if "resetA
-00003a70: 7422 2069 6e20 6461 7461 3a0a 2020 2020  t" in data:.    
-00003a80: 2020 2020 2020 2020 6461 7461 5b22 7265          data["re
-00003a90: 7365 7441 7422 5d20 3d20 7072 6f63 6573  setAt"] = proces
-00003aa0: 735f 6461 7465 7469 6d65 2864 6174 612c  s_datetime(data,
-00003ab0: 2022 7265 7365 7441 7422 290a 2020 2020   "resetAt").    
-00003ac0: 2020 2020 6966 2022 7465 7874 2220 696e      if "text" in
-00003ad0: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
-00003ae0: 2020 2023 2055 6e69 4669 2050 726f 7465     # UniFi Prote
-00003af0: 6374 2062 7567 3a20 736f 6d65 2074 696d  ct bug: some tim
-00003b00: 6573 204c 4344 206d 6573 7361 6765 7320  es LCD messages 
-00003b10: 6361 6e20 6765 7420 696e 746f 2061 2062  can get into a b
-00003b20: 6164 2073 7461 7465 2077 6865 7265 206d  ad state where m
-00003b30: 6573 7361 6765 203d 2044 4546 4155 4c54  essage = DEFAULT
-00003b40: 204d 4553 5341 4745 2c20 6275 7420 6e6f   MESSAGE, but no
-00003b50: 2074 7970 650a 2020 2020 2020 2020 2020   type.          
-00003b60: 2020 6966 2022 7479 7065 2220 6e6f 7420    if "type" not 
-00003b70: 696e 2064 6174 613a 0a20 2020 2020 2020  in data:.       
-00003b80: 2020 2020 2020 2020 2064 6174 615b 2274           data["t
-00003b90: 7970 6522 5d20 3d20 446f 6f72 6265 6c6c  ype"] = Doorbell
-00003ba0: 4d65 7373 6167 6554 7970 652e 4355 5354  MessageType.CUST
-00003bb0: 4f4d 5f4d 4553 5341 4745 2e76 616c 7565  OM_MESSAGE.value
-00003bc0: 0a0a 2020 2020 2020 2020 2020 2020 6461  ..            da
-00003bd0: 7461 5b22 7465 7874 225d 203d 2063 6c73  ta["text"] = cls
-00003be0: 2e5f 6669 785f 7465 7874 2864 6174 615b  ._fix_text(data[
-00003bf0: 2274 6578 7422 5d2c 2064 6174 615b 2274  "text"], data["t
-00003c00: 7970 6522 5d29 0a0a 2020 2020 2020 2020  ype"])..        
-00003c10: 7265 7475 726e 2073 7570 6572 2829 2e75  return super().u
-00003c20: 6e69 6669 5f64 6963 745f 746f 5f64 6963  nifi_dict_to_dic
-00003c30: 7428 6461 7461 290a 0a20 2020 2040 636c  t(data)..    @cl
-00003c40: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
-00003c50: 6620 5f66 6978 5f74 6578 7428 636c 732c  f _fix_text(cls,
-00003c60: 2074 6578 743a 2073 7472 2c20 7465 7874   text: str, text
-00003c70: 5f74 7970 653a 204f 7074 696f 6e61 6c5b  _type: Optional[
-00003c80: 7374 725d 2920 2d3e 2073 7472 3a0a 2020  str]) -> str:.  
-00003c90: 2020 2020 2020 6966 2074 6578 745f 7479        if text_ty
-00003ca0: 7065 2069 7320 4e6f 6e65 3a0a 2020 2020  pe is None:.    
-00003cb0: 2020 2020 2020 2020 7465 7874 5f74 7970          text_typ
-00003cc0: 6520 3d20 636c 732e 7479 7065 2e76 616c  e = cls.type.val
-00003cd0: 7565 0a0a 2020 2020 2020 2020 6966 2074  ue..        if t
-00003ce0: 6578 745f 7479 7065 2021 3d20 446f 6f72  ext_type != Door
-00003cf0: 6265 6c6c 4d65 7373 6167 6554 7970 652e  bellMessageType.
-00003d00: 4355 5354 4f4d 5f4d 4553 5341 4745 2e76  CUSTOM_MESSAGE.v
-00003d10: 616c 7565 3a0a 2020 2020 2020 2020 2020  alue:.          
-00003d20: 2020 7465 7874 203d 2074 6578 745f 7479    text = text_ty
-00003d30: 7065 2e72 6570 6c61 6365 2822 5f22 2c20  pe.replace("_", 
-00003d40: 2220 2229 0a0a 2020 2020 2020 2020 7265  " ")..        re
-00003d50: 7475 726e 2074 6578 740a 0a20 2020 2064  turn text..    d
-00003d60: 6566 2075 6e69 6669 5f64 6963 7428 0a20  ef unifi_dict(. 
-00003d70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00003d80: 2020 2020 2064 6174 613a 204f 7074 696f       data: Optio
-00003d90: 6e61 6c5b 6469 6374 5b73 7472 2c20 416e  nal[dict[str, An
-00003da0: 795d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  y]] = None,.    
-00003db0: 2020 2020 6578 636c 7564 653a 204f 7074      exclude: Opt
-00003dc0: 696f 6e61 6c5b 7365 745b 7374 725d 5d20  ional[set[str]] 
-00003dd0: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
-00003de0: 2064 6963 745b 7374 722c 2041 6e79 5d3a   dict[str, Any]:
-00003df0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00003e00: 7375 7065 7228 292e 756e 6966 695f 6469  super().unifi_di
-00003e10: 6374 2864 6174 613d 6461 7461 2c20 6578  ct(data=data, ex
-00003e20: 636c 7564 653d 6578 636c 7564 6529 0a0a  clude=exclude)..
-00003e30: 2020 2020 2020 2020 6966 2022 7465 7874          if "text
-00003e40: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
-00003e50: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00003e60: 2020 2020 2020 2020 2020 2020 6d73 675f              msg_
-00003e70: 7479 7065 203d 2073 656c 662e 7479 7065  type = self.type
-00003e80: 2e76 616c 7565 0a20 2020 2020 2020 2020  .value.         
-00003e90: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
-00003ea0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
-00003eb0: 2020 2020 2020 2020 2020 6d73 675f 7479            msg_ty
-00003ec0: 7065 203d 204e 6f6e 650a 0a20 2020 2020  pe = None..     
-00003ed0: 2020 2020 2020 2064 6174 615b 2274 6578         data["tex
-00003ee0: 7422 5d20 3d20 7365 6c66 2e5f 6669 785f  t"] = self._fix_
-00003ef0: 7465 7874 2864 6174 615b 2274 6578 7422  text(data["text"
-00003f00: 5d2c 2064 6174 612e 6765 7428 2274 7970  ], data.get("typ
-00003f10: 6522 2c20 6d73 675f 7479 7065 2929 0a20  e", msg_type)). 
-00003f20: 2020 2020 2020 2069 6620 2272 6573 6574         if "reset
-00003f30: 4174 2220 696e 2064 6174 613a 0a20 2020  At" in data:.   
-00003f40: 2020 2020 2020 2020 2064 6174 615b 2272           data["r
-00003f50: 6573 6574 4174 225d 203d 2074 6f5f 6a73  esetAt"] = to_js
-00003f60: 5f74 696d 6528 6461 7461 5b22 7265 7365  _time(data["rese
-00003f70: 7441 7422 5d29 0a0a 2020 2020 2020 2020  tAt"])..        
-00003f80: 7265 7475 726e 2064 6174 610a 0a0a 636c  return data...cl
-00003f90: 6173 7320 5461 6c6b 6261 636b 5365 7474  ass TalkbackSett
-00003fa0: 696e 6773 2850 726f 7465 6374 4261 7365  ings(ProtectBase
-00003fb0: 4f62 6a65 6374 293a 0a20 2020 2074 7970  Object):.    typ
-00003fc0: 655f 666d 743a 2041 7564 696f 436f 6465  e_fmt: AudioCode
-00003fd0: 6373 0a20 2020 2074 7970 655f 696e 3a20  cs.    type_in: 
-00003fe0: 7374 720a 2020 2020 6269 6e64 5f61 6464  str.    bind_add
-00003ff0: 723a 2049 5076 3441 6464 7265 7373 0a20  r: IPv4Address. 
-00004000: 2020 2062 696e 645f 706f 7274 3a20 696e     bind_port: in
-00004010: 740a 2020 2020 6669 6c74 6572 5f61 6464  t.    filter_add
-00004020: 723a 204f 7074 696f 6e61 6c5b 7374 725d  r: Optional[str]
-00004030: 2020 2320 6361 6e20 6265 2075 7365 6420    # can be used 
-00004040: 746f 2072 6573 7472 6963 7420 7365 6e64  to restrict send
-00004050: 6572 2061 6464 7265 7373 0a20 2020 2066  er address.    f
-00004060: 696c 7465 725f 706f 7274 3a20 4f70 7469  ilter_port: Opti
-00004070: 6f6e 616c 5b69 6e74 5d20 2023 2063 616e  onal[int]  # can
-00004080: 2062 6520 7573 6564 2074 6f20 7265 7374   be used to rest
-00004090: 7269 6374 2073 656e 6465 7220 706f 7274  rict sender port
-000040a0: 0a20 2020 2063 6861 6e6e 656c 733a 2069  .    channels: i
-000040b0: 6e74 2020 2320 3120 6f72 2032 0a20 2020  nt  # 1 or 2.   
-000040c0: 2073 616d 706c 696e 675f 7261 7465 3a20   sampling_rate: 
-000040d0: 696e 7420 2023 2038 3030 302c 2031 3130  int  # 8000, 110
-000040e0: 3235 2c20 3232 3035 302c 2034 3431 3030  25, 22050, 44100
-000040f0: 2c20 3438 3030 300a 2020 2020 6269 7473  , 48000.    bits
-00004100: 5f70 6572 5f73 616d 706c 653a 2069 6e74  _per_sample: int
-00004110: 0a20 2020 2071 7561 6c69 7479 3a20 5065  .    quality: Pe
-00004120: 7263 656e 7449 6e74 2020 2320 6f6e 6c79  rcentInt  # only
-00004130: 2066 6f72 2076 6f72 6269 730a 0a0a 636c   for vorbis...cl
-00004140: 6173 7320 5769 6669 5374 6174 7328 5072  ass WifiStats(Pr
-00004150: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
-00004160: 3a0a 2020 2020 6368 616e 6e65 6c3a 204f  :.    channel: O
-00004170: 7074 696f 6e61 6c5b 696e 745d 0a20 2020  ptional[int].   
-00004180: 2066 7265 7175 656e 6379 3a20 4f70 7469   frequency: Opti
-00004190: 6f6e 616c 5b69 6e74 5d0a 2020 2020 6c69  onal[int].    li
-000041a0: 6e6b 5f73 7065 6564 5f6d 6270 733a 204f  nk_speed_mbps: O
-000041b0: 7074 696f 6e61 6c5b 7374 725d 0a20 2020  ptional[str].   
-000041c0: 2073 6967 6e61 6c5f 7175 616c 6974 793a   signal_quality:
-000041d0: 2050 6572 6365 6e74 496e 740a 2020 2020   PercentInt.    
-000041e0: 7369 676e 616c 5f73 7472 656e 6774 683a  signal_strength:
-000041f0: 2069 6e74 0a0a 0a63 6c61 7373 2056 6964   int...class Vid
-00004200: 656f 5374 6174 7328 5072 6f74 6563 7442  eoStats(ProtectB
-00004210: 6173 654f 626a 6563 7429 3a0a 2020 2020  aseObject):.    
-00004220: 7265 636f 7264 696e 675f 7374 6172 743a  recording_start:
-00004230: 204f 7074 696f 6e61 6c5b 6461 7465 7469   Optional[dateti
-00004240: 6d65 5d0a 2020 2020 7265 636f 7264 696e  me].    recordin
-00004250: 675f 656e 643a 204f 7074 696f 6e61 6c5b  g_end: Optional[
-00004260: 6461 7465 7469 6d65 5d0a 2020 2020 7265  datetime].    re
-00004270: 636f 7264 696e 675f 7374 6172 745f 6c71  cording_start_lq
-00004280: 3a20 4f70 7469 6f6e 616c 5b64 6174 6574  : Optional[datet
-00004290: 696d 655d 0a20 2020 2072 6563 6f72 6469  ime].    recordi
-000042a0: 6e67 5f65 6e64 5f6c 713a 204f 7074 696f  ng_end_lq: Optio
-000042b0: 6e61 6c5b 6461 7465 7469 6d65 5d0a 2020  nal[datetime].  
-000042c0: 2020 7469 6d65 6c61 7073 655f 7374 6172    timelapse_star
-000042d0: 743a 204f 7074 696f 6e61 6c5b 6461 7465  t: Optional[date
-000042e0: 7469 6d65 5d0a 2020 2020 7469 6d65 6c61  time].    timela
-000042f0: 7073 655f 656e 643a 204f 7074 696f 6e61  pse_end: Optiona
-00004300: 6c5b 6461 7465 7469 6d65 5d0a 2020 2020  l[datetime].    
-00004310: 7469 6d65 6c61 7073 655f 7374 6172 745f  timelapse_start_
-00004320: 6c71 3a20 4f70 7469 6f6e 616c 5b64 6174  lq: Optional[dat
-00004330: 6574 696d 655d 0a20 2020 2074 696d 656c  etime].    timel
-00004340: 6170 7365 5f65 6e64 5f6c 713a 204f 7074  apse_end_lq: Opt
-00004350: 696f 6e61 6c5b 6461 7465 7469 6d65 5d0a  ional[datetime].
-00004360: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00004370: 640a 2020 2020 4063 6163 6865 0a20 2020  d.    @cache.   
-00004380: 2064 6566 205f 6765 745f 756e 6966 695f   def _get_unifi_
-00004390: 7265 6d61 7073 2863 6c73 2920 2d3e 2064  remaps(cls) -> d
-000043a0: 6963 745b 7374 722c 2073 7472 5d3a 0a20  ict[str, str]:. 
-000043b0: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
-000043c0: 2020 2020 2020 2020 2020 2020 2a2a 7375              **su
-000043d0: 7065 7228 292e 5f67 6574 5f75 6e69 6669  per()._get_unifi
-000043e0: 5f72 656d 6170 7328 292c 0a20 2020 2020  _remaps(),.     
-000043f0: 2020 2020 2020 2022 7265 636f 7264 696e         "recordin
-00004400: 6753 7461 7274 4c51 223a 2022 7265 636f  gStartLQ": "reco
-00004410: 7264 696e 6753 7461 7274 4c71 222c 0a20  rdingStartLq",. 
-00004420: 2020 2020 2020 2020 2020 2022 7265 636f             "reco
-00004430: 7264 696e 6745 6e64 4c51 223a 2022 7265  rdingEndLQ": "re
-00004440: 636f 7264 696e 6745 6e64 4c71 222c 0a20  cordingEndLq",. 
-00004450: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
-00004460: 6c61 7073 6553 7461 7274 4c51 223a 2022  lapseStartLQ": "
-00004470: 7469 6d65 6c61 7073 6553 7461 7274 4c71  timelapseStartLq
-00004480: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-00004490: 7469 6d65 6c61 7073 6545 6e64 4c51 223a  timelapseEndLQ":
-000044a0: 2022 7469 6d65 6c61 7073 6545 6e64 4c71   "timelapseEndLq
-000044b0: 222c 0a20 2020 2020 2020 207d 0a0a 2020  ",.        }..  
-000044c0: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
-000044d0: 2020 2064 6566 2075 6e69 6669 5f64 6963     def unifi_dic
-000044e0: 745f 746f 5f64 6963 7428 636c 732c 2064  t_to_dict(cls, d
-000044f0: 6174 613a 2064 6963 745b 7374 722c 2041  ata: dict[str, A
-00004500: 6e79 5d29 202d 3e20 6469 6374 5b73 7472  ny]) -> dict[str
-00004510: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
-00004520: 6966 2022 7265 636f 7264 696e 6753 7461  if "recordingSta
-00004530: 7274 2220 696e 2064 6174 613a 0a20 2020  rt" in data:.   
-00004540: 2020 2020 2020 2020 2064 6174 615b 2272           data["r
-00004550: 6563 6f72 6469 6e67 5374 6172 7422 5d20  ecordingStart"] 
-00004560: 3d20 7072 6f63 6573 735f 6461 7465 7469  = process_dateti
-00004570: 6d65 2864 6174 612c 2022 7265 636f 7264  me(data, "record
-00004580: 696e 6753 7461 7274 2229 0a20 2020 2020  ingStart").     
-00004590: 2020 2069 6620 2272 6563 6f72 6469 6e67     if "recording
-000045a0: 456e 6422 2069 6e20 6461 7461 3a0a 2020  End" in data:.  
-000045b0: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-000045c0: 7265 636f 7264 696e 6745 6e64 225d 203d  recordingEnd"] =
-000045d0: 2070 726f 6365 7373 5f64 6174 6574 696d   process_datetim
-000045e0: 6528 6461 7461 2c20 2272 6563 6f72 6469  e(data, "recordi
-000045f0: 6e67 456e 6422 290a 2020 2020 2020 2020  ngEnd").        
-00004600: 6966 2022 7265 636f 7264 696e 6753 7461  if "recordingSta
-00004610: 7274 4c51 2220 696e 2064 6174 613a 0a20  rtLQ" in data:. 
-00004620: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-00004630: 2272 6563 6f72 6469 6e67 5374 6172 744c  "recordingStartL
-00004640: 5122 5d20 3d20 7072 6f63 6573 735f 6461  Q"] = process_da
-00004650: 7465 7469 6d65 2864 6174 612c 2022 7265  tetime(data, "re
-00004660: 636f 7264 696e 6753 7461 7274 4c51 2229  cordingStartLQ")
-00004670: 0a20 2020 2020 2020 2069 6620 2272 6563  .        if "rec
-00004680: 6f72 6469 6e67 456e 644c 5122 2069 6e20  ordingEndLQ" in 
-00004690: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
-000046a0: 2020 6461 7461 5b22 7265 636f 7264 696e    data["recordin
-000046b0: 6745 6e64 4c51 225d 203d 2070 726f 6365  gEndLQ"] = proce
-000046c0: 7373 5f64 6174 6574 696d 6528 6461 7461  ss_datetime(data
-000046d0: 2c20 2272 6563 6f72 6469 6e67 456e 644c  , "recordingEndL
-000046e0: 5122 290a 2020 2020 2020 2020 6966 2022  Q").        if "
-000046f0: 7469 6d65 6c61 7073 6553 7461 7274 2220  timelapseStart" 
-00004700: 696e 2064 6174 613a 0a20 2020 2020 2020  in data:.       
-00004710: 2020 2020 2064 6174 615b 2274 696d 656c       data["timel
-00004720: 6170 7365 5374 6172 7422 5d20 3d20 7072  apseStart"] = pr
-00004730: 6f63 6573 735f 6461 7465 7469 6d65 2864  ocess_datetime(d
-00004740: 6174 612c 2022 7469 6d65 6c61 7073 6553  ata, "timelapseS
-00004750: 7461 7274 2229 0a20 2020 2020 2020 2069  tart").        i
-00004760: 6620 2274 696d 656c 6170 7365 456e 6422  f "timelapseEnd"
-00004770: 2069 6e20 6461 7461 3a0a 2020 2020 2020   in data:.      
-00004780: 2020 2020 2020 6461 7461 5b22 7469 6d65        data["time
-00004790: 6c61 7073 6545 6e64 225d 203d 2070 726f  lapseEnd"] = pro
-000047a0: 6365 7373 5f64 6174 6574 696d 6528 6461  cess_datetime(da
-000047b0: 7461 2c20 2274 696d 656c 6170 7365 456e  ta, "timelapseEn
-000047c0: 6422 290a 2020 2020 2020 2020 6966 2022  d").        if "
-000047d0: 7469 6d65 6c61 7073 6553 7461 7274 4c51  timelapseStartLQ
-000047e0: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
-000047f0: 2020 2020 2020 2064 6174 615b 2274 696d         data["tim
-00004800: 656c 6170 7365 5374 6172 744c 5122 5d20  elapseStartLQ"] 
-00004810: 3d20 7072 6f63 6573 735f 6461 7465 7469  = process_dateti
-00004820: 6d65 2864 6174 612c 2022 7469 6d65 6c61  me(data, "timela
-00004830: 7073 6553 7461 7274 4c51 2229 0a20 2020  pseStartLQ").   
-00004840: 2020 2020 2069 6620 2274 696d 656c 6170       if "timelap
-00004850: 7365 456e 644c 5122 2069 6e20 6461 7461  seEndLQ" in data
-00004860: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
-00004870: 7461 5b22 7469 6d65 6c61 7073 6545 6e64  ta["timelapseEnd
-00004880: 4c51 225d 203d 2070 726f 6365 7373 5f64  LQ"] = process_d
-00004890: 6174 6574 696d 6528 6461 7461 2c20 2274  atetime(data, "t
-000048a0: 696d 656c 6170 7365 456e 644c 5122 290a  imelapseEndLQ").
-000048b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000048c0: 7375 7065 7228 292e 756e 6966 695f 6469  super().unifi_di
-000048d0: 6374 5f74 6f5f 6469 6374 2864 6174 6129  ct_to_dict(data)
-000048e0: 0a0a 0a63 6c61 7373 2053 746f 7261 6765  ...class Storage
-000048f0: 5374 6174 7328 5072 6f74 6563 7442 6173  Stats(ProtectBas
-00004900: 654f 626a 6563 7429 3a0a 2020 2020 7573  eObject):.    us
-00004910: 6564 3a20 4f70 7469 6f6e 616c 5b69 6e74  ed: Optional[int
-00004920: 5d20 2023 2062 7974 6573 0a20 2020 2072  ]  # bytes.    r
-00004930: 6174 653a 204f 7074 696f 6e61 6c5b 666c  ate: Optional[fl
-00004940: 6f61 745d 2020 2320 6279 7465 7320 2f20  oat]  # bytes / 
-00004950: 6d69 6c6c 6973 6563 6f6e 640a 0a20 2020  millisecond..   
-00004960: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00004970: 6566 2072 6174 655f 7065 725f 7365 636f  ef rate_per_seco
-00004980: 6e64 2873 656c 6629 202d 3e20 4f70 7469  nd(self) -> Opti
-00004990: 6f6e 616c 5b66 6c6f 6174 5d3a 0a20 2020  onal[float]:.   
-000049a0: 2020 2020 2069 6620 7365 6c66 2e72 6174       if self.rat
-000049b0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-000049c0: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-000049d0: 6e65 0a0a 2020 2020 2020 2020 7265 7475  ne..        retu
-000049e0: 726e 2073 656c 662e 7261 7465 202a 2031  rn self.rate * 1
-000049f0: 3030 300a 0a20 2020 2040 636c 6173 736d  000..    @classm
-00004a00: 6574 686f 640a 2020 2020 6465 6620 756e  ethod.    def un
-00004a10: 6966 695f 6469 6374 5f74 6f5f 6469 6374  ifi_dict_to_dict
-00004a20: 2863 6c73 2c20 6461 7461 3a20 6469 6374  (cls, data: dict
-00004a30: 5b73 7472 2c20 416e 795d 2920 2d3e 2064  [str, Any]) -> d
-00004a40: 6963 745b 7374 722c 2041 6e79 5d3a 0a20  ict[str, Any]:. 
-00004a50: 2020 2020 2020 2069 6620 2272 6174 6522         if "rate"
-00004a60: 206e 6f74 2069 6e20 6461 7461 3a0a 2020   not in data:.  
-00004a70: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-00004a80: 7261 7465 225d 203d 204e 6f6e 650a 0a20  rate"] = None.. 
-00004a90: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-00004aa0: 7065 7228 292e 756e 6966 695f 6469 6374  per().unifi_dict
-00004ab0: 5f74 6f5f 6469 6374 2864 6174 6129 0a0a  _to_dict(data)..
-00004ac0: 2020 2020 6465 6620 756e 6966 695f 6469      def unifi_di
-00004ad0: 6374 280a 2020 2020 2020 2020 7365 6c66  ct(.        self
-00004ae0: 2c0a 2020 2020 2020 2020 6461 7461 3a20  ,.        data: 
-00004af0: 4f70 7469 6f6e 616c 5b64 6963 745b 7374  Optional[dict[st
-00004b00: 722c 2041 6e79 5d5d 203d 204e 6f6e 652c  r, Any]] = None,
-00004b10: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
-00004b20: 3a20 4f70 7469 6f6e 616c 5b73 6574 5b73  : Optional[set[s
-00004b30: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
-00004b40: 2029 202d 3e20 6469 6374 5b73 7472 2c20   ) -> dict[str, 
-00004b50: 416e 795d 3a0a 2020 2020 2020 2020 6461  Any]:.        da
-00004b60: 7461 203d 2073 7570 6572 2829 2e75 6e69  ta = super().uni
-00004b70: 6669 5f64 6963 7428 6461 7461 3d64 6174  fi_dict(data=dat
-00004b80: 612c 2065 7863 6c75 6465 3d65 7863 6c75  a, exclude=exclu
-00004b90: 6465 290a 0a20 2020 2020 2020 2069 6620  de)..        if 
-00004ba0: 2272 6174 6522 2069 6e20 6461 7461 2061  "rate" in data a
-00004bb0: 6e64 2064 6174 615b 2272 6174 6522 5d20  nd data["rate"] 
-00004bc0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00004bd0: 2020 2020 2064 656c 2064 6174 615b 2272       del data["r
-00004be0: 6174 6522 5d0a 0a20 2020 2020 2020 2072  ate"]..        r
-00004bf0: 6574 7572 6e20 6461 7461 0a0a 0a63 6c61  eturn data...cla
-00004c00: 7373 2043 616d 6572 6153 7461 7473 2850  ss CameraStats(P
-00004c10: 726f 7465 6374 4261 7365 4f62 6a65 6374  rotectBaseObject
-00004c20: 293a 0a20 2020 2072 785f 6279 7465 733a  ):.    rx_bytes:
-00004c30: 2069 6e74 0a20 2020 2074 785f 6279 7465   int.    tx_byte
-00004c40: 733a 2069 6e74 0a20 2020 2077 6966 693a  s: int.    wifi:
-00004c50: 2057 6966 6953 7461 7473 0a20 2020 2076   WifiStats.    v
-00004c60: 6964 656f 3a20 5669 6465 6f53 7461 7473  ideo: VideoStats
-00004c70: 0a20 2020 2073 746f 7261 6765 3a20 4f70  .    storage: Op
-00004c80: 7469 6f6e 616c 5b53 746f 7261 6765 5374  tional[StorageSt
-00004c90: 6174 735d 0a20 2020 2077 6966 695f 7175  ats].    wifi_qu
-00004ca0: 616c 6974 793a 2050 6572 6365 6e74 496e  ality: PercentIn
-00004cb0: 740a 2020 2020 7769 6669 5f73 7472 656e  t.    wifi_stren
-00004cc0: 6774 683a 2069 6e74 0a0a 2020 2020 4063  gth: int..    @c
-00004cd0: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-00004ce0: 6566 2075 6e69 6669 5f64 6963 745f 746f  ef unifi_dict_to
-00004cf0: 5f64 6963 7428 636c 732c 2064 6174 613a  _dict(cls, data:
-00004d00: 2064 6963 745b 7374 722c 2041 6e79 5d29   dict[str, Any])
-00004d10: 202d 3e20 6469 6374 5b73 7472 2c20 416e   -> dict[str, An
-00004d20: 795d 3a0a 2020 2020 2020 2020 6966 2022  y]:.        if "
-00004d30: 7374 6f72 6167 6522 2069 6e20 6461 7461  storage" in data
-00004d40: 2061 6e64 2064 6174 615b 2273 746f 7261   and data["stora
-00004d50: 6765 225d 203d 3d20 7b7d 3a0a 2020 2020  ge"] == {}:.    
-00004d60: 2020 2020 2020 2020 6465 6c20 6461 7461          del data
-00004d70: 5b22 7374 6f72 6167 6522 5d0a 0a20 2020  ["storage"]..   
-00004d80: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00004d90: 7228 292e 756e 6966 695f 6469 6374 5f74  r().unifi_dict_t
-00004da0: 6f5f 6469 6374 2864 6174 6129 0a0a 2020  o_dict(data)..  
-00004db0: 2020 6465 6620 756e 6966 695f 6469 6374    def unifi_dict
-00004dc0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00004dd0: 2020 2020 2020 2020 6461 7461 3a20 4f70          data: Op
-00004de0: 7469 6f6e 616c 5b64 6963 745b 7374 722c  tional[dict[str,
-00004df0: 2041 6e79 5d5d 203d 204e 6f6e 652c 0a20   Any]] = None,. 
-00004e00: 2020 2020 2020 2065 7863 6c75 6465 3a20         exclude: 
-00004e10: 4f70 7469 6f6e 616c 5b73 6574 5b73 7472  Optional[set[str
-00004e20: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
-00004e30: 202d 3e20 6469 6374 5b73 7472 2c20 416e   -> dict[str, An
-00004e40: 795d 3a0a 2020 2020 2020 2020 6461 7461  y]:.        data
-00004e50: 203d 2073 7570 6572 2829 2e75 6e69 6669   = super().unifi
-00004e60: 5f64 6963 7428 6461 7461 3d64 6174 612c  _dict(data=data,
-00004e70: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
-00004e80: 290a 0a20 2020 2020 2020 2069 6620 2273  )..        if "s
-00004e90: 746f 7261 6765 2220 696e 2064 6174 6120  torage" in data 
-00004ea0: 616e 6420 6461 7461 5b22 7374 6f72 6167  and data["storag
-00004eb0: 6522 5d20 6973 204e 6f6e 653a 0a20 2020  e"] is None:.   
-00004ec0: 2020 2020 2020 2020 2064 6174 615b 2273           data["s
-00004ed0: 746f 7261 6765 225d 203d 207b 7d0a 0a20  torage"] = {}.. 
-00004ee0: 2020 2020 2020 2072 6574 7572 6e20 6461         return da
-00004ef0: 7461 0a0a 0a63 6c61 7373 2043 616d 6572  ta...class Camer
-00004f00: 615a 6f6e 6528 5072 6f74 6563 7442 6173  aZone(ProtectBas
-00004f10: 654f 626a 6563 7429 3a0a 2020 2020 6964  eObject):.    id
-00004f20: 3a20 696e 740a 2020 2020 6e61 6d65 3a20  : int.    name: 
-00004f30: 7374 720a 2020 2020 636f 6c6f 723a 2043  str.    color: C
-00004f40: 6f6c 6f72 0a20 2020 2070 6f69 6e74 733a  olor.    points:
-00004f50: 206c 6973 745b 7475 706c 655b 5065 7263   list[tuple[Perc
-00004f60: 656e 742c 2050 6572 6365 6e74 5d5d 0a0a  ent, Percent]]..
-00004f70: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00004f80: 0a20 2020 2064 6566 2075 6e69 6669 5f64  .    def unifi_d
-00004f90: 6963 745f 746f 5f64 6963 7428 636c 732c  ict_to_dict(cls,
-00004fa0: 2064 6174 613a 2064 6963 745b 7374 722c   data: dict[str,
-00004fb0: 2041 6e79 5d29 202d 3e20 6469 6374 5b73   Any]) -> dict[s
-00004fc0: 7472 2c20 416e 795d 3a0a 2020 2020 2020  tr, Any]:.      
-00004fd0: 2020 6461 7461 203d 2073 7570 6572 2829    data = super()
-00004fe0: 2e75 6e69 6669 5f64 6963 745f 746f 5f64  .unifi_dict_to_d
-00004ff0: 6963 7428 6461 7461 290a 2020 2020 2020  ict(data).      
-00005000: 2020 6966 2022 706f 696e 7473 2220 696e    if "points" in
-00005010: 2064 6174 6120 616e 6420 6973 696e 7374   data and isinst
-00005020: 616e 6365 2864 6174 615b 2270 6f69 6e74  ance(data["point
-00005030: 7322 5d2c 2049 7465 7261 626c 6529 3a0a  s"], Iterable):.
-00005040: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00005050: 5b22 706f 696e 7473 225d 203d 205b 2870  ["points"] = [(p
-00005060: 5b30 5d2c 2070 5b31 5d29 2066 6f72 2070  [0], p[1]) for p
-00005070: 2069 6e20 6461 7461 5b22 706f 696e 7473   in data["points
-00005080: 225d 5d0a 0a20 2020 2020 2020 2072 6574  "]]..        ret
-00005090: 7572 6e20 6461 7461 0a0a 2020 2020 6465  urn data..    de
-000050a0: 6620 756e 6966 695f 6469 6374 280a 2020  f unifi_dict(.  
-000050b0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000050c0: 2020 2020 6461 7461 3a20 4f70 7469 6f6e      data: Option
-000050d0: 616c 5b64 6963 745b 7374 722c 2041 6e79  al[dict[str, Any
-000050e0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
-000050f0: 2020 2065 7863 6c75 6465 3a20 4f70 7469     exclude: Opti
-00005100: 6f6e 616c 5b73 6574 5b73 7472 5d5d 203d  onal[set[str]] =
-00005110: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
-00005120: 6469 6374 5b73 7472 2c20 416e 795d 3a0a  dict[str, Any]:.
-00005130: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
-00005140: 7570 6572 2829 2e75 6e69 6669 5f64 6963  uper().unifi_dic
-00005150: 7428 6461 7461 3d64 6174 612c 2065 7863  t(data=data, exc
-00005160: 6c75 6465 3d65 7863 6c75 6465 290a 0a20  lude=exclude).. 
-00005170: 2020 2020 2020 2069 6620 2270 6f69 6e74         if "point
-00005180: 7322 2069 6e20 6461 7461 3a0a 2020 2020  s" in data:.    
-00005190: 2020 2020 2020 2020 6461 7461 5b22 706f          data["po
-000051a0: 696e 7473 225d 203d 205b 7365 7269 616c  ints"] = [serial
-000051b0: 697a 655f 706f 696e 7428 7029 2066 6f72  ize_point(p) for
-000051c0: 2070 2069 6e20 6461 7461 5b22 706f 696e   p in data["poin
-000051d0: 7473 225d 5d0a 0a20 2020 2020 2020 2072  ts"]]..        r
-000051e0: 6574 7572 6e20 6461 7461 0a0a 2020 2020  eturn data..    
-000051f0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-00005200: 2020 6465 6620 6372 6561 7465 5f70 7269    def create_pri
-00005210: 7661 6379 5f7a 6f6e 6528 7a6f 6e65 5f69  vacy_zone(zone_i
-00005220: 643a 2069 6e74 2920 2d3e 2043 616d 6572  d: int) -> Camer
-00005230: 615a 6f6e 653a 0a20 2020 2020 2020 2072  aZone:.        r
-00005240: 6574 7572 6e20 4361 6d65 7261 5a6f 6e65  eturn CameraZone
-00005250: 280a 2020 2020 2020 2020 2020 2020 6964  (.            id
-00005260: 3d7a 6f6e 655f 6964 2c0a 2020 2020 2020  =zone_id,.      
-00005270: 2020 2020 2020 6e61 6d65 3d50 5249 5641        name=PRIVA
-00005280: 4359 5f5a 4f4e 455f 4e41 4d45 2c0a 2020  CY_ZONE_NAME,.  
-00005290: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
-000052a0: 436f 6c6f 7228 2223 3835 4243 4543 2229  Color("#85BCEC")
-000052b0: 2c0a 2020 2020 2020 2020 2020 2020 706f  ,.            po
-000052c0: 696e 7473 3d5b 5b30 2c20 305d 2c20 5b31  ints=[[0, 0], [1
-000052d0: 2c20 305d 2c20 5b31 2c20 315d 2c20 5b30  , 0], [1, 1], [0
-000052e0: 2c20 315d 5d2c 2020 2320 7479 7065 3a20  , 1]],  # type: 
-000052f0: 6967 6e6f 7265 5b6c 6973 742d 6974 656d  ignore[list-item
-00005300: 5d0a 2020 2020 2020 2020 290a 0a0a 636c  ].        )...cl
-00005310: 6173 7320 4d6f 7469 6f6e 5a6f 6e65 2843  ass MotionZone(C
-00005320: 616d 6572 615a 6f6e 6529 3a0a 2020 2020  ameraZone):.    
-00005330: 7365 6e73 6974 6976 6974 793a 2050 6572  sensitivity: Per
-00005340: 6365 6e74 496e 740a 0a0a 636c 6173 7320  centInt...class 
-00005350: 536d 6172 744d 6f74 696f 6e5a 6f6e 6528  SmartMotionZone(
-00005360: 4d6f 7469 6f6e 5a6f 6e65 293a 0a20 2020  MotionZone):.   
-00005370: 206f 626a 6563 745f 7479 7065 733a 206c   object_types: l
-00005380: 6973 745b 536d 6172 7444 6574 6563 744f  ist[SmartDetectO
-00005390: 626a 6563 7454 7970 655d 0a0a 2020 2020  bjectType]..    
-000053a0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-000053b0: 2064 6566 2075 6e69 6669 5f64 6963 745f   def unifi_dict_
-000053c0: 746f 5f64 6963 7428 636c 732c 2064 6174  to_dict(cls, dat
-000053d0: 613a 2064 6963 745b 7374 722c 2041 6e79  a: dict[str, Any
-000053e0: 5d29 202d 3e20 6469 6374 5b73 7472 2c20  ]) -> dict[str, 
-000053f0: 416e 795d 3a0a 2020 2020 2020 2020 6966  Any]:.        if
-00005400: 2022 6f62 6a65 6374 5479 7065 7322 2069   "objectTypes" i
-00005410: 6e20 6461 7461 3a0a 2020 2020 2020 2020  n data:.        
-00005420: 2020 2020 6461 7461 5b22 6f62 6a65 6374      data["object
-00005430: 5479 7065 7322 5d20 3d20 636f 6e76 6572  Types"] = conver
-00005440: 745f 736d 6172 745f 7479 7065 7328 6461  t_smart_types(da
-00005450: 7461 2e70 6f70 2822 6f62 6a65 6374 5479  ta.pop("objectTy
-00005460: 7065 7322 2929 0a0a 2020 2020 2020 2020  pes"))..        
-00005470: 7265 7475 726e 2073 7570 6572 2829 2e75  return super().u
-00005480: 6e69 6669 5f64 6963 745f 746f 5f64 6963  nifi_dict_to_dic
-00005490: 7428 6461 7461 290a 0a0a 636c 6173 7320  t(data)...class 
-000054a0: 5072 6976 6163 794d 6173 6b43 6170 6162  PrivacyMaskCapab
-000054b0: 696c 6974 7928 5072 6f74 6563 7442 6173  ility(ProtectBas
-000054c0: 654f 626a 6563 7429 3a0a 2020 2020 6d61  eObject):.    ma
-000054d0: 785f 6d61 736b 733a 204f 7074 696f 6e61  x_masks: Optiona
-000054e0: 6c5b 696e 745d 0a20 2020 2072 6563 7461  l[int].    recta
-000054f0: 6e67 6c65 5f6f 6e6c 793a 2062 6f6f 6c0a  ngle_only: bool.
-00005500: 0a0a 636c 6173 7320 486f 7470 6c75 6745  ..class HotplugE
-00005510: 7874 656e 6465 7228 5072 6f74 6563 7442  xtender(ProtectB
-00005520: 6173 654f 626a 6563 7429 3a0a 2020 2020  aseObject):.    
-00005530: 6861 735f 666c 6173 683a 204f 7074 696f  has_flash: Optio
-00005540: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
-00005550: 0a20 2020 2068 6173 5f69 723a 204f 7074  .    has_ir: Opt
-00005560: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
-00005570: 6e65 0a20 2020 2068 6173 5f72 6164 6172  ne.    has_radar
-00005580: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-00005590: 203d 204e 6f6e 650a 2020 2020 6973 5f61   = None.    is_a
-000055a0: 7474 6163 6865 643a 204f 7074 696f 6e61  ttached: Optiona
-000055b0: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 0a20  l[bool] = None. 
-000055c0: 2020 2023 2033 2e30 2e32 322b 0a20 2020     # 3.0.22+.   
-000055d0: 2066 6c61 7368 5f72 616e 6765 3a20 4f70   flash_range: Op
-000055e0: 7469 6f6e 616c 5b41 6e79 5d20 3d20 4e6f  tional[Any] = No
-000055f0: 6e65 0a0a 2020 2020 4063 6c61 7373 6d65  ne..    @classme
-00005600: 7468 6f64 0a20 2020 2040 6361 6368 650a  thod.    @cache.
-00005610: 2020 2020 6465 6620 5f67 6574 5f75 6e69      def _get_uni
-00005620: 6669 5f72 656d 6170 7328 636c 7329 202d  fi_remaps(cls) -
-00005630: 3e20 6469 6374 5b73 7472 2c20 7374 725d  > dict[str, str]
-00005640: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00005650: 207b 2a2a 7375 7065 7228 292e 5f67 6574   {**super()._get
-00005660: 5f75 6e69 6669 5f72 656d 6170 7328 292c  _unifi_remaps(),
-00005670: 2022 6861 7349 5222 3a20 2268 6173 4972   "hasIR": "hasIr
-00005680: 227d 0a0a 0a63 6c61 7373 2048 6f74 706c  "}...class Hotpl
-00005690: 7567 2850 726f 7465 6374 4261 7365 4f62  ug(ProtectBaseOb
-000056a0: 6a65 6374 293a 0a20 2020 2061 7564 696f  ject):.    audio
-000056b0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-000056c0: 203d 204e 6f6e 650a 2020 2020 7669 6465   = None.    vide
-000056d0: 6f3a 204f 7074 696f 6e61 6c5b 626f 6f6c  o: Optional[bool
-000056e0: 5d20 3d20 4e6f 6e65 0a20 2020 2065 7874  ] = None.    ext
-000056f0: 656e 6465 723a 204f 7074 696f 6e61 6c5b  ender: Optional[
-00005700: 486f 7470 6c75 6745 7874 656e 6465 725d  HotplugExtender]
-00005710: 203d 204e 6f6e 650a 2020 2020 2320 322e   = None.    # 2.
-00005720: 382e 3335 2b0a 2020 2020 7374 616e 6461  8.35+.    standa
-00005730: 6c6f 6e65 5f61 646f 7074 696f 6e3a 204f  lone_adoption: O
-00005740: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-00005750: 4e6f 6e65 0a0a 0a63 6c61 7373 2050 545a  None...class PTZ
-00005760: 5261 6e67 6553 696e 676c 6528 5072 6f74  RangeSingle(Prot
-00005770: 6563 7442 6173 654f 626a 6563 7429 3a0a  ectBaseObject):.
-00005780: 2020 2020 6d61 783a 204f 7074 696f 6e61      max: Optiona
-00005790: 6c5b 666c 6f61 745d 0a20 2020 206d 696e  l[float].    min
-000057a0: 3a20 4f70 7469 6f6e 616c 5b66 6c6f 6174  : Optional[float
-000057b0: 5d0a 2020 2020 7374 6570 3a20 4f70 7469  ].    step: Opti
-000057c0: 6f6e 616c 5b66 6c6f 6174 5d0a 0a0a 636c  onal[float]...cl
-000057d0: 6173 7320 5054 5a52 616e 6765 2850 726f  ass PTZRange(Pro
-000057e0: 7465 6374 4261 7365 4f62 6a65 6374 293a  tectBaseObject):
-000057f0: 0a20 2020 2073 7465 7073 3a20 5054 5a52  .    steps: PTZR
-00005800: 616e 6765 5369 6e67 6c65 0a20 2020 2064  angeSingle.    d
-00005810: 6567 7265 6573 3a20 5054 5a52 616e 6765  egrees: PTZRange
-00005820: 5369 6e67 6c65 0a0a 2020 2020 6465 6620  Single..    def 
-00005830: 746f 5f6e 6174 6976 655f 7661 6c75 6528  to_native_value(
-00005840: 7365 6c66 2c20 6465 6772 6565 5f76 616c  self, degree_val
-00005850: 7565 3a20 666c 6f61 742c 2069 735f 7265  ue: float, is_re
-00005860: 6c61 7469 7665 3a20 626f 6f6c 203d 2046  lative: bool = F
-00005870: 616c 7365 2920 2d3e 2066 6c6f 6174 3a0a  alse) -> float:.
-00005880: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
-00005890: 7274 2064 6567 7265 6520 7661 6c75 6573  rt degree values
-000058a0: 2074 6f20 7374 6570 2076 616c 7565 732e   to step values.
-000058b0: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-000058c0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-000058d0: 6c66 2e64 6567 7265 6573 2e6d 6178 2069  lf.degrees.max i
-000058e0: 7320 4e6f 6e65 2020 2320 6e6f 7161 3a20  s None  # noqa: 
-000058f0: 504c 5230 3931 360a 2020 2020 2020 2020  PLR0916.        
-00005900: 2020 2020 6f72 2073 656c 662e 6465 6772      or self.degr
-00005910: 6565 732e 6d69 6e20 6973 204e 6f6e 650a  ees.min is None.
-00005920: 2020 2020 2020 2020 2020 2020 6f72 2073              or s
-00005930: 656c 662e 6465 6772 6565 732e 7374 6570  elf.degrees.step
-00005940: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
-00005950: 2020 2020 206f 7220 7365 6c66 2e73 7465       or self.ste
-00005960: 7073 2e6d 6178 2069 7320 4e6f 6e65 0a20  ps.max is None. 
-00005970: 2020 2020 2020 2020 2020 206f 7220 7365             or se
-00005980: 6c66 2e73 7465 7073 2e6d 696e 2069 7320  lf.steps.min is 
-00005990: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-000059a0: 206f 7220 7365 6c66 2e73 7465 7073 2e73   or self.steps.s
-000059b0: 7465 7020 6973 204e 6f6e 650a 2020 2020  tep is None.    
-000059c0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-000059d0: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
-000059e0: 6573 7428 2264 6567 7265 6520 746f 2073  est("degree to s
-000059f0: 7465 7020 636f 6e76 6572 7369 6f6e 206e  tep conversion n
-00005a00: 6f74 2073 7570 706f 7274 6564 2e22 290a  ot supported.").
-00005a10: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00005a20: 6973 5f72 656c 6174 6976 653a 0a20 2020  is_relative:.   
-00005a30: 2020 2020 2020 2020 2064 6567 7265 655f           degree_
-00005a40: 7661 6c75 6520 2d3d 2073 656c 662e 6465  value -= self.de
-00005a50: 6772 6565 732e 6d69 6e0a 0a20 2020 2020  grees.min..     
-00005a60: 2020 2073 7465 705f 7261 6e67 6520 3d20     step_range = 
-00005a70: 7365 6c66 2e73 7465 7073 2e6d 6178 202d  self.steps.max -
-00005a80: 2073 656c 662e 7374 6570 732e 6d69 6e0a   self.steps.min.
-00005a90: 2020 2020 2020 2020 6465 6772 6565 5f72          degree_r
-00005aa0: 616e 6765 203d 2073 656c 662e 6465 6772  ange = self.degr
-00005ab0: 6565 732e 6d61 7820 2d20 7365 6c66 2e64  ees.max - self.d
-00005ac0: 6567 7265 6573 2e6d 696e 0a20 2020 2020  egrees.min.     
-00005ad0: 2020 2072 6174 696f 203d 2073 7465 705f     ratio = step_
-00005ae0: 7261 6e67 6520 2f20 6465 6772 6565 5f72  range / degree_r
-00005af0: 616e 6765 0a0a 2020 2020 2020 2020 7374  ange..        st
-00005b00: 6570 5f76 616c 7565 203d 2063 6c61 6d70  ep_value = clamp
-00005b10: 5f76 616c 7565 2864 6567 7265 655f 7661  _value(degree_va
-00005b20: 6c75 6520 2a20 7261 7469 6f2c 2073 656c  lue * ratio, sel
-00005b30: 662e 7374 6570 732e 7374 6570 290a 2020  f.steps.step).  
-00005b40: 2020 2020 2020 6966 206e 6f74 2069 735f        if not is_
-00005b50: 7265 6c61 7469 7665 3a0a 2020 2020 2020  relative:.      
-00005b60: 2020 2020 2020 7374 6570 5f76 616c 7565        step_value
-00005b70: 203d 2073 656c 662e 7374 6570 732e 6d69   = self.steps.mi
-00005b80: 6e20 2b20 7374 6570 5f76 616c 7565 0a0a  n + step_value..
-00005b90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00005ba0: 7465 705f 7661 6c75 650a 0a0a 636c 6173  tep_value...clas
-00005bb0: 7320 5054 5a5a 6f6f 6d52 616e 6765 2850  s PTZZoomRange(P
-00005bc0: 545a 5261 6e67 6529 3a0a 2020 2020 7261  TZRange):.    ra
-00005bd0: 7469 6f3a 2066 6c6f 6174 0a0a 2020 2020  tio: float..    
-00005be0: 6465 6620 746f 5f6e 6174 6976 655f 7661  def to_native_va
-00005bf0: 6c75 6528 7365 6c66 2c20 7a6f 6f6d 5f76  lue(self, zoom_v
-00005c00: 616c 7565 3a20 666c 6f61 742c 2069 735f  alue: float, is_
-00005c10: 7265 6c61 7469 7665 3a20 626f 6f6c 203d  relative: bool =
-00005c20: 2046 616c 7365 2920 2d3e 2066 6c6f 6174   False) -> float
-00005c30: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
-00005c40: 7665 7274 207a 6f6f 6d20 7661 6c75 6573  vert zoom values
-00005c50: 2074 6f20 7374 6570 2076 616c 7565 732e   to step values.
-00005c60: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00005c70: 7365 6c66 2e73 7465 7073 2e6d 6178 2069  self.steps.max i
-00005c80: 7320 4e6f 6e65 206f 7220 7365 6c66 2e73  s None or self.s
-00005c90: 7465 7073 2e6d 696e 2069 7320 4e6f 6e65  teps.min is None
-00005ca0: 206f 7220 7365 6c66 2e73 7465 7073 2e73   or self.steps.s
-00005cb0: 7465 7020 6973 204e 6f6e 653a 0a20 2020  tep is None:.   
-00005cc0: 2020 2020 2020 2020 2072 6169 7365 2042           raise B
-00005cd0: 6164 5265 7175 6573 7428 2273 7465 7020  adRequest("step 
-00005ce0: 636f 6e76 6572 7369 6f6e 206e 6f74 2073  conversion not s
-00005cf0: 7570 706f 7274 6564 2e22 290a 0a20 2020  upported.")..   
-00005d00: 2020 2020 2073 7465 705f 7261 6e67 6520       step_range 
-00005d10: 3d20 7365 6c66 2e73 7465 7073 2e6d 6178  = self.steps.max
-00005d20: 202d 2073 656c 662e 7374 6570 732e 6d69   - self.steps.mi
-00005d30: 6e0a 2020 2020 2020 2020 2320 7a6f 6f6d  n.        # zoom
-00005d40: 206c 6576 656c 7320 7374 6172 7420 6174   levels start at
-00005d50: 2031 0a20 2020 2020 2020 2072 6174 696f   1.        ratio
-00005d60: 203d 2073 7465 705f 7261 6e67 6520 2f20   = step_range / 
-00005d70: 2873 656c 662e 7261 7469 6f20 2d20 3129  (self.ratio - 1)
-00005d80: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00005d90: 6973 5f72 656c 6174 6976 653a 0a20 2020  is_relative:.   
-00005da0: 2020 2020 2020 2020 207a 6f6f 6d5f 7661           zoom_va
-00005db0: 6c75 6520 2d3d 2031 0a0a 2020 2020 2020  lue -= 1..      
-00005dc0: 2020 7374 6570 5f76 616c 7565 203d 2063    step_value = c
-00005dd0: 6c61 6d70 5f76 616c 7565 287a 6f6f 6d5f  lamp_value(zoom_
-00005de0: 7661 6c75 6520 2a20 7261 7469 6f2c 2073  value * ratio, s
-00005df0: 656c 662e 7374 6570 732e 7374 6570 290a  elf.steps.step).
-00005e00: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00005e10: 735f 7265 6c61 7469 7665 3a0a 2020 2020  s_relative:.    
-00005e20: 2020 2020 2020 2020 7374 6570 5f76 616c          step_val
-00005e30: 7565 203d 2073 656c 662e 7374 6570 732e  ue = self.steps.
-00005e40: 6d69 6e20 2b20 7374 6570 5f76 616c 7565  min + step_value
-00005e50: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00005e60: 2073 7465 705f 7661 6c75 650a 0a0a 636c   step_value...cl
-00005e70: 6173 7320 4361 6d65 7261 4665 6174 7572  ass CameraFeatur
-00005e80: 6546 6c61 6773 2850 726f 7465 6374 4261  eFlags(ProtectBa
-00005e90: 7365 4f62 6a65 6374 293a 0a20 2020 2063  seObject):.    c
-00005ea0: 616e 5f61 646a 7573 745f 6972 5f6c 6564  an_adjust_ir_led
-00005eb0: 5f6c 6576 656c 3a20 626f 6f6c 0a20 2020  _level: bool.   
-00005ec0: 2063 616e 5f6d 6167 6963 5f7a 6f6f 6d3a   can_magic_zoom:
-00005ed0: 2062 6f6f 6c0a 2020 2020 6361 6e5f 6f70   bool.    can_op
-00005ee0: 7469 6361 6c5f 7a6f 6f6d 3a20 626f 6f6c  tical_zoom: bool
-00005ef0: 0a20 2020 2063 616e 5f74 6f75 6368 5f66  .    can_touch_f
-00005f00: 6f63 7573 3a20 626f 6f6c 0a20 2020 2068  ocus: bool.    h
-00005f10: 6173 5f61 6363 656c 6572 6f6d 6574 6572  as_accelerometer
-00005f20: 3a20 626f 6f6c 0a20 2020 2068 6173 5f61  : bool.    has_a
-00005f30: 6563 3a20 626f 6f6c 0a20 2020 2068 6173  ec: bool.    has
-00005f40: 5f62 6c75 6574 6f6f 7468 3a20 626f 6f6c  _bluetooth: bool
-00005f50: 0a20 2020 2068 6173 5f63 6869 6d65 3a20  .    has_chime: 
-00005f60: 626f 6f6c 0a20 2020 2068 6173 5f65 7874  bool.    has_ext
-00005f70: 6572 6e61 6c5f 6972 3a20 626f 6f6c 0a20  ernal_ir: bool. 
-00005f80: 2020 2068 6173 5f69 6372 5f73 656e 7369     has_icr_sensi
-00005f90: 7469 7669 7479 3a20 626f 6f6c 0a20 2020  tivity: bool.   
-00005fa0: 2068 6173 5f6c 6463 3a20 626f 6f6c 0a20   has_ldc: bool. 
-00005fb0: 2020 2068 6173 5f6c 6564 5f69 723a 2062     has_led_ir: b
-00005fc0: 6f6f 6c0a 2020 2020 6861 735f 6c65 645f  ool.    has_led_
-00005fd0: 7374 6174 7573 3a20 626f 6f6c 0a20 2020  status: bool.   
-00005fe0: 2068 6173 5f6c 696e 655f 696e 3a20 626f   has_line_in: bo
-00005ff0: 6f6c 0a20 2020 2068 6173 5f6d 6963 3a20  ol.    has_mic: 
-00006000: 626f 6f6c 0a20 2020 2068 6173 5f70 7269  bool.    has_pri
-00006010: 7661 6379 5f6d 6173 6b3a 2062 6f6f 6c0a  vacy_mask: bool.
-00006020: 2020 2020 6861 735f 7274 633a 2062 6f6f      has_rtc: boo
-00006030: 6c0a 2020 2020 6861 735f 7364 5f63 6172  l.    has_sd_car
-00006040: 643a 2062 6f6f 6c0a 2020 2020 6861 735f  d: bool.    has_
-00006050: 7370 6561 6b65 723a 2062 6f6f 6c0a 2020  speaker: bool.  
-00006060: 2020 6861 735f 7769 6669 3a20 626f 6f6c    has_wifi: bool
-00006070: 0a20 2020 2068 6173 5f68 6472 3a20 626f  .    has_hdr: bo
-00006080: 6f6c 0a20 2020 2068 6173 5f61 7574 6f5f  ol.    has_auto_
-00006090: 6963 725f 6f6e 6c79 3a20 626f 6f6c 0a20  icr_only: bool. 
-000060a0: 2020 2076 6964 656f 5f6d 6f64 6573 3a20     video_modes: 
-000060b0: 6c69 7374 5b56 6964 656f 4d6f 6465 5d0a  list[VideoMode].
-000060c0: 2020 2020 7669 6465 6f5f 6d6f 6465 5f6d      video_mode_m
-000060d0: 6178 5f66 7073 3a20 6c69 7374 5b69 6e74  ax_fps: list[int
-000060e0: 5d0a 2020 2020 6861 735f 6d6f 7469 6f6e  ].    has_motion
-000060f0: 5f7a 6f6e 6573 3a20 626f 6f6c 0a20 2020  _zones: bool.   
-00006100: 2068 6173 5f6c 6364 5f73 6372 6565 6e3a   has_lcd_screen:
-00006110: 2062 6f6f 6c0a 2020 2020 736d 6172 745f   bool.    smart_
-00006120: 6465 7465 6374 5f74 7970 6573 3a20 6c69  detect_types: li
-00006130: 7374 5b53 6d61 7274 4465 7465 6374 4f62  st[SmartDetectOb
-00006140: 6a65 6374 5479 7065 5d0a 2020 2020 6d6f  jectType].    mo
-00006150: 7469 6f6e 5f61 6c67 6f72 6974 686d 733a  tion_algorithms:
-00006160: 206c 6973 745b 4d6f 7469 6f6e 416c 676f   list[MotionAlgo
-00006170: 7269 7468 6d5d 0a20 2020 2068 6173 5f73  rithm].    has_s
-00006180: 7175 6172 655f 6576 656e 745f 7468 756d  quare_event_thum
-00006190: 626e 6169 6c3a 2062 6f6f 6c0a 2020 2020  bnail: bool.    
-000061a0: 6861 735f 7061 636b 6167 655f 6361 6d65  has_package_came
-000061b0: 7261 3a20 626f 6f6c 0a20 2020 2070 7269  ra: bool.    pri
-000061c0: 7661 6379 5f6d 6173 6b5f 6361 7061 6269  vacy_mask_capabi
-000061d0: 6c69 7479 3a20 5072 6976 6163 794d 6173  lity: PrivacyMas
-000061e0: 6b43 6170 6162 696c 6974 790a 2020 2020  kCapability.    
-000061f0: 6861 735f 736d 6172 745f 6465 7465 6374  has_smart_detect
-00006200: 3a20 626f 6f6c 0a20 2020 2061 7564 696f  : bool.    audio
-00006210: 3a20 6c69 7374 5b73 7472 5d20 3d20 5b5d  : list[str] = []
-00006220: 0a20 2020 2061 7564 696f 5f63 6f64 6563  .    audio_codec
-00006230: 733a 206c 6973 745b 4175 6469 6f43 6f64  s: list[AudioCod
-00006240: 6563 735d 203d 205b 5d0a 2020 2020 6d6f  ecs] = [].    mo
-00006250: 756e 745f 706f 7369 7469 6f6e 733a 206c  unt_positions: l
-00006260: 6973 745b 4d6f 756e 7450 6f73 6974 696f  ist[MountPositio
-00006270: 6e5d 203d 205b 5d0a 2020 2020 6861 735f  n] = [].    has_
-00006280: 696e 6672 6172 6564 3a20 4f70 7469 6f6e  infrared: Option
-00006290: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 650a  al[bool] = None.
-000062a0: 2020 2020 6c65 6e73 5f74 7970 653a 204f      lens_type: O
-000062b0: 7074 696f 6e61 6c5b 4c65 6e73 5479 7065  ptional[LensType
-000062c0: 5d20 3d20 4e6f 6e65 0a20 2020 2068 6f74  ] = None.    hot
-000062d0: 706c 7567 3a20 4f70 7469 6f6e 616c 5b48  plug: Optional[H
-000062e0: 6f74 706c 7567 5d20 3d20 4e6f 6e65 0a20  otplug] = None. 
-000062f0: 2020 2073 6d61 7274 5f64 6574 6563 745f     smart_detect_
-00006300: 6175 6469 6f5f 7479 7065 733a 204f 7074  audio_types: Opt
-00006310: 696f 6e61 6c5b 6c69 7374 5b53 6d61 7274  ional[list[Smart
-00006320: 4465 7465 6374 4175 6469 6f54 7970 655d  DetectAudioType]
-00006330: 5d20 3d20 4e6f 6e65 0a20 2020 2023 2032  ] = None.    # 2
-00006340: 2e37 2e31 382b 0a20 2020 2069 735f 646f  .7.18+.    is_do
-00006350: 6f72 6265 6c6c 3a20 626f 6f6c 0a20 2020  orbell: bool.   
-00006360: 2023 2032 2e38 2e32 322b 0a20 2020 206c   # 2.8.22+.    l
-00006370: 656e 735f 6d6f 6465 6c3a 204f 7074 696f  ens_model: Optio
-00006380: 6e61 6c5b 7374 725d 203d 204e 6f6e 650a  nal[str] = None.
-00006390: 2020 2020 2320 322e 392e 3230 2b0a 2020      # 2.9.20+.  
-000063a0: 2020 6861 735f 636f 6c6f 725f 6c63 645f    has_color_lcd_
-000063b0: 7363 7265 656e 3a20 4f70 7469 6f6e 616c  screen: Optional
-000063c0: 5b62 6f6f 6c5d 203d 204e 6f6e 650a 2020  [bool] = None.  
-000063d0: 2020 6861 735f 6c69 6e65 5f63 726f 7373    has_line_cross
-000063e0: 696e 673a 204f 7074 696f 6e61 6c5b 626f  ing: Optional[bo
-000063f0: 6f6c 5d20 3d20 4e6f 6e65 0a20 2020 2068  ol] = None.    h
-00006400: 6173 5f6c 696e 655f 6372 6f73 7369 6e67  as_line_crossing
-00006410: 5f63 6f75 6e74 696e 673a 204f 7074 696f  _counting: Optio
-00006420: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
-00006430: 0a20 2020 2068 6173 5f6c 6976 6576 6965  .    has_livevie
-00006440: 775f 7472 6163 6b69 6e67 3a20 4f70 7469  w_tracking: Opti
-00006450: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-00006460: 650a 2020 2020 2320 322e 3130 2e31 302b  e.    # 2.10.10+
-00006470: 0a20 2020 2068 6173 5f66 6c61 7368 3a20  .    has_flash: 
-00006480: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
-00006490: 204e 6f6e 650a 2020 2020 6973 5f70 747a   None.    is_ptz
-000064a0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-000064b0: 203d 204e 6f6e 650a 2020 2020 2320 322e   = None.    # 2.
-000064c0: 3131 2e31 332b 0a20 2020 2061 7564 696f  11.13+.    audio
-000064d0: 5f73 7479 6c65 3a20 4f70 7469 6f6e 616c  _style: Optional
-000064e0: 5b6c 6973 745b 4175 6469 6f53 7479 6c65  [list[AudioStyle
-000064f0: 5d5d 203d 204e 6f6e 650a 2020 2020 6861  ]] = None.    ha
-00006500: 735f 7665 7274 6963 616c 5f66 6c69 703a  s_vertical_flip:
-00006510: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-00006520: 3d20 4e6f 6e65 0a20 2020 2023 2033 2e30  = None.    # 3.0
-00006530: 2e32 322b 0a20 2020 2066 6c61 7368 5f72  .22+.    flash_r
-00006540: 616e 6765 3a20 4f70 7469 6f6e 616c 5b41  ange: Optional[A
-00006550: 6e79 5d20 3d20 4e6f 6e65 0a0a 2020 2020  ny] = None..    
-00006560: 666f 6375 733a 2050 545a 5261 6e67 650a  focus: PTZRange.
-00006570: 2020 2020 7061 6e3a 2050 545a 5261 6e67      pan: PTZRang
-00006580: 650a 2020 2020 7469 6c74 3a20 5054 5a52  e.    tilt: PTZR
-00006590: 616e 6765 0a20 2020 207a 6f6f 6d3a 2050  ange.    zoom: P
-000065a0: 545a 5a6f 6f6d 5261 6e67 650a 0a20 2020  TZZoomRange..   
-000065b0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-000065c0: 2020 6465 6620 756e 6966 695f 6469 6374    def unifi_dict
-000065d0: 5f74 6f5f 6469 6374 2863 6c73 2c20 6461  _to_dict(cls, da
-000065e0: 7461 3a20 6469 6374 5b73 7472 2c20 416e  ta: dict[str, An
-000065f0: 795d 2920 2d3e 2064 6963 745b 7374 722c  y]) -> dict[str,
-00006600: 2041 6e79 5d3a 0a20 2020 2020 2020 2069   Any]:.        i
-00006610: 6620 2273 6d61 7274 4465 7465 6374 5479  f "smartDetectTy
-00006620: 7065 7322 2069 6e20 6461 7461 3a0a 2020  pes" in data:.  
-00006630: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-00006640: 736d 6172 7444 6574 6563 7454 7970 6573  smartDetectTypes
-00006650: 225d 203d 2063 6f6e 7665 7274 5f73 6d61  "] = convert_sma
-00006660: 7274 5f74 7970 6573 2864 6174 612e 706f  rt_types(data.po
-00006670: 7028 2273 6d61 7274 4465 7465 6374 5479  p("smartDetectTy
-00006680: 7065 7322 2929 0a20 2020 2020 2020 2069  pes")).        i
-00006690: 6620 2273 6d61 7274 4465 7465 6374 4175  f "smartDetectAu
-000066a0: 6469 6f54 7970 6573 2220 696e 2064 6174  dioTypes" in dat
-000066b0: 613a 0a20 2020 2020 2020 2020 2020 2064  a:.            d
-000066c0: 6174 615b 2273 6d61 7274 4465 7465 6374  ata["smartDetect
-000066d0: 4175 6469 6f54 7970 6573 225d 203d 2063  AudioTypes"] = c
-000066e0: 6f6e 7665 7274 5f73 6d61 7274 5f61 7564  onvert_smart_aud
-000066f0: 696f 5f74 7970 6573 280a 2020 2020 2020  io_types(.      
-00006700: 2020 2020 2020 2020 2020 6461 7461 2e70            data.p
-00006710: 6f70 2822 736d 6172 7444 6574 6563 7441  op("smartDetectA
-00006720: 7564 696f 5479 7065 7322 292c 0a20 2020  udioTypes"),.   
-00006730: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00006740: 2020 2069 6620 2276 6964 656f 4d6f 6465     if "videoMode
-00006750: 7322 2069 6e20 6461 7461 3a0a 2020 2020  s" in data:.    
-00006760: 2020 2020 2020 2020 6461 7461 5b22 7669          data["vi
-00006770: 6465 6f4d 6f64 6573 225d 203d 2063 6f6e  deoModes"] = con
-00006780: 7665 7274 5f76 6964 656f 5f6d 6f64 6573  vert_video_modes
-00006790: 2864 6174 612e 706f 7028 2276 6964 656f  (data.pop("video
-000067a0: 4d6f 6465 7322 2929 0a0a 2020 2020 2020  Modes"))..      
-000067b0: 2020 2320 6261 636b 706f 7274 2073 7570    # backport sup
-000067c0: 706f 7274 2066 6f72 2060 6973 5f64 6f6f  port for `is_doo
-000067d0: 7262 656c 6c60 2074 6f20 6f6c 6465 7220  rbell` to older 
-000067e0: 7665 7273 696f 6e73 206f 6620 5072 6f74  versions of Prot
-000067f0: 6563 740a 2020 2020 2020 2020 6966 2022  ect.        if "
-00006800: 6861 7343 6869 6d65 2220 696e 2064 6174  hasChime" in dat
-00006810: 6120 616e 6420 2269 7344 6f6f 7262 656c  a and "isDoorbel
-00006820: 6c22 206e 6f74 2069 6e20 6461 7461 3a0a  l" not in data:.
-00006830: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00006840: 5b22 6973 446f 6f72 6265 6c6c 225d 203d  ["isDoorbell"] =
-00006850: 2064 6174 615b 2268 6173 4368 696d 6522   data["hasChime"
-00006860: 5d0a 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
-00006870: 6e20 7375 7065 7228 292e 756e 6966 695f  n super().unifi_
-00006880: 6469 6374 5f74 6f5f 6469 6374 2864 6174  dict_to_dict(dat
-00006890: 6129 0a0a 2020 2020 4063 6c61 7373 6d65  a)..    @classme
-000068a0: 7468 6f64 0a20 2020 2040 6361 6368 650a  thod.    @cache.
-000068b0: 2020 2020 6465 6620 5f67 6574 5f75 6e69      def _get_uni
-000068c0: 6669 5f72 656d 6170 7328 636c 7329 202d  fi_remaps(cls) -
-000068d0: 3e20 6469 6374 5b73 7472 2c20 7374 725d  > dict[str, str]
-000068e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000068f0: 207b 2a2a 7375 7065 7228 292e 5f67 6574   {**super()._get
-00006900: 5f75 6e69 6669 5f72 656d 6170 7328 292c  _unifi_remaps(),
-00006910: 2022 6861 7341 7574 6f49 4352 4f6e 6c79   "hasAutoICROnly
-00006920: 223a 2022 6861 7341 7574 6f49 6372 4f6e  ": "hasAutoIcrOn
-00006930: 6c79 227d 0a0a 2020 2020 4070 726f 7065  ly"}..    @prope
-00006940: 7274 790a 2020 2020 6465 6620 6861 735f  rty.    def has_
-00006950: 6869 6768 6670 7328 7365 6c66 2920 2d3e  highfps(self) ->
-00006960: 2062 6f6f 6c3a 0a20 2020 2020 2020 2072   bool:.        r
-00006970: 6574 7572 6e20 5669 6465 6f4d 6f64 652e  eturn VideoMode.
-00006980: 4849 4748 5f46 5053 2069 6e20 7365 6c66  HIGH_FPS in self
-00006990: 2e76 6964 656f 5f6d 6f64 6573 0a0a 2020  .video_modes..  
-000069a0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000069b0: 6465 6620 6861 735f 7764 7228 7365 6c66  def has_wdr(self
-000069c0: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
-000069d0: 2020 2072 6574 7572 6e20 6e6f 7420 7365     return not se
-000069e0: 6c66 2e68 6173 5f68 6472 0a0a 0a63 6c61  lf.has_hdr...cla
-000069f0: 7373 2043 616d 6572 614c 656e 7365 7328  ss CameraLenses(
-00006a00: 5072 6f74 6563 7442 6173 654f 626a 6563  ProtectBaseObjec
-00006a10: 7429 3a0a 2020 2020 6964 3a20 696e 740a  t):.    id: int.
-00006a20: 2020 2020 7669 6465 6f3a 2056 6964 656f      video: Video
-00006a30: 5374 6174 730a 0a0a 636c 6173 7320 4361  Stats...class Ca
-00006a40: 6d65 7261 486f 6d65 6b69 7453 6574 7469  meraHomekitSetti
-00006a50: 6e67 7328 5072 6f74 6563 7442 6173 654f  ngs(ProtectBaseO
-00006a60: 626a 6563 7429 3a0a 2020 2020 6d69 6372  bject):.    micr
-00006a70: 6f70 686f 6e65 5f6d 7574 6564 3a20 626f  ophone_muted: bo
-00006a80: 6f6c 0a20 2020 2073 7065 616b 6572 5f6d  ol.    speaker_m
-00006a90: 7574 6564 3a20 626f 6f6c 0a20 2020 2073  uted: bool.    s
-00006aa0: 7472 6561 6d5f 696e 5f70 726f 6772 6573  tream_in_progres
-00006ab0: 733a 2062 6f6f 6c0a 2020 2020 7461 6c6b  s: bool.    talk
-00006ac0: 6261 636b 5f73 6574 7469 6e67 735f 6163  back_settings_ac
-00006ad0: 7469 7665 3a20 626f 6f6c 0a0a 0a63 6c61  tive: bool...cla
-00006ae0: 7373 2043 616d 6572 6141 7564 696f 5365  ss CameraAudioSe
-00006af0: 7474 696e 6773 2850 726f 7465 6374 4261  ttings(ProtectBa
-00006b00: 7365 4f62 6a65 6374 293a 0a20 2020 2073  seObject):.    s
-00006b10: 7479 6c65 3a20 6c69 7374 5b41 7564 696f  tyle: list[Audio
-00006b20: 5374 796c 655d 0a0a 0a63 6c61 7373 2043  Style]...class C
-00006b30: 616d 6572 6128 5072 6f74 6563 744d 6f74  amera(ProtectMot
-00006b40: 696f 6e44 6576 6963 654d 6f64 656c 293a  ionDeviceModel):
-00006b50: 0a20 2020 2069 735f 6465 6c65 7469 6e67  .    is_deleting
-00006b60: 3a20 626f 6f6c 0a20 2020 2023 204d 6963  : bool.    # Mic
-00006b70: 726f 7068 6f6e 6520 5365 6e73 6974 6976  rophone Sensitiv
-00006b80: 6974 790a 2020 2020 6d69 635f 766f 6c75  ity.    mic_volu
-00006b90: 6d65 3a20 5065 7263 656e 7449 6e74 0a20  me: PercentInt. 
-00006ba0: 2020 2069 735f 6d69 635f 656e 6162 6c65     is_mic_enable
-00006bb0: 643a 2062 6f6f 6c0a 2020 2020 6973 5f72  d: bool.    is_r
-00006bc0: 6563 6f72 6469 6e67 3a20 626f 6f6c 0a20  ecording: bool. 
-00006bd0: 2020 2069 735f 6d6f 7469 6f6e 5f64 6574     is_motion_det
-00006be0: 6563 7465 643a 2062 6f6f 6c0a 2020 2020  ected: bool.    
-00006bf0: 6973 5f73 6d61 7274 5f64 6574 6563 7465  is_smart_detecte
-00006c00: 643a 2062 6f6f 6c0a 2020 2020 7068 795f  d: bool.    phy_
-00006c10: 7261 7465 3a20 4f70 7469 6f6e 616c 5b66  rate: Optional[f
-00006c20: 6c6f 6174 5d0a 2020 2020 6864 725f 6d6f  loat].    hdr_mo
-00006c30: 6465 3a20 626f 6f6c 0a20 2020 2023 2052  de: bool.    # R
-00006c40: 6563 6f72 6469 6e67 2051 7561 6c69 7479  ecording Quality
-00006c50: 202d 3e20 4869 6768 2046 7261 6d65 0a20   -> High Frame. 
-00006c60: 2020 2076 6964 656f 5f6d 6f64 653a 2056     video_mode: V
-00006c70: 6964 656f 4d6f 6465 0a20 2020 2069 735f  ideoMode.    is_
-00006c80: 7072 6f62 696e 675f 666f 725f 7769 6669  probing_for_wifi
-00006c90: 3a20 626f 6f6c 0a20 2020 2063 6869 6d65  : bool.    chime
-00006ca0: 5f64 7572 6174 696f 6e3a 2074 696d 6564  _duration: timed
-00006cb0: 656c 7461 0a20 2020 206c 6173 745f 7269  elta.    last_ri
-00006cc0: 6e67 3a20 4f70 7469 6f6e 616c 5b64 6174  ng: Optional[dat
-00006cd0: 6574 696d 655d 0a20 2020 2069 735f 6c69  etime].    is_li
-00006ce0: 7665 5f68 6561 746d 6170 5f65 6e61 626c  ve_heatmap_enabl
-00006cf0: 6564 3a20 626f 6f6c 0a20 2020 2076 6964  ed: bool.    vid
-00006d00: 656f 5f72 6563 6f6e 6669 6775 7261 7469  eo_reconfigurati
-00006d10: 6f6e 5f69 6e5f 7072 6f67 7265 7373 3a20  on_in_progress: 
-00006d20: 626f 6f6c 0a20 2020 2063 6861 6e6e 656c  bool.    channel
-00006d30: 733a 206c 6973 745b 4361 6d65 7261 4368  s: list[CameraCh
-00006d40: 616e 6e65 6c5d 0a20 2020 2069 7370 5f73  annel].    isp_s
-00006d50: 6574 7469 6e67 733a 2049 5350 5365 7474  ettings: ISPSett
-00006d60: 696e 6773 0a20 2020 2074 616c 6b62 6163  ings.    talkbac
-00006d70: 6b5f 7365 7474 696e 6773 3a20 5461 6c6b  k_settings: Talk
-00006d80: 6261 636b 5365 7474 696e 6773 0a20 2020  backSettings.   
-00006d90: 206f 7364 5f73 6574 7469 6e67 733a 204f   osd_settings: O
-00006da0: 5344 5365 7474 696e 6773 0a20 2020 206c  SDSettings.    l
-00006db0: 6564 5f73 6574 7469 6e67 733a 204c 4544  ed_settings: LED
-00006dc0: 5365 7474 696e 6773 0a20 2020 2073 7065  Settings.    spe
-00006dd0: 616b 6572 5f73 6574 7469 6e67 733a 2053  aker_settings: S
-00006de0: 7065 616b 6572 5365 7474 696e 6773 0a20  peakerSettings. 
-00006df0: 2020 2072 6563 6f72 6469 6e67 5f73 6574     recording_set
-00006e00: 7469 6e67 733a 2052 6563 6f72 6469 6e67  tings: Recording
-00006e10: 5365 7474 696e 6773 0a20 2020 2073 6d61  Settings.    sma
-00006e20: 7274 5f64 6574 6563 745f 7365 7474 696e  rt_detect_settin
-00006e30: 6773 3a20 536d 6172 7444 6574 6563 7453  gs: SmartDetectS
-00006e40: 6574 7469 6e67 730a 2020 2020 6d6f 7469  ettings.    moti
-00006e50: 6f6e 5f7a 6f6e 6573 3a20 6c69 7374 5b4d  on_zones: list[M
-00006e60: 6f74 696f 6e5a 6f6e 655d 0a20 2020 2070  otionZone].    p
-00006e70: 7269 7661 6379 5f7a 6f6e 6573 3a20 6c69  rivacy_zones: li
-00006e80: 7374 5b43 616d 6572 615a 6f6e 655d 0a20  st[CameraZone]. 
-00006e90: 2020 2073 6d61 7274 5f64 6574 6563 745f     smart_detect_
-00006ea0: 7a6f 6e65 733a 206c 6973 745b 536d 6172  zones: list[Smar
-00006eb0: 744d 6f74 696f 6e5a 6f6e 655d 0a20 2020  tMotionZone].   
-00006ec0: 2073 7461 7473 3a20 4361 6d65 7261 5374   stats: CameraSt
-00006ed0: 6174 730a 2020 2020 6665 6174 7572 655f  ats.    feature_
-00006ee0: 666c 6167 733a 2043 616d 6572 6146 6561  flags: CameraFea
-00006ef0: 7475 7265 466c 6167 730a 2020 2020 6c63  tureFlags.    lc
-00006f00: 645f 6d65 7373 6167 653a 204f 7074 696f  d_message: Optio
-00006f10: 6e61 6c5b 4c43 444d 6573 7361 6765 5d0a  nal[LCDMessage].
-00006f20: 2020 2020 6c65 6e73 6573 3a20 6c69 7374      lenses: list
-00006f30: 5b43 616d 6572 614c 656e 7365 735d 0a20  [CameraLenses]. 
-00006f40: 2020 2070 6c61 7466 6f72 6d3a 2073 7472     platform: str
-00006f50: 0a20 2020 2068 6173 5f73 7065 616b 6572  .    has_speaker
-00006f60: 3a20 626f 6f6c 0a20 2020 2068 6173 5f77  : bool.    has_w
-00006f70: 6966 693a 2062 6f6f 6c0a 2020 2020 6175  ifi: bool.    au
-00006f80: 6469 6f5f 6269 7472 6174 653a 2069 6e74  dio_bitrate: int
-00006f90: 0a20 2020 2063 616e 5f6d 616e 6167 653a  .    can_manage:
-00006fa0: 2062 6f6f 6c0a 2020 2020 6973 5f6d 616e   bool.    is_man
-00006fb0: 6167 6564 3a20 626f 6f6c 0a20 2020 2076  aged: bool.    v
-00006fc0: 6f6c 7461 6765 3a20 4f70 7469 6f6e 616c  oltage: Optional
-00006fd0: 5b66 6c6f 6174 5d0a 2020 2020 2320 7265  [float].    # re
-00006fe0: 7175 6972 6573 2031 2e32 312b 0a20 2020  quires 1.21+.   
-00006ff0: 2069 735f 706f 6f72 5f6e 6574 776f 726b   is_poor_network
-00007000: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-00007010: 0a20 2020 2069 735f 7769 7265 6c65 7373  .    is_wireless
-00007020: 5f75 706c 696e 6b5f 656e 6162 6c65 643a  _uplink_enabled:
-00007030: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d0a   Optional[bool].
-00007040: 2020 2020 2320 7265 7175 6972 6573 2032      # requires 2
-00007050: 2e36 2e31 332b 0a20 2020 2068 6f6d 656b  .6.13+.    homek
-00007060: 6974 5f73 6574 7469 6e67 733a 204f 7074  it_settings: Opt
-00007070: 696f 6e61 6c5b 4361 6d65 7261 486f 6d65  ional[CameraHome
-00007080: 6b69 7453 6574 7469 6e67 735d 203d 204e  kitSettings] = N
-00007090: 6f6e 650a 2020 2020 2320 7265 7175 6972  one.    # requir
-000070a0: 6573 2032 2e36 2e31 372b 0a20 2020 2061  es 2.6.17+.    a
-000070b0: 705f 6d67 6d74 5f69 703a 204f 7074 696f  p_mgmt_ip: Optio
-000070c0: 6e61 6c5b 4950 7634 4164 6472 6573 735d  nal[IPv4Address]
-000070d0: 203d 204e 6f6e 650a 2020 2020 2320 7265   = None.    # re
-000070e0: 7175 6972 6573 2032 2e37 2e35 2b0a 2020  quires 2.7.5+.  
-000070f0: 2020 6973 5f77 6174 6572 7072 6f6f 665f    is_waterproof_
-00007100: 6361 7365 5f61 7474 6163 6865 643a 204f  case_attached: O
-00007110: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-00007120: 4e6f 6e65 0a20 2020 206c 6173 745f 6469  None.    last_di
-00007130: 7363 6f6e 6e65 6374 3a20 4f70 7469 6f6e  sconnect: Option
-00007140: 616c 5b64 6174 6574 696d 655d 203d 204e  al[datetime] = N
-00007150: 6f6e 650a 2020 2020 2320 7265 7175 6972  one.    # requir
-00007160: 6573 2032 2e38 2e31 342b 0a20 2020 2069  es 2.8.14+.    i
-00007170: 735f 326b 3a20 4f70 7469 6f6e 616c 5b62  s_2k: Optional[b
-00007180: 6f6f 6c5d 203d 204e 6f6e 650a 2020 2020  ool] = None.    
-00007190: 6973 5f34 6b3a 204f 7074 696f 6e61 6c5b  is_4k: Optional[
-000071a0: 626f 6f6c 5d20 3d20 4e6f 6e65 0a20 2020  bool] = None.   
-000071b0: 2075 7365 5f67 6c6f 6261 6c3a 204f 7074   use_global: Opt
-000071c0: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
-000071d0: 6e65 0a20 2020 2023 2072 6571 7569 7265  ne.    # require
-000071e0: 7320 322e 382e 3232 2b0a 2020 2020 7573  s 2.8.22+.    us
-000071f0: 6572 5f63 6f6e 6669 6775 7265 645f 6170  er_configured_ap
-00007200: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-00007210: 203d 204e 6f6e 650a 2020 2020 2320 7265   = None.    # re
-00007220: 7175 6972 6573 2032 2e39 2e32 302b 0a20  quires 2.9.20+. 
-00007230: 2020 2068 6173 5f72 6563 6f72 6469 6e67     has_recording
-00007240: 733a 204f 7074 696f 6e61 6c5b 626f 6f6c  s: Optional[bool
-00007250: 5d20 3d20 4e6f 6e65 0a20 2020 2023 2072  ] = None.    # r
-00007260: 6571 7569 7265 7320 322e 3130 2e31 302b  equires 2.10.10+
-00007270: 0a20 2020 2069 735f 7074 7a3a 204f 7074  .    is_ptz: Opt
-00007280: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f  ional[bool] = No
-00007290: 6e65 0a20 2020 2023 2072 6571 7569 7265  ne.    # require
-000072a0: 7320 322e 3131 2e31 332b 0a20 2020 2061  s 2.11.13+.    a
-000072b0: 7564 696f 5f73 6574 7469 6e67 733a 204f  udio_settings: O
-000072c0: 7074 696f 6e61 6c5b 4361 6d65 7261 4175  ptional[CameraAu
-000072d0: 6469 6f53 6574 7469 6e67 735d 203d 204e  dioSettings] = N
-000072e0: 6f6e 650a 0a20 2020 2023 2054 4f44 4f3a  one..    # TODO:
-000072f0: 2075 7365 6420 666f 7220 6164 6f70 7469   used for adopti
-00007300: 6e67 0a20 2020 2023 2061 704d 6163 2072  ng.    # apMac r
-00007310: 6561 6420 6f6e 6c79 0a20 2020 2023 2061  ead only.    # a
-00007320: 7052 7373 6920 7265 6164 206f 6e6c 790a  pRssi read only.
-00007330: 2020 2020 2320 656c 656d 656e 7449 6e66      # elementInf
-00007340: 6f20 7265 6164 206f 6e6c 790a 0a20 2020  o read only..   
-00007350: 2023 2054 4f44 4f3a 0a20 2020 2023 206c   # TODO:.    # l
-00007360: 6173 7450 7269 7661 6379 5a6f 6e65 506f  astPrivacyZonePo
-00007370: 7369 7469 6f6e 4964 0a20 2020 2023 2073  sitionId.    # s
-00007380: 6d61 7274 4465 7465 6374 4c69 6e65 730a  martDetectLines.
-00007390: 2020 2020 2320 7374 7265 616d 5368 6172      # streamShar
-000073a0: 696e 6720 7265 6164 206f 6e6c 790a 2020  ing read only.  
-000073b0: 2020 2320 7374 6f70 5374 7265 616d 4c65    # stopStreamLe
-000073c0: 7665 6c0a 2020 2020 2320 7570 6c69 6e6b  vel.    # uplink
-000073d0: 4465 7669 6365 0a20 2020 2023 2072 6563  Device.    # rec
-000073e0: 6f72 6469 6e67 5363 6865 6475 6c65 7356  ordingSchedulesV
-000073f0: 320a 0a20 2020 2023 206e 6f74 2064 6972  2..    # not dir
-00007400: 6563 746c 7920 6672 6f6d 2055 6e69 4669  ectly from UniFi
-00007410: 0a20 2020 206c 6173 745f 7269 6e67 5f65  .    last_ring_e
-00007420: 7665 6e74 5f69 643a 204f 7074 696f 6e61  vent_id: Optiona
-00007430: 6c5b 7374 725d 203d 204e 6f6e 650a 2020  l[str] = None.  
-00007440: 2020 6c61 7374 5f73 6d61 7274 5f64 6574    last_smart_det
-00007450: 6563 743a 204f 7074 696f 6e61 6c5b 6461  ect: Optional[da
-00007460: 7465 7469 6d65 5d20 3d20 4e6f 6e65 0a20  tetime] = None. 
-00007470: 2020 206c 6173 745f 736d 6172 745f 6175     last_smart_au
-00007480: 6469 6f5f 6465 7465 6374 3a20 4f70 7469  dio_detect: Opti
-00007490: 6f6e 616c 5b64 6174 6574 696d 655d 203d  onal[datetime] =
-000074a0: 204e 6f6e 650a 2020 2020 6c61 7374 5f73   None.    last_s
-000074b0: 6d61 7274 5f64 6574 6563 745f 6576 656e  mart_detect_even
-000074c0: 745f 6964 3a20 4f70 7469 6f6e 616c 5b73  t_id: Optional[s
-000074d0: 7472 5d20 3d20 4e6f 6e65 0a20 2020 206c  tr] = None.    l
-000074e0: 6173 745f 736d 6172 745f 6175 6469 6f5f  ast_smart_audio_
-000074f0: 6465 7465 6374 5f65 7665 6e74 5f69 643a  detect_event_id:
-00007500: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00007510: 204e 6f6e 650a 2020 2020 6c61 7374 5f73   None.    last_s
-00007520: 6d61 7274 5f64 6574 6563 7473 3a20 6469  mart_detects: di
-00007530: 6374 5b53 6d61 7274 4465 7465 6374 4f62  ct[SmartDetectOb
-00007540: 6a65 6374 5479 7065 2c20 6461 7465 7469  jectType, dateti
-00007550: 6d65 5d20 3d20 7b7d 0a20 2020 206c 6173  me] = {}.    las
-00007560: 745f 736d 6172 745f 6175 6469 6f5f 6465  t_smart_audio_de
-00007570: 7465 6374 733a 2064 6963 745b 536d 6172  tects: dict[Smar
-00007580: 7444 6574 6563 7441 7564 696f 5479 7065  tDetectAudioType
-00007590: 2c20 6461 7465 7469 6d65 5d20 3d20 7b7d  , datetime] = {}
-000075a0: 0a20 2020 206c 6173 745f 736d 6172 745f  .    last_smart_
-000075b0: 6465 7465 6374 5f65 7665 6e74 5f69 6473  detect_event_ids
-000075c0: 3a20 6469 6374 5b53 6d61 7274 4465 7465  : dict[SmartDete
-000075d0: 6374 4f62 6a65 6374 5479 7065 2c20 7374  ctObjectType, st
-000075e0: 725d 203d 207b 7d0a 2020 2020 6c61 7374  r] = {}.    last
-000075f0: 5f73 6d61 7274 5f61 7564 696f 5f64 6574  _smart_audio_det
-00007600: 6563 745f 6576 656e 745f 6964 733a 2064  ect_event_ids: d
-00007610: 6963 745b 536d 6172 7444 6574 6563 7441  ict[SmartDetectA
-00007620: 7564 696f 5479 7065 2c20 7374 725d 203d  udioType, str] =
-00007630: 207b 7d0a 2020 2020 7461 6c6b 6261 636b   {}.    talkback
-00007640: 5f73 7472 6561 6d3a 204f 7074 696f 6e61  _stream: Optiona
-00007650: 6c5b 5461 6c6b 6261 636b 5374 7265 616d  l[TalkbackStream
-00007660: 5d20 3d20 4e6f 6e65 0a20 2020 205f 6c61  ] = None.    _la
-00007670: 7374 5f72 696e 675f 7469 6d65 6f75 743a  st_ring_timeout:
-00007680: 204f 7074 696f 6e61 6c5b 6461 7465 7469   Optional[dateti
-00007690: 6d65 5d20 3d20 5072 6976 6174 6541 7474  me] = PrivateAtt
-000076a0: 7228 4e6f 6e65 290a 0a20 2020 2040 636c  r(None)..    @cl
-000076b0: 6173 736d 6574 686f 640a 2020 2020 4063  assmethod.    @c
-000076c0: 6163 6865 0a20 2020 2064 6566 205f 6765  ache.    def _ge
-000076d0: 745f 756e 6966 695f 7265 6d61 7073 2863  t_unifi_remaps(c
-000076e0: 6c73 2920 2d3e 2064 6963 745b 7374 722c  ls) -> dict[str,
-000076f0: 2073 7472 5d3a 0a20 2020 2020 2020 2072   str]:.        r
-00007700: 6574 7572 6e20 7b2a 2a73 7570 6572 2829  eturn {**super()
-00007710: 2e5f 6765 745f 756e 6966 695f 7265 6d61  ._get_unifi_rema
-00007720: 7073 2829 2c20 2269 7332 4b22 3a20 2269  ps(), "is2K": "i
-00007730: 7332 6b22 2c20 2269 7334 4b22 3a20 2269  s2k", "is4K": "i
-00007740: 7334 6b22 7d0a 0a20 2020 2040 636c 6173  s4k"}..    @clas
-00007750: 736d 6574 686f 640a 2020 2020 4063 6163  smethod.    @cac
-00007760: 6865 0a20 2020 2064 6566 205f 6765 745f  he.    def _get_
-00007770: 6578 636c 7564 6564 5f63 6861 6e67 6564  excluded_changed
-00007780: 5f66 6965 6c64 7328 636c 7329 202d 3e20  _fields(cls) -> 
-00007790: 7365 745b 7374 725d 3a0a 2020 2020 2020  set[str]:.      
-000077a0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
-000077b0: 2e5f 6765 745f 6578 636c 7564 6564 5f63  ._get_excluded_c
-000077c0: 6861 6e67 6564 5f66 6965 6c64 7328 2920  hanged_fields() 
-000077d0: 7c20 7b0a 2020 2020 2020 2020 2020 2020  | {.            
-000077e0: 226c 6173 745f 7269 6e67 5f65 7665 6e74  "last_ring_event
-000077f0: 5f69 6422 2c0a 2020 2020 2020 2020 2020  _id",.          
-00007800: 2020 226c 6173 745f 736d 6172 745f 6465    "last_smart_de
-00007810: 7465 6374 222c 0a20 2020 2020 2020 2020  tect",.         
-00007820: 2020 2022 6c61 7374 5f73 6d61 7274 5f61     "last_smart_a
-00007830: 7564 696f 5f64 6574 6563 7422 2c0a 2020  udio_detect",.  
-00007840: 2020 2020 2020 2020 2020 226c 6173 745f            "last_
-00007850: 736d 6172 745f 6465 7465 6374 5f65 7665  smart_detect_eve
-00007860: 6e74 5f69 6422 2c0a 2020 2020 2020 2020  nt_id",.        
-00007870: 2020 2020 226c 6173 745f 736d 6172 745f      "last_smart_
-00007880: 6175 6469 6f5f 6465 7465 6374 5f65 7665  audio_detect_eve
-00007890: 6e74 5f69 6422 2c0a 2020 2020 2020 2020  nt_id",.        
-000078a0: 2020 2020 226c 6173 745f 736d 6172 745f      "last_smart_
-000078b0: 6465 7465 6374 7322 2c0a 2020 2020 2020  detects",.      
-000078c0: 2020 2020 2020 226c 6173 745f 736d 6172        "last_smar
-000078d0: 745f 6175 6469 6f5f 6465 7465 6374 7322  t_audio_detects"
-000078e0: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-000078f0: 6173 745f 736d 6172 745f 6465 7465 6374  ast_smart_detect
-00007900: 5f65 7665 6e74 5f69 6473 222c 0a20 2020  _event_ids",.   
-00007910: 2020 2020 2020 2020 2022 6c61 7374 5f73           "last_s
-00007920: 6d61 7274 5f61 7564 696f 5f64 6574 6563  mart_audio_detec
-00007930: 745f 6576 656e 745f 6964 7322 2c0a 2020  t_event_ids",.  
-00007940: 2020 2020 2020 2020 2020 2274 616c 6b62            "talkb
-00007950: 6163 6b5f 7374 7265 616d 222c 0a20 2020  ack_stream",.   
-00007960: 2020 2020 207d 0a0a 2020 2020 4063 6c61       }..    @cla
-00007970: 7373 6d65 7468 6f64 0a20 2020 2040 6361  ssmethod.    @ca
-00007980: 6368 650a 2020 2020 6465 6620 5f67 6574  che.    def _get
-00007990: 5f72 6561 645f 6f6e 6c79 5f66 6965 6c64  _read_only_field
-000079a0: 7328 636c 7329 202d 3e20 7365 745b 7374  s(cls) -> set[st
-000079b0: 725d 3a0a 2020 2020 2020 2020 7265 7475  r]:.        retu
-000079c0: 726e 2073 7570 6572 2829 2e5f 6765 745f  rn super()._get_
-000079d0: 7265 6164 5f6f 6e6c 795f 6669 656c 6473  read_only_fields
-000079e0: 2829 207c 207b 0a20 2020 2020 2020 2020  () | {.         
-000079f0: 2020 2022 7374 6174 7322 2c0a 2020 2020     "stats",.    
-00007a00: 2020 2020 2020 2020 2269 7344 656c 6574          "isDelet
-00007a10: 696e 6722 2c0a 2020 2020 2020 2020 2020  ing",.          
-00007a20: 2020 2269 7352 6563 6f72 6469 6e67 222c    "isRecording",
-00007a30: 0a20 2020 2020 2020 2020 2020 2022 6973  .            "is
-00007a40: 4d6f 7469 6f6e 4465 7465 6374 6564 222c  MotionDetected",
-00007a50: 0a20 2020 2020 2020 2020 2020 2022 6973  .            "is
-00007a60: 536d 6172 7444 6574 6563 7465 6422 2c0a  SmartDetected",.
-00007a70: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
-00007a80: 5261 7465 222c 0a20 2020 2020 2020 2020  Rate",.         
-00007a90: 2020 2022 6973 5072 6f62 696e 6746 6f72     "isProbingFor
-00007aa0: 5769 6669 222c 0a20 2020 2020 2020 2020  Wifi",.         
-00007ab0: 2020 2022 6c61 7374 5269 6e67 222c 0a20     "lastRing",. 
-00007ac0: 2020 2020 2020 2020 2020 2022 6973 4c69             "isLi
-00007ad0: 7665 4865 6174 6d61 7045 6e61 626c 6564  veHeatmapEnabled
-00007ae0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-00007af0: 7669 6465 6f52 6563 6f6e 6669 6775 7261  videoReconfigura
-00007b00: 7469 6f6e 496e 5072 6f67 7265 7373 222c  tionInProgress",
-00007b10: 0a20 2020 2020 2020 2020 2020 2022 6c65  .            "le
-00007b20: 6e73 6573 222c 0a20 2020 2020 2020 2020  nses",.         
-00007b30: 2020 2022 6973 506f 6f72 4e65 7477 6f72     "isPoorNetwor
-00007b40: 6b22 2c0a 2020 2020 2020 2020 2020 2020  k",.            
-00007b50: 2266 6561 7475 7265 466c 6167 7322 2c0a  "featureFlags",.
-00007b60: 2020 2020 2020 2020 7d0a 0a20 2020 2040          }..    @
-00007b70: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-00007b80: 6465 6620 756e 6966 695f 6469 6374 5f74  def unifi_dict_t
-00007b90: 6f5f 6469 6374 2863 6c73 2c20 6461 7461  o_dict(cls, data
-00007ba0: 3a20 6469 6374 5b73 7472 2c20 416e 795d  : dict[str, Any]
-00007bb0: 2920 2d3e 2064 6963 745b 7374 722c 2041  ) -> dict[str, A
-00007bc0: 6e79 5d3a 0a20 2020 2020 2020 2023 204c  ny]:.        # L
-00007bd0: 4344 206d 6573 7361 6765 7320 636f 6d65  CD messages come
-00007be0: 7320 6261 636b 2061 7320 656d 7074 7920  s back as empty 
-00007bf0: 6469 6374 207b 7d0a 2020 2020 2020 2020  dict {}.        
-00007c00: 6966 2022 6c63 644d 6573 7361 6765 2220  if "lcdMessage" 
-00007c10: 696e 2064 6174 6120 616e 6420 6c65 6e28  in data and len(
-00007c20: 6461 7461 5b22 6c63 644d 6573 7361 6765  data["lcdMessage
-00007c30: 225d 2e6b 6579 7328 2929 203d 3d20 303a  "].keys()) == 0:
-00007c40: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
-00007c50: 2064 6174 615b 226c 6364 4d65 7373 6167   data["lcdMessag
-00007c60: 6522 5d0a 2020 2020 2020 2020 6966 2022  e"].        if "
-00007c70: 6368 696d 6544 7572 6174 696f 6e22 2069  chimeDuration" i
-00007c80: 6e20 6461 7461 2061 6e64 206e 6f74 2069  n data and not i
-00007c90: 7369 6e73 7461 6e63 6528 6461 7461 5b22  sinstance(data["
-00007ca0: 6368 696d 6544 7572 6174 696f 6e22 5d2c  chimeDuration"],
-00007cb0: 2074 696d 6564 656c 7461 293a 0a20 2020   timedelta):.   
-00007cc0: 2020 2020 2020 2020 2064 6174 615b 2263           data["c
-00007cd0: 6869 6d65 4475 7261 7469 6f6e 225d 203d  himeDuration"] =
-00007ce0: 2074 696d 6564 656c 7461 286d 696c 6c69   timedelta(milli
-00007cf0: 7365 636f 6e64 733d 6461 7461 5b22 6368  seconds=data["ch
-00007d00: 696d 6544 7572 6174 696f 6e22 5d29 0a0a  imeDuration"])..
-00007d10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00007d20: 7570 6572 2829 2e75 6e69 6669 5f64 6963  uper().unifi_dic
-00007d30: 745f 746f 5f64 6963 7428 6461 7461 290a  t_to_dict(data).
-00007d40: 0a20 2020 2064 6566 2075 6e69 6669 5f64  .    def unifi_d
-00007d50: 6963 7428 0a20 2020 2020 2020 2073 656c  ict(.        sel
-00007d60: 662c 0a20 2020 2020 2020 2064 6174 613a  f,.        data:
-00007d70: 204f 7074 696f 6e61 6c5b 6469 6374 5b73   Optional[dict[s
-00007d80: 7472 2c20 416e 795d 5d20 3d20 4e6f 6e65  tr, Any]] = None
-00007d90: 2c0a 2020 2020 2020 2020 6578 636c 7564  ,.        exclud
-00007da0: 653a 204f 7074 696f 6e61 6c5b 7365 745b  e: Optional[set[
-00007db0: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
-00007dc0: 2020 2920 2d3e 2064 6963 745b 7374 722c    ) -> dict[str,
-00007dd0: 2041 6e79 5d3a 0a20 2020 2020 2020 2069   Any]:.        i
-00007de0: 6620 6461 7461 2069 7320 6e6f 7420 4e6f  f data is not No
-00007df0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00007e00: 6966 2022 6d6f 7469 6f6e 5f7a 6f6e 6573  if "motion_zones
-00007e10: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
-00007e20: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-00007e30: 226d 6f74 696f 6e5f 7a6f 6e65 7322 5d20  "motion_zones"] 
-00007e40: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-00007e50: 2020 2020 2020 2020 4d6f 7469 6f6e 5a6f          MotionZo
-00007e60: 6e65 282a 2a7a 292e 756e 6966 695f 6469  ne(**z).unifi_di
-00007e70: 6374 2829 2066 6f72 207a 2069 6e20 6461  ct() for z in da
-00007e80: 7461 5b22 6d6f 7469 6f6e 5f7a 6f6e 6573  ta["motion_zones
-00007e90: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00007ea0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00007eb0: 2069 6620 2270 7269 7661 6379 5f7a 6f6e   if "privacy_zon
-00007ec0: 6573 2220 696e 2064 6174 613a 0a20 2020  es" in data:.   
-00007ed0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00007ee0: 615b 2270 7269 7661 6379 5f7a 6f6e 6573  a["privacy_zones
-00007ef0: 225d 203d 205b 0a20 2020 2020 2020 2020  "] = [.         
-00007f00: 2020 2020 2020 2020 2020 2043 616d 6572             Camer
-00007f10: 615a 6f6e 6528 2a2a 7a29 2e75 6e69 6669  aZone(**z).unifi
-00007f20: 5f64 6963 7428 2920 666f 7220 7a20 696e  _dict() for z in
-00007f30: 2064 6174 615b 2270 7269 7661 6379 5f7a   data["privacy_z
-00007f40: 6f6e 6573 225d 0a20 2020 2020 2020 2020  ones"].         
-00007f50: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00007f60: 2020 2020 2069 6620 2273 6d61 7274 5f64       if "smart_d
-00007f70: 6574 6563 745f 7a6f 6e65 7322 2069 6e20  etect_zones" in 
-00007f80: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
-00007f90: 2020 2020 2020 6461 7461 5b22 736d 6172        data["smar
-00007fa0: 745f 6465 7465 6374 5f7a 6f6e 6573 225d  t_detect_zones"]
-00007fb0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-00007fc0: 2020 2020 2020 2020 2053 6d61 7274 4d6f           SmartMo
-00007fd0: 7469 6f6e 5a6f 6e65 282a 2a7a 292e 756e  tionZone(**z).un
-00007fe0: 6966 695f 6469 6374 2829 0a20 2020 2020  ifi_dict().     
-00007ff0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00008000: 6f72 207a 2069 6e20 6461 7461 5b22 736d  or z in data["sm
-00008010: 6172 745f 6465 7465 6374 5f7a 6f6e 6573  art_detect_zones
-00008020: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00008030: 2020 205d 0a0a 2020 2020 2020 2020 6461     ]..        da
-00008040: 7461 203d 2073 7570 6572 2829 2e75 6e69  ta = super().uni
-00008050: 6669 5f64 6963 7428 6461 7461 3d64 6174  fi_dict(data=dat
-00008060: 612c 2065 7863 6c75 6465 3d65 7863 6c75  a, exclude=exclu
-00008070: 6465 290a 0a20 2020 2020 2020 2069 6620  de)..        if 
-00008080: 226c 6173 7452 696e 6745 7665 6e74 4964  "lastRingEventId
-00008090: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
-000080a0: 2020 2020 2020 2064 656c 2064 6174 615b         del data[
-000080b0: 226c 6173 7452 696e 6745 7665 6e74 4964  "lastRingEventId
-000080c0: 225d 0a20 2020 2020 2020 2069 6620 226c  "].        if "l
-000080d0: 6173 7453 6d61 7274 4465 7465 6374 2220  astSmartDetect" 
-000080e0: 696e 2064 6174 613a 0a20 2020 2020 2020  in data:.       
-000080f0: 2020 2020 2064 656c 2064 6174 615b 226c       del data["l
-00008100: 6173 7453 6d61 7274 4465 7465 6374 225d  astSmartDetect"]
-00008110: 0a20 2020 2020 2020 2069 6620 226c 6173  .        if "las
-00008120: 7453 6d61 7274 4175 6469 6f44 6574 6563  tSmartAudioDetec
-00008130: 7422 2069 6e20 6461 7461 3a0a 2020 2020  t" in data:.    
-00008140: 2020 2020 2020 2020 6465 6c20 6461 7461          del data
-00008150: 5b22 6c61 7374 536d 6172 7441 7564 696f  ["lastSmartAudio
-00008160: 4465 7465 6374 225d 0a20 2020 2020 2020  Detect"].       
-00008170: 2069 6620 226c 6173 7453 6d61 7274 4465   if "lastSmartDe
-00008180: 7465 6374 4576 656e 7449 6422 2069 6e20  tectEventId" in 
-00008190: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
-000081a0: 2020 6465 6c20 6461 7461 5b22 6c61 7374    del data["last
-000081b0: 536d 6172 7444 6574 6563 7445 7665 6e74  SmartDetectEvent
-000081c0: 4964 225d 0a20 2020 2020 2020 2069 6620  Id"].        if 
-000081d0: 226c 6173 7453 6d61 7274 4175 6469 6f44  "lastSmartAudioD
-000081e0: 6574 6563 7445 7665 6e74 4964 2220 696e  etectEventId" in
-000081f0: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
-00008200: 2020 2064 656c 2064 6174 615b 226c 6173     del data["las
-00008210: 7453 6d61 7274 4175 6469 6f44 6574 6563  tSmartAudioDetec
-00008220: 7445 7665 6e74 4964 225d 0a20 2020 2020  tEventId"].     
-00008230: 2020 2069 6620 226c 6173 7453 6d61 7274     if "lastSmart
-00008240: 4465 7465 6374 7322 2069 6e20 6461 7461  Detects" in data
-00008250: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
-00008260: 6c20 6461 7461 5b22 6c61 7374 536d 6172  l data["lastSmar
-00008270: 7444 6574 6563 7473 225d 0a20 2020 2020  tDetects"].     
-00008280: 2020 2069 6620 226c 6173 7453 6d61 7274     if "lastSmart
-00008290: 4175 6469 6f44 6574 6563 7473 2220 696e  AudioDetects" in
-000082a0: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
-000082b0: 2020 2064 656c 2064 6174 615b 226c 6173     del data["las
-000082c0: 7453 6d61 7274 4175 6469 6f44 6574 6563  tSmartAudioDetec
-000082d0: 7473 225d 0a20 2020 2020 2020 2069 6620  ts"].        if 
-000082e0: 226c 6173 7453 6d61 7274 4465 7465 6374  "lastSmartDetect
-000082f0: 4576 656e 7449 6473 2220 696e 2064 6174  EventIds" in dat
-00008300: 613a 0a20 2020 2020 2020 2020 2020 2064  a:.            d
-00008310: 656c 2064 6174 615b 226c 6173 7453 6d61  el data["lastSma
-00008320: 7274 4465 7465 6374 4576 656e 7449 6473  rtDetectEventIds
-00008330: 225d 0a20 2020 2020 2020 2069 6620 226c  "].        if "l
-00008340: 6173 7453 6d61 7274 4175 6469 6f44 6574  astSmartAudioDet
-00008350: 6563 7445 7665 6e74 4964 7322 2069 6e20  ectEventIds" in 
-00008360: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
-00008370: 2020 6465 6c20 6461 7461 5b22 6c61 7374    del data["last
-00008380: 536d 6172 7441 7564 696f 4465 7465 6374  SmartAudioDetect
-00008390: 4576 656e 7449 6473 225d 0a20 2020 2020  EventIds"].     
-000083a0: 2020 2069 6620 2274 616c 6b62 6163 6b53     if "talkbackS
-000083b0: 7472 6561 6d22 2069 6e20 6461 7461 3a0a  tream" in data:.
-000083c0: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-000083d0: 6461 7461 5b22 7461 6c6b 6261 636b 5374  data["talkbackSt
-000083e0: 7265 616d 225d 0a20 2020 2020 2020 2069  ream"].        i
-000083f0: 6620 226c 6364 4d65 7373 6167 6522 2069  f "lcdMessage" i
-00008400: 6e20 6461 7461 2061 6e64 2064 6174 615b  n data and data[
-00008410: 226c 6364 4d65 7373 6167 6522 5d20 6973  "lcdMessage"] is
-00008420: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00008430: 2020 2064 6174 615b 226c 6364 4d65 7373     data["lcdMess
-00008440: 6167 6522 5d20 3d20 7b7d 0a0a 2020 2020  age"] = {}..    
-00008450: 2020 2020 7265 7475 726e 2064 6174 610a      return data.
-00008460: 0a20 2020 2064 6566 2067 6574 5f63 6861  .    def get_cha
-00008470: 6e67 6564 2873 656c 662c 2064 6174 615f  nged(self, data_
-00008480: 6265 666f 7265 5f63 6861 6e67 6573 3a20  before_changes: 
-00008490: 6469 6374 5b73 7472 2c20 416e 795d 2920  dict[str, Any]) 
-000084a0: 2d3e 2064 6963 745b 7374 722c 2041 6e79  -> dict[str, Any
-000084b0: 5d3a 0a20 2020 2020 2020 2075 7064 6174  ]:.        updat
-000084c0: 6564 203d 2073 7570 6572 2829 2e67 6574  ed = super().get
-000084d0: 5f63 6861 6e67 6564 2864 6174 615f 6265  _changed(data_be
-000084e0: 666f 7265 5f63 6861 6e67 6573 290a 0a20  fore_changes).. 
-000084f0: 2020 2020 2020 2069 6620 226c 6364 5f6d         if "lcd_m
-00008500: 6573 7361 6765 2220 696e 2075 7064 6174  essage" in updat
-00008510: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-00008520: 6c63 645f 6d65 7373 6167 6520 3d20 7570  lcd_message = up
-00008530: 6461 7465 645b 226c 6364 5f6d 6573 7361  dated["lcd_messa
-00008540: 6765 225d 0a20 2020 2020 2020 2020 2020  ge"].           
-00008550: 2023 2074 6f20 2263 6c65 6172 2220 4c43   # to "clear" LC
-00008560: 4420 6d65 7373 6167 652c 2073 6574 2072  D message, set r
-00008570: 6573 6574 5f61 7420 746f 2061 2074 696d  eset_at to a tim
-00008580: 6520 696e 2074 6865 2070 6173 740a 2020  e in the past.  
-00008590: 2020 2020 2020 2020 2020 6966 206c 6364            if lcd
-000085a0: 5f6d 6573 7361 6765 2069 7320 4e6f 6e65  _message is None
-000085b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000085c0: 2020 7570 6461 7465 645b 226c 6364 5f6d    updated["lcd_m
-000085d0: 6573 7361 6765 225d 203d 207b 2272 6573  essage"] = {"res
-000085e0: 6574 5f61 7422 3a20 7574 635f 6e6f 7728  et_at": utc_now(
-000085f0: 2920 2d20 7469 6d65 6465 6c74 6128 7365  ) - timedelta(se
-00008600: 636f 6e64 733d 3130 297d 0a20 2020 2020  conds=10)}.     
-00008610: 2020 2020 2020 2023 206f 7468 6572 7769         # otherwi
-00008620: 7365 2c20 7061 7373 2066 756c 6c20 4c43  se, pass full LC
-00008630: 4420 6d65 7373 6167 6520 746f 2070 7265  D message to pre
-00008640: 7665 6e74 2069 7373 7565 730a 2020 2020  vent issues.    
-00008650: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00008660: 662e 6c63 645f 6d65 7373 6167 6520 6973  f.lcd_message is
-00008670: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00008680: 2020 2020 2020 2020 2020 2075 7064 6174             updat
-00008690: 6564 5b22 6c63 645f 6d65 7373 6167 6522  ed["lcd_message"
-000086a0: 5d20 3d20 7365 6c66 2e6c 6364 5f6d 6573  ] = self.lcd_mes
-000086b0: 7361 6765 2e64 6963 7428 290a 0a20 2020  sage.dict()..   
-000086c0: 2020 2020 2020 2020 2023 2069 6620 7265           # if re
-000086d0: 7365 745f 6174 2069 7320 6e6f 7420 7061  set_at is not pa
-000086e0: 7373 6564 2069 6e2c 2069 7420 7769 6c6c  ssed in, it will
-000086f0: 2064 6566 6175 6c74 2074 6f20 7265 7365   default to rese
-00008700: 7420 696e 2031 206d 696e 7574 650a 2020  t in 1 minute.  
-00008710: 2020 2020 2020 2020 2020 6966 206c 6364            if lcd
-00008720: 5f6d 6573 7361 6765 2069 7320 6e6f 7420  _message is not 
-00008730: 4e6f 6e65 2061 6e64 2022 7265 7365 745f  None and "reset_
-00008740: 6174 2220 6e6f 7420 696e 206c 6364 5f6d  at" not in lcd_m
-00008750: 6573 7361 6765 3a0a 2020 2020 2020 2020  essage:.        
-00008760: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00008770: 6c63 645f 6d65 7373 6167 6520 6973 204e  lcd_message is N
-00008780: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00008790: 2020 2020 2020 2020 2075 7064 6174 6564           updated
-000087a0: 5b22 6c63 645f 6d65 7373 6167 6522 5d5b  ["lcd_message"][
-000087b0: 2272 6573 6574 5f61 7422 5d20 3d20 4e6f  "reset_at"] = No
-000087c0: 6e65 0a20 2020 2020 2020 2020 2020 2020  ne.             
-000087d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000087e0: 2020 2020 2020 2020 2020 2020 2075 7064               upd
-000087f0: 6174 6564 5b22 6c63 645f 6d65 7373 6167  ated["lcd_messag
-00008800: 6522 5d5b 2272 6573 6574 5f61 7422 5d20  e"]["reset_at"] 
-00008810: 3d20 7365 6c66 2e6c 6364 5f6d 6573 7361  = self.lcd_messa
-00008820: 6765 2e72 6573 6574 5f61 740a 0a20 2020  ge.reset_at..   
-00008830: 2020 2020 2072 6574 7572 6e20 7570 6461       return upda
-00008840: 7465 640a 0a20 2020 2064 6566 2075 7064  ted..    def upd
-00008850: 6174 655f 6672 6f6d 5f64 6963 7428 7365  ate_from_dict(se
-00008860: 6c66 2c20 6461 7461 3a20 6469 6374 5b73  lf, data: dict[s
-00008870: 7472 2c20 416e 795d 2920 2d3e 2043 616d  tr, Any]) -> Cam
-00008880: 6572 613a 0a20 2020 2020 2020 2023 2061  era:.        # a
-00008890: 206d 6573 7361 6765 2069 6e20 7468 6520   message in the 
-000088a0: 7061 7374 2069 7320 6163 7475 616c 6c79  past is actually
-000088b0: 2061 2073 696e 6761 6c20 746f 2077 6970   a singal to wip
-000088c0: 6520 7468 6520 6d65 7373 6167 650a 2020  e the message.  
-000088d0: 2020 2020 2020 7265 7365 745f 6174 203d        reset_at =
-000088e0: 2064 6174 612e 6765 7428 226c 6364 5f6d   data.get("lcd_m
-000088f0: 6573 7361 6765 222c 207b 7d29 2e67 6574  essage", {}).get
-00008900: 2822 7265 7365 745f 6174 2229 0a20 2020  ("reset_at").   
-00008910: 2020 2020 2069 6620 7265 7365 745f 6174       if reset_at
-00008920: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00008930: 2020 2020 2020 2020 2020 7265 7365 745f            reset_
-00008940: 6174 203d 2066 726f 6d5f 6a73 5f74 696d  at = from_js_tim
-00008950: 6528 7265 7365 745f 6174 290a 2020 2020  e(reset_at).    
-00008960: 2020 2020 2020 2020 6966 2075 7463 5f6e          if utc_n
-00008970: 6f77 2829 203e 2072 6573 6574 5f61 743a  ow() > reset_at:
-00008980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008990: 2064 6174 615b 226c 6364 5f6d 6573 7361   data["lcd_messa
-000089a0: 6765 225d 203d 204e 6f6e 650a 0a20 2020  ge"] = None..   
-000089b0: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-000089c0: 7228 292e 7570 6461 7465 5f66 726f 6d5f  r().update_from_
-000089d0: 6469 6374 2864 6174 6129 0a0a 2020 2020  dict(data)..    
-000089e0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000089f0: 6620 6c61 7374 5f72 696e 675f 6576 656e  f last_ring_even
-00008a00: 7428 7365 6c66 2920 2d3e 204f 7074 696f  t(self) -> Optio
-00008a10: 6e61 6c5b 4576 656e 745d 3a0a 2020 2020  nal[Event]:.    
-00008a20: 2020 2020 6966 2073 656c 662e 6c61 7374      if self.last
-00008a30: 5f72 696e 675f 6576 656e 745f 6964 2069  _ring_event_id i
-00008a40: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00008a50: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
-00008a60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008a70: 7365 6c66 2e61 7069 2e62 6f6f 7473 7472  self.api.bootstr
-00008a80: 6170 2e65 7665 6e74 732e 6765 7428 7365  ap.events.get(se
-00008a90: 6c66 2e6c 6173 745f 7269 6e67 5f65 7665  lf.last_ring_eve
-00008aa0: 6e74 5f69 6429 0a0a 2020 2020 4070 726f  nt_id)..    @pro
-00008ab0: 7065 7274 790a 2020 2020 6465 6620 6c61  perty.    def la
-00008ac0: 7374 5f73 6d61 7274 5f64 6574 6563 745f  st_smart_detect_
-00008ad0: 6576 656e 7428 7365 6c66 2920 2d3e 204f  event(self) -> O
-00008ae0: 7074 696f 6e61 6c5b 4576 656e 745d 3a0a  ptional[Event]:.
-00008af0: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
-00008b00: 6865 206c 6173 7420 736d 6172 7420 6465  he last smart de
-00008b10: 7465 6374 2065 7665 6e74 2069 642e 2222  tect event id.""
-00008b20: 220a 0a20 2020 2020 2020 2069 6620 7365  "..        if se
-00008b30: 6c66 2e6c 6173 745f 736d 6172 745f 6465  lf.last_smart_de
-00008b40: 7465 6374 5f65 7665 6e74 5f69 6420 6973  tect_event_id is
-00008b50: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00008b60: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
-00008b70: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00008b80: 656c 662e 6170 692e 626f 6f74 7374 7261  elf.api.bootstra
-00008b90: 702e 6576 656e 7473 2e67 6574 2873 656c  p.events.get(sel
-00008ba0: 662e 6c61 7374 5f73 6d61 7274 5f64 6574  f.last_smart_det
-00008bb0: 6563 745f 6576 656e 745f 6964 290a 0a20  ect_event_id).. 
-00008bc0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00008bd0: 2064 6566 2068 6472 5f6d 6f64 655f 6469   def hdr_mode_di
-00008be0: 7370 6c61 7928 7365 6c66 2920 2d3e 204c  splay(self) -> L
-00008bf0: 6974 6572 616c 5b22 6175 746f 222c 2022  iteral["auto", "
-00008c00: 6f66 6622 2c20 2261 6c77 6179 7322 5d3a  off", "always"]:
-00008c10: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
-00008c20: 4844 5220 6d6f 6465 2073 696d 696c 6172  HDR mode similar
-00008c30: 2074 6f20 686f 7720 5072 6f74 6563 7420   to how Protect 
-00008c40: 696e 7465 7266 6163 6520 776f 726b 732e  interface works.
-00008c50: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00008c60: 6e6f 7420 7365 6c66 2e68 6472 5f6d 6f64  not self.hdr_mod
-00008c70: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00008c80: 6574 7572 6e20 226f 6666 220a 2020 2020  eturn "off".    
-00008c90: 2020 2020 6966 2073 656c 662e 6973 705f      if self.isp_
-00008ca0: 7365 7474 696e 6773 2e68 6472 5f6d 6f64  settings.hdr_mod
-00008cb0: 6520 3d3d 2048 4452 4d6f 6465 2e4e 4f52  e == HDRMode.NOR
-00008cc0: 4d41 4c3a 0a20 2020 2020 2020 2020 2020  MAL:.           
-00008cd0: 2072 6574 7572 6e20 2261 7574 6f22 0a20   return "auto". 
-00008ce0: 2020 2020 2020 2072 6574 7572 6e20 2261         return "a
-00008cf0: 6c77 6179 7322 0a0a 2020 2020 4070 726f  lways"..    @pro
-00008d00: 7065 7274 790a 2020 2020 6465 6620 6963  perty.    def ic
-00008d10: 725f 6c75 785f 6469 7370 6c61 7928 7365  r_lux_display(se
-00008d20: 6c66 2920 2d3e 2069 6e74 207c 204e 6f6e  lf) -> int | Non
-00008d30: 653a 0a20 2020 2020 2020 2022 2222 4765  e:.        """Ge
-00008d40: 7420 4943 5220 4375 7374 6f6d 204c 7578  t ICR Custom Lux
-00008d50: 2076 616c 7565 2073 696d 696c 6172 2074   value similar t
-00008d60: 6f20 686f 7720 7468 6520 5072 6f74 6563  o how the Protec
-00008d70: 7420 696e 7465 7266 6163 6520 776f 726b  t interface work
-00008d80: 732e 2222 220a 0a20 2020 2020 2020 2069  s."""..        i
-00008d90: 6620 7365 6c66 2e69 7370 5f73 6574 7469  f self.isp_setti
-00008da0: 6e67 732e 6963 725f 6375 7374 6f6d 5f76  ngs.icr_custom_v
-00008db0: 616c 7565 2069 7320 4e6f 6e65 3a0a 2020  alue is None:.  
-00008dc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00008dd0: 204e 6f6e 650a 0a20 2020 2020 2020 2072   None..        r
-00008de0: 6574 7572 6e20 4c55 585f 4d41 5050 494e  eturn LUX_MAPPIN
-00008df0: 475f 5641 4c55 4553 5b31 3020 2d20 7365  G_VALUES[10 - se
-00008e00: 6c66 2e69 7370 5f73 6574 7469 6e67 732e  lf.isp_settings.
-00008e10: 6963 725f 6375 7374 6f6d 5f76 616c 7565  icr_custom_value
-00008e20: 5d0a 0a20 2020 2064 6566 2067 6574 5f6c  ]..    def get_l
-00008e30: 6173 745f 736d 6172 745f 6465 7465 6374  ast_smart_detect
-00008e40: 5f65 7665 6e74 280a 2020 2020 2020 2020  _event(.        
-00008e50: 7365 6c66 2c0a 2020 2020 2020 2020 736d  self,.        sm
-00008e60: 6172 745f 7479 7065 3a20 536d 6172 7444  art_type: SmartD
-00008e70: 6574 6563 744f 626a 6563 7454 7970 652c  etectObjectType,
-00008e80: 0a20 2020 2029 202d 3e20 4f70 7469 6f6e  .    ) -> Option
-00008e90: 616c 5b45 7665 6e74 5d3a 0a20 2020 2020  al[Event]:.     
-00008ea0: 2020 2022 2222 4765 7420 7468 6520 6c61     """Get the la
-00008eb0: 7374 2073 6d61 7274 2064 6574 6563 7420  st smart detect 
-00008ec0: 6576 656e 7420 666f 7220 6769 7665 6e20  event for given 
-00008ed0: 7479 7065 2e22 2222 0a0a 2020 2020 2020  type."""..      
-00008ee0: 2020 6576 656e 745f 6964 203d 2073 656c    event_id = sel
-00008ef0: 662e 6c61 7374 5f73 6d61 7274 5f64 6574  f.last_smart_det
-00008f00: 6563 745f 6576 656e 745f 6964 732e 6765  ect_event_ids.ge
-00008f10: 7428 736d 6172 745f 7479 7065 290a 2020  t(smart_type).  
-00008f20: 2020 2020 2020 6966 2065 7665 6e74 5f69        if event_i
-00008f30: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
-00008f40: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-00008f50: 6e65 0a0a 2020 2020 2020 2020 7265 7475  ne..        retu
-00008f60: 726e 2073 656c 662e 6170 692e 626f 6f74  rn self.api.boot
-00008f70: 7374 7261 702e 6576 656e 7473 2e67 6574  strap.events.get
-00008f80: 2865 7665 6e74 5f69 6429 0a0a 2020 2020  (event_id)..    
-00008f90: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00008fa0: 6620 6c61 7374 5f73 6d61 7274 5f61 7564  f last_smart_aud
-00008fb0: 696f 5f64 6574 6563 745f 6576 656e 7428  io_detect_event(
-00008fc0: 7365 6c66 2920 2d3e 204f 7074 696f 6e61  self) -> Optiona
-00008fd0: 6c5b 4576 656e 745d 3a0a 2020 2020 2020  l[Event]:.      
-00008fe0: 2020 2222 2247 6574 2074 6865 206c 6173    """Get the las
-00008ff0: 7420 736d 6172 7420 6175 6469 6f20 6465  t smart audio de
-00009000: 7465 6374 2065 7665 6e74 2069 642e 2222  tect event id.""
-00009010: 220a 0a20 2020 2020 2020 2069 6620 7365  "..        if se
-00009020: 6c66 2e6c 6173 745f 736d 6172 745f 6175  lf.last_smart_au
-00009030: 6469 6f5f 6465 7465 6374 5f65 7665 6e74  dio_detect_event
-00009040: 5f69 6420 6973 204e 6f6e 653a 0a20 2020  _id is None:.   
-00009050: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00009060: 4e6f 6e65 0a0a 2020 2020 2020 2020 7265  None..        re
-00009070: 7475 726e 2073 656c 662e 6170 692e 626f  turn self.api.bo
-00009080: 6f74 7374 7261 702e 6576 656e 7473 2e67  otstrap.events.g
-00009090: 6574 2873 656c 662e 6c61 7374 5f73 6d61  et(self.last_sma
-000090a0: 7274 5f61 7564 696f 5f64 6574 6563 745f  rt_audio_detect_
-000090b0: 6576 656e 745f 6964 290a 0a20 2020 2064  event_id)..    d
-000090c0: 6566 2067 6574 5f6c 6173 745f 736d 6172  ef get_last_smar
-000090d0: 745f 6175 6469 6f5f 6465 7465 6374 5f65  t_audio_detect_e
-000090e0: 7665 6e74 280a 2020 2020 2020 2020 7365  vent(.        se
-000090f0: 6c66 2c0a 2020 2020 2020 2020 736d 6172  lf,.        smar
-00009100: 745f 7479 7065 3a20 536d 6172 7444 6574  t_type: SmartDet
-00009110: 6563 7441 7564 696f 5479 7065 2c0a 2020  ectAudioType,.  
-00009120: 2020 2920 2d3e 204f 7074 696f 6e61 6c5b    ) -> Optional[
-00009130: 4576 656e 745d 3a0a 2020 2020 2020 2020  Event]:.        
-00009140: 2222 2247 6574 2074 6865 206c 6173 7420  """Get the last 
-00009150: 736d 6172 7420 6175 6469 6f20 6465 7465  smart audio dete
-00009160: 6374 2065 7665 6e74 2066 6f72 2067 6976  ct event for giv
-00009170: 656e 2074 7970 652e 2222 220a 0a20 2020  en type."""..   
-00009180: 2020 2020 2065 7665 6e74 5f69 6420 3d20       event_id = 
-00009190: 7365 6c66 2e6c 6173 745f 736d 6172 745f  self.last_smart_
-000091a0: 6175 6469 6f5f 6465 7465 6374 5f65 7665  audio_detect_eve
-000091b0: 6e74 5f69 6473 2e67 6574 2873 6d61 7274  nt_ids.get(smart
-000091c0: 5f74 7970 6529 0a20 2020 2020 2020 2069  _type).        i
-000091d0: 6620 6576 656e 745f 6964 2069 7320 4e6f  f event_id is No
-000091e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000091f0: 7265 7475 726e 204e 6f6e 650a 0a20 2020  return None..   
-00009200: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00009210: 2e61 7069 2e62 6f6f 7473 7472 6170 2e65  .api.bootstrap.e
-00009220: 7665 6e74 732e 6765 7428 6576 656e 745f  vents.get(event_
-00009230: 6964 290a 0a20 2020 2040 7072 6f70 6572  id)..    @proper
-00009240: 7479 0a20 2020 2064 6566 2074 696d 656c  ty.    def timel
-00009250: 6170 7365 5f75 726c 2873 656c 6629 202d  apse_url(self) -
-00009260: 3e20 7374 723a 0a20 2020 2020 2020 2072  > str:.        r
-00009270: 6574 7572 6e20 6622 7b73 656c 662e 6170  eturn f"{self.ap
-00009280: 692e 6261 7365 5f75 726c 7d2f 7072 6f74  i.base_url}/prot
-00009290: 6563 742f 7469 6d65 6c61 7073 652f 7b73  ect/timelapse/{s
-000092a0: 656c 662e 6964 7d22 0a0a 2020 2020 4070  elf.id}"..    @p
-000092b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000092c0: 6973 5f70 7269 7661 6379 5f6f 6e28 7365  is_privacy_on(se
-000092d0: 6c66 2920 2d3e 2062 6f6f 6c3a 0a20 2020  lf) -> bool:.   
-000092e0: 2020 2020 2069 6e64 6578 2c20 5f20 3d20       index, _ = 
-000092f0: 7365 6c66 2e67 6574 5f70 7269 7661 6379  self.get_privacy
-00009300: 5f7a 6f6e 6528 290a 2020 2020 2020 2020  _zone().        
-00009310: 7265 7475 726e 2069 6e64 6578 2069 7320  return index is 
-00009320: 6e6f 7420 4e6f 6e65 0a0a 2020 2020 4070  not None..    @p
-00009330: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00009340: 6973 5f72 6563 6f72 6469 6e67 5f65 6e61  is_recording_ena
-00009350: 626c 6564 2873 656c 6629 202d 3e20 626f  bled(self) -> bo
-00009360: 6f6c 3a0a 2020 2020 2020 2020 2222 2249  ol:.        """I
-00009370: 7320 7265 636f 7264 696e 6720 666f 6f74  s recording foot
-00009380: 6167 652f 6576 656e 7473 2066 726f 6d20  age/events from 
-00009390: 7468 6520 6361 6d65 7261 2065 6e61 626c  the camera enabl
-000093a0: 6564 3f0a 0a20 2020 2020 2020 2049 6620  ed?..        If 
-000093b0: 7265 636f 7264 696e 6720 6973 206e 6f74  recording is not
-000093c0: 2065 6e61 626c 6564 2c20 6361 6d65 7261   enabled, camera
-000093d0: 7320 7769 6c6c 206e 6f74 2070 726f 6475  s will not produ
-000093e0: 6365 2061 6e79 2066 6f6f 7461 6765 2c20  ce any footage, 
-000093f0: 7468 756d 626e 6169 6c73 2c0a 2020 2020  thumbnails,.    
-00009400: 2020 2020 6d6f 7469 6f6e 2f73 6d61 7274      motion/smart
-00009410: 2064 6574 6563 7469 6f6e 2065 7665 6e74   detection event
-00009420: 732e 0a20 2020 2020 2020 2022 2222 0a0a  s..        """..
-00009430: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00009440: 7573 655f 676c 6f62 616c 3a0a 2020 2020  use_global:.    
-00009450: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00009460: 656c 662e 6170 692e 626f 6f74 7374 7261  elf.api.bootstra
-00009470: 702e 6e76 722e 6973 5f67 6c6f 6261 6c5f  p.nvr.is_global_
-00009480: 7265 636f 7264 696e 675f 656e 6162 6c65  recording_enable
-00009490: 640a 0a20 2020 2020 2020 2072 6574 7572  d..        retur
-000094a0: 6e20 7365 6c66 2e72 6563 6f72 6469 6e67  n self.recording
-000094b0: 5f73 6574 7469 6e67 732e 6d6f 6465 2069  _settings.mode i
-000094c0: 7320 6e6f 7420 5265 636f 7264 696e 674d  s not RecordingM
-000094d0: 6f64 652e 4e45 5645 520a 0a20 2020 2040  ode.NEVER..    @
-000094e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-000094f0: 2063 616e 5f6d 616e 6167 655f 7265 636f   can_manage_reco
-00009500: 7264 696e 675f 7365 7474 696e 6728 7365  rding_setting(se
-00009510: 6c66 2920 2d3e 2062 6f6f 6c3a 0a20 2020  lf) -> bool:.   
-00009520: 2020 2020 2022 2222 4361 6e20 7468 6973       """Can this
-00009530: 2063 616d 6572 6120 6d61 6e61 6765 2069   camera manage i
-00009540: 7473 206f 776e 2072 6563 6f72 6469 6e67  ts own recording
-00009550: 2073 6574 7469 6e67 733f 2222 220a 0a20   settings?""".. 
-00009560: 2020 2020 2020 2072 6574 7572 6e20 6e6f         return no
-00009570: 7420 7365 6c66 2e75 7365 5f67 6c6f 6261  t self.use_globa
-00009580: 6c0a 0a20 2020 2040 7072 6f70 6572 7479  l..    @property
-00009590: 0a20 2020 2064 6566 2069 735f 736d 6172  .    def is_smar
-000095a0: 745f 6465 7465 6374 696f 6e73 5f61 6c6c  t_detections_all
-000095b0: 6f77 6564 2873 656c 6629 202d 3e20 626f  owed(self) -> bo
-000095c0: 6f6c 3a0a 2020 2020 2020 2020 2222 2249  ol:.        """I
-000095d0: 7320 736d 6172 7420 6465 7465 6374 696f  s smart detectio
-000095e0: 6e73 2061 6c6c 6f77 6564 2066 6f72 2074  ns allowed for t
-000095f0: 6869 7320 6361 6d65 7261 3f22 2222 0a0a  his camera?"""..
-00009600: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-00009610: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009620: 662e 6973 5f72 6563 6f72 6469 6e67 5f65  f.is_recording_e
-00009630: 6e61 626c 6564 0a20 2020 2020 2020 2020  nabled.         
-00009640: 2020 2061 6e64 2073 656c 662e 6170 692e     and self.api.
-00009650: 626f 6f74 7374 7261 702e 6e76 722e 6973  bootstrap.nvr.is
-00009660: 5f73 6d61 7274 5f64 6574 6563 7469 6f6e  _smart_detection
-00009670: 735f 656e 6162 6c65 640a 2020 2020 2020  s_enabled.      
-00009680: 2020 290a 0a20 2020 2040 7072 6f70 6572    )..    @proper
-00009690: 7479 0a20 2020 2064 6566 2063 616e 5f6d  ty.    def can_m
-000096a0: 616e 6167 655f 736d 6172 745f 6465 7465  anage_smart_dete
-000096b0: 6374 696f 6e73 2873 656c 6629 202d 3e20  ctions(self) -> 
-000096c0: 626f 6f6c 3a0a 2020 2020 2020 2020 2222  bool:.        ""
-000096d0: 2243 616e 2074 6869 7320 6361 6d65 7261  "Can this camera
-000096e0: 206d 616e 6167 6520 6974 7320 6f77 6e20   manage its own 
-000096f0: 7265 636f 7264 696e 6720 7365 7474 696e  recording settin
-00009700: 6773 3f22 2222 0a0a 2020 2020 2020 2020  gs?"""..        
-00009710: 7265 7475 726e 2028 6e6f 7420 7365 6c66  return (not self
-00009720: 2e75 7365 5f67 6c6f 6261 6c29 2061 6e64  .use_global) and
-00009730: 2073 656c 662e 6973 5f73 6d61 7274 5f64   self.is_smart_d
-00009740: 6574 6563 7469 6f6e 735f 616c 6c6f 7765  etections_allowe
-00009750: 640a 0a20 2020 2040 7072 6f70 6572 7479  d..    @property
-00009760: 0a20 2020 2064 6566 2069 735f 6c69 6365  .    def is_lice
-00009770: 6e73 655f 706c 6174 655f 6465 7465 6374  nse_plate_detect
-00009780: 696f 6e73 5f61 6c6c 6f77 6564 2873 656c  ions_allowed(sel
-00009790: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-000097a0: 2020 2020 2222 2249 7320 6c69 6365 6e73      """Is licens
-000097b0: 6520 706c 6174 6520 6465 7465 6374 696f  e plate detectio
-000097c0: 6e73 2061 6c6c 6f77 6564 2066 6f72 2074  ns allowed for t
-000097d0: 6869 7320 6361 6d65 7261 3f22 2222 0a0a  his camera?"""..
-000097e0: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-000097f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009800: 662e 6973 5f72 6563 6f72 6469 6e67 5f65  f.is_recording_e
-00009810: 6e61 626c 6564 0a20 2020 2020 2020 2020  nabled.         
-00009820: 2020 2061 6e64 2073 656c 662e 6170 692e     and self.api.
-00009830: 626f 6f74 7374 7261 702e 6e76 722e 6973  bootstrap.nvr.is
-00009840: 5f6c 6963 656e 7365 5f70 6c61 7465 5f64  _license_plate_d
-00009850: 6574 6563 7469 6f6e 735f 656e 6162 6c65  etections_enable
-00009860: 640a 2020 2020 2020 2020 290a 0a20 2020  d.        )..   
-00009870: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00009880: 6566 2063 616e 5f6d 616e 6167 655f 6c69  ef can_manage_li
-00009890: 6365 6e73 655f 706c 6174 655f 6465 7465  cense_plate_dete
-000098a0: 6374 696f 6e73 2873 656c 6629 202d 3e20  ctions(self) -> 
-000098b0: 626f 6f6c 3a0a 2020 2020 2020 2020 2222  bool:.        ""
-000098c0: 2243 616e 2074 6869 7320 6361 6d65 7261  "Can this camera
-000098d0: 206d 616e 6167 6520 6974 7320 6f77 6e20   manage its own 
-000098e0: 6c69 6365 6e73 6520 706c 6174 6520 7365  license plate se
-000098f0: 7474 696e 6773 3f22 2222 0a0a 2020 2020  ttings?"""..    
-00009900: 2020 2020 7265 7475 726e 2028 6e6f 7420      return (not 
-00009910: 7365 6c66 2e75 7365 5f67 6c6f 6261 6c29  self.use_global)
-00009920: 2061 6e64 2073 656c 662e 6973 5f6c 6963   and self.is_lic
-00009930: 656e 7365 5f70 6c61 7465 5f64 6574 6563  ense_plate_detec
-00009940: 7469 6f6e 735f 616c 6c6f 7765 640a 0a20  tions_allowed.. 
-00009950: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00009960: 2064 6566 2069 735f 6661 6365 5f64 6574   def is_face_det
-00009970: 6563 7469 6f6e 735f 616c 6c6f 7765 6428  ections_allowed(
-00009980: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
-00009990: 2020 2020 2020 2022 2222 4973 2066 6163         """Is fac
-000099a0: 6520 6465 7465 6374 696f 6e73 2061 6c6c  e detections all
-000099b0: 6f77 6564 2066 6f72 2074 6869 7320 6361  owed for this ca
-000099c0: 6d65 7261 3f22 2222 0a0a 2020 2020 2020  mera?"""..      
-000099d0: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-000099e0: 2020 2020 2020 2073 656c 662e 6973 5f72         self.is_r
-000099f0: 6563 6f72 6469 6e67 5f65 6e61 626c 6564  ecording_enabled
-00009a00: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00009a10: 2073 656c 662e 6170 692e 626f 6f74 7374   self.api.bootst
-00009a20: 7261 702e 6e76 722e 6973 5f66 6163 655f  rap.nvr.is_face_
-00009a30: 6465 7465 6374 696f 6e73 5f65 6e61 626c  detections_enabl
-00009a40: 6564 0a20 2020 2020 2020 2029 0a0a 2020  ed.        )..  
-00009a50: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00009a60: 6465 6620 6361 6e5f 6d61 6e61 6765 5f66  def can_manage_f
-00009a70: 6163 655f 6465 7465 6374 696f 6e73 2873  ace_detections(s
-00009a80: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
-00009a90: 2020 2020 2020 2222 2243 616e 2074 6869        """Can thi
-00009aa0: 7320 6361 6d65 7261 206d 616e 6167 6520  s camera manage 
-00009ab0: 6974 7320 6f77 6e20 6661 6365 2064 6574  its own face det
-00009ac0: 6563 7469 6f6e 2073 6574 7469 6e67 733f  ection settings?
-00009ad0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-00009ae0: 7572 6e20 286e 6f74 2073 656c 662e 7573  urn (not self.us
-00009af0: 655f 676c 6f62 616c 2920 616e 6420 7365  e_global) and se
-00009b00: 6c66 2e69 735f 6661 6365 5f64 6574 6563  lf.is_face_detec
-00009b10: 7469 6f6e 735f 616c 6c6f 7765 640a 0a20  tions_allowed.. 
-00009b20: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00009b30: 2064 6566 2061 6374 6976 655f 7265 636f   def active_reco
-00009b40: 7264 696e 675f 7365 7474 696e 6773 2873  rding_settings(s
-00009b50: 656c 6629 202d 3e20 5265 636f 7264 696e  elf) -> Recordin
-00009b60: 6753 6574 7469 6e67 733a 0a20 2020 2020  gSettings:.     
-00009b70: 2020 2022 2222 4765 7420 6163 7469 7665     """Get active
-00009b80: 2072 6563 6f72 6469 6e67 2073 6574 7469   recording setti
-00009b90: 6e67 732e 2222 220a 0a20 2020 2020 2020  ngs."""..       
-00009ba0: 2069 6620 7365 6c66 2e75 7365 5f67 6c6f   if self.use_glo
-00009bb0: 6261 6c20 616e 6420 7365 6c66 2e61 7069  bal and self.api
-00009bc0: 2e62 6f6f 7473 7472 6170 2e6e 7672 2e67  .bootstrap.nvr.g
-00009bd0: 6c6f 6261 6c5f 6361 6d65 7261 5f73 6574  lobal_camera_set
-00009be0: 7469 6e67 733a 0a20 2020 2020 2020 2020  tings:.         
-00009bf0: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
-00009c00: 7069 2e62 6f6f 7473 7472 6170 2e6e 7672  pi.bootstrap.nvr
-00009c10: 2e67 6c6f 6261 6c5f 6361 6d65 7261 5f73  .global_camera_s
-00009c20: 6574 7469 6e67 732e 7265 636f 7264 696e  ettings.recordin
-00009c30: 675f 7365 7474 696e 6773 0a0a 2020 2020  g_settings..    
-00009c40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00009c50: 7265 636f 7264 696e 675f 7365 7474 696e  recording_settin
-00009c60: 6773 0a0a 2020 2020 4070 726f 7065 7274  gs..    @propert
-00009c70: 790a 2020 2020 6465 6620 6163 7469 7665  y.    def active
-00009c80: 5f73 6d61 7274 5f64 6574 6563 745f 7365  _smart_detect_se
-00009c90: 7474 696e 6773 2873 656c 6629 202d 3e20  ttings(self) -> 
-00009ca0: 536d 6172 7444 6574 6563 7453 6574 7469  SmartDetectSetti
-00009cb0: 6e67 733a 0a20 2020 2020 2020 2022 2222  ngs:.        """
-00009cc0: 4765 7420 6163 7469 7665 2073 6d61 7274  Get active smart
-00009cd0: 2064 6574 6563 7469 6f6e 2073 6574 7469   detection setti
-00009ce0: 6e67 732e 2222 220a 0a20 2020 2020 2020  ngs."""..       
-00009cf0: 2069 6620 7365 6c66 2e75 7365 5f67 6c6f   if self.use_glo
-00009d00: 6261 6c20 616e 6420 7365 6c66 2e61 7069  bal and self.api
-00009d10: 2e62 6f6f 7473 7472 6170 2e6e 7672 2e67  .bootstrap.nvr.g
-00009d20: 6c6f 6261 6c5f 6361 6d65 7261 5f73 6574  lobal_camera_set
-00009d30: 7469 6e67 733a 0a20 2020 2020 2020 2020  tings:.         
-00009d40: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
-00009d50: 7069 2e62 6f6f 7473 7472 6170 2e6e 7672  pi.bootstrap.nvr
-00009d60: 2e67 6c6f 6261 6c5f 6361 6d65 7261 5f73  .global_camera_s
-00009d70: 6574 7469 6e67 732e 736d 6172 745f 6465  ettings.smart_de
-00009d80: 7465 6374 5f73 6574 7469 6e67 730a 0a20  tect_settings.. 
-00009d90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00009da0: 6c66 2e73 6d61 7274 5f64 6574 6563 745f  lf.smart_detect_
-00009db0: 7365 7474 696e 6773 0a0a 2020 2020 4070  settings..    @p
-00009dc0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00009dd0: 6163 7469 7665 5f73 6d61 7274 5f64 6574  active_smart_det
-00009de0: 6563 745f 7479 7065 7328 7365 6c66 2920  ect_types(self) 
-00009df0: 2d3e 2073 6574 5b53 6d61 7274 4465 7465  -> set[SmartDete
-00009e00: 6374 4f62 6a65 6374 5479 7065 5d3a 0a20  ctObjectType]:. 
-00009e10: 2020 2020 2020 2022 2222 4765 7420 6163         """Get ac
-00009e20: 7469 7665 2073 6d61 7274 2064 6574 6563  tive smart detec
-00009e30: 7469 6f6e 2074 7970 6573 2e22 2222 0a0a  tion types."""..
-00009e40: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00009e50: 7573 655f 676c 6f62 616c 3a0a 2020 2020  use_global:.    
-00009e60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00009e70: 6574 2873 656c 662e 736d 6172 745f 6465  et(self.smart_de
-00009e80: 7465 6374 5f73 6574 7469 6e67 732e 6f62  tect_settings.ob
-00009e90: 6a65 6374 5f74 7970 6573 292e 696e 7465  ject_types).inte
-00009ea0: 7273 6563 7469 6f6e 280a 2020 2020 2020  rsection(.      
-00009eb0: 2020 2020 2020 2020 2020 7365 7428 7365            set(se
-00009ec0: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
-00009ed0: 2e73 6d61 7274 5f64 6574 6563 745f 7479  .smart_detect_ty
-00009ee0: 7065 7329 2c0a 2020 2020 2020 2020 2020  pes),.          
-00009ef0: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
-00009f00: 7572 6e20 7365 7428 7365 6c66 2e73 6d61  urn set(self.sma
-00009f10: 7274 5f64 6574 6563 745f 7365 7474 696e  rt_detect_settin
-00009f20: 6773 2e6f 626a 6563 745f 7479 7065 7329  gs.object_types)
-00009f30: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00009f40: 2020 2020 6465 6620 6163 7469 7665 5f61      def active_a
-00009f50: 7564 696f 5f64 6574 6563 745f 7479 7065  udio_detect_type
-00009f60: 7328 7365 6c66 2920 2d3e 2073 6574 5b53  s(self) -> set[S
-00009f70: 6d61 7274 4465 7465 6374 4175 6469 6f54  martDetectAudioT
-00009f80: 7970 655d 3a0a 2020 2020 2020 2020 2222  ype]:.        ""
-00009f90: 2247 6574 2061 6374 6976 6520 6175 6469  "Get active audi
-00009fa0: 6f20 6465 7465 6374 696f 6e20 7479 7065  o detection type
-00009fb0: 732e 2222 220a 0a20 2020 2020 2020 2069  s."""..        i
-00009fc0: 6620 7365 6c66 2e75 7365 5f67 6c6f 6261  f self.use_globa
-00009fd0: 6c3a 0a20 2020 2020 2020 2020 2020 2072  l:.            r
-00009fe0: 6574 7572 6e20 7365 7428 7365 6c66 2e73  eturn set(self.s
-00009ff0: 6d61 7274 5f64 6574 6563 745f 7365 7474  mart_detect_sett
-0000a000: 696e 6773 2e61 7564 696f 5f74 7970 6573  ings.audio_types
-0000a010: 206f 7220 5b5d 292e 696e 7465 7273 6563   or []).intersec
-0000a020: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-0000a030: 2020 2020 2020 7365 7428 7365 6c66 2e66        set(self.f
-0000a040: 6561 7475 7265 5f66 6c61 6773 2e73 6d61  eature_flags.sma
-0000a050: 7274 5f64 6574 6563 745f 6175 6469 6f5f  rt_detect_audio_
-0000a060: 7479 7065 7320 6f72 205b 5d29 2c0a 2020  types or []),.  
-0000a070: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000a080: 2020 2020 2072 6574 7572 6e20 7365 7428       return set(
-0000a090: 7365 6c66 2e73 6d61 7274 5f64 6574 6563  self.smart_detec
-0000a0a0: 745f 7365 7474 696e 6773 2e61 7564 696f  t_settings.audio
-0000a0b0: 5f74 7970 6573 206f 7220 5b5d 290a 0a20  _types or []).. 
-0000a0c0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000a0d0: 2064 6566 2069 735f 6d6f 7469 6f6e 5f64   def is_motion_d
-0000a0e0: 6574 6563 7469 6f6e 5f6f 6e28 7365 6c66  etection_on(self
-0000a0f0: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
-0000a100: 2020 2022 2222 4973 204d 6f74 696f 6e20     """Is Motion 
-0000a110: 4465 7465 6374 696f 6e20 6176 6169 6c61  Detection availa
-0000a120: 626c 6520 616e 6420 656e 6162 6c65 6420  ble and enabled 
-0000a130: 2863 616d 6572 6120 7769 6c6c 2070 726f  (camera will pro
-0000a140: 6475 6365 206d 6f74 696f 6e20 6576 656e  duce motion even
-0000a150: 7473 293f 2222 220a 0a20 2020 2020 2020  ts)?"""..       
-0000a160: 2072 6574 7572 6e20 280a 2020 2020 2020   return (.      
-0000a170: 2020 2020 2020 7365 6c66 2e69 735f 7265        self.is_re
-0000a180: 636f 7264 696e 675f 656e 6162 6c65 640a  cording_enabled.
-0000a190: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0000a1a0: 7365 6c66 2e61 6374 6976 655f 7265 636f  self.active_reco
-0000a1b0: 7264 696e 675f 7365 7474 696e 6773 2e65  rding_settings.e
-0000a1c0: 6e61 626c 655f 6d6f 7469 6f6e 5f64 6574  nable_motion_det
-0000a1d0: 6563 7469 6f6e 2069 7320 6e6f 7420 4661  ection is not Fa
-0000a1e0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-0000a1f0: 616e 6420 7365 6c66 2e63 616e 5f6d 616e  and self.can_man
-0000a200: 6167 655f 7265 636f 7264 696e 675f 7365  age_recording_se
-0000a210: 7474 696e 670a 2020 2020 2020 2020 290a  tting.        ).
-0000a220: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000a230: 2020 2064 6566 2069 735f 6d6f 7469 6f6e     def is_motion
-0000a240: 5f63 7572 7265 6e74 6c79 5f64 6574 6563  _currently_detec
-0000a250: 7465 6428 7365 6c66 2920 2d3e 2062 6f6f  ted(self) -> boo
-0000a260: 6c3a 0a20 2020 2020 2020 2022 2222 4973  l:.        """Is
-0000a270: 206d 6f74 696f 6e20 6375 7272 656e 746c   motion currentl
-0000a280: 7920 6265 696e 6720 6465 7465 6374 6564  y being detected
-0000a290: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-0000a2a0: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
-0000a2b0: 2020 7365 6c66 2e69 735f 6d6f 7469 6f6e    self.is_motion
-0000a2c0: 5f64 6574 6563 7469 6f6e 5f6f 6e0a 2020  _detection_on.  
-0000a2d0: 2020 2020 2020 2020 2020 616e 6420 7365            and se
-0000a2e0: 6c66 2e69 735f 6d6f 7469 6f6e 5f64 6574  lf.is_motion_det
-0000a2f0: 6563 7465 640a 2020 2020 2020 2020 2020  ected.          
-0000a300: 2020 616e 6420 7365 6c66 2e6c 6173 745f    and self.last_
-0000a310: 6d6f 7469 6f6e 5f65 7665 6e74 2069 7320  motion_event is 
-0000a320: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
-0000a330: 2020 2020 2061 6e64 2073 656c 662e 6c61       and self.la
-0000a340: 7374 5f6d 6f74 696f 6e5f 6576 656e 742e  st_motion_event.
-0000a350: 656e 6420 6973 204e 6f6e 650a 2020 2020  end is None.    
-0000a360: 2020 2020 290a 0a20 2020 2061 7379 6e63      )..    async
-0000a370: 2064 6566 2073 6574 5f6d 6f74 696f 6e5f   def set_motion_
-0000a380: 6465 7465 6374 696f 6e28 7365 6c66 2c20  detection(self, 
-0000a390: 656e 6162 6c65 643a 2062 6f6f 6c29 202d  enabled: bool) -
-0000a3a0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0000a3b0: 2222 2253 6574 7320 6d6f 7469 6f6e 2064  """Sets motion d
-0000a3c0: 6574 6563 7469 6f6e 206f 6e20 6361 6d65  etection on came
-0000a3d0: 7261 2222 220a 0a20 2020 2020 2020 2069  ra"""..        i
-0000a3e0: 6620 7365 6c66 2e75 7365 5f67 6c6f 6261  f self.use_globa
-0000a3f0: 6c3a 0a20 2020 2020 2020 2020 2020 2072  l:.            r
-0000a400: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
-0000a410: 2243 616d 6572 6120 6973 2075 7369 6e67  "Camera is using
-0000a420: 2067 6c6f 6261 6c20 7265 636f 7264 696e   global recordin
-0000a430: 6720 7365 7474 696e 6773 2e22 290a 0a20  g settings.").. 
-0000a440: 2020 2020 2020 2064 6566 2063 616c 6c62         def callb
-0000a450: 6163 6b28 2920 2d3e 204e 6f6e 653a 0a20  ack() -> None:. 
-0000a460: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a470: 7265 636f 7264 696e 675f 7365 7474 696e  recording_settin
-0000a480: 6773 2e65 6e61 626c 655f 6d6f 7469 6f6e  gs.enable_motion
-0000a490: 5f64 6574 6563 7469 6f6e 203d 2065 6e61  _detection = ena
-0000a4a0: 626c 6564 0a0a 2020 2020 2020 2020 6177  bled..        aw
-0000a4b0: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
-0000a4c0: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
-0000a4d0: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
-0000a4e0: 6574 5f75 7365 5f67 6c6f 6261 6c28 7365  et_use_global(se
-0000a4f0: 6c66 2c20 656e 6162 6c65 643a 2062 6f6f  lf, enabled: boo
-0000a500: 6c29 202d 3e20 4e6f 6e65 3a0a 2020 2020  l) -> None:.    
-0000a510: 2020 2020 2222 2253 6574 7320 6966 2063      """Sets if c
-0000a520: 616d 6572 6120 7368 6f75 6c64 2075 7365  amera should use
-0000a530: 2067 6c6f 6261 6c20 7265 636f 7264 696e   global recordin
-0000a540: 6720 7365 7474 696e 6773 206f 7220 6e6f  g settings or no
-0000a550: 742e 2222 220a 0a20 2020 2020 2020 2064  t."""..        d
-0000a560: 6566 2063 616c 6c62 6163 6b28 2920 2d3e  ef callback() ->
-0000a570: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000a580: 2020 2073 656c 662e 7573 655f 676c 6f62     self.use_glob
-0000a590: 616c 203d 2065 6e61 626c 6564 0a0a 2020  al = enabled..  
-0000a5a0: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
-0000a5b0: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
-0000a5c0: 6c6c 6261 636b 290a 0a20 2020 2023 2072  llback)..    # r
-0000a5d0: 6567 696f 6e20 4f62 6a65 6374 2053 6d61  egion Object Sma
-0000a5e0: 7274 2044 6574 6563 7469 6f6e 730a 0a20  rt Detections.. 
-0000a5f0: 2020 2064 6566 205f 6973 5f73 6d61 7274     def _is_smart
-0000a600: 5f65 6e61 626c 6564 2873 656c 662c 2073  _enabled(self, s
-0000a610: 6d61 7274 5f74 7970 653a 2053 6d61 7274  mart_type: Smart
-0000a620: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
-0000a630: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
-0000a640: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
-0000a650: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
-0000a660: 7265 636f 7264 696e 675f 656e 6162 6c65  recording_enable
-0000a670: 640a 2020 2020 2020 2020 2020 2020 616e  d.            an
-0000a680: 6420 736d 6172 745f 7479 7065 2069 6e20  d smart_type in 
-0000a690: 7365 6c66 2e61 6374 6976 655f 736d 6172  self.active_smar
-0000a6a0: 745f 6465 7465 6374 5f74 7970 6573 0a20  t_detect_types. 
-0000a6b0: 2020 2020 2020 2020 2020 2061 6e64 2073             and s
-0000a6c0: 656c 662e 6361 6e5f 6d61 6e61 6765 5f73  elf.can_manage_s
-0000a6d0: 6d61 7274 5f64 6574 6563 7469 6f6e 730a  mart_detections.
-0000a6e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0000a6f0: 6566 205f 6973 5f73 6d61 7274 5f64 6574  ef _is_smart_det
-0000a700: 6563 7465 6428 7365 6c66 2c20 736d 6172  ected(self, smar
-0000a710: 745f 7479 7065 3a20 536d 6172 7444 6574  t_type: SmartDet
-0000a720: 6563 744f 626a 6563 7454 7970 6529 202d  ectObjectType) -
-0000a730: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000a740: 6576 656e 7420 3d20 7365 6c66 2e67 6574  event = self.get
-0000a750: 5f6c 6173 745f 736d 6172 745f 6465 7465  _last_smart_dete
-0000a760: 6374 5f65 7665 6e74 2873 6d61 7274 5f74  ct_event(smart_t
-0000a770: 7970 6529 0a20 2020 2020 2020 2072 6574  ype).        ret
-0000a780: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
-0000a790: 2020 7365 6c66 2e5f 6973 5f73 6d61 7274    self._is_smart
-0000a7a0: 5f65 6e61 626c 6564 2873 6d61 7274 5f74  _enabled(smart_t
-0000a7b0: 7970 6529 0a20 2020 2020 2020 2020 2020  ype).           
-0000a7c0: 2061 6e64 2073 656c 662e 6973 5f73 6d61   and self.is_sma
-0000a7d0: 7274 5f64 6574 6563 7465 640a 2020 2020  rt_detected.    
-0000a7e0: 2020 2020 2020 2020 616e 6420 6576 656e          and even
-0000a7f0: 7420 6973 206e 6f74 204e 6f6e 650a 2020  t is not None.  
-0000a800: 2020 2020 2020 2020 2020 616e 6420 6576            and ev
-0000a810: 656e 742e 656e 6420 6973 204e 6f6e 650a  ent.end is None.
-0000a820: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0000a830: 736d 6172 745f 7479 7065 2069 6e20 6576  smart_type in ev
-0000a840: 656e 742e 736d 6172 745f 6465 7465 6374  ent.smart_detect
-0000a850: 5f74 7970 6573 0a20 2020 2020 2020 2029  _types.        )
-0000a860: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000a870: 2020 2020 6465 6620 6973 5f73 6d61 7274      def is_smart
-0000a880: 5f63 7572 7265 6e74 6c79 5f64 6574 6563  _currently_detec
-0000a890: 7465 6428 7365 6c66 2920 2d3e 2062 6f6f  ted(self) -> boo
-0000a8a0: 6c3a 0a20 2020 2020 2020 2022 2222 4973  l:.        """Is
-0000a8b0: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
-0000a8c0: 2063 7572 7265 6e74 6c79 2062 6569 6e67   currently being
-0000a8d0: 2064 6574 6563 7465 6422 2222 0a0a 2020   detected"""..  
-0000a8e0: 2020 2020 2020 7265 7475 726e 2028 0a20        return (. 
-0000a8f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a900: 6973 5f72 6563 6f72 6469 6e67 5f65 6e61  is_recording_ena
-0000a910: 626c 6564 0a20 2020 2020 2020 2020 2020  bled.           
-0000a920: 2061 6e64 2062 6f6f 6c28 7365 6c66 2e61   and bool(self.a
-0000a930: 6374 6976 655f 736d 6172 745f 6465 7465  ctive_smart_dete
-0000a940: 6374 5f74 7970 6573 290a 2020 2020 2020  ct_types).      
-0000a950: 2020 2020 2020 616e 6420 7365 6c66 2e69        and self.i
-0000a960: 735f 736d 6172 745f 6465 7465 6374 6564  s_smart_detected
-0000a970: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-0000a980: 2073 656c 662e 6c61 7374 5f73 6d61 7274   self.last_smart
-0000a990: 5f64 6574 6563 745f 6576 656e 7420 6973  _detect_event is
-0000a9a0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
-0000a9b0: 2020 2020 2020 616e 6420 7365 6c66 2e6c        and self.l
-0000a9c0: 6173 745f 736d 6172 745f 6465 7465 6374  ast_smart_detect
-0000a9d0: 5f65 7665 6e74 2e65 6e64 2069 7320 4e6f  _event.end is No
-0000a9e0: 6e65 0a20 2020 2020 2020 2029 0a0a 2020  ne.        )..  
-0000a9f0: 2020 2320 7265 6769 6f6e 2050 6572 736f    # region Perso
-0000aa00: 6e0a 0a20 2020 2040 7072 6f70 6572 7479  n..    @property
-0000aa10: 0a20 2020 2064 6566 2063 616e 5f64 6574  .    def can_det
-0000aa20: 6563 745f 7065 7273 6f6e 2873 656c 6629  ect_person(self)
-0000aa30: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
-0000aa40: 2020 7265 7475 726e 2053 6d61 7274 4465    return SmartDe
-0000aa50: 7465 6374 4f62 6a65 6374 5479 7065 2e50  tectObjectType.P
-0000aa60: 4552 534f 4e20 696e 2073 656c 662e 6665  ERSON in self.fe
-0000aa70: 6174 7572 655f 666c 6167 732e 736d 6172  ature_flags.smar
-0000aa80: 745f 6465 7465 6374 5f74 7970 6573 0a0a  t_detect_types..
-0000aa90: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000aaa0: 2020 6465 6620 6973 5f70 6572 736f 6e5f    def is_person_
-0000aab0: 6465 7465 6374 696f 6e5f 6f6e 2873 656c  detection_on(sel
-0000aac0: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-0000aad0: 2020 2020 2222 2249 7320 5065 7273 6f6e      """Is Person
-0000aae0: 2044 6574 6563 7469 6f6e 2061 7661 696c   Detection avail
-0000aaf0: 6162 6c65 2061 6e64 2065 6e61 626c 6564  able and enabled
-0000ab00: 2028 6361 6d65 7261 2077 696c 6c20 7072   (camera will pr
-0000ab10: 6f64 7563 6520 7065 7273 6f6e 2073 6d61  oduce person sma
-0000ab20: 7274 0a20 2020 2020 2020 2064 6574 6563  rt.        detec
-0000ab30: 7469 6f6e 2065 7665 6e74 7329 3f0a 2020  tion events)?.  
-0000ab40: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000ab50: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000ab60: 6973 5f73 6d61 7274 5f65 6e61 626c 6564  is_smart_enabled
-0000ab70: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000ab80: 6374 5479 7065 2e50 4552 534f 4e29 0a0a  ctType.PERSON)..
-0000ab90: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000aba0: 2020 6465 6620 6c61 7374 5f70 6572 736f    def last_perso
-0000abb0: 6e5f 6465 7465 6374 5f65 7665 6e74 2873  n_detect_event(s
-0000abc0: 656c 6629 202d 3e20 4f70 7469 6f6e 616c  elf) -> Optional
-0000abd0: 5b45 7665 6e74 5d3a 0a20 2020 2020 2020  [Event]:.       
-0000abe0: 2022 2222 4765 7420 7468 6520 6c61 7374   """Get the last
-0000abf0: 2070 6572 736f 6e20 736d 6172 7420 6465   person smart de
-0000ac00: 7465 6374 696f 6e20 6576 656e 742e 2222  tection event.""
-0000ac10: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-0000ac20: 6e20 7365 6c66 2e67 6574 5f6c 6173 745f  n self.get_last_
-0000ac30: 736d 6172 745f 6465 7465 6374 5f65 7665  smart_detect_eve
-0000ac40: 6e74 2853 6d61 7274 4465 7465 6374 4f62  nt(SmartDetectOb
-0000ac50: 6a65 6374 5479 7065 2e50 4552 534f 4e29  jectType.PERSON)
-0000ac60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000ac70: 2020 2020 6465 6620 6c61 7374 5f70 6572      def last_per
-0000ac80: 736f 6e5f 6465 7465 6374 2873 656c 6629  son_detect(self)
-0000ac90: 202d 3e20 4f70 7469 6f6e 616c 5b64 6174   -> Optional[dat
-0000aca0: 6574 696d 655d 3a0a 2020 2020 2020 2020  etime]:.        
-0000acb0: 2222 2247 6574 2074 6865 206c 6173 7420  """Get the last 
-0000acc0: 7065 7273 6f6e 2073 6d61 7274 2064 6574  person smart det
-0000acd0: 6563 7469 6f6e 2065 7665 6e74 2e22 2222  ection event."""
-0000ace0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000acf0: 2073 656c 662e 6c61 7374 5f73 6d61 7274   self.last_smart
-0000ad00: 5f64 6574 6563 7473 2e67 6574 2853 6d61  _detects.get(Sma
-0000ad10: 7274 4465 7465 6374 4f62 6a65 6374 5479  rtDetectObjectTy
-0000ad20: 7065 2e50 4552 534f 4e29 0a0a 2020 2020  pe.PERSON)..    
-0000ad30: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000ad40: 6620 6973 5f70 6572 736f 6e5f 6375 7272  f is_person_curr
-0000ad50: 656e 746c 795f 6465 7465 6374 6564 2873  ently_detected(s
-0000ad60: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
-0000ad70: 2020 2020 2020 2222 2249 7320 7065 7273        """Is pers
-0000ad80: 6f6e 2063 7572 7265 6e74 6c79 2062 6569  on currently bei
-0000ad90: 6e67 2064 6574 6563 7465 6422 2222 0a0a  ng detected"""..
-0000ada0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000adb0: 656c 662e 5f69 735f 736d 6172 745f 6465  elf._is_smart_de
-0000adc0: 7465 6374 6564 2853 6d61 7274 4465 7465  tected(SmartDete
-0000add0: 6374 4f62 6a65 6374 5479 7065 2e50 4552  ctObjectType.PER
-0000ade0: 534f 4e29 0a0a 2020 2020 6173 796e 6320  SON)..    async 
-0000adf0: 6465 6620 7365 745f 7065 7273 6f6e 5f64  def set_person_d
-0000ae00: 6574 6563 7469 6f6e 2873 656c 662c 2065  etection(self, e
-0000ae10: 6e61 626c 6564 3a20 626f 6f6c 2920 2d3e  nabled: bool) ->
-0000ae20: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-0000ae30: 2222 546f 6767 6c65 7320 7065 7273 6f6e  ""Toggles person
-0000ae40: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
-0000ae50: 2e20 5265 7175 6972 6573 2063 616d 6572  . Requires camer
-0000ae60: 6120 746f 2068 6176 6520 736d 6172 7420  a to have smart 
-0000ae70: 6465 7465 6374 696f 6e22 2222 0a0a 2020  detection"""..  
-0000ae80: 2020 2020 2020 7265 7475 726e 2061 7761        return awa
-0000ae90: 6974 2073 656c 662e 5f73 6574 5f6f 626a  it self._set_obj
-0000aea0: 6563 745f 6465 7465 6374 2853 6d61 7274  ect_detect(Smart
-0000aeb0: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
-0000aec0: 2e50 4552 534f 4e2c 2065 6e61 626c 6564  .PERSON, enabled
-0000aed0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000aee0: 0a20 2020 2064 6566 2069 735f 7065 7273  .    def is_pers
-0000aef0: 6f6e 5f74 7261 636b 696e 675f 656e 6162  on_tracking_enab
-0000af00: 6c65 6428 7365 6c66 2920 2d3e 2062 6f6f  led(self) -> boo
-0000af10: 6c3a 0a20 2020 2020 2020 2022 2222 4973  l:.        """Is
-0000af20: 2070 6572 736f 6e20 7472 6163 6b69 6e67   person tracking
-0000af30: 2065 6e61 626c 6564 2222 220a 2020 2020   enabled""".    
-0000af40: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
-0000af50: 2020 2020 2020 2020 2073 656c 662e 6163           self.ac
-0000af60: 7469 7665 5f73 6d61 7274 5f64 6574 6563  tive_smart_detec
-0000af70: 745f 7365 7474 696e 6773 2e61 7574 6f5f  t_settings.auto_
-0000af80: 7472 6163 6b69 6e67 5f6f 626a 6563 745f  tracking_object_
-0000af90: 7479 7065 7320 6973 206e 6f74 204e 6f6e  types is not Non
-0000afa0: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-0000afb0: 6420 536d 6172 7444 6574 6563 744f 626a  d SmartDetectObj
-0000afc0: 6563 7454 7970 652e 5045 5253 4f4e 0a20  ectType.PERSON. 
-0000afd0: 2020 2020 2020 2020 2020 2069 6e20 7365             in se
-0000afe0: 6c66 2e61 6374 6976 655f 736d 6172 745f  lf.active_smart_
-0000aff0: 6465 7465 6374 5f73 6574 7469 6e67 732e  detect_settings.
-0000b000: 6175 746f 5f74 7261 636b 696e 675f 6f62  auto_tracking_ob
-0000b010: 6a65 6374 5f74 7970 6573 0a20 2020 2020  ject_types.     
-0000b020: 2020 2029 0a0a 2020 2020 2320 656e 6472     )..    # endr
-0000b030: 6567 696f 6e0a 2020 2020 2320 7265 6769  egion.    # regi
-0000b040: 6f6e 2056 6568 6963 6c65 0a0a 2020 2020  on Vehicle..    
-0000b050: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000b060: 6620 6361 6e5f 6465 7465 6374 5f76 6568  f can_detect_veh
-0000b070: 6963 6c65 2873 656c 6629 202d 3e20 626f  icle(self) -> bo
-0000b080: 6f6c 3a0a 2020 2020 2020 2020 7265 7475  ol:.        retu
-0000b090: 726e 2053 6d61 7274 4465 7465 6374 4f62  rn SmartDetectOb
-0000b0a0: 6a65 6374 5479 7065 2e56 4548 4943 4c45  jectType.VEHICLE
-0000b0b0: 2069 6e20 7365 6c66 2e66 6561 7475 7265   in self.feature
-0000b0c0: 5f66 6c61 6773 2e73 6d61 7274 5f64 6574  _flags.smart_det
-0000b0d0: 6563 745f 7479 7065 730a 0a20 2020 2040  ect_types..    @
-0000b0e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000b0f0: 2069 735f 7665 6869 636c 655f 6465 7465   is_vehicle_dete
-0000b100: 6374 696f 6e5f 6f6e 2873 656c 6629 202d  ction_on(self) -
-0000b110: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000b120: 2222 2249 7320 5665 6869 636c 6520 4465  """Is Vehicle De
-0000b130: 7465 6374 696f 6e20 6176 6169 6c61 626c  tection availabl
-0000b140: 6520 616e 6420 656e 6162 6c65 6420 2863  e and enabled (c
-0000b150: 616d 6572 6120 7769 6c6c 2070 726f 6475  amera will produ
-0000b160: 6365 2076 6568 6963 6c65 2073 6d61 7274  ce vehicle smart
-0000b170: 0a20 2020 2020 2020 2064 6574 6563 7469  .        detecti
-0000b180: 6f6e 2065 7665 6e74 7329 3f0a 2020 2020  on events)?.    
-0000b190: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000b1a0: 2072 6574 7572 6e20 7365 6c66 2e5f 6973   return self._is
-0000b1b0: 5f73 6d61 7274 5f65 6e61 626c 6564 2853  _smart_enabled(S
-0000b1c0: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
-0000b1d0: 5479 7065 2e56 4548 4943 4c45 290a 0a20  Type.VEHICLE).. 
-0000b1e0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000b1f0: 2064 6566 206c 6173 745f 7665 6869 636c   def last_vehicl
-0000b200: 655f 6465 7465 6374 5f65 7665 6e74 2873  e_detect_event(s
-0000b210: 656c 6629 202d 3e20 4f70 7469 6f6e 616c  elf) -> Optional
-0000b220: 5b45 7665 6e74 5d3a 0a20 2020 2020 2020  [Event]:.       
-0000b230: 2022 2222 4765 7420 7468 6520 6c61 7374   """Get the last
-0000b240: 2076 6568 6963 6c65 2073 6d61 7274 2064   vehicle smart d
-0000b250: 6574 6563 7469 6f6e 2065 7665 6e74 2e22  etection event."
-0000b260: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
-0000b270: 726e 2073 656c 662e 6765 745f 6c61 7374  rn self.get_last
-0000b280: 5f73 6d61 7274 5f64 6574 6563 745f 6576  _smart_detect_ev
-0000b290: 656e 7428 536d 6172 7444 6574 6563 744f  ent(SmartDetectO
-0000b2a0: 626a 6563 7454 7970 652e 5645 4849 434c  bjectType.VEHICL
-0000b2b0: 4529 0a0a 2020 2020 4070 726f 7065 7274  E)..    @propert
-0000b2c0: 790a 2020 2020 6465 6620 6c61 7374 5f76  y.    def last_v
-0000b2d0: 6568 6963 6c65 5f64 6574 6563 7428 7365  ehicle_detect(se
-0000b2e0: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-0000b2f0: 6461 7465 7469 6d65 5d3a 0a20 2020 2020  datetime]:.     
-0000b300: 2020 2022 2222 4765 7420 7468 6520 6c61     """Get the la
-0000b310: 7374 2076 6568 6963 6c65 2073 6d61 7274  st vehicle smart
-0000b320: 2064 6574 6563 7469 6f6e 2065 7665 6e74   detection event
-0000b330: 2e22 2222 0a0a 2020 2020 2020 2020 7265  ."""..        re
-0000b340: 7475 726e 2073 656c 662e 6c61 7374 5f73  turn self.last_s
-0000b350: 6d61 7274 5f64 6574 6563 7473 2e67 6574  mart_detects.get
-0000b360: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000b370: 6374 5479 7065 2e56 4548 4943 4c45 290a  ctType.VEHICLE).
-0000b380: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000b390: 2020 2064 6566 2069 735f 7665 6869 636c     def is_vehicl
-0000b3a0: 655f 6375 7272 656e 746c 795f 6465 7465  e_currently_dete
-0000b3b0: 6374 6564 2873 656c 6629 202d 3e20 626f  cted(self) -> bo
-0000b3c0: 6f6c 3a0a 2020 2020 2020 2020 2222 2249  ol:.        """I
-0000b3d0: 7320 7665 6869 636c 6520 6375 7272 656e  s vehicle curren
-0000b3e0: 746c 7920 6265 696e 6720 6465 7465 6374  tly being detect
-0000b3f0: 6564 2222 220a 0a20 2020 2020 2020 2072  ed"""..        r
-0000b400: 6574 7572 6e20 7365 6c66 2e5f 6973 5f73  eturn self._is_s
-0000b410: 6d61 7274 5f64 6574 6563 7465 6428 536d  mart_detected(Sm
-0000b420: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
-0000b430: 7970 652e 5645 4849 434c 4529 0a0a 2020  ype.VEHICLE)..  
-0000b440: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-0000b450: 7665 6869 636c 655f 6465 7465 6374 696f  vehicle_detectio
-0000b460: 6e28 7365 6c66 2c20 656e 6162 6c65 643a  n(self, enabled:
-0000b470: 2062 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a   bool) -> None:.
-0000b480: 2020 2020 2020 2020 2222 2254 6f67 676c          """Toggl
-0000b490: 6573 2076 6568 6963 6c65 2073 6d61 7274  es vehicle smart
-0000b4a0: 2064 6574 6563 7469 6f6e 2e20 5265 7175   detection. Requ
-0000b4b0: 6972 6573 2063 616d 6572 6120 746f 2068  ires camera to h
-0000b4c0: 6176 6520 736d 6172 7420 6465 7465 6374  ave smart detect
-0000b4d0: 696f 6e22 2222 0a0a 2020 2020 2020 2020  ion"""..        
-0000b4e0: 7265 7475 726e 2061 7761 6974 2073 656c  return await sel
-0000b4f0: 662e 5f73 6574 5f6f 626a 6563 745f 6465  f._set_object_de
-0000b500: 7465 6374 2853 6d61 7274 4465 7465 6374  tect(SmartDetect
-0000b510: 4f62 6a65 6374 5479 7065 2e56 4548 4943  ObjectType.VEHIC
-0000b520: 4c45 2c20 656e 6162 6c65 6429 0a0a 2020  LE, enabled)..  
-0000b530: 2020 2320 656e 6472 6567 696f 6e0a 2020    # endregion.  
-0000b540: 2020 2320 7265 6769 6f6e 204c 6963 656e    # region Licen
-0000b550: 7365 2050 6c61 7465 0a0a 2020 2020 4070  se Plate..    @p
-0000b560: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000b570: 6361 6e5f 6465 7465 6374 5f6c 6963 656e  can_detect_licen
-0000b580: 7365 5f70 6c61 7465 2873 656c 6629 202d  se_plate(self) -
-0000b590: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000b5a0: 7265 7475 726e 2028 0a20 2020 2020 2020  return (.       
-0000b5b0: 2020 2020 2053 6d61 7274 4465 7465 6374       SmartDetect
-0000b5c0: 4f62 6a65 6374 5479 7065 2e4c 4943 454e  ObjectType.LICEN
-0000b5d0: 5345 5f50 4c41 5445 2069 6e20 7365 6c66  SE_PLATE in self
-0000b5e0: 2e66 6561 7475 7265 5f66 6c61 6773 2e73  .feature_flags.s
-0000b5f0: 6d61 7274 5f64 6574 6563 745f 7479 7065  mart_detect_type
-0000b600: 730a 2020 2020 2020 2020 290a 0a20 2020  s.        )..   
-0000b610: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000b620: 6566 2069 735f 6c69 6365 6e73 655f 706c  ef is_license_pl
-0000b630: 6174 655f 6465 7465 6374 696f 6e5f 6f6e  ate_detection_on
-0000b640: 2873 656c 6629 202d 3e20 626f 6f6c 3a0a  (self) -> bool:.
-0000b650: 2020 2020 2020 2020 2222 2249 7320 4c69          """Is Li
-0000b660: 6365 6e73 6520 506c 6174 6520 4465 7465  cense Plate Dete
-0000b670: 6374 696f 6e20 6176 6169 6c61 626c 6520  ction available 
-0000b680: 616e 6420 656e 6162 6c65 6420 2863 616d  and enabled (cam
-0000b690: 6572 6120 7769 6c6c 2070 726f 6475 6365  era will produce
-0000b6a0: 2066 6163 6520 6c69 6365 6e73 650a 2020   face license.  
-0000b6b0: 2020 2020 2020 706c 6174 6520 6465 7465        plate dete
-0000b6c0: 6374 696f 6e20 6576 656e 7473 293f 0a20  ction events)?. 
-0000b6d0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000b6e0: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
-0000b6f0: 2020 2020 2020 2020 2073 656c 662e 5f69           self._i
-0000b700: 735f 736d 6172 745f 656e 6162 6c65 6428  s_smart_enabled(
-0000b710: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
-0000b720: 7454 7970 652e 4c49 4345 4e53 455f 504c  tType.LICENSE_PL
-0000b730: 4154 4529 0a20 2020 2020 2020 2020 2020  ATE).           
-0000b740: 2061 6e64 2073 656c 662e 6973 5f6c 6963   and self.is_lic
-0000b750: 656e 7365 5f70 6c61 7465 5f64 6574 6563  ense_plate_detec
-0000b760: 7469 6f6e 735f 616c 6c6f 7765 640a 2020  tions_allowed.  
-0000b770: 2020 2020 2020 290a 0a20 2020 2040 7072        )..    @pr
-0000b780: 6f70 6572 7479 0a20 2020 2064 6566 206c  operty.    def l
-0000b790: 6173 745f 6c69 6365 6e73 655f 706c 6174  ast_license_plat
-0000b7a0: 655f 6465 7465 6374 5f65 7665 6e74 2873  e_detect_event(s
-0000b7b0: 656c 6629 202d 3e20 4f70 7469 6f6e 616c  elf) -> Optional
-0000b7c0: 5b45 7665 6e74 5d3a 0a20 2020 2020 2020  [Event]:.       
-0000b7d0: 2022 2222 4765 7420 7468 6520 6c61 7374   """Get the last
-0000b7e0: 206c 6963 656e 7365 2070 6c61 7465 2073   license plate s
-0000b7f0: 6d61 7274 2064 6574 6563 7469 6f6e 2065  mart detection e
-0000b800: 7665 6e74 2e22 2222 0a0a 2020 2020 2020  vent."""..      
-0000b810: 2020 7265 7475 726e 2073 656c 662e 6765    return self.ge
-0000b820: 745f 6c61 7374 5f73 6d61 7274 5f64 6574  t_last_smart_det
-0000b830: 6563 745f 6576 656e 7428 536d 6172 7444  ect_event(SmartD
-0000b840: 6574 6563 744f 626a 6563 7454 7970 652e  etectObjectType.
-0000b850: 4c49 4345 4e53 455f 504c 4154 4529 0a0a  LICENSE_PLATE)..
-0000b860: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000b870: 2020 6465 6620 6c61 7374 5f6c 6963 656e    def last_licen
-0000b880: 7365 5f70 6c61 7465 5f64 6574 6563 7428  se_plate_detect(
-0000b890: 7365 6c66 2920 2d3e 204f 7074 696f 6e61  self) -> Optiona
-0000b8a0: 6c5b 6461 7465 7469 6d65 5d3a 0a20 2020  l[datetime]:.   
-0000b8b0: 2020 2020 2022 2222 4765 7420 7468 6520       """Get the 
-0000b8c0: 6c61 7374 206c 6963 656e 7365 2070 6c61  last license pla
-0000b8d0: 7465 2073 6d61 7274 2064 6574 6563 7469  te smart detecti
-0000b8e0: 6f6e 2065 7665 6e74 2e22 2222 0a0a 2020  on event."""..  
-0000b8f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000b900: 662e 6c61 7374 5f73 6d61 7274 5f64 6574  f.last_smart_det
-0000b910: 6563 7473 2e67 6574 2853 6d61 7274 4465  ects.get(SmartDe
-0000b920: 7465 6374 4f62 6a65 6374 5479 7065 2e4c  tectObjectType.L
-0000b930: 4943 454e 5345 5f50 4c41 5445 290a 0a20  ICENSE_PLATE).. 
-0000b940: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000b950: 2064 6566 2069 735f 6c69 6365 6e73 655f   def is_license_
-0000b960: 706c 6174 655f 6375 7272 656e 746c 795f  plate_currently_
-0000b970: 6465 7465 6374 6564 2873 656c 6629 202d  detected(self) -
-0000b980: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000b990: 2222 2249 7320 6c69 6365 6e73 6520 706c  """Is license pl
-0000b9a0: 6174 6520 6375 7272 656e 746c 7920 6265  ate currently be
-0000b9b0: 696e 6720 6465 7465 6374 6564 2222 220a  ing detected""".
-0000b9c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b9d0: 7365 6c66 2e5f 6973 5f73 6d61 7274 5f64  self._is_smart_d
-0000b9e0: 6574 6563 7465 6428 536d 6172 7444 6574  etected(SmartDet
-0000b9f0: 6563 744f 626a 6563 7454 7970 652e 4c49  ectObjectType.LI
-0000ba00: 4345 4e53 455f 504c 4154 4529 0a0a 2020  CENSE_PLATE)..  
-0000ba10: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-0000ba20: 6c69 6365 6e73 655f 706c 6174 655f 6465  license_plate_de
-0000ba30: 7465 6374 696f 6e28 7365 6c66 2c20 656e  tection(self, en
-0000ba40: 6162 6c65 643a 2062 6f6f 6c29 202d 3e20  abled: bool) -> 
-0000ba50: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-0000ba60: 2254 6f67 676c 6573 206c 6963 656e 7365  "Toggles license
-0000ba70: 2070 6c61 7465 2073 6d61 7274 2064 6574   plate smart det
-0000ba80: 6563 7469 6f6e 2e20 5265 7175 6972 6573  ection. Requires
-0000ba90: 2063 616d 6572 6120 746f 2068 6176 6520   camera to have 
-0000baa0: 736d 6172 7420 6465 7465 6374 696f 6e22  smart detection"
-0000bab0: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
-0000bac0: 726e 2061 7761 6974 2073 656c 662e 5f73  rn await self._s
-0000bad0: 6574 5f6f 626a 6563 745f 6465 7465 6374  et_object_detect
-0000bae0: 280a 2020 2020 2020 2020 2020 2020 536d  (.            Sm
-0000baf0: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
-0000bb00: 7970 652e 4c49 4345 4e53 455f 504c 4154  ype.LICENSE_PLAT
-0000bb10: 452c 0a20 2020 2020 2020 2020 2020 2065  E,.            e
-0000bb20: 6e61 626c 6564 2c0a 2020 2020 2020 2020  nabled,.        
-0000bb30: 290a 0a20 2020 2023 2065 6e64 7265 6769  )..    # endregi
-0000bb40: 6f6e 0a20 2020 2023 2072 6567 696f 6e20  on.    # region 
-0000bb50: 5061 636b 6167 650a 0a20 2020 2040 7072  Package..    @pr
-0000bb60: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
-0000bb70: 616e 5f64 6574 6563 745f 7061 636b 6167  an_detect_packag
-0000bb80: 6528 7365 6c66 2920 2d3e 2062 6f6f 6c3a  e(self) -> bool:
-0000bb90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000bba0: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
-0000bbb0: 7454 7970 652e 5041 434b 4147 4520 696e  tType.PACKAGE in
-0000bbc0: 2073 656c 662e 6665 6174 7572 655f 666c   self.feature_fl
-0000bbd0: 6167 732e 736d 6172 745f 6465 7465 6374  ags.smart_detect
-0000bbe0: 5f74 7970 6573 0a0a 2020 2020 4070 726f  _types..    @pro
-0000bbf0: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
-0000bc00: 5f70 6163 6b61 6765 5f64 6574 6563 7469  _package_detecti
-0000bc10: 6f6e 5f6f 6e28 7365 6c66 2920 2d3e 2062  on_on(self) -> b
-0000bc20: 6f6f 6c3a 0a20 2020 2020 2020 2022 2222  ool:.        """
-0000bc30: 4973 2050 6163 6b61 6765 2044 6574 6563  Is Package Detec
-0000bc40: 7469 6f6e 2061 7661 696c 6162 6c65 2061  tion available a
-0000bc50: 6e64 2065 6e61 626c 6564 2028 6361 6d65  nd enabled (came
-0000bc60: 7261 2077 696c 6c20 7072 6f64 7563 6520  ra will produce 
-0000bc70: 7061 636b 6167 6520 736d 6172 740a 2020  package smart.  
-0000bc80: 2020 2020 2020 6465 7465 6374 696f 6e20        detection 
-0000bc90: 6576 656e 7473 293f 0a20 2020 2020 2020  events)?.       
-0000bca0: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
-0000bcb0: 7475 726e 2073 656c 662e 5f69 735f 736d  turn self._is_sm
-0000bcc0: 6172 745f 656e 6162 6c65 6428 536d 6172  art_enabled(Smar
-0000bcd0: 7444 6574 6563 744f 626a 6563 7454 7970  tDetectObjectTyp
-0000bce0: 652e 5041 434b 4147 4529 0a0a 2020 2020  e.PACKAGE)..    
-0000bcf0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000bd00: 6620 6c61 7374 5f70 6163 6b61 6765 5f64  f last_package_d
-0000bd10: 6574 6563 745f 6576 656e 7428 7365 6c66  etect_event(self
-0000bd20: 2920 2d3e 204f 7074 696f 6e61 6c5b 4576  ) -> Optional[Ev
-0000bd30: 656e 745d 3a0a 2020 2020 2020 2020 2222  ent]:.        ""
-0000bd40: 2247 6574 2074 6865 206c 6173 7420 7061  "Get the last pa
-0000bd50: 636b 6167 6520 736d 6172 7420 6465 7465  ckage smart dete
-0000bd60: 6374 696f 6e20 6576 656e 742e 2222 220a  ction event.""".
-0000bd70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000bd80: 7365 6c66 2e67 6574 5f6c 6173 745f 736d  self.get_last_sm
-0000bd90: 6172 745f 6465 7465 6374 5f65 7665 6e74  art_detect_event
-0000bda0: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000bdb0: 6374 5479 7065 2e50 4143 4b41 4745 290a  ctType.PACKAGE).
-0000bdc0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000bdd0: 2020 2064 6566 206c 6173 745f 7061 636b     def last_pack
-0000bde0: 6167 655f 6465 7465 6374 2873 656c 6629  age_detect(self)
-0000bdf0: 202d 3e20 4f70 7469 6f6e 616c 5b64 6174   -> Optional[dat
-0000be00: 6574 696d 655d 3a0a 2020 2020 2020 2020  etime]:.        
-0000be10: 2222 2247 6574 2074 6865 206c 6173 7420  """Get the last 
-0000be20: 7061 636b 6167 6520 736d 6172 7420 6465  package smart de
-0000be30: 7465 6374 696f 6e20 6576 656e 742e 2222  tection event.""
-0000be40: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-0000be50: 6e20 7365 6c66 2e6c 6173 745f 736d 6172  n self.last_smar
-0000be60: 745f 6465 7465 6374 732e 6765 7428 536d  t_detects.get(Sm
-0000be70: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
-0000be80: 7970 652e 5041 434b 4147 4529 0a0a 2020  ype.PACKAGE)..  
-0000be90: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000bea0: 6465 6620 6973 5f70 6163 6b61 6765 5f63  def is_package_c
-0000beb0: 7572 7265 6e74 6c79 5f64 6574 6563 7465  urrently_detecte
-0000bec0: 6428 7365 6c66 2920 2d3e 2062 6f6f 6c3a  d(self) -> bool:
-0000bed0: 0a20 2020 2020 2020 2022 2222 4973 2070  .        """Is p
-0000bee0: 6163 6b61 6765 2063 7572 7265 6e74 6c79  ackage currently
-0000bef0: 2062 6569 6e67 2064 6574 6563 7465 6422   being detected"
-0000bf00: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
-0000bf10: 726e 2073 656c 662e 5f69 735f 736d 6172  rn self._is_smar
-0000bf20: 745f 6465 7465 6374 6564 2853 6d61 7274  t_detected(Smart
-0000bf30: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
-0000bf40: 2e50 4143 4b41 4745 290a 0a20 2020 2061  .PACKAGE)..    a
-0000bf50: 7379 6e63 2064 6566 2073 6574 5f70 6163  sync def set_pac
-0000bf60: 6b61 6765 5f64 6574 6563 7469 6f6e 2873  kage_detection(s
-0000bf70: 656c 662c 2065 6e61 626c 6564 3a20 626f  elf, enabled: bo
-0000bf80: 6f6c 2920 2d3e 204e 6f6e 653a 0a20 2020  ol) -> None:.   
-0000bf90: 2020 2020 2022 2222 546f 6767 6c65 7320       """Toggles 
-0000bfa0: 7061 636b 6167 6520 736d 6172 7420 6465  package smart de
-0000bfb0: 7465 6374 696f 6e2e 2052 6571 7569 7265  tection. Require
-0000bfc0: 7320 6361 6d65 7261 2074 6f20 6861 7665  s camera to have
-0000bfd0: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
-0000bfe0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-0000bff0: 7572 6e20 6177 6169 7420 7365 6c66 2e5f  urn await self._
-0000c000: 7365 745f 6f62 6a65 6374 5f64 6574 6563  set_object_detec
-0000c010: 7428 536d 6172 7444 6574 6563 744f 626a  t(SmartDetectObj
-0000c020: 6563 7454 7970 652e 5041 434b 4147 452c  ectType.PACKAGE,
-0000c030: 2065 6e61 626c 6564 290a 0a20 2020 2023   enabled)..    #
-0000c040: 2065 6e64 7265 6769 6f6e 0a20 2020 2023   endregion.    #
-0000c050: 2072 6567 696f 6e20 416e 696d 616c 0a0a   region Animal..
-0000c060: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000c070: 2020 6465 6620 6361 6e5f 6465 7465 6374    def can_detect
-0000c080: 5f61 6e69 6d61 6c28 7365 6c66 2920 2d3e  _animal(self) ->
-0000c090: 2062 6f6f 6c3a 0a20 2020 2020 2020 2072   bool:.        r
-0000c0a0: 6574 7572 6e20 536d 6172 7444 6574 6563  eturn SmartDetec
-0000c0b0: 744f 626a 6563 7454 7970 652e 414e 494d  tObjectType.ANIM
-0000c0c0: 414c 2069 6e20 7365 6c66 2e66 6561 7475  AL in self.featu
-0000c0d0: 7265 5f66 6c61 6773 2e73 6d61 7274 5f64  re_flags.smart_d
-0000c0e0: 6574 6563 745f 7479 7065 730a 0a20 2020  etect_types..   
-0000c0f0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000c100: 6566 2069 735f 616e 696d 616c 5f64 6574  ef is_animal_det
-0000c110: 6563 7469 6f6e 5f6f 6e28 7365 6c66 2920  ection_on(self) 
-0000c120: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-0000c130: 2022 2222 4973 2041 6e69 6d61 6c20 4465   """Is Animal De
-0000c140: 7465 6374 696f 6e20 6176 6169 6c61 626c  tection availabl
-0000c150: 6520 616e 6420 656e 6162 6c65 6420 2863  e and enabled (c
-0000c160: 616d 6572 6120 7769 6c6c 2070 726f 6475  amera will produ
-0000c170: 6365 2070 6163 6b61 6765 2073 6d61 7274  ce package smart
-0000c180: 0a20 2020 2020 2020 2064 6574 6563 7469  .        detecti
-0000c190: 6f6e 2065 7665 6e74 7329 3f0a 2020 2020  on events)?.    
-0000c1a0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000c1b0: 2072 6574 7572 6e20 7365 6c66 2e5f 6973   return self._is
-0000c1c0: 5f73 6d61 7274 5f65 6e61 626c 6564 2853  _smart_enabled(S
-0000c1d0: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
-0000c1e0: 5479 7065 2e41 4e49 4d41 4c29 0a0a 2020  Type.ANIMAL)..  
-0000c1f0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000c200: 6465 6620 6c61 7374 5f61 6e69 6d61 6c5f  def last_animal_
-0000c210: 6465 7465 6374 5f65 7665 6e74 2873 656c  detect_event(sel
-0000c220: 6629 202d 3e20 4f70 7469 6f6e 616c 5b45  f) -> Optional[E
-0000c230: 7665 6e74 5d3a 0a20 2020 2020 2020 2022  vent]:.        "
-0000c240: 2222 4765 7420 7468 6520 6c61 7374 2061  ""Get the last a
-0000c250: 6e69 6d61 6c20 736d 6172 7420 6465 7465  nimal smart dete
-0000c260: 6374 696f 6e20 6576 656e 742e 2222 220a  ction event.""".
-0000c270: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000c280: 7365 6c66 2e67 6574 5f6c 6173 745f 736d  self.get_last_sm
-0000c290: 6172 745f 6465 7465 6374 5f65 7665 6e74  art_detect_event
-0000c2a0: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000c2b0: 6374 5479 7065 2e41 4e49 4d41 4c29 0a0a  ctType.ANIMAL)..
-0000c2c0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000c2d0: 2020 6465 6620 6c61 7374 5f61 6e69 6d61    def last_anima
-0000c2e0: 6c5f 6465 7465 6374 2873 656c 6629 202d  l_detect(self) -
-0000c2f0: 3e20 4f70 7469 6f6e 616c 5b64 6174 6574  > Optional[datet
-0000c300: 696d 655d 3a0a 2020 2020 2020 2020 2222  ime]:.        ""
-0000c310: 2247 6574 2074 6865 206c 6173 7420 616e  "Get the last an
-0000c320: 696d 616c 2073 6d61 7274 2064 6574 6563  imal smart detec
-0000c330: 7469 6f6e 2065 7665 6e74 2e22 2222 0a0a  tion event."""..
-0000c340: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000c350: 656c 662e 6c61 7374 5f73 6d61 7274 5f64  elf.last_smart_d
-0000c360: 6574 6563 7473 2e67 6574 2853 6d61 7274  etects.get(Smart
-0000c370: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
-0000c380: 2e41 4e49 4d41 4c29 0a0a 2020 2020 4070  .ANIMAL)..    @p
-0000c390: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000c3a0: 6973 5f61 6e69 6d61 6c5f 6375 7272 656e  is_animal_curren
-0000c3b0: 746c 795f 6465 7465 6374 6564 2873 656c  tly_detected(sel
-0000c3c0: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-0000c3d0: 2020 2020 2222 2249 7320 616e 696d 616c      """Is animal
-0000c3e0: 2063 7572 7265 6e74 6c79 2062 6569 6e67   currently being
-0000c3f0: 2064 6574 6563 7465 6422 2222 0a0a 2020   detected"""..  
-0000c400: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000c410: 662e 5f69 735f 736d 6172 745f 6465 7465  f._is_smart_dete
-0000c420: 6374 6564 2853 6d61 7274 4465 7465 6374  cted(SmartDetect
-0000c430: 4f62 6a65 6374 5479 7065 2e41 4e49 4d41  ObjectType.ANIMA
-0000c440: 4c29 0a0a 2020 2020 6173 796e 6320 6465  L)..    async de
-0000c450: 6620 7365 745f 616e 696d 616c 5f64 6574  f set_animal_det
-0000c460: 6563 7469 6f6e 2873 656c 662c 2065 6e61  ection(self, ena
-0000c470: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
-0000c480: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-0000c490: 546f 6767 6c65 7320 616e 696d 616c 2073  Toggles animal s
-0000c4a0: 6d61 7274 2064 6574 6563 7469 6f6e 2e20  mart detection. 
-0000c4b0: 5265 7175 6972 6573 2063 616d 6572 6120  Requires camera 
-0000c4c0: 746f 2068 6176 6520 736d 6172 7420 6465  to have smart de
-0000c4d0: 7465 6374 696f 6e22 2222 0a0a 2020 2020  tection"""..    
-0000c4e0: 2020 2020 7265 7475 726e 2061 7761 6974      return await
-0000c4f0: 2073 656c 662e 5f73 6574 5f6f 626a 6563   self._set_objec
-0000c500: 745f 6465 7465 6374 2853 6d61 7274 4465  t_detect(SmartDe
-0000c510: 7465 6374 4f62 6a65 6374 5479 7065 2e41  tectObjectType.A
-0000c520: 4e49 4d41 4c2c 2065 6e61 626c 6564 290a  NIMAL, enabled).
-0000c530: 0a20 2020 2023 2065 6e64 7265 6769 6f6e  .    # endregion
-0000c540: 0a20 2020 2023 2065 6e64 7265 6769 6f6e  .    # endregion
-0000c550: 0a20 2020 2023 2072 6567 696f 6e20 4175  .    # region Au
-0000c560: 6469 6f20 536d 6172 7420 4465 7465 6374  dio Smart Detect
-0000c570: 696f 6e73 0a0a 2020 2020 6465 6620 5f63  ions..    def _c
-0000c580: 616e 5f64 6574 6563 745f 6175 6469 6f28  an_detect_audio(
-0000c590: 7365 6c66 2c20 736d 6172 745f 7479 7065  self, smart_type
-0000c5a0: 3a20 536d 6172 7444 6574 6563 744f 626a  : SmartDetectObj
-0000c5b0: 6563 7454 7970 6529 202d 3e20 626f 6f6c  ectType) -> bool
-0000c5c0: 3a0a 2020 2020 2020 2020 6175 6469 6f5f  :.        audio_
-0000c5d0: 7479 7065 203d 2073 6d61 7274 5f74 7970  type = smart_typ
-0000c5e0: 652e 6175 6469 6f5f 7479 7065 0a20 2020  e.audio_type.   
-0000c5f0: 2020 2020 2072 6574 7572 6e20 280a 2020       return (.  
-0000c600: 2020 2020 2020 2020 2020 6175 6469 6f5f            audio_
-0000c610: 7479 7065 2069 7320 6e6f 7420 4e6f 6e65  type is not None
-0000c620: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-0000c630: 2073 656c 662e 6665 6174 7572 655f 666c   self.feature_fl
-0000c640: 6167 732e 736d 6172 745f 6465 7465 6374  ags.smart_detect
-0000c650: 5f61 7564 696f 5f74 7970 6573 2069 7320  _audio_types is 
-0000c660: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
-0000c670: 2020 2020 2061 6e64 2061 7564 696f 5f74       and audio_t
-0000c680: 7970 6520 696e 2073 656c 662e 6665 6174  ype in self.feat
-0000c690: 7572 655f 666c 6167 732e 736d 6172 745f  ure_flags.smart_
-0000c6a0: 6465 7465 6374 5f61 7564 696f 5f74 7970  detect_audio_typ
-0000c6b0: 6573 0a20 2020 2020 2020 2029 0a0a 2020  es.        )..  
-0000c6c0: 2020 6465 6620 5f69 735f 6175 6469 6f5f    def _is_audio_
-0000c6d0: 656e 6162 6c65 6428 7365 6c66 2c20 736d  enabled(self, sm
-0000c6e0: 6172 745f 7479 7065 3a20 536d 6172 7444  art_type: SmartD
-0000c6f0: 6574 6563 744f 626a 6563 7454 7970 6529  etectObjectType)
-0000c700: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
-0000c710: 2020 6175 6469 6f5f 7479 7065 203d 2073    audio_type = s
-0000c720: 6d61 7274 5f74 7970 652e 6175 6469 6f5f  mart_type.audio_
-0000c730: 7479 7065 0a20 2020 2020 2020 2072 6574  type.        ret
-0000c740: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
-0000c750: 2020 6175 6469 6f5f 7479 7065 2069 7320    audio_type is 
-0000c760: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
-0000c770: 2020 2020 2061 6e64 2073 656c 662e 6973       and self.is
-0000c780: 5f72 6563 6f72 6469 6e67 5f65 6e61 626c  _recording_enabl
-0000c790: 6564 0a20 2020 2020 2020 2020 2020 2061  ed.            a
-0000c7a0: 6e64 2061 7564 696f 5f74 7970 6520 696e  nd audio_type in
-0000c7b0: 2073 656c 662e 6163 7469 7665 5f61 7564   self.active_aud
-0000c7c0: 696f 5f64 6574 6563 745f 7479 7065 730a  io_detect_types.
-0000c7d0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0000c7e0: 7365 6c66 2e63 616e 5f6d 616e 6167 655f  self.can_manage_
-0000c7f0: 736d 6172 745f 6465 7465 6374 696f 6e73  smart_detections
-0000c800: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000c810: 6465 6620 5f69 735f 6175 6469 6f5f 6465  def _is_audio_de
-0000c820: 7465 6374 6564 2873 656c 662c 2073 6d61  tected(self, sma
-0000c830: 7274 5f74 7970 653a 2053 6d61 7274 4465  rt_type: SmartDe
-0000c840: 7465 6374 4f62 6a65 6374 5479 7065 2920  tectObjectType) 
-0000c850: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-0000c860: 2061 7564 696f 5f74 7970 6520 3d20 736d   audio_type = sm
-0000c870: 6172 745f 7479 7065 2e61 7564 696f 5f74  art_type.audio_t
-0000c880: 7970 650a 2020 2020 2020 2020 6966 2061  ype.        if a
-0000c890: 7564 696f 5f74 7970 6520 6973 204e 6f6e  udio_type is Non
-0000c8a0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000c8b0: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
-0000c8c0: 2020 2020 2065 7665 6e74 203d 2073 656c       event = sel
-0000c8d0: 662e 6765 745f 6c61 7374 5f73 6d61 7274  f.get_last_smart
-0000c8e0: 5f61 7564 696f 5f64 6574 6563 745f 6576  _audio_detect_ev
-0000c8f0: 656e 7428 6175 6469 6f5f 7479 7065 290a  ent(audio_type).
-0000c900: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-0000c910: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000c920: 662e 5f69 735f 6175 6469 6f5f 656e 6162  f._is_audio_enab
-0000c930: 6c65 6428 736d 6172 745f 7479 7065 290a  led(smart_type).
-0000c940: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0000c950: 6576 656e 7420 6973 206e 6f74 204e 6f6e  event is not Non
-0000c960: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-0000c970: 6420 6576 656e 742e 656e 6420 6973 204e  d event.end is N
-0000c980: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0000c990: 616e 6420 736d 6172 745f 7479 7065 2069  and smart_type i
-0000c9a0: 6e20 6576 656e 742e 736d 6172 745f 6465  n event.smart_de
-0000c9b0: 7465 6374 5f74 7970 6573 0a20 2020 2020  tect_types.     
-0000c9c0: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-0000c9d0: 7274 790a 2020 2020 6465 6620 6973 5f61  rty.    def is_a
-0000c9e0: 7564 696f 5f63 7572 7265 6e74 6c79 5f64  udio_currently_d
-0000c9f0: 6574 6563 7465 6428 7365 6c66 2920 2d3e  etected(self) ->
-0000ca00: 2062 6f6f 6c3a 0a20 2020 2020 2020 2022   bool:.        "
-0000ca10: 2222 4973 2061 7564 696f 2064 6574 6563  ""Is audio detec
-0000ca20: 7469 6f6e 2063 7572 7265 6e74 6c79 2062  tion currently b
-0000ca30: 6569 6e67 2064 6574 6563 7465 6422 2222  eing detected"""
-0000ca40: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000ca50: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
-0000ca60: 656c 662e 6973 5f72 6563 6f72 6469 6e67  elf.is_recording
-0000ca70: 5f65 6e61 626c 6564 0a20 2020 2020 2020  _enabled.       
-0000ca80: 2020 2020 2061 6e64 2062 6f6f 6c28 7365       and bool(se
-0000ca90: 6c66 2e61 6374 6976 655f 6175 6469 6f5f  lf.active_audio_
-0000caa0: 6465 7465 6374 5f74 7970 6573 290a 2020  detect_types).  
-0000cab0: 2020 2020 2020 2020 2020 616e 6420 7365            and se
-0000cac0: 6c66 2e6c 6173 745f 736d 6172 745f 6175  lf.last_smart_au
-0000cad0: 6469 6f5f 6465 7465 6374 5f65 7665 6e74  dio_detect_event
-0000cae0: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
-0000caf0: 2020 2020 2020 2020 2061 6e64 2073 656c           and sel
-0000cb00: 662e 6c61 7374 5f73 6d61 7274 5f61 7564  f.last_smart_aud
-0000cb10: 696f 5f64 6574 6563 745f 6576 656e 742e  io_detect_event.
-0000cb20: 656e 6420 6973 204e 6f6e 650a 2020 2020  end is None.    
-0000cb30: 2020 2020 290a 0a20 2020 2023 2072 6567      )..    # reg
-0000cb40: 696f 6e20 536d 6f6b 6520 416c 6172 6d0a  ion Smoke Alarm.
-0000cb50: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000cb60: 2020 2064 6566 2063 616e 5f64 6574 6563     def can_detec
-0000cb70: 745f 736d 6f6b 6528 7365 6c66 2920 2d3e  t_smoke(self) ->
-0000cb80: 2062 6f6f 6c3a 0a20 2020 2020 2020 2072   bool:.        r
-0000cb90: 6574 7572 6e20 7365 6c66 2e5f 6361 6e5f  eturn self._can_
-0000cba0: 6465 7465 6374 5f61 7564 696f 2853 6d61  detect_audio(Sma
-0000cbb0: 7274 4465 7465 6374 4f62 6a65 6374 5479  rtDetectObjectTy
-0000cbc0: 7065 2e53 4d4f 4b45 290a 0a20 2020 2040  pe.SMOKE)..    @
-0000cbd0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000cbe0: 2069 735f 736d 6f6b 655f 6465 7465 6374   is_smoke_detect
-0000cbf0: 696f 6e5f 6f6e 2873 656c 6629 202d 3e20  ion_on(self) -> 
-0000cc00: 626f 6f6c 3a0a 2020 2020 2020 2020 2222  bool:.        ""
-0000cc10: 2249 7320 536d 6f6b 6520 416c 6172 6d20  "Is Smoke Alarm 
-0000cc20: 4465 7465 6374 696f 6e20 6176 6169 6c61  Detection availa
-0000cc30: 626c 6520 616e 6420 656e 6162 6c65 6420  ble and enabled 
-0000cc40: 2863 616d 6572 6120 7769 6c6c 2070 726f  (camera will pro
-0000cc50: 6475 6365 2073 6d6f 6b65 0a20 2020 2020  duce smoke.     
-0000cc60: 2020 2073 6d61 7274 2064 6574 6563 7469     smart detecti
-0000cc70: 6f6e 2065 7665 6e74 7329 3f0a 2020 2020  on events)?.    
-0000cc80: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000cc90: 2072 6574 7572 6e20 7365 6c66 2e5f 6973   return self._is
-0000cca0: 5f61 7564 696f 5f65 6e61 626c 6564 2853  _audio_enabled(S
-0000ccb0: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
-0000ccc0: 5479 7065 2e53 4d4f 4b45 290a 0a20 2020  Type.SMOKE)..   
-0000ccd0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000cce0: 6566 206c 6173 745f 736d 6f6b 655f 6465  ef last_smoke_de
-0000ccf0: 7465 6374 5f65 7665 6e74 2873 656c 6629  tect_event(self)
-0000cd00: 202d 3e20 4f70 7469 6f6e 616c 5b45 7665   -> Optional[Eve
-0000cd10: 6e74 5d3a 0a20 2020 2020 2020 2022 2222  nt]:.        """
-0000cd20: 4765 7420 7468 6520 6c61 7374 2070 6572  Get the last per
-0000cd30: 736f 6e20 736d 6172 7420 6465 7465 6374  son smart detect
-0000cd40: 696f 6e20 6576 656e 742e 2222 220a 0a20  ion event.""".. 
-0000cd50: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000cd60: 6c66 2e67 6574 5f6c 6173 745f 736d 6172  lf.get_last_smar
-0000cd70: 745f 6175 6469 6f5f 6465 7465 6374 5f65  t_audio_detect_e
-0000cd80: 7665 6e74 2853 6d61 7274 4465 7465 6374  vent(SmartDetect
-0000cd90: 4175 6469 6f54 7970 652e 534d 4f4b 4529  AudioType.SMOKE)
-0000cda0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000cdb0: 2020 2020 6465 6620 6c61 7374 5f73 6d6f      def last_smo
-0000cdc0: 6b65 5f64 6574 6563 7428 7365 6c66 2920  ke_detect(self) 
-0000cdd0: 2d3e 204f 7074 696f 6e61 6c5b 6461 7465  -> Optional[date
-0000cde0: 7469 6d65 5d3a 0a20 2020 2020 2020 2022  time]:.        "
-0000cdf0: 2222 4765 7420 7468 6520 6c61 7374 2073  ""Get the last s
-0000ce00: 6d6f 6b65 2073 6d61 7274 2064 6574 6563  moke smart detec
-0000ce10: 7469 6f6e 2065 7665 6e74 2e22 2222 0a0a  tion event."""..
-0000ce20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000ce30: 656c 662e 6c61 7374 5f73 6d61 7274 5f61  elf.last_smart_a
-0000ce40: 7564 696f 5f64 6574 6563 7473 2e67 6574  udio_detects.get
-0000ce50: 2853 6d61 7274 4465 7465 6374 4175 6469  (SmartDetectAudi
-0000ce60: 6f54 7970 652e 534d 4f4b 4529 0a0a 2020  oType.SMOKE)..  
-0000ce70: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000ce80: 6465 6620 6973 5f73 6d6f 6b65 5f63 7572  def is_smoke_cur
-0000ce90: 7265 6e74 6c79 5f64 6574 6563 7465 6428  rently_detected(
-0000cea0: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
-0000ceb0: 2020 2020 2020 2022 2222 4973 2073 6d6f         """Is smo
-0000cec0: 6b65 2061 6c61 726d 2063 7572 7265 6e74  ke alarm current
-0000ced0: 6c79 2062 6569 6e67 2064 6574 6563 7465  ly being detecte
-0000cee0: 6422 2222 0a0a 2020 2020 2020 2020 7265  d"""..        re
-0000cef0: 7475 726e 2073 656c 662e 5f69 735f 6175  turn self._is_au
-0000cf00: 6469 6f5f 6465 7465 6374 6564 2853 6d61  dio_detected(Sma
-0000cf10: 7274 4465 7465 6374 4f62 6a65 6374 5479  rtDetectObjectTy
-0000cf20: 7065 2e53 4d4f 4b45 290a 0a20 2020 2061  pe.SMOKE)..    a
-0000cf30: 7379 6e63 2064 6566 2073 6574 5f73 6d6f  sync def set_smo
-0000cf40: 6b65 5f64 6574 6563 7469 6f6e 2873 656c  ke_detection(sel
-0000cf50: 662c 2065 6e61 626c 6564 3a20 626f 6f6c  f, enabled: bool
-0000cf60: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000cf70: 2020 2022 2222 546f 6767 6c65 7320 736d     """Toggles sm
-0000cf80: 6f6b 6520 736d 6172 7420 6465 7465 6374  oke smart detect
-0000cf90: 696f 6e2e 2052 6571 7569 7265 7320 6361  ion. Requires ca
-0000cfa0: 6d65 7261 2074 6f20 6861 7665 2073 6d61  mera to have sma
-0000cfb0: 7274 2064 6574 6563 7469 6f6e 2222 220a  rt detection""".
-0000cfc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000cfd0: 6177 6169 7420 7365 6c66 2e5f 7365 745f  await self._set_
-0000cfe0: 6175 6469 6f5f 6465 7465 6374 2853 6d61  audio_detect(Sma
-0000cff0: 7274 4465 7465 6374 4175 6469 6f54 7970  rtDetectAudioTyp
-0000d000: 652e 534d 4f4b 452c 2065 6e61 626c 6564  e.SMOKE, enabled
-0000d010: 290a 0a20 2020 2023 2065 6e64 7265 6769  )..    # endregi
-0000d020: 6f6e 0a20 2020 2023 2072 6567 696f 6e20  on.    # region 
-0000d030: 434f 2041 6c61 726d 0a0a 2020 2020 4070  CO Alarm..    @p
-0000d040: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000d050: 6361 6e5f 6465 7465 6374 5f63 6f28 7365  can_detect_co(se
-0000d060: 6c66 2920 2d3e 2062 6f6f 6c3a 0a20 2020  lf) -> bool:.   
-0000d070: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000d080: 2e5f 6361 6e5f 6465 7465 6374 5f61 7564  ._can_detect_aud
-0000d090: 696f 2853 6d61 7274 4465 7465 6374 4f62  io(SmartDetectOb
-0000d0a0: 6a65 6374 5479 7065 2e43 4d4f 4e58 290a  jectType.CMONX).
-0000d0b0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000d0c0: 2020 2064 6566 2069 735f 636f 5f64 6574     def is_co_det
-0000d0d0: 6563 7469 6f6e 5f6f 6e28 7365 6c66 2920  ection_on(self) 
-0000d0e0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-0000d0f0: 2022 2222 4973 2043 4f20 416c 6172 6d20   """Is CO Alarm 
-0000d100: 4465 7465 6374 696f 6e20 6176 6169 6c61  Detection availa
-0000d110: 626c 6520 616e 6420 656e 6162 6c65 6420  ble and enabled 
-0000d120: 2863 616d 6572 6120 7769 6c6c 2070 726f  (camera will pro
-0000d130: 6475 6365 2073 6d6f 6b65 2073 6d61 7274  duce smoke smart
-0000d140: 0a20 2020 2020 2020 2064 6574 6563 7469  .        detecti
-0000d150: 6f6e 2065 7665 6e74 7329 3f0a 2020 2020  on events)?.    
-0000d160: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000d170: 2072 6574 7572 6e20 7365 6c66 2e5f 6973   return self._is
-0000d180: 5f61 7564 696f 5f65 6e61 626c 6564 2853  _audio_enabled(S
-0000d190: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
-0000d1a0: 5479 7065 2e43 4d4f 4e58 290a 0a20 2020  Type.CMONX)..   
-0000d1b0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000d1c0: 6566 206c 6173 745f 636d 6f6e 785f 6465  ef last_cmonx_de
-0000d1d0: 7465 6374 5f65 7665 6e74 2873 656c 6629  tect_event(self)
-0000d1e0: 202d 3e20 4f70 7469 6f6e 616c 5b45 7665   -> Optional[Eve
-0000d1f0: 6e74 5d3a 0a20 2020 2020 2020 2022 2222  nt]:.        """
-0000d200: 4765 7420 7468 6520 6c61 7374 2043 4f20  Get the last CO 
-0000d210: 616c 6172 6d20 736d 6172 7420 6465 7465  alarm smart dete
-0000d220: 6374 696f 6e20 6576 656e 742e 2222 220a  ction event.""".
-0000d230: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000d240: 7365 6c66 2e67 6574 5f6c 6173 745f 736d  self.get_last_sm
-0000d250: 6172 745f 6175 6469 6f5f 6465 7465 6374  art_audio_detect
-0000d260: 5f65 7665 6e74 2853 6d61 7274 4465 7465  _event(SmartDete
-0000d270: 6374 4175 6469 6f54 7970 652e 434d 4f4e  ctAudioType.CMON
-0000d280: 5829 0a0a 2020 2020 4070 726f 7065 7274  X)..    @propert
-0000d290: 790a 2020 2020 6465 6620 6c61 7374 5f63  y.    def last_c
-0000d2a0: 6d6f 6e78 5f64 6574 6563 7428 7365 6c66  monx_detect(self
-0000d2b0: 2920 2d3e 204f 7074 696f 6e61 6c5b 6461  ) -> Optional[da
-0000d2c0: 7465 7469 6d65 5d3a 0a20 2020 2020 2020  tetime]:.       
-0000d2d0: 2022 2222 4765 7420 7468 6520 6c61 7374   """Get the last
-0000d2e0: 2043 4f20 616c 6172 6d20 736d 6172 7420   CO alarm smart 
-0000d2f0: 6465 7465 6374 696f 6e20 6576 656e 742e  detection event.
-0000d300: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-0000d310: 7572 6e20 7365 6c66 2e6c 6173 745f 736d  urn self.last_sm
-0000d320: 6172 745f 6175 6469 6f5f 6465 7465 6374  art_audio_detect
-0000d330: 732e 6765 7428 536d 6172 7444 6574 6563  s.get(SmartDetec
-0000d340: 7441 7564 696f 5479 7065 2e43 4d4f 4e58  tAudioType.CMONX
-0000d350: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000d360: 0a20 2020 2064 6566 2069 735f 636d 6f6e  .    def is_cmon
-0000d370: 785f 6375 7272 656e 746c 795f 6465 7465  x_currently_dete
-0000d380: 6374 6564 2873 656c 6629 202d 3e20 626f  cted(self) -> bo
-0000d390: 6f6c 3a0a 2020 2020 2020 2020 2222 2249  ol:.        """I
-0000d3a0: 7320 434f 2061 6c61 726d 2063 7572 7265  s CO alarm curre
-0000d3b0: 6e74 6c79 2062 6569 6e67 2064 6574 6563  ntly being detec
-0000d3c0: 7465 6422 2222 0a0a 2020 2020 2020 2020  ted"""..        
-0000d3d0: 7265 7475 726e 2073 656c 662e 5f69 735f  return self._is_
-0000d3e0: 6175 6469 6f5f 6465 7465 6374 6564 2853  audio_detected(S
-0000d3f0: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
-0000d400: 5479 7065 2e43 4d4f 4e58 290a 0a20 2020  Type.CMONX)..   
-0000d410: 2061 7379 6e63 2064 6566 2073 6574 5f63   async def set_c
-0000d420: 6d6f 6e78 5f64 6574 6563 7469 6f6e 2873  monx_detection(s
-0000d430: 656c 662c 2065 6e61 626c 6564 3a20 626f  elf, enabled: bo
-0000d440: 6f6c 2920 2d3e 204e 6f6e 653a 0a20 2020  ol) -> None:.   
-0000d450: 2020 2020 2022 2222 546f 6767 6c65 7320       """Toggles 
-0000d460: 736d 6f6b 6520 736d 6172 7420 6465 7465  smoke smart dete
-0000d470: 6374 696f 6e2e 2052 6571 7569 7265 7320  ction. Requires 
-0000d480: 6361 6d65 7261 2074 6f20 6861 7665 2073  camera to have s
-0000d490: 6d61 7274 2064 6574 6563 7469 6f6e 2222  mart detection""
-0000d4a0: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-0000d4b0: 6e20 6177 6169 7420 7365 6c66 2e5f 7365  n await self._se
-0000d4c0: 745f 6175 6469 6f5f 6465 7465 6374 2853  t_audio_detect(S
-0000d4d0: 6d61 7274 4465 7465 6374 4175 6469 6f54  martDetectAudioT
-0000d4e0: 7970 652e 434d 4f4e 582c 2065 6e61 626c  ype.CMONX, enabl
-0000d4f0: 6564 290a 0a20 2020 2023 2065 6e64 7265  ed)..    # endre
-0000d500: 6769 6f6e 0a20 2020 2023 2072 6567 696f  gion.    # regio
-0000d510: 6e20 5369 7265 6e0a 0a20 2020 2040 7072  n Siren..    @pr
-0000d520: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
-0000d530: 616e 5f64 6574 6563 745f 7369 7265 6e28  an_detect_siren(
-0000d540: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
-0000d550: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000d560: 6c66 2e5f 6361 6e5f 6465 7465 6374 5f61  lf._can_detect_a
-0000d570: 7564 696f 2853 6d61 7274 4465 7465 6374  udio(SmartDetect
-0000d580: 4f62 6a65 6374 5479 7065 2e53 4952 454e  ObjectType.SIREN
-0000d590: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000d5a0: 0a20 2020 2064 6566 2069 735f 7369 7265  .    def is_sire
-0000d5b0: 6e5f 6465 7465 6374 696f 6e5f 6f6e 2873  n_detection_on(s
-0000d5c0: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
-0000d5d0: 2020 2020 2020 2222 2249 7320 5369 7265        """Is Sire
-0000d5e0: 6e20 4465 7465 6374 696f 6e20 6176 6169  n Detection avai
-0000d5f0: 6c61 626c 6520 616e 6420 656e 6162 6c65  lable and enable
-0000d600: 6420 2863 616d 6572 6120 7769 6c6c 2070  d (camera will p
-0000d610: 726f 6475 6365 2073 6972 656e 2073 6d61  roduce siren sma
-0000d620: 7274 0a20 2020 2020 2020 2064 6574 6563  rt.        detec
-0000d630: 7469 6f6e 2065 7665 6e74 7329 3f0a 2020  tion events)?.  
-0000d640: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000d650: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000d660: 6973 5f61 7564 696f 5f65 6e61 626c 6564  is_audio_enabled
-0000d670: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000d680: 6374 5479 7065 2e53 4952 454e 290a 0a20  ctType.SIREN).. 
-0000d690: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000d6a0: 2064 6566 206c 6173 745f 7369 7265 6e5f   def last_siren_
-0000d6b0: 6465 7465 6374 5f65 7665 6e74 2873 656c  detect_event(sel
-0000d6c0: 6629 202d 3e20 4f70 7469 6f6e 616c 5b45  f) -> Optional[E
-0000d6d0: 7665 6e74 5d3a 0a20 2020 2020 2020 2022  vent]:.        "
-0000d6e0: 2222 4765 7420 7468 6520 6c61 7374 2053  ""Get the last S
-0000d6f0: 6972 656e 2073 6d61 7274 2064 6574 6563  iren smart detec
-0000d700: 7469 6f6e 2065 7665 6e74 2e22 2222 0a0a  tion event."""..
-0000d710: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000d720: 656c 662e 6765 745f 6c61 7374 5f73 6d61  elf.get_last_sma
-0000d730: 7274 5f61 7564 696f 5f64 6574 6563 745f  rt_audio_detect_
-0000d740: 6576 656e 7428 536d 6172 7444 6574 6563  event(SmartDetec
-0000d750: 7441 7564 696f 5479 7065 2e53 4952 454e  tAudioType.SIREN
-0000d760: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000d770: 0a20 2020 2064 6566 206c 6173 745f 7369  .    def last_si
-0000d780: 7265 6e5f 6465 7465 6374 2873 656c 6629  ren_detect(self)
-0000d790: 202d 3e20 4f70 7469 6f6e 616c 5b64 6174   -> Optional[dat
-0000d7a0: 6574 696d 655d 3a0a 2020 2020 2020 2020  etime]:.        
-0000d7b0: 2222 2247 6574 2074 6865 206c 6173 7420  """Get the last 
-0000d7c0: 5369 7265 6e20 736d 6172 7420 6465 7465  Siren smart dete
-0000d7d0: 6374 696f 6e20 6576 656e 742e 2222 220a  ction event.""".
-0000d7e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000d7f0: 7365 6c66 2e6c 6173 745f 736d 6172 745f  self.last_smart_
-0000d800: 6175 6469 6f5f 6465 7465 6374 732e 6765  audio_detects.ge
-0000d810: 7428 536d 6172 7444 6574 6563 7441 7564  t(SmartDetectAud
-0000d820: 696f 5479 7065 2e53 4952 454e 290a 0a20  ioType.SIREN).. 
-0000d830: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000d840: 2064 6566 2069 735f 7369 7265 6e5f 6375   def is_siren_cu
-0000d850: 7272 656e 746c 795f 6465 7465 6374 6564  rrently_detected
-0000d860: 2873 656c 6629 202d 3e20 626f 6f6c 3a0a  (self) -> bool:.
-0000d870: 2020 2020 2020 2020 2222 2249 7320 5369          """Is Si
-0000d880: 7265 6e20 6375 7272 656e 746c 7920 6265  ren currently be
-0000d890: 696e 6720 6465 7465 6374 6564 2222 220a  ing detected""".
-0000d8a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000d8b0: 7365 6c66 2e5f 6973 5f61 7564 696f 5f64  self._is_audio_d
-0000d8c0: 6574 6563 7465 6428 536d 6172 7444 6574  etected(SmartDet
-0000d8d0: 6563 744f 626a 6563 7454 7970 652e 5349  ectObjectType.SI
-0000d8e0: 5245 4e29 0a0a 2020 2020 6173 796e 6320  REN)..    async 
-0000d8f0: 6465 6620 7365 745f 7369 7265 6e5f 6465  def set_siren_de
-0000d900: 7465 6374 696f 6e28 7365 6c66 2c20 656e  tection(self, en
-0000d910: 6162 6c65 643a 2062 6f6f 6c29 202d 3e20  abled: bool) -> 
-0000d920: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-0000d930: 2254 6f67 676c 6573 2073 6972 656e 2073  "Toggles siren s
-0000d940: 6d61 7274 2064 6574 6563 7469 6f6e 2e20  mart detection. 
-0000d950: 5265 7175 6972 6573 2063 616d 6572 6120  Requires camera 
-0000d960: 746f 2068 6176 6520 736d 6172 7420 6465  to have smart de
-0000d970: 7465 6374 696f 6e22 2222 0a0a 2020 2020  tection"""..    
-0000d980: 2020 2020 7265 7475 726e 2061 7761 6974      return await
-0000d990: 2073 656c 662e 5f73 6574 5f61 7564 696f   self._set_audio
-0000d9a0: 5f64 6574 6563 7428 536d 6172 7444 6574  _detect(SmartDet
-0000d9b0: 6563 7441 7564 696f 5479 7065 2e53 4952  ectAudioType.SIR
-0000d9c0: 454e 2c20 656e 6162 6c65 6429 0a0a 2020  EN, enabled)..  
-0000d9d0: 2020 2320 656e 6472 6567 696f 6e0a 2020    # endregion.  
-0000d9e0: 2020 2320 7265 6769 6f6e 2042 6162 7920    # region Baby 
-0000d9f0: 4372 790a 0a20 2020 2040 7072 6f70 6572  Cry..    @proper
-0000da00: 7479 0a20 2020 2064 6566 2063 616e 5f64  ty.    def can_d
-0000da10: 6574 6563 745f 6261 6279 5f63 7279 2873  etect_baby_cry(s
-0000da20: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
-0000da30: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000da40: 662e 5f63 616e 5f64 6574 6563 745f 6175  f._can_detect_au
-0000da50: 6469 6f28 536d 6172 7444 6574 6563 744f  dio(SmartDetectO
-0000da60: 626a 6563 7454 7970 652e 4241 4259 5f43  bjectType.BABY_C
-0000da70: 5259 290a 0a20 2020 2040 7072 6f70 6572  RY)..    @proper
-0000da80: 7479 0a20 2020 2064 6566 2069 735f 6261  ty.    def is_ba
-0000da90: 6279 5f63 7279 5f64 6574 6563 7469 6f6e  by_cry_detection
-0000daa0: 5f6f 6e28 7365 6c66 2920 2d3e 2062 6f6f  _on(self) -> boo
-0000dab0: 6c3a 0a20 2020 2020 2020 2022 2222 4973  l:.        """Is
-0000dac0: 2042 6162 7920 4372 7920 4465 7465 6374   Baby Cry Detect
-0000dad0: 696f 6e20 6176 6169 6c61 626c 6520 616e  ion available an
-0000dae0: 6420 656e 6162 6c65 6420 2863 616d 6572  d enabled (camer
-0000daf0: 6120 7769 6c6c 2070 726f 6475 6365 2062  a will produce b
-0000db00: 6162 7920 6372 7920 736d 6172 740a 2020  aby cry smart.  
-0000db10: 2020 2020 2020 6465 7465 6374 696f 6e20        detection 
-0000db20: 6576 656e 7473 293f 0a20 2020 2020 2020  events)?.       
-0000db30: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
-0000db40: 7475 726e 2073 656c 662e 5f69 735f 6175  turn self._is_au
-0000db50: 6469 6f5f 656e 6162 6c65 6428 536d 6172  dio_enabled(Smar
-0000db60: 7444 6574 6563 744f 626a 6563 7454 7970  tDetectObjectTyp
-0000db70: 652e 4241 4259 5f43 5259 290a 0a20 2020  e.BABY_CRY)..   
-0000db80: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000db90: 6566 206c 6173 745f 6261 6279 5f63 7279  ef last_baby_cry
-0000dba0: 5f64 6574 6563 745f 6576 656e 7428 7365  _detect_event(se
-0000dbb0: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-0000dbc0: 4576 656e 745d 3a0a 2020 2020 2020 2020  Event]:.        
-0000dbd0: 2222 2247 6574 2074 6865 206c 6173 7420  """Get the last 
-0000dbe0: 4261 6279 2043 7279 2073 6d61 7274 2064  Baby Cry smart d
-0000dbf0: 6574 6563 7469 6f6e 2065 7665 6e74 2e22  etection event."
-0000dc00: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
-0000dc10: 726e 2073 656c 662e 6765 745f 6c61 7374  rn self.get_last
-0000dc20: 5f73 6d61 7274 5f61 7564 696f 5f64 6574  _smart_audio_det
-0000dc30: 6563 745f 6576 656e 7428 536d 6172 7444  ect_event(SmartD
-0000dc40: 6574 6563 7441 7564 696f 5479 7065 2e42  etectAudioType.B
-0000dc50: 4142 595f 4352 5929 0a0a 2020 2020 4070  ABY_CRY)..    @p
-0000dc60: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000dc70: 6c61 7374 5f62 6162 795f 6372 795f 6465  last_baby_cry_de
-0000dc80: 7465 6374 2873 656c 6629 202d 3e20 4f70  tect(self) -> Op
-0000dc90: 7469 6f6e 616c 5b64 6174 6574 696d 655d  tional[datetime]
-0000dca0: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
-0000dcb0: 2074 6865 206c 6173 7420 4261 6279 2043   the last Baby C
-0000dcc0: 7279 2073 6d61 7274 2064 6574 6563 7469  ry smart detecti
-0000dcd0: 6f6e 2065 7665 6e74 2e22 2222 0a0a 2020  on event."""..  
-0000dce0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000dcf0: 662e 6c61 7374 5f73 6d61 7274 5f61 7564  f.last_smart_aud
-0000dd00: 696f 5f64 6574 6563 7473 2e67 6574 2853  io_detects.get(S
-0000dd10: 6d61 7274 4465 7465 6374 4175 6469 6f54  martDetectAudioT
-0000dd20: 7970 652e 4241 4259 5f43 5259 290a 0a20  ype.BABY_CRY).. 
-0000dd30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000dd40: 2064 6566 2069 735f 6261 6279 5f63 7279   def is_baby_cry
-0000dd50: 5f63 7572 7265 6e74 6c79 5f64 6574 6563  _currently_detec
-0000dd60: 7465 6428 7365 6c66 2920 2d3e 2062 6f6f  ted(self) -> boo
-0000dd70: 6c3a 0a20 2020 2020 2020 2022 2222 4973  l:.        """Is
-0000dd80: 2042 6162 7920 4372 7920 6375 7272 656e   Baby Cry curren
-0000dd90: 746c 7920 6265 696e 6720 6465 7465 6374  tly being detect
-0000dda0: 6564 2222 220a 0a20 2020 2020 2020 2072  ed"""..        r
-0000ddb0: 6574 7572 6e20 7365 6c66 2e5f 6973 5f61  eturn self._is_a
-0000ddc0: 7564 696f 5f64 6574 6563 7465 6428 536d  udio_detected(Sm
-0000ddd0: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
-0000dde0: 7970 652e 4241 4259 5f43 5259 290a 0a20  ype.BABY_CRY).. 
-0000ddf0: 2020 2061 7379 6e63 2064 6566 2073 6574     async def set
-0000de00: 5f62 6162 795f 6372 795f 6465 7465 6374  _baby_cry_detect
-0000de10: 696f 6e28 7365 6c66 2c20 656e 6162 6c65  ion(self, enable
-0000de20: 643a 2062 6f6f 6c29 202d 3e20 4e6f 6e65  d: bool) -> None
-0000de30: 3a0a 2020 2020 2020 2020 2222 2254 6f67  :.        """Tog
-0000de40: 676c 6573 2062 6162 795f 6372 7920 736d  gles baby_cry sm
-0000de50: 6172 7420 6465 7465 6374 696f 6e2e 2052  art detection. R
-0000de60: 6571 7569 7265 7320 6361 6d65 7261 2074  equires camera t
-0000de70: 6f20 6861 7665 2073 6d61 7274 2064 6574  o have smart det
-0000de80: 6563 7469 6f6e 2222 220a 0a20 2020 2020  ection"""..     
-0000de90: 2020 2072 6574 7572 6e20 6177 6169 7420     return await 
-0000dea0: 7365 6c66 2e5f 7365 745f 6175 6469 6f5f  self._set_audio_
-0000deb0: 6465 7465 6374 2853 6d61 7274 4465 7465  detect(SmartDete
-0000dec0: 6374 4175 6469 6f54 7970 652e 4241 4259  ctAudioType.BABY
-0000ded0: 5f43 5259 2c20 656e 6162 6c65 6429 0a0a  _CRY, enabled)..
-0000dee0: 2020 2020 2320 656e 6472 6567 696f 6e0a      # endregion.
-0000def0: 2020 2020 2320 7265 6769 6f6e 2053 7065      # region Spe
-0000df00: 616b 696e 670a 0a20 2020 2040 7072 6f70  aking..    @prop
-0000df10: 6572 7479 0a20 2020 2064 6566 2063 616e  erty.    def can
-0000df20: 5f64 6574 6563 745f 7370 6561 6b69 6e67  _detect_speaking
-0000df30: 2873 656c 6629 202d 3e20 626f 6f6c 3a0a  (self) -> bool:.
-0000df40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000df50: 656c 662e 5f63 616e 5f64 6574 6563 745f  elf._can_detect_
-0000df60: 6175 6469 6f28 536d 6172 7444 6574 6563  audio(SmartDetec
-0000df70: 744f 626a 6563 7454 7970 652e 5350 4541  tObjectType.SPEA
-0000df80: 4b29 0a0a 2020 2020 4070 726f 7065 7274  K)..    @propert
-0000df90: 790a 2020 2020 6465 6620 6973 5f73 7065  y.    def is_spe
-0000dfa0: 616b 696e 675f 6465 7465 6374 696f 6e5f  aking_detection_
-0000dfb0: 6f6e 2873 656c 6629 202d 3e20 626f 6f6c  on(self) -> bool
-0000dfc0: 3a0a 2020 2020 2020 2020 2222 2249 7320  :.        """Is 
-0000dfd0: 5370 6561 6b69 6e67 2044 6574 6563 7469  Speaking Detecti
-0000dfe0: 6f6e 2061 7661 696c 6162 6c65 2061 6e64  on available and
-0000dff0: 2065 6e61 626c 6564 2028 6361 6d65 7261   enabled (camera
-0000e000: 2077 696c 6c20 7072 6f64 7563 6520 7370   will produce sp
-0000e010: 6561 6b69 6e67 2073 6d61 7274 0a20 2020  eaking smart.   
-0000e020: 2020 2020 2064 6574 6563 7469 6f6e 2065       detection e
-0000e030: 7665 6e74 7329 3f0a 2020 2020 2020 2020  vents)?.        
-0000e040: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-0000e050: 7572 6e20 7365 6c66 2e5f 6973 5f61 7564  urn self._is_aud
-0000e060: 696f 5f65 6e61 626c 6564 2853 6d61 7274  io_enabled(Smart
-0000e070: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
-0000e080: 2e53 5045 414b 290a 0a20 2020 2040 7072  .SPEAK)..    @pr
-0000e090: 6f70 6572 7479 0a20 2020 2064 6566 206c  operty.    def l
-0000e0a0: 6173 745f 7370 6561 6b69 6e67 5f64 6574  ast_speaking_det
-0000e0b0: 6563 745f 6576 656e 7428 7365 6c66 2920  ect_event(self) 
-0000e0c0: 2d3e 204f 7074 696f 6e61 6c5b 4576 656e  -> Optional[Even
-0000e0d0: 745d 3a0a 2020 2020 2020 2020 2222 2247  t]:.        """G
-0000e0e0: 6574 2074 6865 206c 6173 7420 5370 6561  et the last Spea
-0000e0f0: 6b69 6e67 2073 6d61 7274 2064 6574 6563  king smart detec
-0000e100: 7469 6f6e 2065 7665 6e74 2e22 2222 0a0a  tion event."""..
-0000e110: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000e120: 656c 662e 6765 745f 6c61 7374 5f73 6d61  elf.get_last_sma
-0000e130: 7274 5f61 7564 696f 5f64 6574 6563 745f  rt_audio_detect_
-0000e140: 6576 656e 7428 536d 6172 7444 6574 6563  event(SmartDetec
-0000e150: 7441 7564 696f 5479 7065 2e53 5045 414b  tAudioType.SPEAK
-0000e160: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000e170: 0a20 2020 2064 6566 206c 6173 745f 7370  .    def last_sp
-0000e180: 6561 6b69 6e67 5f64 6574 6563 7428 7365  eaking_detect(se
-0000e190: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-0000e1a0: 6461 7465 7469 6d65 5d3a 0a20 2020 2020  datetime]:.     
-0000e1b0: 2020 2022 2222 4765 7420 7468 6520 6c61     """Get the la
-0000e1c0: 7374 2053 7065 616b 696e 6720 736d 6172  st Speaking smar
-0000e1d0: 7420 6465 7465 6374 696f 6e20 6576 656e  t detection even
-0000e1e0: 742e 2222 220a 0a20 2020 2020 2020 2072  t."""..        r
-0000e1f0: 6574 7572 6e20 7365 6c66 2e6c 6173 745f  eturn self.last_
-0000e200: 736d 6172 745f 6175 6469 6f5f 6465 7465  smart_audio_dete
-0000e210: 6374 732e 6765 7428 536d 6172 7444 6574  cts.get(SmartDet
-0000e220: 6563 7441 7564 696f 5479 7065 2e53 5045  ectAudioType.SPE
-0000e230: 414b 290a 0a20 2020 2040 7072 6f70 6572  AK)..    @proper
-0000e240: 7479 0a20 2020 2064 6566 2069 735f 7370  ty.    def is_sp
-0000e250: 6561 6b69 6e67 5f63 7572 7265 6e74 6c79  eaking_currently
-0000e260: 5f64 6574 6563 7465 6428 7365 6c66 2920  _detected(self) 
-0000e270: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-0000e280: 2022 2222 4973 2053 7065 616b 696e 6720   """Is Speaking 
-0000e290: 6375 7272 656e 746c 7920 6265 696e 6720  currently being 
-0000e2a0: 6465 7465 6374 6564 2222 220a 0a20 2020  detected"""..   
-0000e2b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000e2c0: 2e5f 6973 5f61 7564 696f 5f64 6574 6563  ._is_audio_detec
-0000e2d0: 7465 6428 536d 6172 7444 6574 6563 744f  ted(SmartDetectO
-0000e2e0: 626a 6563 7454 7970 652e 5350 4541 4b29  bjectType.SPEAK)
-0000e2f0: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-0000e300: 7365 745f 7370 6561 6b69 6e67 5f64 6574  set_speaking_det
-0000e310: 6563 7469 6f6e 2873 656c 662c 2065 6e61  ection(self, ena
-0000e320: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
-0000e330: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-0000e340: 546f 6767 6c65 7320 7370 6561 6b69 6e67  Toggles speaking
-0000e350: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
-0000e360: 2e20 5265 7175 6972 6573 2063 616d 6572  . Requires camer
-0000e370: 6120 746f 2068 6176 6520 736d 6172 7420  a to have smart 
-0000e380: 6465 7465 6374 696f 6e22 2222 0a0a 2020  detection"""..  
-0000e390: 2020 2020 2020 7265 7475 726e 2061 7761        return awa
-0000e3a0: 6974 2073 656c 662e 5f73 6574 5f61 7564  it self._set_aud
-0000e3b0: 696f 5f64 6574 6563 7428 536d 6172 7444  io_detect(SmartD
-0000e3c0: 6574 6563 7441 7564 696f 5479 7065 2e53  etectAudioType.S
-0000e3d0: 5045 414b 2c20 656e 6162 6c65 6429 0a0a  PEAK, enabled)..
-0000e3e0: 2020 2020 2320 656e 6472 6567 696f 6e0a      # endregion.
-0000e3f0: 2020 2020 2320 7265 6769 6f6e 2042 6172      # region Bar
-0000e400: 6b0a 0a20 2020 2040 7072 6f70 6572 7479  k..    @property
-0000e410: 0a20 2020 2064 6566 2063 616e 5f64 6574  .    def can_det
-0000e420: 6563 745f 6261 726b 2873 656c 6629 202d  ect_bark(self) -
-0000e430: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000e440: 7265 7475 726e 2073 656c 662e 5f63 616e  return self._can
-0000e450: 5f64 6574 6563 745f 6175 6469 6f28 536d  _detect_audio(Sm
-0000e460: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
-0000e470: 7970 652e 4241 524b 290a 0a20 2020 2040  ype.BARK)..    @
-0000e480: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000e490: 2069 735f 6261 726b 5f64 6574 6563 7469   is_bark_detecti
-0000e4a0: 6f6e 5f6f 6e28 7365 6c66 2920 2d3e 2062  on_on(self) -> b
-0000e4b0: 6f6f 6c3a 0a20 2020 2020 2020 2022 2222  ool:.        """
-0000e4c0: 4973 2042 6172 6b20 4465 7465 6374 696f  Is Bark Detectio
-0000e4d0: 6e20 6176 6169 6c61 626c 6520 616e 6420  n available and 
-0000e4e0: 656e 6162 6c65 6420 2863 616d 6572 6120  enabled (camera 
-0000e4f0: 7769 6c6c 2070 726f 6475 6365 2062 6172  will produce bar
-0000e500: 6b69 6e67 2073 6d61 7274 0a20 2020 2020  king smart.     
-0000e510: 2020 2064 6574 6563 7469 6f6e 2065 7665     detection eve
-0000e520: 6e74 7329 3f0a 2020 2020 2020 2020 2222  nts)?.        ""
-0000e530: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-0000e540: 6e20 7365 6c66 2e5f 6973 5f61 7564 696f  n self._is_audio
-0000e550: 5f65 6e61 626c 6564 2853 6d61 7274 4465  _enabled(SmartDe
-0000e560: 7465 6374 4f62 6a65 6374 5479 7065 2e42  tectObjectType.B
-0000e570: 4152 4b29 0a0a 2020 2020 4070 726f 7065  ARK)..    @prope
-0000e580: 7274 790a 2020 2020 6465 6620 6c61 7374  rty.    def last
-0000e590: 5f62 6172 6b5f 6465 7465 6374 5f65 7665  _bark_detect_eve
-0000e5a0: 6e74 2873 656c 6629 202d 3e20 4f70 7469  nt(self) -> Opti
-0000e5b0: 6f6e 616c 5b45 7665 6e74 5d3a 0a20 2020  onal[Event]:.   
-0000e5c0: 2020 2020 2022 2222 4765 7420 7468 6520       """Get the 
-0000e5d0: 6c61 7374 2042 6172 6b20 736d 6172 7420  last Bark smart 
-0000e5e0: 6465 7465 6374 696f 6e20 6576 656e 742e  detection event.
-0000e5f0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-0000e600: 7572 6e20 7365 6c66 2e67 6574 5f6c 6173  urn self.get_las
-0000e610: 745f 736d 6172 745f 6175 6469 6f5f 6465  t_smart_audio_de
-0000e620: 7465 6374 5f65 7665 6e74 2853 6d61 7274  tect_event(Smart
-0000e630: 4465 7465 6374 4175 6469 6f54 7970 652e  DetectAudioType.
-0000e640: 4241 524b 290a 0a20 2020 2040 7072 6f70  BARK)..    @prop
-0000e650: 6572 7479 0a20 2020 2064 6566 206c 6173  erty.    def las
-0000e660: 745f 6261 726b 5f64 6574 6563 7428 7365  t_bark_detect(se
-0000e670: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-0000e680: 6461 7465 7469 6d65 5d3a 0a20 2020 2020  datetime]:.     
-0000e690: 2020 2022 2222 4765 7420 7468 6520 6c61     """Get the la
-0000e6a0: 7374 2042 6172 6b20 736d 6172 7420 6465  st Bark smart de
-0000e6b0: 7465 6374 696f 6e20 6576 656e 742e 2222  tection event.""
-0000e6c0: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-0000e6d0: 6e20 7365 6c66 2e6c 6173 745f 736d 6172  n self.last_smar
-0000e6e0: 745f 6175 6469 6f5f 6465 7465 6374 732e  t_audio_detects.
-0000e6f0: 6765 7428 536d 6172 7444 6574 6563 7441  get(SmartDetectA
-0000e700: 7564 696f 5479 7065 2e42 4152 4b29 0a0a  udioType.BARK)..
-0000e710: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000e720: 2020 6465 6620 6973 5f62 6172 6b5f 6375    def is_bark_cu
-0000e730: 7272 656e 746c 795f 6465 7465 6374 6564  rrently_detected
-0000e740: 2873 656c 6629 202d 3e20 626f 6f6c 3a0a  (self) -> bool:.
-0000e750: 2020 2020 2020 2020 2222 2249 7320 4261          """Is Ba
-0000e760: 726b 2063 7572 7265 6e74 6c79 2062 6569  rk currently bei
-0000e770: 6e67 2064 6574 6563 7465 6422 2222 0a0a  ng detected"""..
-0000e780: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000e790: 656c 662e 5f69 735f 6175 6469 6f5f 6465  elf._is_audio_de
-0000e7a0: 7465 6374 6564 2853 6d61 7274 4465 7465  tected(SmartDete
-0000e7b0: 6374 4f62 6a65 6374 5479 7065 2e42 4152  ctObjectType.BAR
-0000e7c0: 4b29 0a0a 2020 2020 6173 796e 6320 6465  K)..    async de
-0000e7d0: 6620 7365 745f 6261 726b 5f64 6574 6563  f set_bark_detec
-0000e7e0: 7469 6f6e 2873 656c 662c 2065 6e61 626c  tion(self, enabl
-0000e7f0: 6564 3a20 626f 6f6c 2920 2d3e 204e 6f6e  ed: bool) -> Non
-0000e800: 653a 0a20 2020 2020 2020 2022 2222 546f  e:.        """To
-0000e810: 6767 6c65 7320 6261 726b 2073 6d61 7274  ggles bark smart
-0000e820: 2064 6574 6563 7469 6f6e 2e20 5265 7175   detection. Requ
-0000e830: 6972 6573 2063 616d 6572 6120 746f 2068  ires camera to h
-0000e840: 6176 6520 736d 6172 7420 6465 7465 6374  ave smart detect
-0000e850: 696f 6e22 2222 0a0a 2020 2020 2020 2020  ion"""..        
-0000e860: 7265 7475 726e 2061 7761 6974 2073 656c  return await sel
-0000e870: 662e 5f73 6574 5f61 7564 696f 5f64 6574  f._set_audio_det
-0000e880: 6563 7428 536d 6172 7444 6574 6563 7441  ect(SmartDetectA
-0000e890: 7564 696f 5479 7065 2e42 4152 4b2c 2065  udioType.BARK, e
-0000e8a0: 6e61 626c 6564 290a 0a20 2020 2023 2065  nabled)..    # e
-0000e8b0: 6e64 7265 6769 6f6e 0a20 2020 2023 2072  ndregion.    # r
-0000e8c0: 6567 696f 6e20 4361 7220 416c 6172 6d0a  egion Car Alarm.
-0000e8d0: 2020 2020 2320 2862 7572 676c 6172 2069      # (burglar i
-0000e8e0: 6e20 636f 6465 2c20 6361 7220 616c 6172  n code, car alar
-0000e8f0: 6d20 696e 2050 726f 7465 6374 2055 4929  m in Protect UI)
-0000e900: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000e910: 2020 2020 6465 6620 6361 6e5f 6465 7465      def can_dete
-0000e920: 6374 5f63 6172 5f61 6c61 726d 2873 656c  ct_car_alarm(sel
-0000e930: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-0000e940: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000e950: 5f63 616e 5f64 6574 6563 745f 6175 6469  _can_detect_audi
-0000e960: 6f28 536d 6172 7444 6574 6563 744f 626a  o(SmartDetectObj
-0000e970: 6563 7454 7970 652e 4255 5247 4c41 5229  ectType.BURGLAR)
-0000e980: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000e990: 2020 2020 6465 6620 6973 5f63 6172 5f61      def is_car_a
-0000e9a0: 6c61 726d 5f64 6574 6563 7469 6f6e 5f6f  larm_detection_o
-0000e9b0: 6e28 7365 6c66 2920 2d3e 2062 6f6f 6c3a  n(self) -> bool:
-0000e9c0: 0a20 2020 2020 2020 2022 2222 4973 2043  .        """Is C
-0000e9d0: 6172 2041 6c61 726d 2044 6574 6563 7469  ar Alarm Detecti
-0000e9e0: 6f6e 2061 7661 696c 6162 6c65 2061 6e64  on available and
-0000e9f0: 2065 6e61 626c 6564 2028 6361 6d65 7261   enabled (camera
-0000ea00: 2077 696c 6c20 7072 6f64 7563 6520 6361   will produce ca
-0000ea10: 7220 616c 6172 6d20 736d 6172 740a 2020  r alarm smart.  
-0000ea20: 2020 2020 2020 6465 7465 6374 696f 6e20        detection 
-0000ea30: 6576 656e 7473 293f 0a20 2020 2020 2020  events)?.       
-0000ea40: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
-0000ea50: 7475 726e 2073 656c 662e 5f69 735f 6175  turn self._is_au
-0000ea60: 6469 6f5f 656e 6162 6c65 6428 536d 6172  dio_enabled(Smar
-0000ea70: 7444 6574 6563 744f 626a 6563 7454 7970  tDetectObjectTyp
-0000ea80: 652e 4255 5247 4c41 5229 0a0a 2020 2020  e.BURGLAR)..    
-0000ea90: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000eaa0: 6620 6c61 7374 5f63 6172 5f61 6c61 726d  f last_car_alarm
-0000eab0: 5f64 6574 6563 745f 6576 656e 7428 7365  _detect_event(se
-0000eac0: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-0000ead0: 4576 656e 745d 3a0a 2020 2020 2020 2020  Event]:.        
-0000eae0: 2222 2247 6574 2074 6865 206c 6173 7420  """Get the last 
-0000eaf0: 4361 7220 416c 6172 6d20 736d 6172 7420  Car Alarm smart 
-0000eb00: 6465 7465 6374 696f 6e20 6576 656e 742e  detection event.
-0000eb10: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-0000eb20: 7572 6e20 7365 6c66 2e67 6574 5f6c 6173  urn self.get_las
-0000eb30: 745f 736d 6172 745f 6175 6469 6f5f 6465  t_smart_audio_de
-0000eb40: 7465 6374 5f65 7665 6e74 2853 6d61 7274  tect_event(Smart
-0000eb50: 4465 7465 6374 4175 6469 6f54 7970 652e  DetectAudioType.
-0000eb60: 4255 5247 4c41 5229 0a0a 2020 2020 4070  BURGLAR)..    @p
-0000eb70: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000eb80: 6c61 7374 5f63 6172 5f61 6c61 726d 5f64  last_car_alarm_d
-0000eb90: 6574 6563 7428 7365 6c66 2920 2d3e 204f  etect(self) -> O
-0000eba0: 7074 696f 6e61 6c5b 6461 7465 7469 6d65  ptional[datetime
-0000ebb0: 5d3a 0a20 2020 2020 2020 2022 2222 4765  ]:.        """Ge
-0000ebc0: 7420 7468 6520 6c61 7374 2043 6172 2041  t the last Car A
-0000ebd0: 6c61 726d 2073 6d61 7274 2064 6574 6563  larm smart detec
-0000ebe0: 7469 6f6e 2065 7665 6e74 2e22 2222 0a0a  tion event."""..
-0000ebf0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000ec00: 656c 662e 6c61 7374 5f73 6d61 7274 5f61  elf.last_smart_a
-0000ec10: 7564 696f 5f64 6574 6563 7473 2e67 6574  udio_detects.get
-0000ec20: 2853 6d61 7274 4465 7465 6374 4175 6469  (SmartDetectAudi
-0000ec30: 6f54 7970 652e 4255 5247 4c41 5229 0a0a  oType.BURGLAR)..
-0000ec40: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000ec50: 2020 6465 6620 6973 5f63 6172 5f61 6c61    def is_car_ala
-0000ec60: 726d 5f63 7572 7265 6e74 6c79 5f64 6574  rm_currently_det
-0000ec70: 6563 7465 6428 7365 6c66 2920 2d3e 2062  ected(self) -> b
-0000ec80: 6f6f 6c3a 0a20 2020 2020 2020 2022 2222  ool:.        """
-0000ec90: 4973 2043 6172 2041 6c61 726d 2063 7572  Is Car Alarm cur
-0000eca0: 7265 6e74 6c79 2062 6569 6e67 2064 6574  rently being det
-0000ecb0: 6563 7465 6422 2222 0a0a 2020 2020 2020  ected"""..      
-0000ecc0: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
-0000ecd0: 735f 6175 6469 6f5f 6465 7465 6374 6564  s_audio_detected
-0000ece0: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000ecf0: 6374 5479 7065 2e42 5552 474c 4152 290a  ctType.BURGLAR).
-0000ed00: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
-0000ed10: 6574 5f63 6172 5f61 6c61 726d 5f64 6574  et_car_alarm_det
-0000ed20: 6563 7469 6f6e 2873 656c 662c 2065 6e61  ection(self, ena
-0000ed30: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
-0000ed40: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-0000ed50: 546f 6767 6c65 7320 6361 725f 616c 6172  Toggles car_alar
-0000ed60: 6d20 736d 6172 7420 6465 7465 6374 696f  m smart detectio
-0000ed70: 6e2e 2052 6571 7569 7265 7320 6361 6d65  n. Requires came
-0000ed80: 7261 2074 6f20 6861 7665 2073 6d61 7274  ra to have smart
-0000ed90: 2064 6574 6563 7469 6f6e 2222 220a 0a20   detection""".. 
-0000eda0: 2020 2020 2020 2072 6574 7572 6e20 6177         return aw
-0000edb0: 6169 7420 7365 6c66 2e5f 7365 745f 6175  ait self._set_au
-0000edc0: 6469 6f5f 6465 7465 6374 2853 6d61 7274  dio_detect(Smart
-0000edd0: 4465 7465 6374 4175 6469 6f54 7970 652e  DetectAudioType.
-0000ede0: 4255 5247 4c41 522c 2065 6e61 626c 6564  BURGLAR, enabled
-0000edf0: 290a 0a20 2020 2023 2065 6e64 7265 6769  )..    # endregi
-0000ee00: 6f6e 0a20 2020 2023 2072 6567 696f 6e20  on.    # region 
-0000ee10: 4361 7220 486f 726e 0a0a 2020 2020 4070  Car Horn..    @p
-0000ee20: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000ee30: 6361 6e5f 6465 7465 6374 5f63 6172 5f68  can_detect_car_h
-0000ee40: 6f72 6e28 7365 6c66 2920 2d3e 2062 6f6f  orn(self) -> boo
-0000ee50: 6c3a 0a20 2020 2020 2020 2072 6574 7572  l:.        retur
-0000ee60: 6e20 7365 6c66 2e5f 6361 6e5f 6465 7465  n self._can_dete
-0000ee70: 6374 5f61 7564 696f 2853 6d61 7274 4465  ct_audio(SmartDe
-0000ee80: 7465 6374 4f62 6a65 6374 5479 7065 2e43  tectObjectType.C
-0000ee90: 4152 5f48 4f52 4e29 0a0a 2020 2020 4070  AR_HORN)..    @p
-0000eea0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000eeb0: 6973 5f63 6172 5f68 6f72 6e5f 6465 7465  is_car_horn_dete
-0000eec0: 6374 696f 6e5f 6f6e 2873 656c 6629 202d  ction_on(self) -
-0000eed0: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000eee0: 2222 2249 7320 4361 7220 486f 726e 2044  """Is Car Horn D
-0000eef0: 6574 6563 7469 6f6e 2061 7661 696c 6162  etection availab
-0000ef00: 6c65 2061 6e64 2065 6e61 626c 6564 2028  le and enabled (
-0000ef10: 6361 6d65 7261 2077 696c 6c20 7072 6f64  camera will prod
-0000ef20: 7563 6520 6361 7220 686f 726e 2073 6d61  uce car horn sma
-0000ef30: 7274 0a20 2020 2020 2020 2064 6574 6563  rt.        detec
-0000ef40: 7469 6f6e 2065 7665 6e74 7329 3f0a 2020  tion events)?.  
-0000ef50: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000ef60: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000ef70: 6973 5f61 7564 696f 5f65 6e61 626c 6564  is_audio_enabled
-0000ef80: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000ef90: 6374 5479 7065 2e43 4152 5f48 4f52 4e29  ctType.CAR_HORN)
-0000efa0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000efb0: 2020 2020 6465 6620 6c61 7374 5f63 6172      def last_car
-0000efc0: 5f68 6f72 6e5f 6465 7465 6374 5f65 7665  _horn_detect_eve
-0000efd0: 6e74 2873 656c 6629 202d 3e20 4f70 7469  nt(self) -> Opti
-0000efe0: 6f6e 616c 5b45 7665 6e74 5d3a 0a20 2020  onal[Event]:.   
-0000eff0: 2020 2020 2022 2222 4765 7420 7468 6520       """Get the 
-0000f000: 6c61 7374 2043 6172 2048 6f72 6e20 736d  last Car Horn sm
-0000f010: 6172 7420 6465 7465 6374 696f 6e20 6576  art detection ev
-0000f020: 656e 742e 2222 220a 0a20 2020 2020 2020  ent."""..       
-0000f030: 2072 6574 7572 6e20 7365 6c66 2e67 6574   return self.get
-0000f040: 5f6c 6173 745f 736d 6172 745f 6175 6469  _last_smart_audi
-0000f050: 6f5f 6465 7465 6374 5f65 7665 6e74 2853  o_detect_event(S
-0000f060: 6d61 7274 4465 7465 6374 4175 6469 6f54  martDetectAudioT
-0000f070: 7970 652e 4341 525f 484f 524e 290a 0a20  ype.CAR_HORN).. 
-0000f080: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000f090: 2064 6566 206c 6173 745f 6361 725f 686f   def last_car_ho
-0000f0a0: 726e 5f64 6574 6563 7428 7365 6c66 2920  rn_detect(self) 
-0000f0b0: 2d3e 204f 7074 696f 6e61 6c5b 6461 7465  -> Optional[date
-0000f0c0: 7469 6d65 5d3a 0a20 2020 2020 2020 2022  time]:.        "
-0000f0d0: 2222 4765 7420 7468 6520 6c61 7374 2043  ""Get the last C
-0000f0e0: 6172 2048 6f72 6e20 736d 6172 7420 6465  ar Horn smart de
-0000f0f0: 7465 6374 696f 6e20 6576 656e 742e 2222  tection event.""
-0000f100: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-0000f110: 6e20 7365 6c66 2e6c 6173 745f 736d 6172  n self.last_smar
-0000f120: 745f 6175 6469 6f5f 6465 7465 6374 732e  t_audio_detects.
-0000f130: 6765 7428 536d 6172 7444 6574 6563 7441  get(SmartDetectA
-0000f140: 7564 696f 5479 7065 2e43 4152 5f48 4f52  udioType.CAR_HOR
-0000f150: 4e29 0a0a 2020 2020 4070 726f 7065 7274  N)..    @propert
-0000f160: 790a 2020 2020 6465 6620 6973 5f63 6172  y.    def is_car
-0000f170: 5f68 6f72 6e5f 6375 7272 656e 746c 795f  _horn_currently_
-0000f180: 6465 7465 6374 6564 2873 656c 6629 202d  detected(self) -
-0000f190: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000f1a0: 2222 2249 7320 4361 7220 486f 726e 2063  """Is Car Horn c
-0000f1b0: 7572 7265 6e74 6c79 2062 6569 6e67 2064  urrently being d
-0000f1c0: 6574 6563 7465 6422 2222 0a0a 2020 2020  etected"""..    
-0000f1d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000f1e0: 5f69 735f 6175 6469 6f5f 6465 7465 6374  _is_audio_detect
-0000f1f0: 6564 2853 6d61 7274 4465 7465 6374 4f62  ed(SmartDetectOb
-0000f200: 6a65 6374 5479 7065 2e43 4152 5f48 4f52  jectType.CAR_HOR
-0000f210: 4e29 0a0a 2020 2020 6173 796e 6320 6465  N)..    async de
-0000f220: 6620 7365 745f 6361 725f 686f 726e 5f64  f set_car_horn_d
-0000f230: 6574 6563 7469 6f6e 2873 656c 662c 2065  etection(self, e
-0000f240: 6e61 626c 6564 3a20 626f 6f6c 2920 2d3e  nabled: bool) ->
-0000f250: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-0000f260: 2222 546f 6767 6c65 7320 6361 725f 686f  ""Toggles car_ho
-0000f270: 726e 2073 6d61 7274 2064 6574 6563 7469  rn smart detecti
-0000f280: 6f6e 2e20 5265 7175 6972 6573 2063 616d  on. Requires cam
-0000f290: 6572 6120 746f 2068 6176 6520 736d 6172  era to have smar
-0000f2a0: 7420 6465 7465 6374 696f 6e22 2222 0a0a  t detection"""..
-0000f2b0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-0000f2c0: 7761 6974 2073 656c 662e 5f73 6574 5f61  wait self._set_a
-0000f2d0: 7564 696f 5f64 6574 6563 7428 536d 6172  udio_detect(Smar
-0000f2e0: 7444 6574 6563 7441 7564 696f 5479 7065  tDetectAudioType
-0000f2f0: 2e43 4152 5f48 4f52 4e2c 2065 6e61 626c  .CAR_HORN, enabl
-0000f300: 6564 290a 0a20 2020 2023 2065 6e64 7265  ed)..    # endre
-0000f310: 6769 6f6e 0a20 2020 2023 2072 6567 696f  gion.    # regio
-0000f320: 6e20 476c 6173 7320 4272 6561 6b0a 0a20  n Glass Break.. 
-0000f330: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000f340: 2064 6566 2063 616e 5f64 6574 6563 745f   def can_detect_
-0000f350: 676c 6173 735f 6272 6561 6b28 7365 6c66  glass_break(self
-0000f360: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
-0000f370: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000f380: 6361 6e5f 6465 7465 6374 5f61 7564 696f  can_detect_audio
-0000f390: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
-0000f3a0: 6374 5479 7065 2e47 4c41 5353 5f42 5245  ctType.GLASS_BRE
-0000f3b0: 414b 290a 0a20 2020 2040 7072 6f70 6572  AK)..    @proper
-0000f3c0: 7479 0a20 2020 2064 6566 2069 735f 676c  ty.    def is_gl
-0000f3d0: 6173 735f 6272 6561 6b5f 6465 7465 6374  ass_break_detect
-0000f3e0: 696f 6e5f 6f6e 2873 656c 6629 202d 3e20  ion_on(self) -> 
-0000f3f0: 626f 6f6c 3a0a 2020 2020 2020 2020 2222  bool:.        ""
-0000f400: 2249 7320 476c 6173 7320 4272 6561 6b20  "Is Glass Break 
-0000f410: 6176 6169 6c61 626c 6520 616e 6420 656e  available and en
-0000f420: 6162 6c65 6420 2863 616d 6572 6120 7769  abled (camera wi
-0000f430: 6c6c 2070 726f 6475 6365 2067 6c61 7373  ll produce glass
-0000f440: 2062 7265 616b 2073 6d61 7274 0a20 2020   break smart.   
-0000f450: 2020 2020 2064 6574 6563 7469 6f6e 2065       detection e
-0000f460: 7665 6e74 7329 3f0a 2020 2020 2020 2020  vents)?.        
-0000f470: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
-0000f480: 7572 6e20 7365 6c66 2e5f 6973 5f61 7564  urn self._is_aud
-0000f490: 696f 5f65 6e61 626c 6564 2853 6d61 7274  io_enabled(Smart
-0000f4a0: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
-0000f4b0: 2e47 4c41 5353 5f42 5245 414b 290a 0a20  .GLASS_BREAK).. 
-0000f4c0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000f4d0: 2064 6566 206c 6173 745f 676c 6173 735f   def last_glass_
-0000f4e0: 6272 6561 6b5f 6465 7465 6374 5f65 7665  break_detect_eve
-0000f4f0: 6e74 2873 656c 6629 202d 3e20 4f70 7469  nt(self) -> Opti
-0000f500: 6f6e 616c 5b45 7665 6e74 5d3a 0a20 2020  onal[Event]:.   
-0000f510: 2020 2020 2022 2222 4765 7420 7468 6520       """Get the 
-0000f520: 6c61 7374 2047 6c61 7373 2042 7265 616b  last Glass Break
-0000f530: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
-0000f540: 2065 7665 6e74 2e22 2222 0a0a 2020 2020   event."""..    
-0000f550: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000f560: 6765 745f 6c61 7374 5f73 6d61 7274 5f61  get_last_smart_a
-0000f570: 7564 696f 5f64 6574 6563 745f 6576 656e  udio_detect_even
-0000f580: 7428 536d 6172 7444 6574 6563 7441 7564  t(SmartDetectAud
-0000f590: 696f 5479 7065 2e47 4c41 5353 5f42 5245  ioType.GLASS_BRE
-0000f5a0: 414b 290a 0a20 2020 2040 7072 6f70 6572  AK)..    @proper
-0000f5b0: 7479 0a20 2020 2064 6566 206c 6173 745f  ty.    def last_
-0000f5c0: 676c 6173 735f 6272 6561 6b5f 6465 7465  glass_break_dete
-0000f5d0: 6374 2873 656c 6629 202d 3e20 4f70 7469  ct(self) -> Opti
-0000f5e0: 6f6e 616c 5b64 6174 6574 696d 655d 3a0a  onal[datetime]:.
-0000f5f0: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
-0000f600: 6865 206c 6173 7420 476c 6173 7320 4272  he last Glass Br
-0000f610: 6561 6b20 736d 6172 7420 6465 7465 6374  eak smart detect
-0000f620: 696f 6e20 6576 656e 742e 2222 220a 0a20  ion event.""".. 
-0000f630: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000f640: 6c66 2e6c 6173 745f 736d 6172 745f 6175  lf.last_smart_au
-0000f650: 6469 6f5f 6465 7465 6374 732e 6765 7428  dio_detects.get(
-0000f660: 536d 6172 7444 6574 6563 7441 7564 696f  SmartDetectAudio
-0000f670: 5479 7065 2e47 4c41 5353 5f42 5245 414b  Type.GLASS_BREAK
-0000f680: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000f690: 0a20 2020 2064 6566 2069 735f 676c 6173  .    def is_glas
-0000f6a0: 735f 6272 6561 6b5f 6375 7272 656e 746c  s_break_currentl
-0000f6b0: 795f 6465 7465 6374 6564 2873 656c 6629  y_detected(self)
-0000f6c0: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
-0000f6d0: 2020 2222 2249 7320 476c 6173 7320 4272    """Is Glass Br
-0000f6e0: 6561 6b20 6375 7272 656e 746c 7920 6265  eak currently be
-0000f6f0: 696e 6720 6465 7465 6374 6564 2222 220a  ing detected""".
-0000f700: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000f710: 7365 6c66 2e5f 6973 5f61 7564 696f 5f64  self._is_audio_d
-0000f720: 6574 6563 7465 6428 536d 6172 7444 6574  etected(SmartDet
-0000f730: 6563 744f 626a 6563 7454 7970 652e 474c  ectObjectType.GL
-0000f740: 4153 535f 4252 4541 4b29 0a0a 2020 2020  ASS_BREAK)..    
-0000f750: 6173 796e 6320 6465 6620 7365 745f 676c  async def set_gl
-0000f760: 6173 735f 6272 6561 6b5f 6465 7465 6374  ass_break_detect
-0000f770: 696f 6e28 7365 6c66 2c20 656e 6162 6c65  ion(self, enable
-0000f780: 643a 2062 6f6f 6c29 202d 3e20 4e6f 6e65  d: bool) -> None
-0000f790: 3a0a 2020 2020 2020 2020 2222 2254 6f67  :.        """Tog
-0000f7a0: 676c 6573 2067 6c61 7373 5f62 7265 616b  gles glass_break
-0000f7b0: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
-0000f7c0: 2e20 5265 7175 6972 6573 2063 616d 6572  . Requires camer
-0000f7d0: 6120 746f 2068 6176 6520 736d 6172 7420  a to have smart 
-0000f7e0: 6465 7465 6374 696f 6e22 2222 0a0a 2020  detection"""..  
-0000f7f0: 2020 2020 2020 7265 7475 726e 2061 7761        return awa
-0000f800: 6974 2073 656c 662e 5f73 6574 5f61 7564  it self._set_aud
-0000f810: 696f 5f64 6574 6563 7428 536d 6172 7444  io_detect(SmartD
-0000f820: 6574 6563 7441 7564 696f 5479 7065 2e47  etectAudioType.G
-0000f830: 4c41 5353 5f42 5245 414b 2c20 656e 6162  LASS_BREAK, enab
-0000f840: 6c65 6429 0a0a 2020 2020 2320 656e 6472  led)..    # endr
-0000f850: 6567 696f 6e0a 2020 2020 2320 656e 6472  egion.    # endr
-0000f860: 6567 696f 6e0a 0a20 2020 2040 7072 6f70  egion..    @prop
-0000f870: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
-0000f880: 7269 6e67 696e 6728 7365 6c66 2920 2d3e  ringing(self) ->
-0000f890: 2062 6f6f 6c3a 0a20 2020 2020 2020 2069   bool:.        i
-0000f8a0: 6620 7365 6c66 2e5f 6c61 7374 5f72 696e  f self._last_rin
-0000f8b0: 675f 7469 6d65 6f75 7420 6973 204e 6f6e  g_timeout is Non
-0000f8c0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000f8d0: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
-0000f8e0: 2020 2020 7265 7475 726e 2075 7463 5f6e      return utc_n
-0000f8f0: 6f77 2829 203c 2073 656c 662e 5f6c 6173  ow() < self._las
-0000f900: 745f 7269 6e67 5f74 696d 656f 7574 0a0a  t_ring_timeout..
-0000f910: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000f920: 2020 6465 6620 6368 696d 655f 7479 7065    def chime_type
-0000f930: 2873 656c 6629 202d 3e20 4368 696d 6554  (self) -> ChimeT
-0000f940: 7970 653a 0a20 2020 2020 2020 2069 6620  ype:.        if 
-0000f950: 7365 6c66 2e63 6869 6d65 5f64 7572 6174  self.chime_durat
-0000f960: 696f 6e2e 746f 7461 6c5f 7365 636f 6e64  ion.total_second
-0000f970: 7328 2920 3d3d 2030 2e33 3a0a 2020 2020  s() == 0.3:.    
-0000f980: 2020 2020 2020 2020 7265 7475 726e 2043          return C
-0000f990: 6869 6d65 5479 7065 2e4d 4543 4841 4e49  himeType.MECHANI
-0000f9a0: 4341 4c0a 2020 2020 2020 2020 6966 2073  CAL.        if s
-0000f9b0: 656c 662e 6368 696d 655f 6475 7261 7469  elf.chime_durati
-0000f9c0: 6f6e 2e74 6f74 616c 5f73 6563 6f6e 6473  on.total_seconds
-0000f9d0: 2829 203e 2030 2e33 3a0a 2020 2020 2020  () > 0.3:.      
-0000f9e0: 2020 2020 2020 7265 7475 726e 2043 6869        return Chi
-0000f9f0: 6d65 5479 7065 2e44 4947 4954 414c 0a20  meType.DIGITAL. 
-0000fa00: 2020 2020 2020 2072 6574 7572 6e20 4368         return Ch
-0000fa10: 696d 6554 7970 652e 4e4f 4e45 0a0a 2020  imeType.NONE..  
-0000fa20: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000fa30: 6465 6620 6973 5f64 6967 6974 616c 5f63  def is_digital_c
-0000fa40: 6869 6d65 2873 656c 6629 202d 3e20 626f  hime(self) -> bo
-0000fa50: 6f6c 3a0a 2020 2020 2020 2020 7265 7475  ol:.        retu
-0000fa60: 726e 2073 656c 662e 6368 696d 655f 7479  rn self.chime_ty
-0000fa70: 7065 2069 7320 4368 696d 6554 7970 652e  pe is ChimeType.
-0000fa80: 4449 4749 5441 4c0a 0a20 2020 2040 7072  DIGITAL..    @pr
-0000fa90: 6f70 6572 7479 0a20 2020 2064 6566 2068  operty.    def h
-0000faa0: 6967 685f 6361 6d65 7261 5f63 6861 6e6e  igh_camera_chann
-0000fab0: 656c 2873 656c 6629 202d 3e20 4f70 7469  el(self) -> Opti
-0000fac0: 6f6e 616c 5b43 616d 6572 6143 6861 6e6e  onal[CameraChann
-0000fad0: 656c 5d3a 0a20 2020 2020 2020 2069 6620  el]:.        if 
-0000fae0: 6c65 6e28 7365 6c66 2e63 6861 6e6e 656c  len(self.channel
-0000faf0: 7329 203e 3d20 333a 0a20 2020 2020 2020  s) >= 3:.       
-0000fb00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000fb10: 2e63 6861 6e6e 656c 735b 305d 0a20 2020  .channels[0].   
-0000fb20: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-0000fb30: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000fb40: 2020 2020 6465 6620 6d65 6469 756d 5f63      def medium_c
-0000fb50: 616d 6572 615f 6368 616e 6e65 6c28 7365  amera_channel(se
-0000fb60: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-0000fb70: 4361 6d65 7261 4368 616e 6e65 6c5d 3a0a  CameraChannel]:.
-0000fb80: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-0000fb90: 656c 662e 6368 616e 6e65 6c73 2920 3e3d  elf.channels) >=
-0000fba0: 2033 3a0a 2020 2020 2020 2020 2020 2020   3:.            
-0000fbb0: 7265 7475 726e 2073 656c 662e 6368 616e  return self.chan
-0000fbc0: 6e65 6c73 5b31 5d0a 2020 2020 2020 2020  nels[1].        
-0000fbd0: 7265 7475 726e 204e 6f6e 650a 0a20 2020  return None..   
-0000fbe0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000fbf0: 6566 206c 6f77 5f63 616d 6572 615f 6368  ef low_camera_ch
-0000fc00: 616e 6e65 6c28 7365 6c66 2920 2d3e 204f  annel(self) -> O
-0000fc10: 7074 696f 6e61 6c5b 4361 6d65 7261 4368  ptional[CameraCh
-0000fc20: 616e 6e65 6c5d 3a0a 2020 2020 2020 2020  annel]:.        
-0000fc30: 6966 206c 656e 2873 656c 662e 6368 616e  if len(self.chan
-0000fc40: 6e65 6c73 2920 3e3d 2033 3a0a 2020 2020  nels) >= 3:.    
-0000fc50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000fc60: 656c 662e 6368 616e 6e65 6c73 5b32 5d0a  elf.channels[2].
-0000fc70: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-0000fc80: 6f6e 650a 0a20 2020 2040 7072 6f70 6572  one..    @proper
-0000fc90: 7479 0a20 2020 2064 6566 2064 6566 6175  ty.    def defau
-0000fca0: 6c74 5f63 616d 6572 615f 6368 616e 6e65  lt_camera_channe
-0000fcb0: 6c28 7365 6c66 2920 2d3e 204f 7074 696f  l(self) -> Optio
-0000fcc0: 6e61 6c5b 4361 6d65 7261 4368 616e 6e65  nal[CameraChanne
-0000fcd0: 6c5d 3a0a 2020 2020 2020 2020 666f 7220  l]:.        for 
-0000fce0: 6368 616e 6e65 6c20 696e 205b 0a20 2020  channel in [.   
-0000fcf0: 2020 2020 2020 2020 2073 656c 662e 6869           self.hi
-0000fd00: 6768 5f63 616d 6572 615f 6368 616e 6e65  gh_camera_channe
-0000fd10: 6c2c 0a20 2020 2020 2020 2020 2020 2073  l,.            s
-0000fd20: 656c 662e 6d65 6469 756d 5f63 616d 6572  elf.medium_camer
-0000fd30: 615f 6368 616e 6e65 6c2c 0a20 2020 2020  a_channel,.     
-0000fd40: 2020 2020 2020 2073 656c 662e 6c6f 775f         self.low_
-0000fd50: 6361 6d65 7261 5f63 6861 6e6e 656c 2c0a  camera_channel,.
-0000fd60: 2020 2020 2020 2020 5d3a 0a20 2020 2020          ]:.     
-0000fd70: 2020 2020 2020 2069 6620 6368 616e 6e65         if channe
-0000fd80: 6c20 6973 206e 6f74 204e 6f6e 6520 616e  l is not None an
-0000fd90: 6420 6368 616e 6e65 6c2e 6973 5f72 7473  d channel.is_rts
-0000fda0: 705f 656e 6162 6c65 643a 0a20 2020 2020  p_enabled:.     
-0000fdb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000fdc0: 6e20 6368 616e 6e65 6c0a 2020 2020 2020  n channel.      
-0000fdd0: 2020 7265 7475 726e 2073 656c 662e 6869    return self.hi
-0000fde0: 6768 5f63 616d 6572 615f 6368 616e 6e65  gh_camera_channe
-0000fdf0: 6c0a 0a20 2020 2040 7072 6f70 6572 7479  l..    @property
-0000fe00: 0a20 2020 2064 6566 2070 6163 6b61 6765  .    def package
-0000fe10: 5f63 616d 6572 615f 6368 616e 6e65 6c28  _camera_channel(
-0000fe20: 7365 6c66 2920 2d3e 204f 7074 696f 6e61  self) -> Optiona
-0000fe30: 6c5b 4361 6d65 7261 4368 616e 6e65 6c5d  l[CameraChannel]
-0000fe40: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-0000fe50: 662e 6665 6174 7572 655f 666c 6167 732e  f.feature_flags.
-0000fe60: 6861 735f 7061 636b 6167 655f 6361 6d65  has_package_came
-0000fe70: 7261 2061 6e64 206c 656e 2873 656c 662e  ra and len(self.
-0000fe80: 6368 616e 6e65 6c73 2920 3d3d 2034 3a0a  channels) == 4:.
-0000fe90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000fea0: 726e 2073 656c 662e 6368 616e 6e65 6c73  rn self.channels
-0000feb0: 5b33 5d0a 2020 2020 2020 2020 7265 7475  [3].        retu
-0000fec0: 726e 204e 6f6e 650a 0a20 2020 2040 7072  rn None..    @pr
-0000fed0: 6f70 6572 7479 0a20 2020 2064 6566 2069  operty.    def i
-0000fee0: 735f 6869 6768 5f66 7073 5f65 6e61 626c  s_high_fps_enabl
-0000fef0: 6564 2873 656c 6629 202d 3e20 626f 6f6c  ed(self) -> bool
-0000ff00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000ff10: 2073 656c 662e 7669 6465 6f5f 6d6f 6465   self.video_mode
-0000ff20: 203d 3d20 5669 6465 6f4d 6f64 652e 4849   == VideoMode.HI
-0000ff30: 4748 5f46 5053 0a0a 2020 2020 4070 726f  GH_FPS..    @pro
-0000ff40: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
-0000ff50: 5f76 6964 656f 5f72 6561 6479 2873 656c  _video_ready(sel
-0000ff60: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-0000ff70: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
-0000ff80: 2020 2020 2020 2020 2073 656c 662e 6665           self.fe
-0000ff90: 6174 7572 655f 666c 6167 732e 6c65 6e73  ature_flags.lens
-0000ffa0: 5f74 7970 6520 6973 204e 6f6e 650a 2020  _type is None.  
-0000ffb0: 2020 2020 2020 2020 2020 6f72 2073 656c            or sel
-0000ffc0: 662e 6665 6174 7572 655f 666c 6167 732e  f.feature_flags.
-0000ffd0: 6c65 6e73 5f74 7970 6520 213d 204c 656e  lens_type != Len
-0000ffe0: 7354 7970 652e 4e4f 4e45 0a20 2020 2020  sType.NONE.     
-0000fff0: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-00010000: 7274 790a 2020 2020 6465 6620 6861 735f  rty.    def has_
-00010010: 7265 6d6f 7661 626c 655f 6c65 6e73 2873  removable_lens(s
-00010020: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
-00010030: 2020 2020 2020 7265 7475 726e 2028 0a20        return (. 
-00010040: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00010050: 6665 6174 7572 655f 666c 6167 732e 686f  feature_flags.ho
-00010060: 7470 6c75 6720 6973 206e 6f74 204e 6f6e  tplug is not Non
-00010070: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-00010080: 6420 7365 6c66 2e66 6561 7475 7265 5f66  d self.feature_f
-00010090: 6c61 6773 2e68 6f74 706c 7567 2e76 6964  lags.hotplug.vid
-000100a0: 656f 2069 7320 6e6f 7420 4e6f 6e65 0a20  eo is not None. 
-000100b0: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-000100c0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000100d0: 6861 735f 7265 6d6f 7661 626c 655f 7370  has_removable_sp
-000100e0: 6561 6b65 7228 7365 6c66 2920 2d3e 2062  eaker(self) -> b
-000100f0: 6f6f 6c3a 0a20 2020 2020 2020 2072 6574  ool:.        ret
-00010100: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
-00010110: 2020 7365 6c66 2e66 6561 7475 7265 5f66    self.feature_f
-00010120: 6c61 6773 2e68 6f74 706c 7567 2069 7320  lags.hotplug is 
-00010130: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
-00010140: 2020 2020 2061 6e64 2073 656c 662e 6665       and self.fe
-00010150: 6174 7572 655f 666c 6167 732e 686f 7470  ature_flags.hotp
-00010160: 6c75 672e 6175 6469 6f20 6973 206e 6f74  lug.audio is not
-00010170: 204e 6f6e 650a 2020 2020 2020 2020 290a   None.        ).
-00010180: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00010190: 2020 2064 6566 2068 6173 5f6d 6963 2873     def has_mic(s
-000101a0: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
-000101b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000101c0: 662e 6665 6174 7572 655f 666c 6167 732e  f.feature_flags.
-000101d0: 6861 735f 6d69 6320 6f72 2073 656c 662e  has_mic or self.
-000101e0: 6861 735f 7265 6d6f 7661 626c 655f 7370  has_removable_sp
-000101f0: 6561 6b65 720a 0a20 2020 2040 7072 6f70  eaker..    @prop
-00010200: 6572 7479 0a20 2020 2064 6566 2068 6173  erty.    def has
-00010210: 5f63 6f6c 6f72 5f6e 6967 6874 5f76 6973  _color_night_vis
-00010220: 696f 6e28 7365 6c66 2920 2d3e 2062 6f6f  ion(self) -> boo
-00010230: 6c3a 0a20 2020 2020 2020 2069 6620 280a  l:.        if (.
-00010240: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010250: 2e66 6561 7475 7265 5f66 6c61 6773 2e68  .feature_flags.h
-00010260: 6f74 706c 7567 2069 7320 6e6f 7420 4e6f  otplug is not No
-00010270: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
-00010280: 6e64 2073 656c 662e 6665 6174 7572 655f  nd self.feature_
-00010290: 666c 6167 732e 686f 7470 6c75 672e 6578  flags.hotplug.ex
-000102a0: 7465 6e64 6572 2069 7320 6e6f 7420 4e6f  tender is not No
-000102b0: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
-000102c0: 6e64 2073 656c 662e 6665 6174 7572 655f  nd self.feature_
-000102d0: 666c 6167 732e 686f 7470 6c75 672e 6578  flags.hotplug.ex
-000102e0: 7465 6e64 6572 2e69 735f 6174 7461 6368  tender.is_attach
-000102f0: 6564 2069 7320 6e6f 7420 4e6f 6e65 0a20  ed is not None. 
-00010300: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00010310: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00010320: 662e 6665 6174 7572 655f 666c 6167 732e  f.feature_flags.
-00010330: 686f 7470 6c75 672e 6578 7465 6e64 6572  hotplug.extender
-00010340: 2e69 735f 6174 7461 6368 6564 0a0a 2020  .is_attached..  
-00010350: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-00010360: 7365 0a0a 2020 2020 6465 6620 7365 745f  se..    def set_
-00010370: 7269 6e67 5f74 696d 656f 7574 2873 656c  ring_timeout(sel
-00010380: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-00010390: 2020 2020 7365 6c66 2e5f 6c61 7374 5f72      self._last_r
-000103a0: 696e 675f 7469 6d65 6f75 7420 3d20 7574  ing_timeout = ut
-000103b0: 635f 6e6f 7728 2920 2b20 4556 454e 545f  c_now() + EVENT_
-000103c0: 5049 4e47 5f49 4e54 4552 5641 4c0a 2020  PING_INTERVAL.  
-000103d0: 2020 2020 2020 7365 6c66 2e5f 6576 656e        self._even
-000103e0: 745f 6361 6c6c 6261 636b 5f70 696e 6728  t_callback_ping(
-000103f0: 290a 0a20 2020 2064 6566 2067 6574 5f70  )..    def get_p
-00010400: 7269 7661 6379 5f7a 6f6e 6528 7365 6c66  rivacy_zone(self
-00010410: 2920 2d3e 2074 7570 6c65 5b4f 7074 696f  ) -> tuple[Optio
-00010420: 6e61 6c5b 696e 745d 2c20 4f70 7469 6f6e  nal[int], Option
-00010430: 616c 5b43 616d 6572 615a 6f6e 655d 5d3a  al[CameraZone]]:
-00010440: 0a20 2020 2020 2020 2066 6f72 2069 6e64  .        for ind
-00010450: 6578 2c20 7a6f 6e65 2069 6e20 656e 756d  ex, zone in enum
-00010460: 6572 6174 6528 7365 6c66 2e70 7269 7661  erate(self.priva
-00010470: 6379 5f7a 6f6e 6573 293a 0a20 2020 2020  cy_zones):.     
-00010480: 2020 2020 2020 2069 6620 7a6f 6e65 2e6e         if zone.n
-00010490: 616d 6520 3d3d 2050 5249 5641 4359 5f5a  ame == PRIVACY_Z
-000104a0: 4f4e 455f 4e41 4d45 3a0a 2020 2020 2020  ONE_NAME:.      
-000104b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000104c0: 2069 6e64 6578 2c20 7a6f 6e65 0a20 2020   index, zone.   
-000104d0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-000104e0: 2c20 4e6f 6e65 0a0a 2020 2020 6465 6620  , None..    def 
-000104f0: 6164 645f 7072 6976 6163 795f 7a6f 6e65  add_privacy_zone
-00010500: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
-00010510: 2020 2020 2020 2020 696e 6465 782c 205f          index, _
-00010520: 203d 2073 656c 662e 6765 745f 7072 6976   = self.get_priv
-00010530: 6163 795f 7a6f 6e65 2829 0a20 2020 2020  acy_zone().     
-00010540: 2020 2069 6620 696e 6465 7820 6973 204e     if index is N
-00010550: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00010560: 207a 6f6e 655f 6964 203d 2030 0a20 2020   zone_id = 0.   
-00010570: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-00010580: 7365 6c66 2e70 7269 7661 6379 5f7a 6f6e  self.privacy_zon
-00010590: 6573 2920 3e20 303a 0a20 2020 2020 2020  es) > 0:.       
-000105a0: 2020 2020 2020 2020 207a 6f6e 655f 6964           zone_id
-000105b0: 203d 2073 656c 662e 7072 6976 6163 795f   = self.privacy_
-000105c0: 7a6f 6e65 735b 2d31 5d2e 6964 202b 2031  zones[-1].id + 1
-000105d0: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000105e0: 6c66 2e70 7269 7661 6379 5f7a 6f6e 6573  lf.privacy_zones
-000105f0: 2e61 7070 656e 6428 4361 6d65 7261 5a6f  .append(CameraZo
-00010600: 6e65 2e63 7265 6174 655f 7072 6976 6163  ne.create_privac
-00010610: 795f 7a6f 6e65 287a 6f6e 655f 6964 2929  y_zone(zone_id))
-00010620: 0a0a 2020 2020 6465 6620 7265 6d6f 7665  ..    def remove
-00010630: 5f70 7269 7661 6379 5f7a 6f6e 6528 7365  _privacy_zone(se
-00010640: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-00010650: 2020 2020 2069 6e64 6578 2c20 5f20 3d20       index, _ = 
-00010660: 7365 6c66 2e67 6574 5f70 7269 7661 6379  self.get_privacy
-00010670: 5f7a 6f6e 6528 290a 0a20 2020 2020 2020  _zone()..       
-00010680: 2069 6620 696e 6465 7820 6973 206e 6f74   if index is not
-00010690: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000106a0: 2020 2073 656c 662e 7072 6976 6163 795f     self.privacy_
-000106b0: 7a6f 6e65 732e 706f 7028 696e 6465 7829  zones.pop(index)
-000106c0: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-000106d0: 6765 745f 736e 6170 7368 6f74 280a 2020  get_snapshot(.  
-000106e0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000106f0: 2020 2020 7769 6474 683a 204f 7074 696f      width: Optio
-00010700: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-00010710: 0a20 2020 2020 2020 2068 6569 6768 743a  .        height:
-00010720: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-00010730: 204e 6f6e 652c 0a20 2020 2020 2020 2064   None,.        d
-00010740: 743a 204f 7074 696f 6e61 6c5b 6461 7465  t: Optional[date
-00010750: 7469 6d65 5d20 3d20 4e6f 6e65 2c0a 2020  time] = None,.  
-00010760: 2020 2920 2d3e 204f 7074 696f 6e61 6c5b    ) -> Optional[
-00010770: 6279 7465 735d 3a0a 2020 2020 2020 2020  bytes]:.        
-00010780: 2222 2247 6574 7320 736e 6170 7368 6f74  """Gets snapshot
-00010790: 2066 6f72 2063 616d 6572 612e 0a0a 2020   for camera...  
-000107a0: 2020 2020 2020 4461 7465 7469 6d65 206f        Datetime o
-000107b0: 6620 7363 7265 656e 7368 6f74 2069 7320  f screenshot is 
-000107c0: 6170 7072 6f78 696d 6174 652e 2049 7420  approximate. It 
-000107d0: 6d61 7920 6265 202b 2f2d 2061 2066 6577  may be +/- a few
-000107e0: 2073 6563 6f6e 6473 2e0a 2020 2020 2020   seconds..      
-000107f0: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
-00010800: 6620 6e6f 7420 7365 6c66 2e61 7069 2e62  f not self.api.b
-00010810: 6f6f 7473 7472 6170 2e61 7574 685f 7573  ootstrap.auth_us
-00010820: 6572 2e63 616e 280a 2020 2020 2020 2020  er.can(.        
-00010830: 2020 2020 4d6f 6465 6c54 7970 652e 4341      ModelType.CA
-00010840: 4d45 5241 2c0a 2020 2020 2020 2020 2020  MERA,.          
-00010850: 2020 5065 726d 6973 7369 6f6e 4e6f 6465    PermissionNode
-00010860: 2e52 4541 445f 4d45 4449 412c 0a20 2020  .READ_MEDIA,.   
-00010870: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00010880: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00010890: 2020 2020 2020 7261 6973 6520 4e6f 7441        raise NotA
-000108a0: 7574 686f 7269 7a65 6428 0a20 2020 2020  uthorized(.     
-000108b0: 2020 2020 2020 2020 2020 2066 2244 6f20             f"Do 
-000108c0: 6e6f 7420 6861 7665 2070 6572 6d69 7373  not have permiss
-000108d0: 696f 6e20 746f 2072 6561 6420 6d65 6469  ion to read medi
-000108e0: 6120 666f 7220 6361 6d65 7261 3a20 7b73  a for camera: {s
-000108f0: 656c 662e 6964 7d22 2c0a 2020 2020 2020  elf.id}",.      
-00010900: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00010910: 2069 6620 6865 6967 6874 2069 7320 4e6f   if height is No
-00010920: 6e65 2061 6e64 2077 6964 7468 2069 7320  ne and width is 
-00010930: 4e6f 6e65 2061 6e64 2073 656c 662e 6869  None and self.hi
-00010940: 6768 5f63 616d 6572 615f 6368 616e 6e65  gh_camera_channe
-00010950: 6c20 6973 206e 6f74 204e 6f6e 653a 0a20  l is not None:. 
-00010960: 2020 2020 2020 2020 2020 2068 6569 6768             heigh
-00010970: 7420 3d20 7365 6c66 2e68 6967 685f 6361  t = self.high_ca
-00010980: 6d65 7261 5f63 6861 6e6e 656c 2e68 6569  mera_channel.hei
-00010990: 6768 740a 0a20 2020 2020 2020 2072 6574  ght..        ret
-000109a0: 7572 6e20 6177 6169 7420 7365 6c66 2e61  urn await self.a
-000109b0: 7069 2e67 6574 5f63 616d 6572 615f 736e  pi.get_camera_sn
-000109c0: 6170 7368 6f74 2873 656c 662e 6964 2c20  apshot(self.id, 
-000109d0: 7769 6474 682c 2068 6569 6768 742c 2064  width, height, d
-000109e0: 743d 6474 290a 0a20 2020 2061 7379 6e63  t=dt)..    async
-000109f0: 2064 6566 2067 6574 5f70 6163 6b61 6765   def get_package
-00010a00: 5f73 6e61 7073 686f 7428 0a20 2020 2020  _snapshot(.     
-00010a10: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00010a20: 2077 6964 7468 3a20 4f70 7469 6f6e 616c   width: Optional
-00010a30: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
-00010a40: 2020 2020 2020 6865 6967 6874 3a20 4f70        height: Op
-00010a50: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
-00010a60: 6e65 2c0a 2020 2020 2020 2020 6474 3a20  ne,.        dt: 
-00010a70: 4f70 7469 6f6e 616c 5b64 6174 6574 696d  Optional[datetim
-00010a80: 655d 203d 204e 6f6e 652c 0a20 2020 2029  e] = None,.    )
-00010a90: 202d 3e20 4f70 7469 6f6e 616c 5b62 7974   -> Optional[byt
-00010aa0: 6573 5d3a 0a20 2020 2020 2020 2022 2222  es]:.        """
-00010ab0: 4765 7473 2073 6e61 7073 686f 7420 6672  Gets snapshot fr
-00010ac0: 6f6d 2074 6865 2070 6163 6b61 6765 2063  om the package c
-00010ad0: 616d 6572 612e 0a0a 2020 2020 2020 2020  amera...        
-00010ae0: 4461 7465 7469 6d65 206f 6620 7363 7265  Datetime of scre
-00010af0: 656e 7368 6f74 2069 7320 6170 7072 6f78  enshot is approx
-00010b00: 696d 6174 652e 2049 7420 6d61 7920 6265  imate. It may be
-00010b10: 202b 2f2d 2061 2066 6577 2073 6563 6f6e   +/- a few secon
-00010b20: 6473 2e0a 2020 2020 2020 2020 2222 220a  ds..        """.
-00010b30: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00010b40: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
-00010b50: 6773 2e68 6173 5f70 6163 6b61 6765 5f63  gs.has_package_c
-00010b60: 616d 6572 613a 0a20 2020 2020 2020 2020  amera:.         
-00010b70: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
-00010b80: 6573 7428 2244 6576 6963 6520 646f 6573  est("Device does
-00010b90: 206e 6f74 2068 6176 6520 7061 636b 6167   not have packag
-00010ba0: 6520 6361 6d65 7261 2229 0a0a 2020 2020  e camera")..    
-00010bb0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00010bc0: 6170 692e 626f 6f74 7374 7261 702e 6175  api.bootstrap.au
-00010bd0: 7468 5f75 7365 722e 6361 6e28 0a20 2020  th_user.can(.   
-00010be0: 2020 2020 2020 2020 204d 6f64 656c 5479           ModelTy
-00010bf0: 7065 2e43 414d 4552 412c 0a20 2020 2020  pe.CAMERA,.     
-00010c00: 2020 2020 2020 2050 6572 6d69 7373 696f         Permissio
-00010c10: 6e4e 6f64 652e 5245 4144 5f4d 4544 4941  nNode.READ_MEDIA
-00010c20: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-00010c30: 6c66 2c0a 2020 2020 2020 2020 293a 0a20  lf,.        ):. 
-00010c40: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00010c50: 204e 6f74 4175 7468 6f72 697a 6564 280a   NotAuthorized(.
-00010c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c70: 6622 446f 206e 6f74 2068 6176 6520 7065  f"Do not have pe
-00010c80: 726d 6973 7369 6f6e 2074 6f20 7265 6164  rmission to read
-00010c90: 206d 6564 6961 2066 6f72 2063 616d 6572   media for camer
-00010ca0: 613a 207b 7365 6c66 2e69 647d 222c 0a20  a: {self.id}",. 
-00010cb0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00010cc0: 2020 2020 2020 6966 2068 6569 6768 7420        if height 
-00010cd0: 6973 204e 6f6e 6520 616e 6420 7769 6474  is None and widt
-00010ce0: 6820 6973 204e 6f6e 6520 616e 6420 7365  h is None and se
-00010cf0: 6c66 2e70 6163 6b61 6765 5f63 616d 6572  lf.package_camer
-00010d00: 615f 6368 616e 6e65 6c20 6973 206e 6f74  a_channel is not
-00010d10: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00010d20: 2020 2068 6569 6768 7420 3d20 7365 6c66     height = self
-00010d30: 2e70 6163 6b61 6765 5f63 616d 6572 615f  .package_camera_
-00010d40: 6368 616e 6e65 6c2e 6865 6967 6874 0a0a  channel.height..
-00010d50: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00010d60: 7761 6974 2073 656c 662e 6170 692e 6765  wait self.api.ge
-00010d70: 745f 7061 636b 6167 655f 6361 6d65 7261  t_package_camera
-00010d80: 5f73 6e61 7073 686f 7428 7365 6c66 2e69  _snapshot(self.i
-00010d90: 642c 2077 6964 7468 2c20 6865 6967 6874  d, width, height
-00010da0: 2c20 6474 3d64 7429 0a0a 2020 2020 6173  , dt=dt)..    as
-00010db0: 796e 6320 6465 6620 6765 745f 7669 6465  ync def get_vide
-00010dc0: 6f28 0a20 2020 2020 2020 2073 656c 662c  o(.        self,
-00010dd0: 0a20 2020 2020 2020 2073 7461 7274 3a20  .        start: 
-00010de0: 6461 7465 7469 6d65 2c0a 2020 2020 2020  datetime,.      
-00010df0: 2020 656e 643a 2064 6174 6574 696d 652c    end: datetime,
-00010e00: 0a20 2020 2020 2020 2063 6861 6e6e 656c  .        channel
-00010e10: 5f69 6e64 6578 3a20 696e 7420 3d20 302c  _index: int = 0,
-00010e20: 0a20 2020 2020 2020 206f 7574 7075 745f  .        output_
-00010e30: 6669 6c65 3a20 4f70 7469 6f6e 616c 5b50  file: Optional[P
-00010e40: 6174 685d 203d 204e 6f6e 652c 0a20 2020  ath] = None,.   
-00010e50: 2020 2020 2069 7465 7261 746f 725f 6361       iterator_ca
-00010e60: 6c6c 6261 636b 3a20 4f70 7469 6f6e 616c  llback: Optional
-00010e70: 5b49 7465 7261 746f 7243 616c 6c62 6163  [IteratorCallbac
-00010e80: 6b5d 203d 204e 6f6e 652c 0a20 2020 2020  k] = None,.     
-00010e90: 2020 2070 726f 6772 6573 735f 6361 6c6c     progress_call
-00010ea0: 6261 636b 3a20 4f70 7469 6f6e 616c 5b50  back: Optional[P
-00010eb0: 726f 6772 6573 7343 616c 6c62 6163 6b5d  rogressCallback]
-00010ec0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00010ed0: 2063 6875 6e6b 5f73 697a 653a 2069 6e74   chunk_size: int
-00010ee0: 203d 2036 3535 3336 2c0a 2020 2020 2020   = 65536,.      
-00010ef0: 2020 6670 733a 204f 7074 696f 6e61 6c5b    fps: Optional[
-00010f00: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
-00010f10: 2029 202d 3e20 4f70 7469 6f6e 616c 5b62   ) -> Optional[b
-00010f20: 7974 6573 5d3a 0a20 2020 2020 2020 2022  ytes]:.        "
-00010f30: 2222 4578 706f 7274 7320 4d50 3420 7669  ""Exports MP4 vi
-00010f40: 6465 6f20 6672 6f6d 2061 2067 6976 656e  deo from a given
-00010f50: 2063 616d 6572 6120 6174 2061 2073 7065   camera at a spe
-00010f60: 6369 6669 6320 7469 6d65 2e0a 0a20 2020  cific time...   
-00010f70: 2020 2020 2053 7461 7274 2f45 6e64 206f       Start/End o
-00010f80: 6620 7669 6465 6f20 6578 706f 7274 2061  f video export a
-00010f90: 7265 2061 7070 726f 7869 6d61 7465 2e20  re approximate. 
-00010fa0: 4974 206d 6179 2062 6520 2b2f 2d20 6120  It may be +/- a 
-00010fb0: 6665 7720 7365 636f 6e64 732e 0a0a 2020  few seconds...  
-00010fc0: 2020 2020 2020 4974 2069 7320 7265 636f        It is reco
-00010fd0: 6d6d 656e 6465 6420 746f 2070 726f 7669  mmended to provi
-00010fe0: 6465 2061 206f 7574 7075 7420 6669 6c65  de a output file
-00010ff0: 206f 7220 7072 6f67 7265 7373 2063 616c   or progress cal
-00011000: 6c62 6163 6b20 666f 7220 6c61 7267 6572  lback for larger
-00011010: 0a20 2020 2020 2020 2076 6964 656f 2063  .        video c
-00011020: 6c69 7073 2c20 6f74 6865 7277 6973 6520  lips, otherwise 
-00011030: 7468 6520 6675 6c6c 2076 6964 656f 206d  the full video m
-00011040: 7573 7420 6265 2064 6f77 6e6c 6f61 6465  ust be downloade
-00011050: 6420 746f 206d 656d 6f72 7920 6265 666f  d to memory befo
-00011060: 7265 0a20 2020 2020 2020 2062 6569 6e67  re.        being
-00011070: 2077 7269 7474 656e 2e0a 0a20 2020 2020   written...     
-00011080: 2020 2050 726f 7669 6469 6e67 2074 6865     Providing the
-00011090: 2060 6670 7360 2070 6172 616d 6574 6572   `fps` parameter
-000110a0: 2063 7265 6174 6573 2061 2022 7469 6d65   creates a "time
-000110b0: 6c61 7073 6522 2065 7870 6f72 7420 7774  lapse" export wt
-000110c0: 6968 2074 6865 2067 6976 656e 2046 5053  ih the given FPS
-000110d0: 0a20 2020 2020 2020 2076 616c 7565 2e20  .        value. 
-000110e0: 5072 6f74 6563 7420 6170 7020 6769 7665  Protect app give
-000110f0: 7320 7468 6520 6f70 7469 6f6e 7320 666f  s the options fo
-00011100: 7220 3630 7820 2866 7073 3d34 292c 2031  r 60x (fps=4), 1
-00011110: 3230 7820 2866 7073 3d38 292c 2033 3030  20x (fps=8), 300
-00011120: 780a 2020 2020 2020 2020 2866 7073 3d32  x.        (fps=2
-00011130: 3029 2c20 616e 6420 3630 3078 2028 6670  0), and 600x (fp
-00011140: 733d 3430 292e 0a20 2020 2020 2020 2022  s=40)..        "
-00011150: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
-00011160: 6f74 2073 656c 662e 6170 692e 626f 6f74  ot self.api.boot
-00011170: 7374 7261 702e 6175 7468 5f75 7365 722e  strap.auth_user.
-00011180: 6361 6e28 0a20 2020 2020 2020 2020 2020  can(.           
-00011190: 204d 6f64 656c 5479 7065 2e43 414d 4552   ModelType.CAMER
-000111a0: 412c 0a20 2020 2020 2020 2020 2020 2050  A,.            P
-000111b0: 6572 6d69 7373 696f 6e4e 6f64 652e 5245  ermissionNode.RE
-000111c0: 4144 5f4d 4544 4941 2c0a 2020 2020 2020  AD_MEDIA,.      
-000111d0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000111e0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-000111f0: 2020 2072 6169 7365 204e 6f74 4175 7468     raise NotAuth
-00011200: 6f72 697a 6564 280a 2020 2020 2020 2020  orized(.        
-00011210: 2020 2020 2020 2020 6622 446f 206e 6f74          f"Do not
-00011220: 2068 6176 6520 7065 726d 6973 7369 6f6e   have permission
-00011230: 2074 6f20 7265 6164 206d 6564 6961 2066   to read media f
-00011240: 6f72 2063 616d 6572 613a 207b 7365 6c66  or camera: {self
-00011250: 2e69 647d 222c 0a20 2020 2020 2020 2020  .id}",.         
-00011260: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-00011270: 7475 726e 2061 7761 6974 2073 656c 662e  turn await self.
-00011280: 6170 692e 6765 745f 6361 6d65 7261 5f76  api.get_camera_v
-00011290: 6964 656f 280a 2020 2020 2020 2020 2020  ideo(.          
-000112a0: 2020 7365 6c66 2e69 642c 0a20 2020 2020    self.id,.     
-000112b0: 2020 2020 2020 2073 7461 7274 2c0a 2020         start,.  
-000112c0: 2020 2020 2020 2020 2020 656e 642c 0a20            end,. 
-000112d0: 2020 2020 2020 2020 2020 2063 6861 6e6e             chann
-000112e0: 656c 5f69 6e64 6578 2c0a 2020 2020 2020  el_index,.      
-000112f0: 2020 2020 2020 6f75 7470 7574 5f66 696c        output_fil
-00011300: 653d 6f75 7470 7574 5f66 696c 652c 0a20  e=output_file,. 
-00011310: 2020 2020 2020 2020 2020 2069 7465 7261             itera
-00011320: 746f 725f 6361 6c6c 6261 636b 3d69 7465  tor_callback=ite
-00011330: 7261 746f 725f 6361 6c6c 6261 636b 2c0a  rator_callback,.
-00011340: 2020 2020 2020 2020 2020 2020 7072 6f67              prog
-00011350: 7265 7373 5f63 616c 6c62 6163 6b3d 7072  ress_callback=pr
-00011360: 6f67 7265 7373 5f63 616c 6c62 6163 6b2c  ogress_callback,
-00011370: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00011380: 6e6b 5f73 697a 653d 6368 756e 6b5f 7369  nk_size=chunk_si
-00011390: 7a65 2c0a 2020 2020 2020 2020 2020 2020  ze,.            
-000113a0: 6670 733d 6670 732c 0a20 2020 2020 2020  fps=fps,.       
-000113b0: 2029 0a0a 2020 2020 6173 796e 6320 6465   )..    async de
-000113c0: 6620 7365 745f 7265 636f 7264 696e 675f  f set_recording_
-000113d0: 6d6f 6465 2873 656c 662c 206d 6f64 653a  mode(self, mode:
-000113e0: 2052 6563 6f72 6469 6e67 4d6f 6465 2920   RecordingMode) 
-000113f0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00011400: 2022 2222 5365 7473 2072 6563 6f72 6469   """Sets recordi
-00011410: 6e67 206d 6f64 6520 6f6e 2063 616d 6572  ng mode on camer
-00011420: 6122 2222 0a0a 2020 2020 2020 2020 6966  a"""..        if
-00011430: 2073 656c 662e 7573 655f 676c 6f62 616c   self.use_global
-00011440: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00011450: 6973 6520 4261 6452 6571 7565 7374 2822  ise BadRequest("
-00011460: 4361 6d65 7261 2069 7320 7573 696e 6720  Camera is using 
-00011470: 676c 6f62 616c 2072 6563 6f72 6469 6e67  global recording
-00011480: 2073 6574 7469 6e67 732e 2229 0a0a 2020   settings.")..  
-00011490: 2020 2020 2020 6465 6620 6361 6c6c 6261        def callba
-000114a0: 636b 2829 202d 3e20 4e6f 6e65 3a0a 2020  ck() -> None:.  
-000114b0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-000114c0: 6563 6f72 6469 6e67 5f73 6574 7469 6e67  ecording_setting
-000114d0: 732e 6d6f 6465 203d 206d 6f64 650a 0a20  s.mode = mode.. 
-000114e0: 2020 2020 2020 2061 7761 6974 2073 656c         await sel
-000114f0: 662e 7175 6575 655f 7570 6461 7465 2863  f.queue_update(c
-00011500: 616c 6c62 6163 6b29 0a0a 2020 2020 6173  allback)..    as
-00011510: 796e 6320 6465 6620 7365 745f 6972 5f6c  ync def set_ir_l
-00011520: 6564 5f6d 6f64 656c 2873 656c 662c 206d  ed_model(self, m
-00011530: 6f64 653a 2049 524c 4544 4d6f 6465 2920  ode: IRLEDMode) 
-00011540: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00011550: 2022 2222 5365 7473 2049 5220 4c45 4420   """Sets IR LED 
-00011560: 6d6f 6465 206f 6e20 6361 6d65 7261 2222  mode on camera""
-00011570: 220a 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
-00011580: 7420 7365 6c66 2e66 6561 7475 7265 5f66  t self.feature_f
-00011590: 6c61 6773 2e68 6173 5f6c 6564 5f69 723a  lags.has_led_ir:
-000115a0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000115b0: 7365 2042 6164 5265 7175 6573 7428 2243  se BadRequest("C
-000115c0: 616d 6572 6120 646f 6573 206e 6f74 2068  amera does not h
-000115d0: 6176 6520 616e 204c 4544 2049 5222 290a  ave an LED IR").
-000115e0: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
-000115f0: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
-00011600: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00011610: 662e 6973 705f 7365 7474 696e 6773 2e69  f.isp_settings.i
-00011620: 725f 6c65 645f 6d6f 6465 203d 206d 6f64  r_led_mode = mod
-00011630: 650a 0a20 2020 2020 2020 2061 7761 6974  e..        await
-00011640: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
-00011650: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
-00011660: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-00011670: 6963 725f 6375 7374 6f6d 5f6c 7578 2873  icr_custom_lux(s
-00011680: 656c 662c 2076 616c 7565 3a20 4943 524c  elf, value: ICRL
-00011690: 7578 5661 6c75 6529 202d 3e20 4e6f 6e65  uxValue) -> None
-000116a0: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
-000116b0: 2049 4352 4375 7374 6f6d 5661 6c75 6520   ICRCustomValue 
-000116c0: 6672 6f6d 206c 7578 2076 616c 7565 2e22  from lux value."
-000116d0: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
-000116e0: 6f74 2073 656c 662e 6665 6174 7572 655f  ot self.feature_
-000116f0: 666c 6167 732e 6861 735f 6c65 645f 6972  flags.has_led_ir
-00011700: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00011710: 6973 6520 4261 6452 6571 7565 7374 2822  ise BadRequest("
-00011720: 4361 6d65 7261 2064 6f65 7320 6e6f 7420  Camera does not 
-00011730: 6861 7665 2061 6e20 4c45 4420 4952 2229  have an LED IR")
-00011740: 0a0a 2020 2020 2020 2020 6963 725f 7661  ..        icr_va
-00011750: 6c75 6520 3d20 300a 2020 2020 2020 2020  lue = 0.        
-00011760: 666f 7220 696e 6465 782c 2074 6872 6573  for index, thres
-00011770: 686f 6c64 2069 6e20 656e 756d 6572 6174  hold in enumerat
-00011780: 6528 4c55 585f 4d41 5050 494e 475f 5641  e(LUX_MAPPING_VA
-00011790: 4c55 4553 293a 0a20 2020 2020 2020 2020  LUES):.         
-000117a0: 2020 2069 6620 7661 6c75 6520 3e3d 2074     if value >= t
-000117b0: 6872 6573 686f 6c64 3a0a 2020 2020 2020  hreshold:.      
-000117c0: 2020 2020 2020 2020 2020 6963 725f 7661            icr_va
-000117d0: 6c75 6520 3d20 3130 202d 2069 6e64 6578  lue = 10 - index
-000117e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000117f0: 2062 7265 616b 0a0a 2020 2020 2020 2020   break..        
-00011800: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
-00011810: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00011820: 2020 2020 7365 6c66 2e69 7370 5f73 6574      self.isp_set
-00011830: 7469 6e67 732e 6963 725f 6375 7374 6f6d  tings.icr_custom
-00011840: 5f76 616c 7565 203d 2063 6173 7428 4943  _value = cast(IC
-00011850: 5243 7573 746f 6d56 616c 7565 2c20 6963  RCustomValue, ic
-00011860: 725f 7661 6c75 6529 0a0a 2020 2020 2020  r_value)..      
-00011870: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
-00011880: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
-00011890: 636b 290a 0a20 2020 2040 7072 6f70 6572  ck)..    @proper
-000118a0: 7479 0a20 2020 2064 6566 2069 735f 6972  ty.    def is_ir
-000118b0: 5f6c 6564 5f73 6c69 6465 725f 656e 6162  _led_slider_enab
-000118c0: 6c65 6428 7365 6c66 2920 2d3e 2062 6f6f  led(self) -> boo
-000118d0: 6c3a 0a20 2020 2020 2020 2022 2222 5265  l:.        """Re
-000118e0: 7475 726e 2069 6620 4952 204c 4544 2063  turn if IR LED c
-000118f0: 7573 746f 6d20 736c 6964 6572 2069 7320  ustom slider is 
-00011900: 656e 6162 6c65 642e 2222 220a 0a20 2020  enabled."""..   
-00011910: 2020 2020 2072 6574 7572 6e20 280a 2020       return (.  
-00011920: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00011930: 6561 7475 7265 5f66 6c61 6773 2e68 6173  eature_flags.has
-00011940: 5f6c 6564 5f69 720a 2020 2020 2020 2020  _led_ir.        
-00011950: 2020 2020 616e 6420 7365 6c66 2e69 7370      and self.isp
-00011960: 5f73 6574 7469 6e67 732e 6972 5f6c 6564  _settings.ir_led
-00011970: 5f6d 6f64 6520 3d3d 2049 524c 4544 4d6f  _mode == IRLEDMo
-00011980: 6465 2e43 5553 544f 4d0a 2020 2020 2020  de.CUSTOM.      
-00011990: 2020 290a 0a20 2020 2061 7379 6e63 2064    )..    async d
-000119a0: 6566 2073 6574 5f73 7461 7475 735f 6c69  ef set_status_li
-000119b0: 6768 7428 7365 6c66 2c20 656e 6162 6c65  ght(self, enable
-000119c0: 643a 2062 6f6f 6c29 202d 3e20 4e6f 6e65  d: bool) -> None
-000119d0: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
-000119e0: 7320 7374 6174 7573 2069 6e64 6963 6963  s status indicic
-000119f0: 6174 6f72 206c 6967 6874 206f 6e20 6361  ator light on ca
-00011a00: 6d65 7261 2222 220a 0a20 2020 2020 2020  mera"""..       
-00011a10: 2069 6620 6e6f 7420 7365 6c66 2e66 6561   if not self.fea
-00011a20: 7475 7265 5f66 6c61 6773 2e68 6173 5f6c  ture_flags.has_l
-00011a30: 6564 5f73 7461 7475 733a 0a20 2020 2020  ed_status:.     
-00011a40: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
-00011a50: 5265 7175 6573 7428 2243 616d 6572 6120  Request("Camera 
-00011a60: 646f 6573 206e 6f74 2068 6176 6520 7374  does not have st
-00011a70: 6174 7573 206c 6967 6874 2229 0a0a 2020  atus light")..  
-00011a80: 2020 2020 2020 6465 6620 6361 6c6c 6261        def callba
-00011a90: 636b 2829 202d 3e20 4e6f 6e65 3a0a 2020  ck() -> None:.  
-00011aa0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00011ab0: 6564 5f73 6574 7469 6e67 732e 6973 5f65  ed_settings.is_e
-00011ac0: 6e61 626c 6564 203d 2065 6e61 626c 6564  nabled = enabled
-00011ad0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00011ae0: 662e 6c65 645f 7365 7474 696e 6773 2e62  f.led_settings.b
-00011af0: 6c69 6e6b 5f72 6174 6520 3d20 300a 0a20  link_rate = 0.. 
-00011b00: 2020 2020 2020 2061 7761 6974 2073 656c         await sel
-00011b10: 662e 7175 6575 655f 7570 6461 7465 2863  f.queue_update(c
-00011b20: 616c 6c62 6163 6b29 0a0a 2020 2020 6173  allback)..    as
-00011b30: 796e 6320 6465 6620 7365 745f 6864 7228  ync def set_hdr(
-00011b40: 7365 6c66 2c20 656e 6162 6c65 643a 2062  self, enabled: b
-00011b50: 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a 2020  ool) -> None:.  
-00011b60: 2020 2020 2020 2222 2253 6574 7320 4844        """Sets HD
-00011b70: 5220 2848 6967 6820 4479 6e61 6d69 6320  R (High Dynamic 
-00011b80: 5261 6e67 6529 206f 6e20 6361 6d65 7261  Range) on camera
-00011b90: 2222 220a 0a20 2020 2020 2020 2077 6172  """..        war
-00011ba0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00011bb0: 2020 2020 2020 2020 2273 6574 5f68 6472          "set_hdr
-00011bc0: 2069 7320 6465 7072 6563 6174 6564 2061   is deprecated a
-00011bd0: 6e64 2072 6570 6c61 6365 6420 7769 7468  nd replaced with
-00011be0: 2073 6574 5f68 6472 5f6d 6f64 6520 666f   set_hdr_mode fo
-00011bf0: 7220 7665 7273 696f 6e73 206f 6620 556e  r versions of Un
-00011c00: 6946 6920 5072 6f74 6563 7420 7633 2e30  iFi Protect v3.0
-00011c10: 2b22 2c0a 2020 2020 2020 2020 2020 2020  +",.            
-00011c20: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00011c30: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-00011c40: 7374 6163 6b6c 6576 656c 3d32 2c0a 2020  stacklevel=2,.  
-00011c50: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00011c60: 2069 6620 6e6f 7420 7365 6c66 2e66 6561   if not self.fea
-00011c70: 7475 7265 5f66 6c61 6773 2e68 6173 5f68  ture_flags.has_h
-00011c80: 6472 3a0a 2020 2020 2020 2020 2020 2020  dr:.            
-00011c90: 7261 6973 6520 4261 6452 6571 7565 7374  raise BadRequest
-00011ca0: 2822 4361 6d65 7261 2064 6f65 7320 6e6f  ("Camera does no
-00011cb0: 7420 6861 7665 2048 4452 2229 0a0a 2020  t have HDR")..  
-00011cc0: 2020 2020 2020 6465 6620 6361 6c6c 6261        def callba
-00011cd0: 636b 2829 202d 3e20 4e6f 6e65 3a0a 2020  ck() -> None:.  
-00011ce0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
-00011cf0: 6472 5f6d 6f64 6520 3d20 656e 6162 6c65  dr_mode = enable
-00011d00: 640a 0a20 2020 2020 2020 2061 7761 6974  d..        await
-00011d10: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
-00011d20: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
-00011d30: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-00011d40: 6864 725f 6d6f 6465 2873 656c 662c 206d  hdr_mode(self, m
-00011d50: 6f64 653a 204c 6974 6572 616c 5b22 6175  ode: Literal["au
-00011d60: 746f 222c 2022 6f66 6622 2c20 2261 6c77  to", "off", "alw
-00011d70: 6179 7322 5d29 202d 3e20 4e6f 6e65 3a0a  ays"]) -> None:.
-00011d80: 2020 2020 2020 2020 2222 2253 6574 7320          """Sets 
-00011d90: 4844 5220 6d6f 6465 2073 696d 696c 6172  HDR mode similar
-00011da0: 2074 6f20 686f 7720 5072 6f74 6563 7420   to how Protect 
-00011db0: 696e 7465 7266 6163 6520 776f 726b 732e  interface works.
-00011dc0: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00011dd0: 6e6f 7420 7365 6c66 2e66 6561 7475 7265  not self.feature
-00011de0: 5f66 6c61 6773 2e68 6173 5f68 6472 3a0a  _flags.has_hdr:.
-00011df0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00011e00: 6520 4261 6452 6571 7565 7374 2822 4361  e BadRequest("Ca
-00011e10: 6d65 7261 2064 6f65 7320 6e6f 7420 6861  mera does not ha
-00011e20: 7665 2048 4452 2229 0a0a 2020 2020 2020  ve HDR")..      
-00011e30: 2020 6465 6620 6361 6c6c 6261 636b 2829    def callback()
-00011e40: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00011e50: 2020 2020 2020 6966 206d 6f64 6520 3d3d        if mode ==
-00011e60: 2022 6f66 6622 3a0a 2020 2020 2020 2020   "off":.        
-00011e70: 2020 2020 2020 2020 7365 6c66 2e68 6472          self.hdr
-00011e80: 5f6d 6f64 6520 3d20 4661 6c73 650a 2020  _mode = False.  
-00011e90: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00011ea0: 2073 656c 662e 6973 705f 7365 7474 696e   self.isp_settin
-00011eb0: 6773 2e68 6472 5f6d 6f64 6520 6973 206e  gs.hdr_mode is n
-00011ec0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00011ed0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00011ee0: 662e 6973 705f 7365 7474 696e 6773 2e68  f.isp_settings.h
-00011ef0: 6472 5f6d 6f64 6520 3d20 4844 524d 6f64  dr_mode = HDRMod
-00011f00: 652e 4e4f 524d 414c 0a20 2020 2020 2020  e.NORMAL.       
-00011f10: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00011f20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011f30: 6864 725f 6d6f 6465 203d 2054 7275 650a  hdr_mode = True.
-00011f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f50: 6966 2073 656c 662e 6973 705f 7365 7474  if self.isp_sett
-00011f60: 696e 6773 2e68 6472 5f6d 6f64 6520 6973  ings.hdr_mode is
-00011f70: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00011f80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011f90: 656c 662e 6973 705f 7365 7474 696e 6773  elf.isp_settings
-00011fa0: 2e68 6472 5f6d 6f64 6520 3d20 280a 2020  .hdr_mode = (.  
-00011fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011fc0: 2020 2020 2020 4844 524d 6f64 652e 4e4f        HDRMode.NO
-00011fd0: 524d 414c 2069 6620 6d6f 6465 203d 3d20  RMAL if mode == 
-00011fe0: 2261 7574 6f22 2065 6c73 6520 4844 524d  "auto" else HDRM
-00011ff0: 6f64 652e 414c 5741 5953 5f4f 4e0a 2020  ode.ALWAYS_ON.  
-00012000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012010: 2020 290a 0a20 2020 2020 2020 2061 7761    )..        awa
-00012020: 6974 2073 656c 662e 7175 6575 655f 7570  it self.queue_up
-00012030: 6461 7465 2863 616c 6c62 6163 6b29 0a0a  date(callback)..
-00012040: 2020 2020 6173 796e 6320 6465 6620 7365      async def se
-00012050: 745f 636f 6c6f 725f 6e69 6768 745f 7669  t_color_night_vi
-00012060: 7369 6f6e 2873 656c 662c 2065 6e61 626c  sion(self, enabl
-00012070: 6564 3a20 626f 6f6c 2920 2d3e 204e 6f6e  ed: bool) -> Non
-00012080: 653a 0a20 2020 2020 2020 2022 2222 5365  e:.        """Se
-00012090: 7473 2043 6f6c 6f72 204e 6967 6874 2056  ts Color Night V
-000120a0: 6973 696f 6e20 6f6e 2063 616d 6572 6122  ision on camera"
-000120b0: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
-000120c0: 6f74 2073 656c 662e 6861 735f 636f 6c6f  ot self.has_colo
-000120d0: 725f 6e69 6768 745f 7669 7369 6f6e 3a0a  r_night_vision:.
-000120e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000120f0: 6520 4261 6452 6571 7565 7374 2822 4361  e BadRequest("Ca
-00012100: 6d65 7261 2064 6f65 7320 6e6f 7420 6861  mera does not ha
-00012110: 7665 2043 6f6c 6f72 204e 6967 6874 2056  ve Color Night V
-00012120: 6973 696f 6e22 290a 0a20 2020 2020 2020  ision")..       
-00012130: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
-00012140: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00012150: 2020 2020 2073 656c 662e 6973 705f 7365       self.isp_se
-00012160: 7474 696e 6773 2e69 735f 636f 6c6f 725f  ttings.is_color_
-00012170: 6e69 6768 745f 7669 7369 6f6e 5f65 6e61  night_vision_ena
-00012180: 626c 6564 203d 2065 6e61 626c 6564 0a0a  bled = enabled..
-00012190: 2020 2020 2020 2020 6177 6169 7420 7365          await se
-000121a0: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
-000121b0: 6361 6c6c 6261 636b 290a 0a20 2020 2061  callback)..    a
-000121c0: 7379 6e63 2064 6566 2073 6574 5f76 6964  sync def set_vid
-000121d0: 656f 5f6d 6f64 6528 7365 6c66 2c20 6d6f  eo_mode(self, mo
-000121e0: 6465 3a20 5669 6465 6f4d 6f64 6529 202d  de: VideoMode) -
-000121f0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00012200: 2222 2253 6574 7320 7669 6465 6f20 6d6f  """Sets video mo
-00012210: 6465 206f 6e20 6361 6d65 7261 2222 220a  de on camera""".
-00012220: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-00012230: 206e 6f74 2069 6e20 7365 6c66 2e66 6561   not in self.fea
-00012240: 7475 7265 5f66 6c61 6773 2e76 6964 656f  ture_flags.video
-00012250: 5f6d 6f64 6573 3a0a 2020 2020 2020 2020  _modes:.        
-00012260: 2020 2020 7261 6973 6520 4261 6452 6571      raise BadReq
-00012270: 7565 7374 2866 2243 616d 6572 6120 646f  uest(f"Camera do
-00012280: 6573 206e 6f74 2068 6176 6520 7b6d 6f64  es not have {mod
-00012290: 657d 2229 0a0a 2020 2020 2020 2020 6465  e}")..        de
-000122a0: 6620 6361 6c6c 6261 636b 2829 202d 3e20  f callback() -> 
-000122b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000122c0: 2020 7365 6c66 2e76 6964 656f 5f6d 6f64    self.video_mod
-000122d0: 6520 3d20 6d6f 6465 0a0a 2020 2020 2020  e = mode..      
-000122e0: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
-000122f0: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
-00012300: 636b 290a 0a20 2020 2061 7379 6e63 2064  ck)..    async d
-00012310: 6566 2073 6574 5f63 616d 6572 615f 7a6f  ef set_camera_zo
-00012320: 6f6d 2873 656c 662c 206c 6576 656c 3a20  om(self, level: 
-00012330: 696e 7429 202d 3e20 4e6f 6e65 3a0a 2020  int) -> None:.  
-00012340: 2020 2020 2020 2222 2253 6574 7320 7a6f        """Sets zo
-00012350: 6f6d 206c 6576 656c 2066 6f72 2063 616d  om level for cam
-00012360: 6572 6122 2222 0a0a 2020 2020 2020 2020  era"""..        
-00012370: 6966 206e 6f74 2073 656c 662e 6665 6174  if not self.feat
-00012380: 7572 655f 666c 6167 732e 6361 6e5f 6f70  ure_flags.can_op
-00012390: 7469 6361 6c5f 7a6f 6f6d 3a0a 2020 2020  tical_zoom:.    
-000123a0: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
-000123b0: 6452 6571 7565 7374 2822 4361 6d65 7261  dRequest("Camera
-000123c0: 2063 616e 6e6f 7420 6f70 7469 6361 6c20   cannot optical 
-000123d0: 7a6f 6f6d 2229 0a0a 2020 2020 2020 2020  zoom")..        
-000123e0: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
-000123f0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00012400: 2020 2020 7365 6c66 2e69 7370 5f73 6574      self.isp_set
-00012410: 7469 6e67 732e 7a6f 6f6d 5f70 6f73 6974  tings.zoom_posit
-00012420: 696f 6e20 3d20 5065 7263 656e 7449 6e74  ion = PercentInt
-00012430: 286c 6576 656c 290a 0a20 2020 2020 2020  (level)..       
-00012440: 2061 7761 6974 2073 656c 662e 7175 6575   await self.queu
-00012450: 655f 7570 6461 7465 2863 616c 6c62 6163  e_update(callbac
-00012460: 6b29 0a0a 2020 2020 6173 796e 6320 6465  k)..    async de
-00012470: 6620 7365 745f 7764 725f 6c65 7665 6c28  f set_wdr_level(
-00012480: 7365 6c66 2c20 6c65 7665 6c3a 2069 6e74  self, level: int
-00012490: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000124a0: 2020 2022 2222 5365 7473 2057 4452 2028     """Sets WDR (
-000124b0: 5769 6465 2044 796e 616d 6963 2052 616e  Wide Dynamic Ran
-000124c0: 6765 2920 6f6e 2063 616d 6572 6122 2222  ge) on camera"""
-000124d0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000124e0: 662e 6665 6174 7572 655f 666c 6167 732e  f.feature_flags.
-000124f0: 6861 735f 6864 723a 0a20 2020 2020 2020  has_hdr:.       
-00012500: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
-00012510: 7175 6573 7428 2243 616e 6e6f 7420 7365  quest("Cannot se
-00012520: 7420 5744 5220 6f6e 2063 616d 6572 6173  t WDR on cameras
-00012530: 2077 6974 6820 4844 5222 290a 0a20 2020   with HDR")..   
-00012540: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
-00012550: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
-00012560: 2020 2020 2020 2020 2073 656c 662e 6973           self.is
-00012570: 705f 7365 7474 696e 6773 2e77 6472 203d  p_settings.wdr =
-00012580: 2057 4452 4c65 7665 6c28 6c65 7665 6c29   WDRLevel(level)
-00012590: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
-000125a0: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
-000125b0: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
-000125c0: 2061 7379 6e63 2064 6566 2073 6574 5f6d   async def set_m
-000125d0: 6963 5f76 6f6c 756d 6528 7365 6c66 2c20  ic_volume(self, 
-000125e0: 6c65 7665 6c3a 2069 6e74 2920 2d3e 204e  level: int) -> N
-000125f0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00012600: 5365 7473 2074 6865 206d 6963 2073 656e  Sets the mic sen
-00012610: 7369 7469 7669 7479 206c 6576 656c 206f  sitivity level o
-00012620: 6e20 6361 6d65 7261 2222 220a 0a20 2020  n camera"""..   
-00012630: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00012640: 2e66 6561 7475 7265 5f66 6c61 6773 2e68  .feature_flags.h
-00012650: 6173 5f6d 6963 3a0a 2020 2020 2020 2020  as_mic:.        
-00012660: 2020 2020 7261 6973 6520 4261 6452 6571      raise BadReq
-00012670: 7565 7374 2822 4361 6d65 7261 2064 6f65  uest("Camera doe
-00012680: 7320 6e6f 7420 6861 7665 206d 6963 2229  s not have mic")
-00012690: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
-000126a0: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
-000126b0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000126c0: 6c66 2e6d 6963 5f76 6f6c 756d 6520 3d20  lf.mic_volume = 
-000126d0: 5065 7263 656e 7449 6e74 286c 6576 656c  PercentInt(level
-000126e0: 290a 0a20 2020 2020 2020 2061 7761 6974  )..        await
-000126f0: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
-00012700: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
-00012710: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-00012720: 7370 6561 6b65 725f 766f 6c75 6d65 2873  speaker_volume(s
-00012730: 656c 662c 206c 6576 656c 3a20 696e 7429  elf, level: int)
-00012740: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00012750: 2020 2222 2253 6574 7320 7468 6520 7370    """Sets the sp
-00012760: 6561 6b65 7220 7365 6e73 6974 6976 6974  eaker sensitivit
-00012770: 7920 6c65 7665 6c20 6f6e 2063 616d 6572  y level on camer
-00012780: 612e 2052 6571 7569 7265 7320 6361 6d65  a. Requires came
-00012790: 7261 2074 6f20 6861 7665 2073 7065 616b  ra to have speak
-000127a0: 6572 7322 2222 0a0a 2020 2020 2020 2020  ers"""..        
-000127b0: 6966 206e 6f74 2073 656c 662e 6665 6174  if not self.feat
-000127c0: 7572 655f 666c 6167 732e 6861 735f 7370  ure_flags.has_sp
-000127d0: 6561 6b65 723a 0a20 2020 2020 2020 2020  eaker:.         
-000127e0: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
-000127f0: 6573 7428 2243 616d 6572 6120 646f 6573  est("Camera does
-00012800: 206e 6f74 2068 6176 6520 7370 6561 6b65   not have speake
-00012810: 7222 290a 0a20 2020 2020 2020 2064 6566  r")..        def
-00012820: 2063 616c 6c62 6163 6b28 2920 2d3e 204e   callback() -> N
-00012830: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00012840: 2073 656c 662e 7370 6561 6b65 725f 7365   self.speaker_se
-00012850: 7474 696e 6773 2e76 6f6c 756d 6520 3d20  ttings.volume = 
-00012860: 5065 7263 656e 7449 6e74 286c 6576 656c  PercentInt(level
-00012870: 290a 0a20 2020 2020 2020 2061 7761 6974  )..        await
-00012880: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
-00012890: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
-000128a0: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-000128b0: 6368 696d 655f 7479 7065 2873 656c 662c  chime_type(self,
-000128c0: 2063 6869 6d65 5f74 7970 653a 2043 6869   chime_type: Chi
-000128d0: 6d65 5479 7065 2920 2d3e 204e 6f6e 653a  meType) -> None:
-000128e0: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
-000128f0: 2063 6869 6d65 2074 7970 6520 666f 7220   chime type for 
-00012900: 646f 6f72 6265 6c6c 2e20 5265 7175 6972  doorbell. Requir
-00012910: 6573 2063 616d 6572 6120 746f 2062 6520  es camera to be 
-00012920: 6120 646f 6f72 6265 6c6c 2222 220a 0a20  a doorbell""".. 
-00012930: 2020 2020 2020 2061 7761 6974 2073 656c         await sel
-00012940: 662e 7365 745f 6368 696d 655f 6475 7261  f.set_chime_dura
-00012950: 7469 6f6e 2874 696d 6564 656c 7461 286d  tion(timedelta(m
-00012960: 696c 6c69 7365 636f 6e64 733d 6368 696d  illiseconds=chim
-00012970: 655f 7479 7065 2e76 616c 7565 2929 0a0a  e_type.value))..
-00012980: 2020 2020 6173 796e 6320 6465 6620 7365      async def se
-00012990: 745f 6368 696d 655f 6475 7261 7469 6f6e  t_chime_duration
-000129a0: 2873 656c 662c 2064 7572 6174 696f 6e3a  (self, duration:
-000129b0: 2074 696d 6564 656c 7461 207c 2066 6c6f   timedelta | flo
-000129c0: 6174 2920 2d3e 204e 6f6e 653a 0a20 2020  at) -> None:.   
-000129d0: 2020 2020 2022 2222 5365 7473 2063 6869       """Sets chi
-000129e0: 6d65 2064 7572 6174 696f 6e20 666f 7220  me duration for 
-000129f0: 646f 6f72 6265 6c6c 2e20 5265 7175 6972  doorbell. Requir
-00012a00: 6573 2063 616d 6572 6120 746f 2062 6520  es camera to be 
-00012a10: 6120 646f 6f72 6265 6c6c 2222 220a 0a20  a doorbell""".. 
-00012a20: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00012a30: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
-00012a40: 2e68 6173 5f63 6869 6d65 3a0a 2020 2020  .has_chime:.    
-00012a50: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
-00012a60: 6452 6571 7565 7374 2822 4361 6d65 7261  dRequest("Camera
-00012a70: 2064 6f65 7320 6e6f 7420 6861 7665 2061   does not have a
-00012a80: 2063 6869 6d65 2229 0a0a 2020 2020 2020   chime")..      
-00012a90: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00012aa0: 6475 7261 7469 6f6e 2c20 2866 6c6f 6174  duration, (float
-00012ab0: 2c20 696e 7429 293a 0a20 2020 2020 2020  , int)):.       
-00012ac0: 2020 2020 2069 6620 6475 7261 7469 6f6e       if duration
-00012ad0: 203c 2030 3a0a 2020 2020 2020 2020 2020   < 0:.          
-00012ae0: 2020 2020 2020 7261 6973 6520 4261 6452        raise BadR
-00012af0: 6571 7565 7374 2822 4368 696d 6520 6475  equest("Chime du
-00012b00: 7261 7469 6f6e 206d 7573 7420 6265 2061  ration must be a
-00012b10: 2070 6f73 6974 6976 6520 6e75 6d62 6572   positive number
-00012b20: 206f 6620 7365 636f 6e64 7322 290a 2020   of seconds").  
-00012b30: 2020 2020 2020 2020 2020 6475 7261 7469            durati
-00012b40: 6f6e 5f74 6420 3d20 7469 6d65 6465 6c74  on_td = timedelt
-00012b50: 6128 7365 636f 6e64 733d 6475 7261 7469  a(seconds=durati
-00012b60: 6f6e 290a 2020 2020 2020 2020 656c 7365  on).        else
-00012b70: 3a0a 2020 2020 2020 2020 2020 2020 6475  :.            du
-00012b80: 7261 7469 6f6e 5f74 6420 3d20 6475 7261  ration_td = dura
-00012b90: 7469 6f6e 0a0a 2020 2020 2020 2020 6966  tion..        if
-00012ba0: 2064 7572 6174 696f 6e5f 7464 2e74 6f74   duration_td.tot
-00012bb0: 616c 5f73 6563 6f6e 6473 2829 203e 2031  al_seconds() > 1
-00012bc0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-00012bd0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
-00012be0: 2243 6869 6d65 2064 7572 6174 696f 6e20  "Chime duration 
-00012bf0: 6973 2074 6f6f 206c 6f6e 6722 290a 0a20  is too long").. 
-00012c00: 2020 2020 2020 2064 6566 2063 616c 6c62         def callb
-00012c10: 6163 6b28 2920 2d3e 204e 6f6e 653a 0a20  ack() -> None:. 
-00012c20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012c30: 6368 696d 655f 6475 7261 7469 6f6e 203d  chime_duration =
-00012c40: 2064 7572 6174 696f 6e5f 7464 0a0a 2020   duration_td..  
-00012c50: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
-00012c60: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
-00012c70: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
-00012c80: 6e63 2064 6566 2073 6574 5f73 7973 7465  nc def set_syste
-00012c90: 6d5f 736f 756e 6473 2873 656c 662c 2065  m_sounds(self, e
-00012ca0: 6e61 626c 6564 3a20 626f 6f6c 2920 2d3e  nabled: bool) ->
-00012cb0: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-00012cc0: 2222 5365 7473 2073 7973 7465 6d20 736f  ""Sets system so
-00012cd0: 756e 6420 706c 6179 6261 636b 2074 6872  und playback thr
-00012ce0: 6f75 6768 2073 7065 616b 6572 732e 2052  ough speakers. R
-00012cf0: 6571 7569 7265 7320 6361 6d65 7261 2074  equires camera t
-00012d00: 6f20 6861 7665 2073 7065 616b 6572 7322  o have speakers"
-00012d10: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
-00012d20: 6f74 2073 656c 662e 6665 6174 7572 655f  ot self.feature_
-00012d30: 666c 6167 732e 6861 735f 7370 6561 6b65  flags.has_speake
-00012d40: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
-00012d50: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
-00012d60: 2243 616d 6572 6120 646f 6573 206e 6f74  "Camera does not
-00012d70: 2068 6176 6520 7370 6561 6b65 7222 290a   have speaker").
-00012d80: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
-00012d90: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
-00012da0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012db0: 662e 7370 6561 6b65 725f 7365 7474 696e  f.speaker_settin
-00012dc0: 6773 2e61 7265 5f73 7973 7465 6d5f 736f  gs.are_system_so
-00012dd0: 756e 6473 5f65 6e61 626c 6564 203d 2065  unds_enabled = e
-00012de0: 6e61 626c 6564 0a0a 2020 2020 2020 2020  nabled..        
-00012df0: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
-00012e00: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
-00012e10: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
-00012e20: 2073 6574 5f6f 7364 5f6e 616d 6528 7365   set_osd_name(se
-00012e30: 6c66 2c20 656e 6162 6c65 643a 2062 6f6f  lf, enabled: boo
-00012e40: 6c29 202d 3e20 4e6f 6e65 3a0a 2020 2020  l) -> None:.    
-00012e50: 2020 2020 2222 2253 6574 7320 7768 6574      """Sets whet
-00012e60: 6865 7220 6361 6d65 7261 206e 616d 6520  her camera name 
-00012e70: 6973 2069 6e20 7468 6520 4f6e 2053 6372  is in the On Scr
-00012e80: 6565 6e20 4469 7370 6c61 7922 2222 0a0a  een Display"""..
-00012e90: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00012ea0: 7573 655f 676c 6f62 616c 3a0a 2020 2020  use_global:.    
-00012eb0: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
-00012ec0: 6452 6571 7565 7374 2822 4361 6d65 7261  dRequest("Camera
-00012ed0: 2069 7320 7573 696e 6720 676c 6f62 616c   is using global
-00012ee0: 2072 6563 6f72 6469 6e67 2073 6574 7469   recording setti
-00012ef0: 6e67 732e 2229 0a0a 2020 2020 2020 2020  ngs.")..        
-00012f00: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
-00012f10: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00012f20: 2020 2020 7365 6c66 2e6f 7364 5f73 6574      self.osd_set
-00012f30: 7469 6e67 732e 6973 5f6e 616d 655f 656e  tings.is_name_en
-00012f40: 6162 6c65 6420 3d20 656e 6162 6c65 640a  abled = enabled.
-00012f50: 0a20 2020 2020 2020 2061 7761 6974 2073  .        await s
-00012f60: 656c 662e 7175 6575 655f 7570 6461 7465  elf.queue_update
-00012f70: 2863 616c 6c62 6163 6b29 0a0a 2020 2020  (callback)..    
-00012f80: 6173 796e 6320 6465 6620 7365 745f 6f73  async def set_os
-00012f90: 645f 6461 7465 2873 656c 662c 2065 6e61  d_date(self, ena
-00012fa0: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
-00012fb0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00012fc0: 5365 7473 2077 6865 7468 6572 2063 7572  Sets whether cur
-00012fd0: 7265 6e74 2064 6174 6520 6973 2069 6e20  rent date is in 
-00012fe0: 7468 6520 4f6e 2053 6372 6565 6e20 4469  the On Screen Di
-00012ff0: 7370 6c61 7922 2222 0a0a 2020 2020 2020  splay"""..      
-00013000: 2020 6966 2073 656c 662e 7573 655f 676c    if self.use_gl
-00013010: 6f62 616c 3a0a 2020 2020 2020 2020 2020  obal:.          
-00013020: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
-00013030: 7374 2822 4361 6d65 7261 2069 7320 7573  st("Camera is us
-00013040: 696e 6720 676c 6f62 616c 2072 6563 6f72  ing global recor
-00013050: 6469 6e67 2073 6574 7469 6e67 732e 2229  ding settings.")
-00013060: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
-00013070: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
-00013080: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00013090: 6c66 2e6f 7364 5f73 6574 7469 6e67 732e  lf.osd_settings.
-000130a0: 6973 5f64 6174 655f 656e 6162 6c65 6420  is_date_enabled 
-000130b0: 3d20 656e 6162 6c65 640a 0a20 2020 2020  = enabled..     
-000130c0: 2020 2061 7761 6974 2073 656c 662e 7175     await self.qu
-000130d0: 6575 655f 7570 6461 7465 2863 616c 6c62  eue_update(callb
-000130e0: 6163 6b29 0a0a 2020 2020 6173 796e 6320  ack)..    async 
-000130f0: 6465 6620 7365 745f 6f73 645f 6c6f 676f  def set_osd_logo
-00013100: 2873 656c 662c 2065 6e61 626c 6564 3a20  (self, enabled: 
-00013110: 626f 6f6c 2920 2d3e 204e 6f6e 653a 0a20  bool) -> None:. 
-00013120: 2020 2020 2020 2022 2222 5365 7473 2077         """Sets w
-00013130: 6865 7468 6572 2074 6865 2055 6e69 4669  hether the UniFi
-00013140: 206c 6f67 6f20 6973 2069 6e20 7468 6520   logo is in the 
-00013150: 4f6e 2053 6372 6565 6e20 4469 7370 6c61  On Screen Displa
-00013160: 7922 2222 0a0a 2020 2020 2020 2020 6966  y"""..        if
-00013170: 2073 656c 662e 7573 655f 676c 6f62 616c   self.use_global
-00013180: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00013190: 6973 6520 4261 6452 6571 7565 7374 2822  ise BadRequest("
-000131a0: 4361 6d65 7261 2069 7320 7573 696e 6720  Camera is using 
-000131b0: 676c 6f62 616c 2072 6563 6f72 6469 6e67  global recording
-000131c0: 2073 6574 7469 6e67 732e 2229 0a0a 2020   settings.")..  
-000131d0: 2020 2020 2020 6465 6620 6361 6c6c 6261        def callba
-000131e0: 636b 2829 202d 3e20 4e6f 6e65 3a0a 2020  ck() -> None:.  
-000131f0: 2020 2020 2020 2020 2020 7365 6c66 2e6f            self.o
-00013200: 7364 5f73 6574 7469 6e67 732e 6973 5f6c  sd_settings.is_l
-00013210: 6f67 6f5f 656e 6162 6c65 6420 3d20 656e  ogo_enabled = en
-00013220: 6162 6c65 640a 0a20 2020 2020 2020 2061  abled..        a
-00013230: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
-00013240: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
-00013250: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-00013260: 7365 745f 6f73 645f 6269 7472 6174 6528  set_osd_bitrate(
-00013270: 7365 6c66 2c20 656e 6162 6c65 643a 2062  self, enabled: b
-00013280: 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a 2020  ool) -> None:.  
-00013290: 2020 2020 2020 2222 2253 6574 7320 7768        """Sets wh
-000132a0: 6574 6865 7220 6361 6d65 7261 2062 6974  ether camera bit
-000132b0: 7261 7465 2069 7320 696e 2074 6865 204f  rate is in the O
-000132c0: 6e20 5363 7265 656e 2044 6973 706c 6179  n Screen Display
-000132d0: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-000132e0: 7365 6c66 2e75 7365 5f67 6c6f 6261 6c3a  self.use_global:
-000132f0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00013300: 7365 2042 6164 5265 7175 6573 7428 2243  se BadRequest("C
-00013310: 616d 6572 6120 6973 2075 7369 6e67 2067  amera is using g
-00013320: 6c6f 6261 6c20 7265 636f 7264 696e 6720  lobal recording 
-00013330: 7365 7474 696e 6773 2e22 290a 0a20 2020  settings.")..   
-00013340: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
-00013350: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
-00013360: 2020 2020 2020 2020 2023 206d 6973 6d61           # misma
-00013370: 7463 6820 6265 7477 6565 6e20 5549 2069  tch between UI i
-00013380: 6e74 6572 6e61 6c20 6461 7461 2073 7472  nternal data str
-00013390: 7563 7475 7265 2064 6562 7567 203d 2062  ucture debug = b
-000133a0: 6974 7261 7465 2064 6174 610a 2020 2020  itrate data.    
-000133b0: 2020 2020 2020 2020 7365 6c66 2e6f 7364          self.osd
-000133c0: 5f73 6574 7469 6e67 732e 6973 5f64 6562  _settings.is_deb
-000133d0: 7567 5f65 6e61 626c 6564 203d 2065 6e61  ug_enabled = ena
-000133e0: 626c 6564 0a0a 2020 2020 2020 2020 6177  bled..        aw
-000133f0: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
-00013400: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
-00013410: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
-00013420: 6574 5f73 6d61 7274 5f64 6574 6563 745f  et_smart_detect_
-00013430: 7479 7065 7328 7365 6c66 2c20 7479 7065  types(self, type
-00013440: 733a 206c 6973 745b 536d 6172 7444 6574  s: list[SmartDet
-00013450: 6563 744f 626a 6563 7454 7970 655d 2920  ectObjectType]) 
-00013460: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00013470: 2022 2222 5365 7473 2063 7572 7265 6e74   """Sets current
-00013480: 2065 6e61 626c 6564 2073 6d61 7274 2064   enabled smart d
-00013490: 6574 6563 7469 6f6e 2074 7970 6573 2e20  etection types. 
-000134a0: 5265 7175 6972 6573 2063 616d 6572 6120  Requires camera 
-000134b0: 746f 2068 6176 6520 736d 6172 7420 6465  to have smart de
-000134c0: 7465 6374 696f 6e22 2222 0a0a 2020 2020  tection"""..    
-000134d0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-000134e0: 6665 6174 7572 655f 666c 6167 732e 6861  feature_flags.ha
-000134f0: 735f 736d 6172 745f 6465 7465 6374 3a0a  s_smart_detect:.
-00013500: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00013510: 6520 4261 6452 6571 7565 7374 2822 4361  e BadRequest("Ca
-00013520: 6d65 7261 2064 6f65 7320 6e6f 7420 6861  mera does not ha
-00013530: 7665 2061 2073 6d61 7274 2064 6574 6563  ve a smart detec
-00013540: 7469 6f6e 7322 290a 0a20 2020 2020 2020  tions")..       
-00013550: 2069 6620 7365 6c66 2e75 7365 5f67 6c6f   if self.use_glo
-00013560: 6261 6c3a 0a20 2020 2020 2020 2020 2020  bal:.           
-00013570: 2072 6169 7365 2042 6164 5265 7175 6573   raise BadReques
-00013580: 7428 2243 616d 6572 6120 6973 2075 7369  t("Camera is usi
-00013590: 6e67 2067 6c6f 6261 6c20 7265 636f 7264  ng global record
-000135a0: 696e 6720 7365 7474 696e 6773 2e22 290a  ing settings.").
-000135b0: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
-000135c0: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
-000135d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000135e0: 662e 736d 6172 745f 6465 7465 6374 5f73  f.smart_detect_s
-000135f0: 6574 7469 6e67 732e 6f62 6a65 6374 5f74  ettings.object_t
-00013600: 7970 6573 203d 2074 7970 6573 0a0a 2020  ypes = types..  
-00013610: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
-00013620: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
-00013630: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
-00013640: 6e63 2064 6566 2073 6574 5f73 6d61 7274  nc def set_smart
-00013650: 5f61 7564 696f 5f64 6574 6563 745f 7479  _audio_detect_ty
-00013660: 7065 7328 0a20 2020 2020 2020 2073 656c  pes(.        sel
-00013670: 662c 0a20 2020 2020 2020 2074 7970 6573  f,.        types
-00013680: 3a20 6c69 7374 5b53 6d61 7274 4465 7465  : list[SmartDete
-00013690: 6374 4175 6469 6f54 7970 655d 2c0a 2020  ctAudioType],.  
-000136a0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-000136b0: 2020 2020 2022 2222 5365 7473 2063 7572       """Sets cur
-000136c0: 7265 6e74 2065 6e61 626c 6564 2073 6d61  rent enabled sma
-000136d0: 7274 2061 7564 696f 2064 6574 6563 7469  rt audio detecti
-000136e0: 6f6e 2074 7970 6573 2e20 5265 7175 6972  on types. Requir
-000136f0: 6573 2063 616d 6572 6120 746f 2068 6176  es camera to hav
-00013700: 6520 736d 6172 7420 6465 7465 6374 696f  e smart detectio
-00013710: 6e22 2222 0a0a 2020 2020 2020 2020 6966  n"""..        if
-00013720: 206e 6f74 2073 656c 662e 6665 6174 7572   not self.featur
-00013730: 655f 666c 6167 732e 6861 735f 736d 6172  e_flags.has_smar
-00013740: 745f 6465 7465 6374 3a0a 2020 2020 2020  t_detect:.      
-00013750: 2020 2020 2020 7261 6973 6520 4261 6452        raise BadR
-00013760: 6571 7565 7374 2822 4361 6d65 7261 2064  equest("Camera d
-00013770: 6f65 7320 6e6f 7420 6861 7665 2061 2073  oes not have a s
-00013780: 6d61 7274 2064 6574 6563 7469 6f6e 7322  mart detections"
-00013790: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-000137a0: 6c66 2e75 7365 5f67 6c6f 6261 6c3a 0a20  lf.use_global:. 
-000137b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000137c0: 2042 6164 5265 7175 6573 7428 2243 616d   BadRequest("Cam
-000137d0: 6572 6120 6973 2075 7369 6e67 2067 6c6f  era is using glo
-000137e0: 6261 6c20 7265 636f 7264 696e 6720 7365  bal recording se
-000137f0: 7474 696e 6773 2e22 290a 0a20 2020 2020  ttings.")..     
-00013800: 2020 2064 6566 2063 616c 6c62 6163 6b28     def callback(
-00013810: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00013820: 2020 2020 2020 2073 656c 662e 736d 6172         self.smar
-00013830: 745f 6465 7465 6374 5f73 6574 7469 6e67  t_detect_setting
-00013840: 732e 6175 6469 6f5f 7479 7065 7320 3d20  s.audio_types = 
-00013850: 7479 7065 730a 0a20 2020 2020 2020 2061  types..        a
-00013860: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
-00013870: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
-00013880: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-00013890: 5f73 6574 5f6f 626a 6563 745f 6465 7465  _set_object_dete
-000138a0: 6374 280a 2020 2020 2020 2020 7365 6c66  ct(.        self
-000138b0: 2c0a 2020 2020 2020 2020 6f62 6a5f 746f  ,.        obj_to
-000138c0: 5f6d 6f64 3a20 536d 6172 7444 6574 6563  _mod: SmartDetec
-000138d0: 744f 626a 6563 7454 7970 652c 0a20 2020  tObjectType,.   
-000138e0: 2020 2020 2065 6e61 626c 6564 3a20 626f       enabled: bo
-000138f0: 6f6c 2c0a 2020 2020 2920 2d3e 204e 6f6e  ol,.    ) -> Non
-00013900: 653a 0a20 2020 2020 2020 2069 6620 6f62  e:.        if ob
-00013910: 6a5f 746f 5f6d 6f64 206e 6f74 2069 6e20  j_to_mod not in 
-00013920: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
-00013930: 6773 2e73 6d61 7274 5f64 6574 6563 745f  gs.smart_detect_
-00013940: 7479 7065 733a 0a20 2020 2020 2020 2020  types:.         
-00013950: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
-00013960: 6573 7428 6622 4361 6d65 7261 2064 6f65  est(f"Camera doe
-00013970: 7320 6e6f 7420 7375 7070 6f72 7420 7468  s not support th
-00013980: 6520 7b6f 626a 5f74 6f5f 6d6f 647d 2064  e {obj_to_mod} d
-00013990: 6574 6563 7469 6f6e 2074 7970 6522 290a  etection type").
-000139a0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000139b0: 2e75 7365 5f67 6c6f 6261 6c3a 0a20 2020  .use_global:.   
-000139c0: 2020 2020 2020 2020 2072 6169 7365 2042           raise B
-000139d0: 6164 5265 7175 6573 7428 2243 616d 6572  adRequest("Camer
-000139e0: 6120 6973 2075 7369 6e67 2067 6c6f 6261  a is using globa
-000139f0: 6c20 7265 636f 7264 696e 6720 7365 7474  l recording sett
-00013a00: 696e 6773 2e22 290a 0a20 2020 2020 2020  ings.")..       
-00013a10: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
-00013a20: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00013a30: 2020 2020 206f 626a 6563 7473 203d 2073       objects = s
-00013a40: 656c 662e 736d 6172 745f 6465 7465 6374  elf.smart_detect
-00013a50: 5f73 6574 7469 6e67 732e 6f62 6a65 6374  _settings.object
-00013a60: 5f74 7970 6573 0a20 2020 2020 2020 2020  _types.         
-00013a70: 2020 2069 6620 656e 6162 6c65 643a 0a20     if enabled:. 
-00013a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00013a90: 6620 6f62 6a5f 746f 5f6d 6f64 206e 6f74  f obj_to_mod not
-00013aa0: 2069 6e20 6f62 6a65 6374 733a 0a20 2020   in objects:.   
-00013ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ac0: 206f 626a 6563 7473 203d 205b 2a6f 626a   objects = [*obj
-00013ad0: 6563 7473 2c20 6f62 6a5f 746f 5f6d 6f64  ects, obj_to_mod
-00013ae0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00013af0: 2020 2020 2020 6f62 6a65 6374 732e 736f        objects.so
-00013b00: 7274 2829 0a20 2020 2020 2020 2020 2020  rt().           
-00013b10: 2065 6c69 6620 6f62 6a5f 746f 5f6d 6f64   elif obj_to_mod
-00013b20: 2069 6e20 6f62 6a65 6374 733a 0a20 2020   in objects:.   
-00013b30: 2020 2020 2020 2020 2020 2020 206f 626a               obj
-00013b40: 6563 7473 2e72 656d 6f76 6528 6f62 6a5f  ects.remove(obj_
-00013b50: 746f 5f6d 6f64 290a 2020 2020 2020 2020  to_mod).        
-00013b60: 2020 2020 7365 6c66 2e73 6d61 7274 5f64      self.smart_d
-00013b70: 6574 6563 745f 7365 7474 696e 6773 2e6f  etect_settings.o
-00013b80: 626a 6563 745f 7479 7065 7320 3d20 6f62  bject_types = ob
-00013b90: 6a65 6374 730a 0a20 2020 2020 2020 2061  jects..        a
-00013ba0: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
-00013bb0: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
-00013bc0: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-00013bd0: 5f73 6574 5f61 7564 696f 5f64 6574 6563  _set_audio_detec
-00013be0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-00013bf0: 0a20 2020 2020 2020 206f 626a 5f74 6f5f  .        obj_to_
-00013c00: 6d6f 643a 2053 6d61 7274 4465 7465 6374  mod: SmartDetect
-00013c10: 4175 6469 6f54 7970 652c 0a20 2020 2020  AudioType,.     
-00013c20: 2020 2065 6e61 626c 6564 3a20 626f 6f6c     enabled: bool
-00013c30: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-00013c40: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
-00013c50: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00013c60: 6561 7475 7265 5f66 6c61 6773 2e73 6d61  eature_flags.sma
-00013c70: 7274 5f64 6574 6563 745f 6175 6469 6f5f  rt_detect_audio_
-00013c80: 7479 7065 7320 6973 204e 6f6e 650a 2020  types is None.  
-00013c90: 2020 2020 2020 2020 2020 6f72 206f 626a            or obj
-00013ca0: 5f74 6f5f 6d6f 6420 6e6f 7420 696e 2073  _to_mod not in s
-00013cb0: 656c 662e 6665 6174 7572 655f 666c 6167  elf.feature_flag
-00013cc0: 732e 736d 6172 745f 6465 7465 6374 5f61  s.smart_detect_a
-00013cd0: 7564 696f 5f74 7970 6573 0a20 2020 2020  udio_types.     
-00013ce0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00013cf0: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
-00013d00: 7374 2866 2243 616d 6572 6120 646f 6573  st(f"Camera does
-00013d10: 206e 6f74 2073 7570 706f 7274 2074 6865   not support the
-00013d20: 207b 6f62 6a5f 746f 5f6d 6f64 7d20 6465   {obj_to_mod} de
-00013d30: 7465 6374 696f 6e20 7479 7065 2229 0a0a  tection type")..
-00013d40: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00013d50: 7573 655f 676c 6f62 616c 3a0a 2020 2020  use_global:.    
-00013d60: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
-00013d70: 6452 6571 7565 7374 2822 4361 6d65 7261  dRequest("Camera
-00013d80: 2069 7320 7573 696e 6720 676c 6f62 616c   is using global
-00013d90: 2072 6563 6f72 6469 6e67 2073 6574 7469   recording setti
-00013da0: 6e67 732e 2229 0a0a 2020 2020 2020 2020  ngs.")..        
-00013db0: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
-00013dc0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00013dd0: 2020 2020 6f62 6a65 6374 7320 3d20 7365      objects = se
-00013de0: 6c66 2e73 6d61 7274 5f64 6574 6563 745f  lf.smart_detect_
-00013df0: 7365 7474 696e 6773 2e61 7564 696f 5f74  settings.audio_t
-00013e00: 7970 6573 206f 7220 5b5d 0a20 2020 2020  ypes or [].     
-00013e10: 2020 2020 2020 2069 6620 656e 6162 6c65         if enable
-00013e20: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-00013e30: 2020 2069 6620 6f62 6a5f 746f 5f6d 6f64     if obj_to_mod
-00013e40: 206e 6f74 2069 6e20 6f62 6a65 6374 733a   not in objects:
-00013e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013e60: 2020 2020 206f 626a 6563 7473 203d 205b       objects = [
-00013e70: 2a6f 626a 6563 7473 2c20 6f62 6a5f 746f  *objects, obj_to
-00013e80: 5f6d 6f64 5d0a 2020 2020 2020 2020 2020  _mod].          
-00013e90: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
-00013ea0: 732e 736f 7274 2829 0a20 2020 2020 2020  s.sort().       
-00013eb0: 2020 2020 2065 6c69 6620 6f62 6a5f 746f       elif obj_to
-00013ec0: 5f6d 6f64 2069 6e20 6f62 6a65 6374 733a  _mod in objects:
-00013ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ee0: 206f 626a 6563 7473 2e72 656d 6f76 6528   objects.remove(
-00013ef0: 6f62 6a5f 746f 5f6d 6f64 290a 2020 2020  obj_to_mod).    
-00013f00: 2020 2020 2020 2020 7365 6c66 2e73 6d61          self.sma
-00013f10: 7274 5f64 6574 6563 745f 7365 7474 696e  rt_detect_settin
-00013f20: 6773 2e61 7564 696f 5f74 7970 6573 203d  gs.audio_types =
-00013f30: 206f 626a 6563 7473 0a0a 2020 2020 2020   objects..      
-00013f40: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
-00013f50: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
-00013f60: 636b 290a 0a20 2020 2061 7379 6e63 2064  ck)..    async d
-00013f70: 6566 2073 6574 5f6c 6364 5f74 6578 7428  ef set_lcd_text(
-00013f80: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00013f90: 2020 2020 2020 2074 6578 745f 7479 7065         text_type
-00013fa0: 3a20 4f70 7469 6f6e 616c 5b44 6f6f 7262  : Optional[Doorb
-00013fb0: 656c 6c4d 6573 7361 6765 5479 7065 5d2c  ellMessageType],
-00013fc0: 0a20 2020 2020 2020 2074 6578 743a 204f  .        text: O
-00013fd0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-00013fe0: 6f6e 652c 0a20 2020 2020 2020 2072 6573  one,.        res
-00013ff0: 6574 5f61 743a 2055 6e69 6f6e 5b4e 6f6e  et_at: Union[Non
-00014000: 652c 2064 6174 6574 696d 652c 2044 4546  e, datetime, DEF
-00014010: 4155 4c54 5f54 5950 455d 203d 204e 6f6e  AULT_TYPE] = Non
-00014020: 652c 0a20 2020 2029 202d 3e20 4e6f 6e65  e,.    ) -> None
-00014030: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
-00014040: 7320 646f 6f72 6265 6c6c 204c 4344 2074  s doorbell LCD t
-00014050: 6578 742e 2052 6571 7569 7265 7320 6361  ext. Requires ca
-00014060: 6d65 7261 2074 6f20 6265 2064 6f6f 7262  mera to be doorb
-00014070: 656c 6c22 2222 0a0a 2020 2020 2020 2020  ell"""..        
-00014080: 6966 206e 6f74 2073 656c 662e 6665 6174  if not self.feat
-00014090: 7572 655f 666c 6167 732e 6861 735f 6c63  ure_flags.has_lc
-000140a0: 645f 7363 7265 656e 3a0a 2020 2020 2020  d_screen:.      
-000140b0: 2020 2020 2020 7261 6973 6520 4261 6452        raise BadR
-000140c0: 6571 7565 7374 2822 4361 6d65 7261 2064  equest("Camera d
-000140d0: 6f65 7320 6e6f 7420 6861 7665 2061 6e20  oes not have an 
-000140e0: 4c43 4420 7363 7265 656e 2229 0a0a 2020  LCD screen")..  
-000140f0: 2020 2020 2020 6966 2074 6578 745f 7479        if text_ty
-00014100: 7065 2069 7320 4e6f 6e65 3a0a 2020 2020  pe is None:.    
-00014110: 2020 2020 2020 2020 6173 796e 6320 7769          async wi
-00014120: 7468 2073 656c 662e 5f75 7064 6174 655f  th self._update_
-00014130: 6c6f 636b 3a0a 2020 2020 2020 2020 2020  lock:.          
-00014140: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
-00014150: 6369 6f2e 736c 6565 7028 0a20 2020 2020  cio.sleep(.     
-00014160: 2020 2020 2020 2020 2020 2020 2020 2030                 0
-00014170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014180: 2020 2920 2023 2079 6965 6c64 2074 6f20    )  # yield to 
-00014190: 7468 6520 6576 656e 7420 6c6f 6f70 206f  the event loop o
-000141a0: 6e63 6520 7765 2068 6176 6520 7468 6520  nce we have the 
-000141b0: 6c6f 636b 2074 6f20 7072 6f63 6573 7320  lock to process 
-000141c0: 616e 7920 7065 6e64 696e 6720 7570 6461  any pending upda
-000141d0: 7465 730a 2020 2020 2020 2020 2020 2020  tes.            
-000141e0: 2020 2020 6461 7461 5f62 6566 6f72 655f      data_before_
-000141f0: 6368 616e 6765 7320 3d20 7365 6c66 2e64  changes = self.d
-00014200: 6963 745f 7769 7468 5f65 7863 6c75 6465  ict_with_exclude
-00014210: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-00014220: 2020 2020 7365 6c66 2e6c 6364 5f6d 6573      self.lcd_mes
-00014230: 7361 6765 203d 204e 6f6e 650a 2020 2020  sage = None.    
-00014240: 2020 2020 2020 2020 2020 2020 2320 556e              # Un
-00014250: 6946 6920 5072 6f74 6563 7420 6275 673a  iFi Protect bug:
-00014260: 2063 6c65 6172 696e 6720 4c43 4420 7465   clearing LCD te
-00014270: 7874 206d 6573 7361 6765 2064 6f65 7320  xt message does 
-00014280: 5f6e 6f74 5f20 656d 6974 2061 2057 5320  _not_ emit a WS 
-00014290: 6d65 7373 6167 650a 2020 2020 2020 2020  message.        
-000142a0: 2020 2020 2020 2020 6177 6169 7420 7365          await se
-000142b0: 6c66 2e73 6176 655f 6465 7669 6365 2864  lf.save_device(d
-000142c0: 6174 615f 6265 666f 7265 5f63 6861 6e67  ata_before_chang
-000142d0: 6573 2c20 666f 7263 655f 656d 6974 3d54  es, force_emit=T
-000142e0: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-000142f0: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-00014300: 2020 2020 2069 6620 7465 7874 5f74 7970       if text_typ
-00014310: 6520 213d 2044 6f6f 7262 656c 6c4d 6573  e != DoorbellMes
-00014320: 7361 6765 5479 7065 2e43 5553 544f 4d5f  sageType.CUSTOM_
-00014330: 4d45 5353 4147 453a 0a20 2020 2020 2020  MESSAGE:.       
-00014340: 2020 2020 2069 6620 7465 7874 2069 7320       if text is 
-00014350: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00014360: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00014370: 4261 6452 6571 7565 7374 2822 4361 6e20  BadRequest("Can 
-00014380: 6f6e 6c79 2073 6574 2074 6578 7420 6966  only set text if
-00014390: 2074 6578 745f 7479 7065 2069 7320 4355   text_type is CU
-000143a0: 5354 4f4d 5f4d 4553 5341 4745 2229 0a20  STOM_MESSAGE"). 
-000143b0: 2020 2020 2020 2020 2020 2074 6578 7420             text 
-000143c0: 3d20 7465 7874 5f74 7970 652e 7661 6c75  = text_type.valu
-000143d0: 652e 7265 706c 6163 6528 225f 222c 2022  e.replace("_", "
-000143e0: 2022 290a 0a20 2020 2020 2020 2069 6620   ")..        if 
-000143f0: 7265 7365 745f 6174 203d 3d20 4445 4641  reset_at == DEFA
-00014400: 554c 543a 0a20 2020 2020 2020 2020 2020  ULT:.           
-00014410: 2072 6573 6574 5f61 7420 3d20 280a 2020   reset_at = (.  
-00014420: 2020 2020 2020 2020 2020 2020 2020 7574                ut
-00014430: 635f 6e6f 7728 290a 2020 2020 2020 2020  c_now().        
-00014440: 2020 2020 2020 2020 2b20 7365 6c66 2e61          + self.a
-00014450: 7069 2e62 6f6f 7473 7472 6170 2e6e 7672  pi.bootstrap.nvr
-00014460: 2e64 6f6f 7262 656c 6c5f 7365 7474 696e  .doorbell_settin
-00014470: 6773 2e64 6566 6175 6c74 5f6d 6573 7361  gs.default_messa
-00014480: 6765 5f72 6573 6574 5f74 696d 656f 7574  ge_reset_timeout
-00014490: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-000144a0: 2020 2020 2020 2020 6465 6620 6361 6c6c          def call
-000144b0: 6261 636b 2829 202d 3e20 4e6f 6e65 3a0a  back() -> None:.
-000144c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000144d0: 2e6c 6364 5f6d 6573 7361 6765 203d 204c  .lcd_message = L
-000144e0: 4344 4d65 7373 6167 6528 2020 2320 7479  CDMessage(  # ty
-000144f0: 7065 3a20 6967 6e6f 7265 5b63 616c 6c2d  pe: ignore[call-
-00014500: 6172 675d 0a20 2020 2020 2020 2020 2020  arg].           
-00014510: 2020 2020 2061 7069 3d73 656c 662e 5f61       api=self._a
-00014520: 7069 2c0a 2020 2020 2020 2020 2020 2020  pi,.            
-00014530: 2020 2020 7479 7065 3d74 6578 745f 7479      type=text_ty
-00014540: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00014550: 2020 2020 7465 7874 3d74 6578 742c 2020      text=text,  
-00014560: 2320 7479 7065 3a20 6967 6e6f 7265 5b61  # type: ignore[a
-00014570: 7267 2d74 7970 655d 0a20 2020 2020 2020  rg-type].       
-00014580: 2020 2020 2020 2020 2072 6573 6574 5f61           reset_a
-00014590: 743d 7265 7365 745f 6174 2c20 2023 2074  t=reset_at,  # t
-000145a0: 7970 653a 2069 676e 6f72 655b 6172 672d  ype: ignore[arg-
-000145b0: 7479 7065 5d0a 2020 2020 2020 2020 2020  type].          
-000145c0: 2020 290a 0a20 2020 2020 2020 2061 7761    )..        awa
-000145d0: 6974 2073 656c 662e 7175 6575 655f 7570  it self.queue_up
-000145e0: 6461 7465 2863 616c 6c62 6163 6b29 0a0a  date(callback)..
-000145f0: 2020 2020 6173 796e 6320 6465 6620 7365      async def se
-00014600: 745f 7072 6976 6163 7928 0a20 2020 2020  t_privacy(.     
-00014610: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00014620: 2065 6e61 626c 6564 3a20 626f 6f6c 2c0a   enabled: bool,.
-00014630: 2020 2020 2020 2020 6d69 635f 6c65 7665          mic_leve
-00014640: 6c3a 204f 7074 696f 6e61 6c5b 696e 745d  l: Optional[int]
-00014650: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00014660: 2072 6563 6f72 6469 6e67 5f6d 6f64 653a   recording_mode:
-00014670: 204f 7074 696f 6e61 6c5b 5265 636f 7264   Optional[Record
-00014680: 696e 674d 6f64 655d 203d 204e 6f6e 652c  ingMode] = None,
-00014690: 0a20 2020 2020 2020 2072 6565 6e61 626c  .        reenabl
-000146a0: 655f 676c 6f62 616c 3a20 626f 6f6c 203d  e_global: bool =
-000146b0: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
-000146c0: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-000146d0: 2222 4164 6473 2f72 656d 6f76 6573 2061  ""Adds/removes a
-000146e0: 2070 7269 7661 6379 207a 6f6e 6520 7468   privacy zone th
-000146f0: 6174 2062 6c61 636b 7320 6f75 7420 7468  at blacks out th
-00014700: 6520 7768 6f6c 6520 6361 6d65 7261 2e22  e whole camera."
-00014710: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
-00014720: 6f74 2073 656c 662e 6665 6174 7572 655f  ot self.feature_
-00014730: 666c 6167 732e 6861 735f 7072 6976 6163  flags.has_privac
-00014740: 795f 6d61 736b 3a0a 2020 2020 2020 2020  y_mask:.        
-00014750: 2020 2020 7261 6973 6520 4261 6452 6571      raise BadReq
-00014760: 7565 7374 2822 4361 6d65 7261 2064 6f65  uest("Camera doe
-00014770: 7320 6e6f 7420 616c 6c6f 7720 7072 6976  s not allow priv
-00014780: 6163 7920 7a6f 6e65 7322 290a 0a20 2020  acy zones")..   
-00014790: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
-000147a0: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
-000147b0: 2020 2020 2020 2020 2069 6620 656e 6162           if enab
-000147c0: 6c65 643a 0a20 2020 2020 2020 2020 2020  led:.           
-000147d0: 2020 2020 2073 656c 662e 7573 655f 676c       self.use_gl
-000147e0: 6f62 616c 203d 2046 616c 7365 0a20 2020  obal = False.   
-000147f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00014800: 662e 6164 645f 7072 6976 6163 795f 7a6f  f.add_privacy_zo
-00014810: 6e65 2829 0a20 2020 2020 2020 2020 2020  ne().           
-00014820: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00014830: 2020 2020 2020 2069 6620 7265 656e 6162         if reenab
-00014840: 6c65 5f67 6c6f 6261 6c3a 0a20 2020 2020  le_global:.     
-00014850: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00014860: 656c 662e 7573 655f 676c 6f62 616c 203d  elf.use_global =
-00014870: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-00014880: 2020 2020 2020 7365 6c66 2e72 656d 6f76        self.remov
-00014890: 655f 7072 6976 6163 795f 7a6f 6e65 2829  e_privacy_zone()
-000148a0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000148b0: 206e 6f74 2072 6565 6e61 626c 655f 676c   not reenable_gl
-000148c0: 6f62 616c 3a0a 2020 2020 2020 2020 2020  obal:.          
-000148d0: 2020 2020 2020 6966 206d 6963 5f6c 6576        if mic_lev
-000148e0: 656c 2069 7320 6e6f 7420 4e6f 6e65 3a0a  el is not None:.
-000148f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014900: 2020 2020 7365 6c66 2e6d 6963 5f76 6f6c      self.mic_vol
-00014910: 756d 6520 3d20 5065 7263 656e 7449 6e74  ume = PercentInt
-00014920: 286d 6963 5f6c 6576 656c 290a 0a20 2020  (mic_level)..   
-00014930: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00014940: 7265 636f 7264 696e 675f 6d6f 6465 2069  recording_mode i
-00014950: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00014960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014970: 7365 6c66 2e72 6563 6f72 6469 6e67 5f73  self.recording_s
-00014980: 6574 7469 6e67 732e 6d6f 6465 203d 2072  ettings.mode = r
-00014990: 6563 6f72 6469 6e67 5f6d 6f64 650a 0a20  ecording_mode.. 
-000149a0: 2020 2020 2020 2061 7761 6974 2073 656c         await sel
-000149b0: 662e 7175 6575 655f 7570 6461 7465 2863  f.queue_update(c
-000149c0: 616c 6c62 6163 6b29 0a0a 2020 2020 6173  allback)..    as
-000149d0: 796e 6320 6465 6620 7365 745f 7065 7273  ync def set_pers
-000149e0: 6f6e 5f74 7261 636b 2873 656c 662c 2065  on_track(self, e
-000149f0: 6e61 626c 6564 3a20 626f 6f6c 2920 2d3e  nabled: bool) ->
-00014a00: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-00014a10: 2222 5365 7473 2070 6572 736f 6e20 7472  ""Sets person tr
-00014a20: 6163 6b69 6e67 206f 6e20 6361 6d65 7261  acking on camera
-00014a30: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00014a40: 6e6f 7420 7365 6c66 2e66 6561 7475 7265  not self.feature
-00014a50: 5f66 6c61 6773 2e69 735f 7074 7a3a 0a20  _flags.is_ptz:. 
-00014a60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00014a70: 2042 6164 5265 7175 6573 7428 2243 616d   BadRequest("Cam
-00014a80: 6572 6120 646f 6573 206e 6f74 2073 7570  era does not sup
-00014a90: 706f 7274 2070 6572 736f 6e20 7472 6163  port person trac
-00014aa0: 6b69 6e67 2229 0a0a 2020 2020 2020 2020  king")..        
-00014ab0: 6966 2073 656c 662e 7573 655f 676c 6f62  if self.use_glob
-00014ac0: 616c 3a0a 2020 2020 2020 2020 2020 2020  al:.            
-00014ad0: 7261 6973 6520 4261 6452 6571 7565 7374  raise BadRequest
-00014ae0: 2822 4361 6d65 7261 2069 7320 7573 696e  ("Camera is usin
-00014af0: 6720 676c 6f62 616c 2072 6563 6f72 6469  g global recordi
-00014b00: 6e67 2073 6574 7469 6e67 732e 2229 0a0a  ng settings.")..
-00014b10: 2020 2020 2020 2020 6465 6620 6361 6c6c          def call
-00014b20: 6261 636b 2829 202d 3e20 4e6f 6e65 3a0a  back() -> None:.
-00014b30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00014b40: 2e73 6d61 7274 5f64 6574 6563 745f 7365  .smart_detect_se
-00014b50: 7474 696e 6773 2e61 7574 6f5f 7472 6163  ttings.auto_trac
-00014b60: 6b69 6e67 5f6f 626a 6563 745f 7479 7065  king_object_type
-00014b70: 7320 3d20 280a 2020 2020 2020 2020 2020  s = (.          
-00014b80: 2020 2020 2020 5b53 6d61 7274 4465 7465        [SmartDete
-00014b90: 6374 4f62 6a65 6374 5479 7065 2e50 4552  ctObjectType.PER
-00014ba0: 534f 4e5d 2069 6620 656e 6162 6c65 6420  SON] if enabled 
-00014bb0: 656c 7365 205b 5d0a 2020 2020 2020 2020  else [].        
-00014bc0: 2020 2020 290a 0a20 2020 2020 2020 2061      )..        a
-00014bd0: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
-00014be0: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
-00014bf0: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-00014c00: 5f74 616c 6b62 6163 6b5f 7374 7265 616d  _talkback_stream
-00014c10: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00014c20: 2020 2020 2020 2020 636f 6e74 656e 745f          content_
-00014c30: 7572 6c3a 2073 7472 2c0a 2020 2020 2020  url: str,.      
-00014c40: 2020 6666 6d70 6567 5f70 6174 683a 204f    ffmpeg_path: O
-00014c50: 7074 696f 6e61 6c5b 5061 7468 5d20 3d20  ptional[Path] = 
-00014c60: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2054  None,.    ) -> T
-00014c70: 616c 6b62 6163 6b53 7472 6561 6d3a 0a20  alkbackStream:. 
-00014c80: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
-00014c90: 7320 6120 7375 6270 726f 6365 7373 2074  s a subprocess t
-00014ca0: 6f20 706c 6179 2061 7564 696f 2074 6f20  o play audio to 
-00014cb0: 6120 6361 6d65 7261 2074 6872 6f75 6768  a camera through
-00014cc0: 2069 7473 2073 7065 616b 6572 2e0a 0a20   its speaker... 
-00014cd0: 2020 2020 2020 2052 6571 7569 7265 7320         Requires 
-00014ce0: 6666 6d70 6567 2074 6f20 7573 652e 0a0a  ffmpeg to use...
-00014cf0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00014d00: 2020 2020 2020 2d2d 2d2d 0a20 2020 2020        ----.     
-00014d10: 2020 2020 2020 2063 6f6e 7465 6e74 5f75         content_u
-00014d20: 726c 3a20 4569 7468 6572 2061 2055 524c  rl: Either a URL
-00014d30: 2061 6363 6573 7369 626c 6520 6279 2070   accessible by p
-00014d40: 7974 686f 6e20 6f72 2061 2070 6174 6820  ython or a path 
-00014d50: 746f 2061 2066 696c 6520 2866 666d 6570  to a file (ffmep
-00014d60: 6727 7320 602d 6960 2070 6172 616d 6574  g's `-i` paramet
-00014d70: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
-00014d80: 6666 6d70 6567 5f70 6174 683a 204f 7074  ffmpeg_path: Opt
-00014d90: 696f 6e61 6c20 7061 7468 2074 6f20 6666  ional path to ff
-00014da0: 6d70 6567 2062 696e 6172 790a 0a20 2020  mpeg binary..   
-00014db0: 2020 2020 2055 7365 2065 6974 6865 7220       Use either 
-00014dc0: 6061 7761 6974 2073 7472 6561 6d2e 7275  `await stream.ru
-00014dd0: 6e5f 756e 7469 6c5f 636f 6d70 6c65 7465  n_until_complete
-00014de0: 2829 6020 6f72 2060 6177 6169 7420 7374  ()` or `await st
-00014df0: 7265 616d 2e73 7461 7274 2829 6020 746f  ream.start()` to
-00014e00: 2073 7461 7274 2073 7562 7072 6f63 6573   start subproces
-00014e10: 7320 636f 6d6d 616e 640a 2020 2020 2020  s command.      
-00014e20: 2020 6166 7465 7220 6765 7474 696e 6720    after getting 
-00014e30: 7468 6520 7374 7265 616d 2e0a 0a20 2020  the stream...   
-00014e40: 2020 2020 2060 2e70 6c61 795f 6175 6469       `.play_audi
-00014e50: 6f28 2960 2069 7320 6120 6865 6c70 6572  o()` is a helper
-00014e60: 2074 6861 7420 7772 6170 7320 7468 6973   that wraps this
-00014e70: 206d 6574 686f 6420 616e 6420 6175 746f   method and auto
-00014e80: 6d61 7469 6361 6c6c 7920 7275 6e73 2074  matically runs t
-00014e90: 6865 2073 7562 7072 6f63 6573 7320 6173  he subprocess as
-00014ea0: 2077 656c 6c0a 2020 2020 2020 2020 2222   well.        ""
-00014eb0: 220a 0a20 2020 2020 2020 2069 6620 7365  "..        if se
-00014ec0: 6c66 2e74 616c 6b62 6163 6b5f 7374 7265  lf.talkback_stre
-00014ed0: 616d 2069 7320 6e6f 7420 4e6f 6e65 2061  am is not None a
-00014ee0: 6e64 2073 656c 662e 7461 6c6b 6261 636b  nd self.talkback
-00014ef0: 5f73 7472 6561 6d2e 6973 5f72 756e 6e69  _stream.is_runni
-00014f00: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-00014f10: 7261 6973 6520 4261 6452 6571 7565 7374  raise BadRequest
-00014f20: 2822 4361 6d65 7261 2069 7320 616c 7265  ("Camera is alre
-00014f30: 6164 7920 706c 6179 696e 6720 6175 6469  ady playing audi
-00014f40: 6f22 290a 0a20 2020 2020 2020 2073 656c  o")..        sel
-00014f50: 662e 7461 6c6b 6261 636b 5f73 7472 6561  f.talkback_strea
-00014f60: 6d20 3d20 5461 6c6b 6261 636b 5374 7265  m = TalkbackStre
-00014f70: 616d 2873 656c 662c 2063 6f6e 7465 6e74  am(self, content
-00014f80: 5f75 726c 2c20 6666 6d70 6567 5f70 6174  _url, ffmpeg_pat
-00014f90: 6829 0a20 2020 2020 2020 2072 6574 7572  h).        retur
-00014fa0: 6e20 7365 6c66 2e74 616c 6b62 6163 6b5f  n self.talkback_
-00014fb0: 7374 7265 616d 0a0a 2020 2020 6173 796e  stream..    asyn
-00014fc0: 6320 6465 6620 706c 6179 5f61 7564 696f  c def play_audio
-00014fd0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00014fe0: 2020 2020 2020 2020 636f 6e74 656e 745f          content_
-00014ff0: 7572 6c3a 2073 7472 2c0a 2020 2020 2020  url: str,.      
-00015000: 2020 6666 6d70 6567 5f70 6174 683a 204f    ffmpeg_path: O
-00015010: 7074 696f 6e61 6c5b 5061 7468 5d20 3d20  ptional[Path] = 
-00015020: 4e6f 6e65 2c0a 2020 2020 2020 2020 626c  None,.        bl
-00015030: 6f63 6b69 6e67 3a20 626f 6f6c 203d 2054  ocking: bool = T
-00015040: 7275 652c 0a20 2020 2029 202d 3e20 4e6f  rue,.    ) -> No
-00015050: 6e65 3a0a 2020 2020 2020 2020 2222 2250  ne:.        """P
-00015060: 6c61 7973 2061 7564 696f 2074 6f20 6120  lays audio to a 
-00015070: 6361 6d65 7261 2074 6872 6f75 6768 2069  camera through i
-00015080: 7473 2073 7065 616b 6572 2e0a 0a20 2020  ts speaker...   
-00015090: 2020 2020 2052 6571 7569 7265 7320 6666       Requires ff
-000150a0: 6d70 6567 2074 6f20 7573 652e 0a0a 2020  mpeg to use...  
-000150b0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-000150c0: 2020 2020 2d2d 2d2d 0a20 2020 2020 2020      ----.       
-000150d0: 2020 2020 2063 6f6e 7465 6e74 5f75 726c       content_url
-000150e0: 3a20 4569 7468 6572 2061 2055 524c 2061  : Either a URL a
-000150f0: 6363 6573 7369 626c 6520 6279 2070 7974  ccessible by pyt
-00015100: 686f 6e20 6f72 2061 2070 6174 6820 746f  hon or a path to
-00015110: 2061 2066 696c 6520 2866 666d 6570 6727   a file (ffmepg'
-00015120: 7320 602d 6960 2070 6172 616d 6574 6572  s `-i` parameter
-00015130: 290a 2020 2020 2020 2020 2020 2020 6666  ).            ff
-00015140: 6d70 6567 5f70 6174 683a 204f 7074 696f  mpeg_path: Optio
-00015150: 6e61 6c20 7061 7468 2074 6f20 6666 6d70  nal path to ffmp
-00015160: 6567 2062 696e 6172 790a 2020 2020 2020  eg binary.      
-00015170: 2020 2020 2020 626c 6f63 6b69 6e67 3a20        blocking: 
-00015180: 4177 6169 7473 2073 7472 6561 6d20 636f  Awaits stream co
-00015190: 6d70 6c65 7469 6f6e 2061 6e64 206c 6f67  mpletion and log
-000151a0: 7320 7374 646f 7574 2f73 7464 6572 720a  s stdout/stderr.
-000151b0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-000151c0: 2020 2020 2073 7472 6561 6d20 3d20 7365       stream = se
-000151d0: 6c66 2e63 7265 6174 655f 7461 6c6b 6261  lf.create_talkba
-000151e0: 636b 5f73 7472 6561 6d28 636f 6e74 656e  ck_stream(conten
-000151f0: 745f 7572 6c2c 2066 666d 7065 675f 7061  t_url, ffmpeg_pa
-00015200: 7468 290a 2020 2020 2020 2020 6177 6169  th).        awai
-00015210: 7420 7374 7265 616d 2e73 7461 7274 2829  t stream.start()
-00015220: 0a0a 2020 2020 2020 2020 6966 2062 6c6f  ..        if blo
-00015230: 636b 696e 673a 0a20 2020 2020 2020 2020  cking:.         
-00015240: 2020 2061 7761 6974 2073 656c 662e 7761     await self.wa
-00015250: 6974 5f75 6e74 696c 5f61 7564 696f 5f63  it_until_audio_c
-00015260: 6f6d 706c 6574 6573 2829 0a0a 2020 2020  ompletes()..    
-00015270: 6173 796e 6320 6465 6620 7761 6974 5f75  async def wait_u
-00015280: 6e74 696c 5f61 7564 696f 5f63 6f6d 706c  ntil_audio_compl
-00015290: 6574 6573 2873 656c 6629 202d 3e20 4e6f  etes(self) -> No
-000152a0: 6e65 3a0a 2020 2020 2020 2020 2222 2241  ne:.        """A
-000152b0: 7761 6974 7320 7374 7265 616d 2063 6f6d  waits stream com
-000152c0: 706c 6574 696f 6e20 6f66 2061 7564 696f  pletion of audio
-000152d0: 2061 6e64 206c 6f67 7320 7374 646f 7574   and logs stdout
-000152e0: 2f73 7464 6572 722e 2222 220a 0a20 2020  /stderr."""..   
-000152f0: 2020 2020 2073 7472 6561 6d20 3d20 7365       stream = se
-00015300: 6c66 2e74 616c 6b62 6163 6b5f 7374 7265  lf.talkback_stre
-00015310: 616d 0a20 2020 2020 2020 2069 6620 7374  am.        if st
-00015320: 7265 616d 2069 7320 4e6f 6e65 3a0a 2020  ream is None:.  
-00015330: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00015340: 5374 7265 616d 4572 726f 7228 224e 6f20  StreamError("No 
-00015350: 6175 6469 6f20 706c 6179 696e 6720 746f  audio playing to
-00015360: 2077 6169 7420 666f 7222 290a 0a20 2020   wait for")..   
-00015370: 2020 2020 2061 7761 6974 2073 7472 6561       await strea
-00015380: 6d2e 7275 6e5f 756e 7469 6c5f 636f 6d70  m.run_until_comp
-00015390: 6c65 7465 2829 0a0a 2020 2020 2020 2020  lete()..        
-000153a0: 5f4c 4f47 4745 522e 6465 6275 6728 2266  _LOGGER.debug("f
-000153b0: 666d 7065 6720 7374 646f 7574 3a5c 6e25  fmpeg stdout:\n%
-000153c0: 7322 2c20 225c 6e22 2e6a 6f69 6e28 7374  s", "\n".join(st
-000153d0: 7265 616d 2e73 7464 6f75 7429 290a 2020  ream.stdout)).  
-000153e0: 2020 2020 2020 5f4c 4f47 4745 522e 6465        _LOGGER.de
-000153f0: 6275 6728 2266 666d 7065 6720 7374 6465  bug("ffmpeg stde
-00015400: 7272 3a5c 6e25 7322 2c20 225c 6e22 2e6a  rr:\n%s", "\n".j
-00015410: 6f69 6e28 7374 7265 616d 2e73 7464 6572  oin(stream.stder
-00015420: 7229 290a 2020 2020 2020 2020 6966 2073  r)).        if s
-00015430: 7472 6561 6d2e 6973 5f65 7272 6f72 3a0a  tream.is_error:.
-00015440: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-00015450: 7220 3d20 225c 6e22 2e6a 6f69 6e28 7374  r = "\n".join(st
-00015460: 7265 616d 2e73 7464 6572 7229 0a20 2020  ream.stderr).   
-00015470: 2020 2020 2020 2020 2072 6169 7365 2053           raise S
-00015480: 7472 6561 6d45 7272 6f72 2822 4572 726f  treamError("Erro
-00015490: 7220 7768 696c 6520 706c 6179 696e 6720  r while playing 
-000154a0: 6175 6469 6f20 2866 666d 7065 6729 3a20  audio (ffmpeg): 
-000154b0: 5c6e 2220 2b20 6572 726f 7229 0a0a 2020  \n" + error)..  
-000154c0: 2020 6173 796e 6320 6465 6620 7374 6f70    async def stop
-000154d0: 5f61 7564 696f 2873 656c 6629 202d 3e20  _audio(self) -> 
-000154e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-000154f0: 2253 746f 7020 6375 7272 656e 746c 7920  "Stop currently 
-00015500: 706c 6179 696e 6720 6175 6469 6f2e 2222  playing audio.""
-00015510: 220a 2020 2020 2020 2020 7374 7265 616d  ".        stream
-00015520: 203d 2073 656c 662e 7461 6c6b 6261 636b   = self.talkback
-00015530: 5f73 7472 6561 6d0a 2020 2020 2020 2020  _stream.        
-00015540: 6966 2073 7472 6561 6d20 6973 204e 6f6e  if stream is Non
-00015550: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00015560: 6169 7365 2053 7472 6561 6d45 7272 6f72  aise StreamError
-00015570: 2822 4e6f 2061 7564 696f 2070 6c61 7969  ("No audio playi
-00015580: 6e67 2074 6f20 7374 6f70 2229 0a0a 2020  ng to stop")..  
-00015590: 2020 2020 2020 6177 6169 7420 7374 7265        await stre
-000155a0: 616d 2e73 746f 7028 290a 0a20 2020 2064  am.stop()..    d
-000155b0: 6566 2063 616e 5f72 6561 645f 6d65 6469  ef can_read_medi
-000155c0: 6128 7365 6c66 2c20 7573 6572 3a20 5573  a(self, user: Us
-000155d0: 6572 2920 2d3e 2062 6f6f 6c3a 0a20 2020  er) -> bool:.   
-000155e0: 2020 2020 2069 6620 7365 6c66 2e6d 6f64       if self.mod
-000155f0: 656c 2069 7320 4e6f 6e65 3a0a 2020 2020  el is None:.    
-00015600: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00015610: 7275 650a 0a20 2020 2020 2020 2072 6574  rue..        ret
-00015620: 7572 6e20 7573 6572 2e63 616e 2873 656c  urn user.can(sel
-00015630: 662e 6d6f 6465 6c2c 2050 6572 6d69 7373  f.model, Permiss
-00015640: 696f 6e4e 6f64 652e 5245 4144 5f4d 4544  ionNode.READ_MED
-00015650: 4941 2c20 7365 6c66 290a 0a20 2020 2064  IA, self)..    d
-00015660: 6566 2063 616e 5f64 656c 6574 655f 6d65  ef can_delete_me
-00015670: 6469 6128 7365 6c66 2c20 7573 6572 3a20  dia(self, user: 
-00015680: 5573 6572 2920 2d3e 2062 6f6f 6c3a 0a20  User) -> bool:. 
-00015690: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-000156a0: 6f64 656c 2069 7320 4e6f 6e65 3a0a 2020  odel is None:.  
-000156b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000156c0: 2054 7275 650a 0a20 2020 2020 2020 2072   True..        r
-000156d0: 6574 7572 6e20 7573 6572 2e63 616e 2873  eturn user.can(s
-000156e0: 656c 662e 6d6f 6465 6c2c 2050 6572 6d69  elf.model, Permi
-000156f0: 7373 696f 6e4e 6f64 652e 4445 4c45 5445  ssionNode.DELETE
-00015700: 5f4d 4544 4941 2c20 7365 6c66 290a 0a20  _MEDIA, self).. 
-00015710: 2020 2023 2072 6567 696f 6e20 5054 5a0a     # region PTZ.
-00015720: 0a20 2020 2061 7379 6e63 2064 6566 2070  .    async def p
-00015730: 747a 5f72 656c 6174 6976 655f 6d6f 7665  tz_relative_move
-00015740: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00015750: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
-00015760: 2020 2070 616e 3a20 666c 6f61 742c 0a20     pan: float,. 
-00015770: 2020 2020 2020 2074 696c 743a 2066 6c6f         tilt: flo
-00015780: 6174 2c0a 2020 2020 2020 2020 7061 6e5f  at,.        pan_
-00015790: 7370 6565 643a 2069 6e74 203d 2031 302c  speed: int = 10,
-000157a0: 0a20 2020 2020 2020 2074 696c 745f 7370  .        tilt_sp
-000157b0: 6565 643a 2069 6e74 203d 2031 302c 0a20  eed: int = 10,. 
-000157c0: 2020 2020 2020 2073 6361 6c65 3a20 696e         scale: in
-000157d0: 7420 3d20 302c 0a20 2020 2020 2020 2075  t = 0,.        u
-000157e0: 7365 5f6e 6174 6976 653a 2062 6f6f 6c20  se_native: bool 
-000157f0: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
-00015800: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00015810: 2222 224d 6f76 6520 5054 5a20 7265 6c61  """Move PTZ rela
-00015820: 7469 7665 2074 6f20 6375 7272 656e 7420  tive to current 
-00015830: 706f 7369 7469 6f6e 2e0a 0a20 2020 2020  position...     
-00015840: 2020 2050 616e 2f74 696c 7420 7661 6c75     Pan/tilt valu
-00015850: 6573 2076 6172 7920 6672 6f6d 2063 616d  es vary from cam
-00015860: 6572 6120 746f 2063 616d 6572 612c 2062  era to camera, b
-00015870: 7574 2066 6f72 2047 3420 5054 5a3a 0a20  ut for G4 PTZ:. 
-00015880: 2020 2020 2020 2020 2020 202a 2050 616e             * Pan
-00015890: 2076 616c 7565 7320 7261 6e67 6520 6672   values range fr
-000158a0: 6f6d 2030 c2b0 2061 6e64 2067 6f20 746f  om 0.. and go to
-000158b0: 2033 3630 c2b0 2f30 c2b0 0a20 2020 2020   360../0...     
-000158c0: 2020 2020 2020 202a 2054 696c 7420 7661         * Tilt va
-000158d0: 6c75 6573 2072 616e 6765 2066 726f 6d20  lues range from 
-000158e0: 2d32 30c2 b020 616e 6420 676f 2074 6f20  -20.. and go to 
-000158f0: 3930 c2b0 0a0a 2020 2020 2020 2020 5265  90....        Re
-00015900: 6c61 7469 7665 2070 6f73 6974 696f 6e73  lative positions
-00015910: 2063 616e 6e6f 7420 6d6f 7665 206d 6f72   cannot move mor
-00015920: 6520 7468 656e 2034 3039 3520 7374 6570  e then 4095 step
-00015930: 7320 6174 2061 2074 696d 6520 696e 2061  s at a time in a
-00015940: 6e79 2064 6972 6563 7469 6f6e 2e0a 0a20  ny direction... 
-00015950: 2020 2020 2020 2046 6f72 2074 6865 2047         For the G
-00015960: 3420 5054 5a2c 2034 3039 3520 7374 6570  4 PTZ, 4095 step
-00015970: 7320 6973 207e 3431 c2b0 2066 6f72 2070  s is ~41.. for p
-00015980: 616e 2061 6e64 207e 3435 c2b0 2066 6f72  an and ~45.. for
-00015990: 2074 696c 742e 0a0a 2020 2020 2020 2020   tilt...        
-000159a0: 6075 7365 5f6e 6174 6976 6560 206c 6574  `use_native` let
-000159b0: 7320 796f 7520 7573 6520 7468 6520 6e61  s you use the na
-000159c0: 7469 7665 2073 7465 7020 7661 6c75 6573  tive step values
-000159d0: 2069 6e73 7465 6164 206f 6620 6465 6772   instead of degr
-000159e0: 6565 732e 0a20 2020 2020 2020 2022 2222  ees..        """
-000159f0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00015a00: 2073 656c 662e 6665 6174 7572 655f 666c   self.feature_fl
-00015a10: 6167 732e 6973 5f70 747a 3a0a 2020 2020  ags.is_ptz:.    
-00015a20: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
-00015a30: 6452 6571 7565 7374 2822 4361 6d65 7261  dRequest("Camera
-00015a40: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
-00015a50: 7420 5054 5a20 6665 6174 7572 6573 2e22  t PTZ features."
-00015a60: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-00015a70: 7420 7573 655f 6e61 7469 7665 3a0a 2020  t use_native:.  
-00015a80: 2020 2020 2020 2020 2020 7061 6e20 3d20            pan = 
-00015a90: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
-00015aa0: 6773 2e70 616e 2e74 6f5f 6e61 7469 7665  gs.pan.to_native
-00015ab0: 5f76 616c 7565 2870 616e 2c20 6973 5f72  _value(pan, is_r
-00015ac0: 656c 6174 6976 653d 5472 7565 290a 2020  elative=True).  
-00015ad0: 2020 2020 2020 2020 2020 7469 6c74 203d            tilt =
-00015ae0: 2073 656c 662e 6665 6174 7572 655f 666c   self.feature_fl
-00015af0: 6167 732e 7469 6c74 2e74 6f5f 6e61 7469  ags.tilt.to_nati
-00015b00: 7665 5f76 616c 7565 2874 696c 742c 2069  ve_value(tilt, i
-00015b10: 735f 7265 6c61 7469 7665 3d54 7275 6529  s_relative=True)
-00015b20: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
-00015b30: 7365 6c66 2e61 7069 2e72 656c 6174 6976  self.api.relativ
-00015b40: 655f 6d6f 7665 5f70 747a 5f63 616d 6572  e_move_ptz_camer
-00015b50: 6128 0a20 2020 2020 2020 2020 2020 2073  a(.            s
-00015b60: 656c 662e 6964 2c0a 2020 2020 2020 2020  elf.id,.        
-00015b70: 2020 2020 7061 6e3d 7061 6e2c 0a20 2020      pan=pan,.   
-00015b80: 2020 2020 2020 2020 2074 696c 743d 7469           tilt=ti
-00015b90: 6c74 2c0a 2020 2020 2020 2020 2020 2020  lt,.            
-00015ba0: 7061 6e5f 7370 6565 643d 7061 6e5f 7370  pan_speed=pan_sp
-00015bb0: 6565 642c 0a20 2020 2020 2020 2020 2020  eed,.           
-00015bc0: 2074 696c 745f 7370 6565 643d 7469 6c74   tilt_speed=tilt
-00015bd0: 5f73 7065 6564 2c0a 2020 2020 2020 2020  _speed,.        
-00015be0: 2020 2020 7363 616c 653d 7363 616c 652c      scale=scale,
-00015bf0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00015c00: 6173 796e 6320 6465 6620 7074 7a5f 6365  async def ptz_ce
-00015c10: 6e74 6572 2873 656c 662c 202a 2c20 783a  nter(self, *, x:
-00015c20: 2069 6e74 2c20 793a 2069 6e74 2c20 7a3a   int, y: int, z:
-00015c30: 2069 6e74 2920 2d3e 204e 6f6e 653a 0a20   int) -> None:. 
-00015c40: 2020 2020 2020 2022 2222 4365 6e74 6572         """Center
-00015c50: 2050 545a 2043 616d 6572 6120 6f6e 2070   PTZ Camera on p
-00015c60: 6f69 6e74 2069 6e20 7669 6577 706f 7274  oint in viewport
-00015c70: 2e0a 0a20 2020 2020 2020 2078 2c20 792c  ...        x, y,
-00015c80: 207a 2076 616c 7565 7320 7261 6e67 6520   z values range 
-00015c90: 6672 6f6d 2030 2074 6f20 3130 3030 2e0a  from 0 to 1000..
-00015ca0: 0a20 2020 2020 2020 2078 2c20 7920 6172  .        x, y ar
-00015cb0: 6520 7265 6c61 7469 7665 2063 6f6f 7264  e relative coord
-00015cc0: 7320 666f 7220 7468 6520 6375 7272 656e  s for the curren
-00015cd0: 7420 7669 6577 706f 7274 3a0a 2020 2020  t viewport:.    
-00015ce0: 2020 2020 2020 2020 2a20 2830 2c20 3029          * (0, 0)
-00015cf0: 2069 7320 746f 7020 6c65 6674 0a20 2020   is top left.   
-00015d00: 2020 2020 2020 2020 202a 2028 3530 302c           * (500,
-00015d10: 2035 3030 2920 6973 2074 6865 2063 656e   500) is the cen
-00015d20: 7465 720a 2020 2020 2020 2020 2020 2020  ter.            
-00015d30: 2a20 2831 3030 302c 2031 3030 3029 2069  * (1000, 1000) i
-00015d40: 7320 7468 6520 626f 7474 6f6d 2072 6967  s the bottom rig
-00015d50: 6874 0a0a 2020 2020 2020 2020 7a20 7661  ht..        z va
-00015d60: 6c75 6520 6973 207a 6f6f 6d2c 2062 7574  lue is zoom, but
-00015d70: 2073 696e 6365 2069 7420 6973 2063 6170   since it is cap
-00015d80: 7065 6420 6174 2031 3030 302c 2070 726f  ped at 1000, pro
-00015d90: 6261 626c 7920 6265 7474 6572 2074 6f20  bably better to 
-00015da0: 7573 6520 6070 747a 5f7a 6f6f 6d60 2e0a  use `ptz_zoom`..
-00015db0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00015dc0: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
-00015dd0: 6170 692e 6365 6e74 6572 5f70 747a 5f63  api.center_ptz_c
-00015de0: 616d 6572 6128 7365 6c66 2e69 642c 2078  amera(self.id, x
-00015df0: 3d78 2c20 793d 792c 207a 3d7a 290a 0a20  =x, y=y, z=z).. 
-00015e00: 2020 2061 7379 6e63 2064 6566 2070 747a     async def ptz
-00015e10: 5f7a 6f6f 6d28 0a20 2020 2020 2020 2073  _zoom(.        s
-00015e20: 656c 662c 0a20 2020 2020 2020 202a 2c0a  elf,.        *,.
-00015e30: 2020 2020 2020 2020 7a6f 6f6d 3a20 666c          zoom: fl
-00015e40: 6f61 742c 0a20 2020 2020 2020 2073 7065  oat,.        spe
-00015e50: 6564 3a20 696e 7420 3d20 3130 302c 0a20  ed: int = 100,. 
-00015e60: 2020 2020 2020 2075 7365 5f6e 6174 6976         use_nativ
-00015e70: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-00015e80: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00015e90: 2020 2020 2020 2020 2222 225a 6f6f 6d20          """Zoom 
-00015ea0: 5054 5a20 4361 6d65 7261 2e0a 0a20 2020  PTZ Camera...   
-00015eb0: 2020 2020 205a 6f6f 6d20 6c65 7665 6c73       Zoom levels
-00015ec0: 2076 6172 7920 6672 6f6d 2063 616d 6572   vary from camer
-00015ed0: 6120 746f 2063 616d 6572 612c 2062 7574  a to camera, but
-00015ee0: 2066 6f72 2047 3420 5054 5a20 6974 2067   for G4 PTZ it g
-00015ef0: 6f65 7320 6672 6f6d 2031 7820 746f 2032  oes from 1x to 2
-00015f00: 3278 2e0a 0a20 2020 2020 2020 205a 6f6f  2x...        Zoo
-00015f10: 6d20 7370 6565 6420 7365 656d 7320 746f  m speed seems to
-00015f20: 2072 616e 6765 2066 726f 6d20 3020 746f   range from 0 to
-00015f30: 2031 3030 2e20 416e 7920 7661 6c75 6520   100. Any value 
-00015f40: 6f76 6572 2031 3030 2072 6573 756c 7473  over 100 results
-00015f50: 2069 6e20 6120 7370 6565 6420 6f66 2030   in a speed of 0
-00015f60: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00015f70: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00015f80: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
-00015f90: 2e69 735f 7074 7a3a 0a20 2020 2020 2020  .is_ptz:.       
-00015fa0: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
-00015fb0: 7175 6573 7428 2243 616d 6572 6120 646f  quest("Camera do
-00015fc0: 6573 206e 6f74 2073 7570 706f 7274 2050  es not support P
-00015fd0: 545a 2066 6561 7475 7265 732e 2229 0a0a  TZ features.")..
-00015fe0: 2020 2020 2020 2020 6966 206e 6f74 2075          if not u
-00015ff0: 7365 5f6e 6174 6976 653a 0a20 2020 2020  se_native:.     
-00016000: 2020 2020 2020 207a 6f6f 6d20 3d20 7365         zoom = se
-00016010: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
-00016020: 2e7a 6f6f 6d2e 746f 5f6e 6174 6976 655f  .zoom.to_native_
-00016030: 7661 6c75 6528 7a6f 6f6d 290a 0a20 2020  value(zoom)..   
-00016040: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
-00016050: 6170 692e 7a6f 6f6d 5f70 747a 5f63 616d  api.zoom_ptz_cam
-00016060: 6572 6128 7365 6c66 2e69 642c 207a 6f6f  era(self.id, zoo
-00016070: 6d3d 7a6f 6f6d 2c20 7370 6565 643d 7370  m=zoom, speed=sp
-00016080: 6565 6429 0a0a 2020 2020 6173 796e 6320  eed)..    async 
-00016090: 6465 6620 6765 745f 7074 7a5f 706f 7369  def get_ptz_posi
-000160a0: 7469 6f6e 2873 656c 6629 202d 3e20 5054  tion(self) -> PT
-000160b0: 5a50 6f73 6974 696f 6e3a 0a20 2020 2020  ZPosition:.     
-000160c0: 2020 2022 2222 4765 7420 6375 7272 656e     """Get curren
-000160d0: 7420 5054 5a20 506f 7369 7469 6f6e 2e22  t PTZ Position."
-000160e0: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
-000160f0: 6f74 2073 656c 662e 6665 6174 7572 655f  ot self.feature_
-00016100: 666c 6167 732e 6973 5f70 747a 3a0a 2020  flags.is_ptz:.  
-00016110: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00016120: 4261 6452 6571 7565 7374 2822 4361 6d65  BadRequest("Came
-00016130: 7261 2064 6f65 7320 6e6f 7420 7375 7070  ra does not supp
-00016140: 6f72 7420 5054 5a20 6665 6174 7572 6573  ort PTZ features
-00016150: 2e22 290a 0a20 2020 2020 2020 2072 6574  .")..        ret
-00016160: 7572 6e20 6177 6169 7420 7365 6c66 2e61  urn await self.a
-00016170: 7069 2e67 6574 5f70 6f73 6974 696f 6e5f  pi.get_position_
-00016180: 7074 7a5f 6361 6d65 7261 2873 656c 662e  ptz_camera(self.
-00016190: 6964 290a 0a20 2020 2061 7379 6e63 2064  id)..    async d
-000161a0: 6566 2067 6f74 6f5f 7074 7a5f 736c 6f74  ef goto_ptz_slot
-000161b0: 2873 656c 662c 202a 2c20 736c 6f74 3a20  (self, *, slot: 
-000161c0: 696e 7429 202d 3e20 4e6f 6e65 3a0a 2020  int) -> None:.  
-000161d0: 2020 2020 2020 2222 2247 6f74 6f20 5054        """Goto PT
-000161e0: 5a20 736c 6f74 2070 6f73 6974 696f 6e2e  Z slot position.
-000161f0: 0a0a 2020 2020 2020 2020 2d31 2069 7320  ..        -1 is 
-00016200: 486f 6d65 2073 6c6f 742e 0a20 2020 2020  Home slot..     
-00016210: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00016220: 6966 206e 6f74 2073 656c 662e 6665 6174  if not self.feat
-00016230: 7572 655f 666c 6167 732e 6973 5f70 747a  ure_flags.is_ptz
-00016240: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00016250: 6973 6520 4261 6452 6571 7565 7374 2822  ise BadRequest("
-00016260: 4361 6d65 7261 2064 6f65 7320 6e6f 7420  Camera does not 
-00016270: 7375 7070 6f72 7420 5054 5a20 6665 6174  support PTZ feat
-00016280: 7572 6573 2e22 290a 0a20 2020 2020 2020  ures.")..       
-00016290: 2061 7761 6974 2073 656c 662e 6170 692e   await self.api.
-000162a0: 676f 746f 5f70 747a 5f63 616d 6572 6128  goto_ptz_camera(
-000162b0: 7365 6c66 2e69 642c 2073 6c6f 743d 736c  self.id, slot=sl
-000162c0: 6f74 290a 0a20 2020 2061 7379 6e63 2064  ot)..    async d
-000162d0: 6566 2063 7265 6174 655f 7074 7a5f 7072  ef create_ptz_pr
-000162e0: 6573 6574 2873 656c 662c 202a 2c20 6e61  eset(self, *, na
-000162f0: 6d65 3a20 7374 7229 202d 3e20 5054 5a50  me: str) -> PTZP
-00016300: 7265 7365 743a 0a20 2020 2020 2020 2022  reset:.        "
-00016310: 2222 4372 6561 7465 2050 545a 2050 7265  ""Create PTZ Pre
-00016320: 7365 7420 666f 7220 6361 6d65 7261 2062  set for camera b
-00016330: 6173 6564 206f 6e20 6375 7272 656e 7420  ased on current 
-00016340: 6361 6d65 7261 2073 6574 7469 6e67 732e  camera settings.
-00016350: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00016360: 6e6f 7420 7365 6c66 2e66 6561 7475 7265  not self.feature
-00016370: 5f66 6c61 6773 2e69 735f 7074 7a3a 0a20  _flags.is_ptz:. 
-00016380: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00016390: 2042 6164 5265 7175 6573 7428 2243 616d   BadRequest("Cam
-000163a0: 6572 6120 646f 6573 206e 6f74 2073 7570  era does not sup
-000163b0: 706f 7274 2050 545a 2066 6561 7475 7265  port PTZ feature
-000163c0: 732e 2229 0a0a 2020 2020 2020 2020 7265  s.")..        re
-000163d0: 7475 726e 2061 7761 6974 2073 656c 662e  turn await self.
-000163e0: 6170 692e 6372 6561 7465 5f70 7265 7365  api.create_prese
-000163f0: 745f 7074 7a5f 6361 6d65 7261 2873 656c  t_ptz_camera(sel
-00016400: 662e 6964 2c20 6e61 6d65 3d6e 616d 6529  f.id, name=name)
-00016410: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-00016420: 6765 745f 7074 7a5f 7072 6573 6574 7328  get_ptz_presets(
-00016430: 7365 6c66 2920 2d3e 206c 6973 745b 5054  self) -> list[PT
-00016440: 5a50 7265 7365 745d 3a0a 2020 2020 2020  ZPreset]:.      
-00016450: 2020 2222 2247 6574 2050 545a 2050 7265    """Get PTZ Pre
-00016460: 7365 7473 2066 6f72 2063 616d 6572 612e  sets for camera.
-00016470: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00016480: 6e6f 7420 7365 6c66 2e66 6561 7475 7265  not self.feature
-00016490: 5f66 6c61 6773 2e69 735f 7074 7a3a 0a20  _flags.is_ptz:. 
-000164a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000164b0: 2042 6164 5265 7175 6573 7428 2243 616d   BadRequest("Cam
-000164c0: 6572 6120 646f 6573 206e 6f74 2073 7570  era does not sup
-000164d0: 706f 7274 2050 545a 2066 6561 7475 7265  port PTZ feature
-000164e0: 732e 2229 0a0a 2020 2020 2020 2020 7265  s.")..        re
-000164f0: 7475 726e 2061 7761 6974 2073 656c 662e  turn await self.
-00016500: 6170 692e 6765 745f 7072 6573 6574 735f  api.get_presets_
-00016510: 7074 7a5f 6361 6d65 7261 2873 656c 662e  ptz_camera(self.
-00016520: 6964 290a 0a20 2020 2061 7379 6e63 2064  id)..    async d
-00016530: 6566 2064 656c 6574 655f 7074 7a5f 7072  ef delete_ptz_pr
-00016540: 6573 6574 2873 656c 662c 202a 2c20 736c  eset(self, *, sl
-00016550: 6f74 3a20 696e 7429 202d 3e20 4e6f 6e65  ot: int) -> None
-00016560: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
-00016570: 6574 6520 5054 5a20 7072 6573 6574 2066  ete PTZ preset f
-00016580: 6f72 2063 616d 6572 612e 2222 220a 0a20  or camera.""".. 
-00016590: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-000165a0: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
-000165b0: 2e69 735f 7074 7a3a 0a20 2020 2020 2020  .is_ptz:.       
-000165c0: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
-000165d0: 7175 6573 7428 2243 616d 6572 6120 646f  quest("Camera do
-000165e0: 6573 206e 6f74 2073 7570 706f 7274 2050  es not support P
-000165f0: 545a 2066 6561 7475 7265 732e 2229 0a0a  TZ features.")..
-00016600: 2020 2020 2020 2020 6177 6169 7420 7365          await se
-00016610: 6c66 2e61 7069 2e64 656c 6574 655f 7072  lf.api.delete_pr
-00016620: 6573 6574 5f70 747a 5f63 616d 6572 6128  eset_ptz_camera(
-00016630: 7365 6c66 2e69 642c 2073 6c6f 743d 736c  self.id, slot=sl
-00016640: 6f74 290a 0a20 2020 2061 7379 6e63 2064  ot)..    async d
-00016650: 6566 2067 6574 5f70 747a 5f68 6f6d 6528  ef get_ptz_home(
-00016660: 7365 6c66 2920 2d3e 2050 545a 5072 6573  self) -> PTZPres
-00016670: 6574 3a0a 2020 2020 2020 2020 2222 2247  et:.        """G
-00016680: 6574 2050 545a 2068 6f6d 6520 7072 6573  et PTZ home pres
-00016690: 6574 2028 2d31 292e 2222 220a 0a20 2020  et (-1)."""..   
-000166a0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-000166b0: 2e66 6561 7475 7265 5f66 6c61 6773 2e69  .feature_flags.i
-000166c0: 735f 7074 7a3a 0a20 2020 2020 2020 2020  s_ptz:.         
-000166d0: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
-000166e0: 6573 7428 2243 616d 6572 6120 646f 6573  est("Camera does
-000166f0: 206e 6f74 2073 7570 706f 7274 2050 545a   not support PTZ
-00016700: 2066 6561 7475 7265 732e 2229 0a0a 2020   features.")..  
-00016710: 2020 2020 2020 7265 7475 726e 2061 7761        return awa
-00016720: 6974 2073 656c 662e 6170 692e 6765 745f  it self.api.get_
-00016730: 686f 6d65 5f70 747a 5f63 616d 6572 6128  home_ptz_camera(
-00016740: 7365 6c66 2e69 6429 0a0a 2020 2020 6173  self.id)..    as
-00016750: 796e 6320 6465 6620 7365 745f 7074 7a5f  ync def set_ptz_
-00016760: 686f 6d65 2873 656c 6629 202d 3e20 5054  home(self) -> PT
-00016770: 5a50 7265 7365 743a 0a20 2020 2020 2020  ZPreset:.       
-00016780: 2022 2222 4765 7420 5054 5a20 686f 6d65   """Get PTZ home
-00016790: 2070 7265 7365 7420 282d 3129 2074 6f20   preset (-1) to 
-000167a0: 6375 7272 656e 7420 706f 7369 7469 6f6e  current position
-000167b0: 2e22 2222 0a0a 2020 2020 2020 2020 6966  ."""..        if
-000167c0: 206e 6f74 2073 656c 662e 6665 6174 7572   not self.featur
-000167d0: 655f 666c 6167 732e 6973 5f70 747a 3a0a  e_flags.is_ptz:.
-000167e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000167f0: 6520 4261 6452 6571 7565 7374 2822 4361  e BadRequest("Ca
-00016800: 6d65 7261 2064 6f65 7320 6e6f 7420 7375  mera does not su
-00016810: 7070 6f72 7420 5054 5a20 6665 6174 7572  pport PTZ featur
-00016820: 6573 2e22 290a 0a20 2020 2020 2020 2072  es.")..        r
-00016830: 6574 7572 6e20 6177 6169 7420 7365 6c66  eturn await self
-00016840: 2e61 7069 2e73 6574 5f68 6f6d 655f 7074  .api.set_home_pt
-00016850: 7a5f 6361 6d65 7261 2873 656c 662e 6964  z_camera(self.id
-00016860: 290a 0a20 2020 2023 2065 6e64 7265 6769  )..    # endregi
-00016870: 6f6e 0a0a 0a63 6c61 7373 2056 6965 7765  on...class Viewe
-00016880: 7228 5072 6f74 6563 7441 646f 7074 6162  r(ProtectAdoptab
-00016890: 6c65 4465 7669 6365 4d6f 6465 6c29 3a0a  leDeviceModel):.
-000168a0: 2020 2020 7374 7265 616d 5f6c 696d 6974      stream_limit
-000168b0: 3a20 696e 740a 2020 2020 736f 6674 7761  : int.    softwa
-000168c0: 7265 5f76 6572 7369 6f6e 3a20 7374 720a  re_version: str.
-000168d0: 2020 2020 6c69 7665 7669 6577 5f69 643a      liveview_id:
-000168e0: 2073 7472 0a0a 2020 2020 4063 6c61 7373   str..    @class
-000168f0: 6d65 7468 6f64 0a20 2020 2040 6361 6368  method.    @cach
-00016900: 650a 2020 2020 6465 6620 5f67 6574 5f75  e.    def _get_u
-00016910: 6e69 6669 5f72 656d 6170 7328 636c 7329  nifi_remaps(cls)
-00016920: 202d 3e20 6469 6374 5b73 7472 2c20 7374   -> dict[str, st
-00016930: 725d 3a0a 2020 2020 2020 2020 7265 7475  r]:.        retu
-00016940: 726e 207b 2a2a 7375 7065 7228 292e 5f67  rn {**super()._g
-00016950: 6574 5f75 6e69 6669 5f72 656d 6170 7328  et_unifi_remaps(
-00016960: 292c 2022 6c69 7665 7669 6577 223a 2022  ), "liveview": "
-00016970: 6c69 7665 7669 6577 4964 227d 0a0a 2020  liveviewId"}..  
-00016980: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
-00016990: 2020 2040 6361 6368 650a 2020 2020 6465     @cache.    de
-000169a0: 6620 5f67 6574 5f72 6561 645f 6f6e 6c79  f _get_read_only
-000169b0: 5f66 6965 6c64 7328 636c 7329 202d 3e20  _fields(cls) -> 
-000169c0: 7365 745b 7374 725d 3a0a 2020 2020 2020  set[str]:.      
-000169d0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
-000169e0: 2e5f 6765 745f 7265 6164 5f6f 6e6c 795f  ._get_read_only_
-000169f0: 6669 656c 6473 2829 207c 207b 2273 6f66  fields() | {"sof
-00016a00: 7477 6172 6556 6572 7369 6f6e 227d 0a0a  twareVersion"}..
-00016a10: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00016a20: 2020 6465 6620 6c69 7665 7669 6577 2873    def liveview(s
-00016a30: 656c 6629 202d 3e20 4f70 7469 6f6e 616c  elf) -> Optional
-00016a40: 5b4c 6976 6576 6965 775d 3a0a 2020 2020  [Liveview]:.    
-00016a50: 2020 2020 2320 7573 6572 206d 6179 206e      # user may n
-00016a60: 6f74 2068 6176 6520 7065 726d 6973 7369  ot have permissi
-00016a70: 6f6e 2074 6f20 7365 6520 7468 6520 6c69  on to see the li
-00016a80: 7665 7669 6577 0a20 2020 2020 2020 2072  veview.        r
-00016a90: 6574 7572 6e20 7365 6c66 2e61 7069 2e62  eturn self.api.b
-00016aa0: 6f6f 7473 7472 6170 2e6c 6976 6576 6965  ootstrap.livevie
-00016ab0: 7773 2e67 6574 2873 656c 662e 6c69 7665  ws.get(self.live
-00016ac0: 7669 6577 5f69 6429 0a0a 2020 2020 6173  view_id)..    as
-00016ad0: 796e 6320 6465 6620 7365 745f 6c69 7665  ync def set_live
-00016ae0: 7669 6577 2873 656c 662c 206c 6976 6576  view(self, livev
-00016af0: 6965 773a 204c 6976 6576 6965 7729 202d  iew: Liveview) -
-00016b00: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00016b10: 2222 2253 6574 7320 7468 6520 6c69 7665  """Sets the live
-00016b20: 7669 6577 2063 7572 7265 6e74 2073 6574  view current set
-00016b30: 2066 6f72 2074 6865 2076 6965 7765 720a   for the viewer.
-00016b40: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00016b50: 2020 2020 2020 202d 2d2d 2d0a 2020 2020         ----.    
-00016b60: 2020 2020 2020 2020 6c69 7665 7669 6577          liveview
-00016b70: 3a20 5468 6520 6c69 7665 7669 6577 2079  : The liveview y
-00016b80: 6f75 2077 616e 7420 746f 2073 6574 0a20  ou want to set. 
-00016b90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00016ba0: 2020 2020 6966 2073 656c 662e 5f61 7069      if self._api
-00016bb0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-00016bc0: 206c 6976 6576 6965 772e 6964 206e 6f74   liveview.id not
-00016bd0: 2069 6e20 7365 6c66 2e5f 6170 692e 626f   in self._api.bo
-00016be0: 6f74 7374 7261 702e 6c69 7665 7669 6577  otstrap.liveview
-00016bf0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-00016c00: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
-00016c10: 2255 6e6b 6e6f 776e 206c 6976 6576 6965  "Unknown livevie
-00016c20: 7722 290a 0a20 2020 2020 2020 2061 7379  w")..        asy
-00016c30: 6e63 2077 6974 6820 7365 6c66 2e5f 7570  nc with self._up
-00016c40: 6461 7465 5f6c 6f63 6b3a 0a20 2020 2020  date_lock:.     
-00016c50: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
-00016c60: 6e63 696f 2e73 6c65 6570 280a 2020 2020  ncio.sleep(.    
-00016c70: 2020 2020 2020 2020 2020 2020 302c 0a20              0,. 
-00016c80: 2020 2020 2020 2020 2020 2029 2020 2320             )  # 
-00016c90: 7969 656c 6420 746f 2074 6865 2065 7665  yield to the eve
-00016ca0: 6e74 206c 6f6f 7020 6f6e 6365 2077 6520  nt loop once we 
-00016cb0: 6861 7665 2074 6865 206c 6f63 6b20 746f  have the lock to
-00016cc0: 2070 726f 6365 7373 2061 6e79 2070 656e   process any pen
-00016cd0: 6469 6e67 2075 7064 6174 6573 0a20 2020  ding updates.   
-00016ce0: 2020 2020 2020 2020 2064 6174 615f 6265           data_be
-00016cf0: 666f 7265 5f63 6861 6e67 6573 203d 2073  fore_changes = s
-00016d00: 656c 662e 6469 6374 5f77 6974 685f 6578  elf.dict_with_ex
-00016d10: 636c 7564 6573 2829 0a20 2020 2020 2020  cludes().       
-00016d20: 2020 2020 2073 656c 662e 6c69 7665 7669       self.livevi
-00016d30: 6577 5f69 6420 3d20 6c69 7665 7669 6577  ew_id = liveview
-00016d40: 2e69 640a 2020 2020 2020 2020 2020 2020  .id.            
-00016d50: 2320 556e 6946 6920 5072 6f74 6563 7420  # UniFi Protect 
-00016d60: 6275 673a 2063 6861 6e67 696e 6720 7468  bug: changing th
-00016d70: 6520 6c69 7665 7669 6577 2064 6f65 7320  e liveview does 
-00016d80: 5f6e 6f74 5f20 656d 6974 2061 2057 5320  _not_ emit a WS 
-00016d90: 6d65 7373 6167 650a 2020 2020 2020 2020  message.        
-00016da0: 2020 2020 6177 6169 7420 7365 6c66 2e73      await self.s
-00016db0: 6176 655f 6465 7669 6365 2864 6174 615f  ave_device(data_
-00016dc0: 6265 666f 7265 5f63 6861 6e67 6573 2c20  before_changes, 
-00016dd0: 666f 7263 655f 656d 6974 3d54 7275 6529  force_emit=True)
-00016de0: 0a0a 0a63 6c61 7373 2042 7269 6467 6528  ...class Bridge(
-00016df0: 5072 6f74 6563 7441 646f 7074 6162 6c65  ProtectAdoptable
-00016e00: 4465 7669 6365 4d6f 6465 6c29 3a0a 2020  DeviceModel):.  
-00016e10: 2020 706c 6174 666f 726d 3a20 7374 720a    platform: str.
-00016e20: 0a0a 636c 6173 7320 5365 6e73 6f72 5365  ..class SensorSe
-00016e30: 7474 696e 6773 4261 7365 2850 726f 7465  ttingsBase(Prote
-00016e40: 6374 4261 7365 4f62 6a65 6374 293a 0a20  ctBaseObject):. 
-00016e50: 2020 2069 735f 656e 6162 6c65 643a 2062     is_enabled: b
-00016e60: 6f6f 6c0a 0a0a 636c 6173 7320 5365 6e73  ool...class Sens
-00016e70: 6f72 5468 7265 7368 6f6c 6453 6574 7469  orThresholdSetti
-00016e80: 6e67 7328 5365 6e73 6f72 5365 7474 696e  ngs(SensorSettin
-00016e90: 6773 4261 7365 293a 0a20 2020 206d 6172  gsBase):.    mar
-00016ea0: 6769 6e3a 2066 6c6f 6174 2020 2320 7265  gin: float  # re
-00016eb0: 6164 206f 6e6c 790a 2020 2020 2320 2273  ad only.    # "s
-00016ec0: 6166 6522 2074 6872 6573 686f 6c64 7320  afe" thresholds 
-00016ed0: 666f 7220 616c 6572 7469 6e67 0a20 2020  for alerting.   
-00016ee0: 2023 2061 6e79 7468 696e 6720 6265 6c6f   # anything belo
-00016ef0: 772f 6162 6f76 6520 7769 6c6c 2074 7269  w/above will tri
-00016f00: 6767 6572 2061 6c65 7274 0a20 2020 206c  gger alert.    l
-00016f10: 6f77 5f74 6872 6573 686f 6c64 3a20 4f70  ow_threshold: Op
-00016f20: 7469 6f6e 616c 5b66 6c6f 6174 5d0a 2020  tional[float].  
-00016f30: 2020 6869 6768 5f74 6872 6573 686f 6c64    high_threshold
-00016f40: 3a20 4f70 7469 6f6e 616c 5b66 6c6f 6174  : Optional[float
-00016f50: 5d0a 0a0a 636c 6173 7320 5365 6e73 6f72  ]...class Sensor
-00016f60: 5365 6e73 6974 6976 6974 7953 6574 7469  SensitivitySetti
-00016f70: 6e67 7328 5365 6e73 6f72 5365 7474 696e  ngs(SensorSettin
-00016f80: 6773 4261 7365 293a 0a20 2020 2073 656e  gsBase):.    sen
-00016f90: 7369 7469 7669 7479 3a20 5065 7263 656e  sitivity: Percen
-00016fa0: 7449 6e74 0a0a 0a63 6c61 7373 2053 656e  tInt...class Sen
-00016fb0: 736f 7242 6174 7465 7279 5374 6174 7573  sorBatteryStatus
-00016fc0: 2850 726f 7465 6374 4261 7365 4f62 6a65  (ProtectBaseObje
-00016fd0: 6374 293a 0a20 2020 2070 6572 6365 6e74  ct):.    percent
-00016fe0: 6167 653a 204f 7074 696f 6e61 6c5b 5065  age: Optional[Pe
-00016ff0: 7263 656e 7449 6e74 5d0a 2020 2020 6973  rcentInt].    is
-00017000: 5f6c 6f77 3a20 626f 6f6c 0a0a 0a63 6c61  _low: bool...cla
-00017010: 7373 2053 656e 736f 7253 7461 7428 5072  ss SensorStat(Pr
-00017020: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
-00017030: 3a0a 2020 2020 7661 6c75 653a 204f 7074  :.    value: Opt
-00017040: 696f 6e61 6c5b 666c 6f61 745d 0a20 2020  ional[float].   
-00017050: 2073 7461 7475 733a 2053 656e 736f 7253   status: SensorS
-00017060: 7461 7475 7354 7970 650a 0a0a 636c 6173  tatusType...clas
-00017070: 7320 5365 6e73 6f72 5374 6174 7328 5072  s SensorStats(Pr
-00017080: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
-00017090: 3a0a 2020 2020 6c69 6768 743a 2053 656e  :.    light: Sen
-000170a0: 736f 7253 7461 740a 2020 2020 6875 6d69  sorStat.    humi
-000170b0: 6469 7479 3a20 5365 6e73 6f72 5374 6174  dity: SensorStat
-000170c0: 0a20 2020 2074 656d 7065 7261 7475 7265  .    temperature
-000170d0: 3a20 5365 6e73 6f72 5374 6174 0a0a 0a63  : SensorStat...c
-000170e0: 6c61 7373 2053 656e 736f 7228 5072 6f74  lass Sensor(Prot
-000170f0: 6563 7441 646f 7074 6162 6c65 4465 7669  ectAdoptableDevi
-00017100: 6365 4d6f 6465 6c29 3a0a 2020 2020 616c  ceModel):.    al
-00017110: 6172 6d5f 7365 7474 696e 6773 3a20 5365  arm_settings: Se
-00017120: 6e73 6f72 5365 7474 696e 6773 4261 7365  nsorSettingsBase
-00017130: 0a20 2020 2061 6c61 726d 5f74 7269 6767  .    alarm_trigg
-00017140: 6572 6564 5f61 743a 204f 7074 696f 6e61  ered_at: Optiona
-00017150: 6c5b 6461 7465 7469 6d65 5d0a 2020 2020  l[datetime].    
-00017160: 6261 7474 6572 795f 7374 6174 7573 3a20  battery_status: 
-00017170: 5365 6e73 6f72 4261 7474 6572 7953 7461  SensorBatterySta
-00017180: 7475 730a 2020 2020 6361 6d65 7261 5f69  tus.    camera_i
-00017190: 643a 204f 7074 696f 6e61 6c5b 7374 725d  d: Optional[str]
-000171a0: 0a20 2020 2068 756d 6964 6974 795f 7365  .    humidity_se
-000171b0: 7474 696e 6773 3a20 5365 6e73 6f72 5468  ttings: SensorTh
-000171c0: 7265 7368 6f6c 6453 6574 7469 6e67 730a  resholdSettings.
-000171d0: 2020 2020 6973 5f6d 6f74 696f 6e5f 6465      is_motion_de
-000171e0: 7465 6374 6564 3a20 626f 6f6c 0a20 2020  tected: bool.   
-000171f0: 2069 735f 6f70 656e 6564 3a20 626f 6f6c   is_opened: bool
-00017200: 0a20 2020 206c 6561 6b5f 6465 7465 6374  .    leak_detect
-00017210: 6564 5f61 743a 204f 7074 696f 6e61 6c5b  ed_at: Optional[
-00017220: 6461 7465 7469 6d65 5d0a 2020 2020 6c65  datetime].    le
-00017230: 645f 7365 7474 696e 6773 3a20 5365 6e73  d_settings: Sens
-00017240: 6f72 5365 7474 696e 6773 4261 7365 0a20  orSettingsBase. 
-00017250: 2020 206c 6967 6874 5f73 6574 7469 6e67     light_setting
-00017260: 733a 2053 656e 736f 7254 6872 6573 686f  s: SensorThresho
-00017270: 6c64 5365 7474 696e 6773 0a20 2020 206d  ldSettings.    m
-00017280: 6f74 696f 6e5f 6465 7465 6374 6564 5f61  otion_detected_a
-00017290: 743a 204f 7074 696f 6e61 6c5b 6461 7465  t: Optional[date
-000172a0: 7469 6d65 5d0a 2020 2020 6d6f 7469 6f6e  time].    motion
-000172b0: 5f73 6574 7469 6e67 733a 2053 656e 736f  _settings: Senso
-000172c0: 7253 656e 7369 7469 7669 7479 5365 7474  rSensitivitySett
-000172d0: 696e 6773 0a20 2020 206f 7065 6e5f 7374  ings.    open_st
-000172e0: 6174 7573 5f63 6861 6e67 6564 5f61 743a  atus_changed_at:
-000172f0: 204f 7074 696f 6e61 6c5b 6461 7465 7469   Optional[dateti
-00017300: 6d65 5d0a 2020 2020 7374 6174 733a 2053  me].    stats: S
-00017310: 656e 736f 7253 7461 7473 0a20 2020 2074  ensorStats.    t
-00017320: 616d 7065 7269 6e67 5f64 6574 6563 7465  ampering_detecte
-00017330: 645f 6174 3a20 4f70 7469 6f6e 616c 5b64  d_at: Optional[d
-00017340: 6174 6574 696d 655d 0a20 2020 2074 656d  atetime].    tem
-00017350: 7065 7261 7475 7265 5f73 6574 7469 6e67  perature_setting
-00017360: 733a 2053 656e 736f 7254 6872 6573 686f  s: SensorThresho
-00017370: 6c64 5365 7474 696e 6773 0a20 2020 206d  ldSettings.    m
-00017380: 6f75 6e74 5f74 7970 653a 204d 6f75 6e74  ount_type: Mount
-00017390: 5479 7065 0a0a 2020 2020 2320 6e6f 7420  Type..    # not 
-000173a0: 6469 7265 6374 6c79 2066 726f 6d20 556e  directly from Un
-000173b0: 6946 690a 2020 2020 6c61 7374 5f6d 6f74  iFi.    last_mot
-000173c0: 696f 6e5f 6576 656e 745f 6964 3a20 4f70  ion_event_id: Op
-000173d0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-000173e0: 6e65 0a20 2020 206c 6173 745f 636f 6e74  ne.    last_cont
-000173f0: 6163 745f 6576 656e 745f 6964 3a20 4f70  act_event_id: Op
-00017400: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-00017410: 6e65 0a20 2020 206c 6173 745f 7661 6c75  ne.    last_valu
-00017420: 655f 6576 656e 745f 6964 3a20 4f70 7469  e_event_id: Opti
-00017430: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-00017440: 0a20 2020 206c 6173 745f 616c 6172 6d5f  .    last_alarm_
-00017450: 6576 656e 745f 6964 3a20 4f70 7469 6f6e  event_id: Option
-00017460: 616c 5b73 7472 5d20 3d20 4e6f 6e65 0a20  al[str] = None. 
-00017470: 2020 2065 7874 7265 6d65 5f76 616c 7565     extreme_value
-00017480: 5f64 6574 6563 7465 645f 6174 3a20 4f70  _detected_at: Op
-00017490: 7469 6f6e 616c 5b64 6174 6574 696d 655d  tional[datetime]
-000174a0: 203d 204e 6f6e 650a 2020 2020 5f74 616d   = None.    _tam
-000174b0: 7065 725f 7469 6d65 6f75 743a 204f 7074  per_timeout: Opt
-000174c0: 696f 6e61 6c5b 6461 7465 7469 6d65 5d20  ional[datetime] 
-000174d0: 3d20 5072 6976 6174 6541 7474 7228 4e6f  = PrivateAttr(No
-000174e0: 6e65 290a 2020 2020 5f61 6c61 726d 5f74  ne).    _alarm_t
-000174f0: 696d 656f 7574 3a20 4f70 7469 6f6e 616c  imeout: Optional
-00017500: 5b64 6174 6574 696d 655d 203d 2050 7269  [datetime] = Pri
-00017510: 7661 7465 4174 7472 284e 6f6e 6529 0a0a  vateAttr(None)..
-00017520: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00017530: 0a20 2020 2040 6361 6368 650a 2020 2020  .    @cache.    
-00017540: 6465 6620 5f67 6574 5f75 6e69 6669 5f72  def _get_unifi_r
-00017550: 656d 6170 7328 636c 7329 202d 3e20 6469  emaps(cls) -> di
-00017560: 6374 5b73 7472 2c20 7374 725d 3a0a 2020  ct[str, str]:.  
-00017570: 2020 2020 2020 7265 7475 726e 207b 2a2a        return {**
-00017580: 7375 7065 7228 292e 5f67 6574 5f75 6e69  super()._get_uni
-00017590: 6669 5f72 656d 6170 7328 292c 2022 6361  fi_remaps(), "ca
-000175a0: 6d65 7261 223a 2022 6361 6d65 7261 4964  mera": "cameraId
-000175b0: 227d 0a0a 2020 2020 4063 6c61 7373 6d65  "}..    @classme
-000175c0: 7468 6f64 0a20 2020 2040 6361 6368 650a  thod.    @cache.
-000175d0: 2020 2020 6465 6620 5f67 6574 5f72 6561      def _get_rea
-000175e0: 645f 6f6e 6c79 5f66 6965 6c64 7328 636c  d_only_fields(cl
-000175f0: 7329 202d 3e20 7365 745b 7374 725d 3a0a  s) -> set[str]:.
-00017600: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00017610: 7570 6572 2829 2e5f 6765 745f 7265 6164  uper()._get_read
-00017620: 5f6f 6e6c 795f 6669 656c 6473 2829 207c  _only_fields() |
-00017630: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00017640: 6261 7474 6572 7953 7461 7475 7322 2c0a  batteryStatus",.
-00017650: 2020 2020 2020 2020 2020 2020 2269 734d              "isM
-00017660: 6f74 696f 6e44 6574 6563 7465 6422 2c0a  otionDetected",.
-00017670: 2020 2020 2020 2020 2020 2020 226c 6561              "lea
-00017680: 6b44 6574 6563 7465 6441 7422 2c0a 2020  kDetectedAt",.  
-00017690: 2020 2020 2020 2020 2020 2274 616d 7065            "tampe
-000176a0: 7269 6e67 4465 7465 6374 6564 4174 222c  ringDetectedAt",
-000176b0: 0a20 2020 2020 2020 2020 2020 2022 6973  .            "is
-000176c0: 4f70 656e 6564 222c 0a20 2020 2020 2020  Opened",.       
-000176d0: 2020 2020 2022 6f70 656e 5374 6174 7573       "openStatus
-000176e0: 4368 616e 6765 6441 7422 2c0a 2020 2020  ChangedAt",.    
-000176f0: 2020 2020 2020 2020 2261 6c61 726d 5472          "alarmTr
-00017700: 6967 6765 7265 6441 7422 2c0a 2020 2020  iggeredAt",.    
-00017710: 2020 2020 2020 2020 226d 6f74 696f 6e44          "motionD
-00017720: 6574 6563 7465 6441 7422 2c0a 2020 2020  etectedAt",.    
-00017730: 2020 2020 2020 2020 2273 7461 7473 222c          "stats",
-00017740: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00017750: 6465 6620 756e 6966 695f 6469 6374 280a  def unifi_dict(.
-00017760: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00017770: 2020 2020 2020 6461 7461 3a20 4f70 7469        data: Opti
-00017780: 6f6e 616c 5b64 6963 745b 7374 722c 2041  onal[dict[str, A
-00017790: 6e79 5d5d 203d 204e 6f6e 652c 0a20 2020  ny]] = None,.   
-000177a0: 2020 2020 2065 7863 6c75 6465 3a20 4f70       exclude: Op
-000177b0: 7469 6f6e 616c 5b73 6574 5b73 7472 5d5d  tional[set[str]]
-000177c0: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
-000177d0: 3e20 6469 6374 5b73 7472 2c20 416e 795d  > dict[str, Any]
-000177e0: 3a0a 2020 2020 2020 2020 6461 7461 203d  :.        data =
-000177f0: 2073 7570 6572 2829 2e75 6e69 6669 5f64   super().unifi_d
-00017800: 6963 7428 6461 7461 3d64 6174 612c 2065  ict(data=data, e
-00017810: 7863 6c75 6465 3d65 7863 6c75 6465 290a  xclude=exclude).
-00017820: 0a20 2020 2020 2020 2069 6620 226c 6173  .        if "las
-00017830: 744d 6f74 696f 6e45 7665 6e74 4964 2220  tMotionEventId" 
-00017840: 696e 2064 6174 613a 0a20 2020 2020 2020  in data:.       
-00017850: 2020 2020 2064 656c 2064 6174 615b 226c       del data["l
-00017860: 6173 744d 6f74 696f 6e45 7665 6e74 4964  astMotionEventId
-00017870: 225d 0a20 2020 2020 2020 2069 6620 226c  "].        if "l
-00017880: 6173 7443 6f6e 7461 6374 4576 656e 7449  astContactEventI
-00017890: 6422 2069 6e20 6461 7461 3a0a 2020 2020  d" in data:.    
-000178a0: 2020 2020 2020 2020 6465 6c20 6461 7461          del data
-000178b0: 5b22 6c61 7374 436f 6e74 6163 7445 7665  ["lastContactEve
-000178c0: 6e74 4964 225d 0a20 2020 2020 2020 2069  ntId"].        i
-000178d0: 6620 226c 6173 7456 616c 7565 4576 656e  f "lastValueEven
-000178e0: 7449 6422 2069 6e20 6461 7461 3a0a 2020  tId" in data:.  
-000178f0: 2020 2020 2020 2020 2020 6465 6c20 6461            del da
-00017900: 7461 5b22 6c61 7374 5661 6c75 6545 7665  ta["lastValueEve
-00017910: 6e74 4964 225d 0a20 2020 2020 2020 2069  ntId"].        i
-00017920: 6620 226c 6173 7441 6c61 726d 4576 656e  f "lastAlarmEven
-00017930: 7449 6422 2069 6e20 6461 7461 3a0a 2020  tId" in data:.  
-00017940: 2020 2020 2020 2020 2020 6465 6c20 6461            del da
-00017950: 7461 5b22 6c61 7374 416c 6172 6d45 7665  ta["lastAlarmEve
-00017960: 6e74 4964 225d 0a20 2020 2020 2020 2069  ntId"].        i
-00017970: 6620 2265 7874 7265 6d65 5661 6c75 6544  f "extremeValueD
-00017980: 6574 6563 7465 6441 7422 2069 6e20 6461  etectedAt" in da
-00017990: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
-000179a0: 6465 6c20 6461 7461 5b22 6578 7472 656d  del data["extrem
-000179b0: 6556 616c 7565 4465 7465 6374 6564 4174  eValueDetectedAt
-000179c0: 225d 0a0a 2020 2020 2020 2020 7265 7475  "]..        retu
-000179d0: 726e 2064 6174 610a 0a20 2020 2040 7072  rn data..    @pr
-000179e0: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
-000179f0: 616d 6572 6128 7365 6c66 2920 2d3e 204f  amera(self) -> O
-00017a00: 7074 696f 6e61 6c5b 4361 6d65 7261 5d3a  ptional[Camera]:
-00017a10: 0a20 2020 2020 2020 2022 2222 5061 6972  .        """Pair
-00017a20: 6564 2043 616d 6572 6120 7769 6c6c 2061  ed Camera will a
-00017a30: 6c77 6179 7320 6265 206e 6f6e 6520 6966  lways be none if
-00017a40: 206e 6f20 6361 6d65 7261 2069 7320 7061   no camera is pa
-00017a50: 6972 6564 2222 220a 0a20 2020 2020 2020  ired"""..       
-00017a60: 2069 6620 7365 6c66 2e63 616d 6572 615f   if self.camera_
-00017a70: 6964 2069 7320 4e6f 6e65 3a0a 2020 2020  id is None:.    
-00017a80: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00017a90: 6f6e 650a 0a20 2020 2020 2020 2072 6574  one..        ret
-00017aa0: 7572 6e20 7365 6c66 2e61 7069 2e62 6f6f  urn self.api.boo
-00017ab0: 7473 7472 6170 2e63 616d 6572 6173 5b73  tstrap.cameras[s
-00017ac0: 656c 662e 6361 6d65 7261 5f69 645d 0a0a  elf.camera_id]..
-00017ad0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00017ae0: 2020 6465 6620 6973 5f74 616d 7065 7269    def is_tamperi
-00017af0: 6e67 5f64 6574 6563 7465 6428 7365 6c66  ng_detected(self
-00017b00: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
-00017b10: 2020 2072 6574 7572 6e20 7365 6c66 2e74     return self.t
-00017b20: 616d 7065 7269 6e67 5f64 6574 6563 7465  ampering_detecte
-00017b30: 645f 6174 2069 7320 6e6f 7420 4e6f 6e65  d_at is not None
-00017b40: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00017b50: 2020 2020 6465 6620 6973 5f61 6c61 726d      def is_alarm
-00017b60: 5f64 6574 6563 7465 6428 7365 6c66 2920  _detected(self) 
-00017b70: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-00017b80: 2069 6620 7365 6c66 2e5f 616c 6172 6d5f   if self._alarm_
-00017b90: 7469 6d65 6f75 7420 6973 204e 6f6e 653a  timeout is None:
-00017ba0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00017bb0: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
-00017bc0: 2020 7265 7475 726e 2075 7463 5f6e 6f77    return utc_now
-00017bd0: 2829 203c 2073 656c 662e 5f61 6c61 726d  () < self._alarm
-00017be0: 5f74 696d 656f 7574 0a0a 2020 2020 4070  _timeout..    @p
-00017bf0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00017c00: 6973 5f63 6f6e 7461 6374 5f73 656e 736f  is_contact_senso
-00017c10: 725f 656e 6162 6c65 6428 7365 6c66 2920  r_enabled(self) 
-00017c20: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-00017c30: 2072 6574 7572 6e20 7365 6c66 2e6d 6f75   return self.mou
-00017c40: 6e74 5f74 7970 6520 696e 207b 4d6f 756e  nt_type in {Moun
-00017c50: 7454 7970 652e 444f 4f52 2c20 4d6f 756e  tType.DOOR, Moun
-00017c60: 7454 7970 652e 5749 4e44 4f57 2c20 4d6f  tType.WINDOW, Mo
-00017c70: 756e 7454 7970 652e 4741 5241 4745 7d0a  untType.GARAGE}.
-00017c80: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00017c90: 2020 2064 6566 2069 735f 6d6f 7469 6f6e     def is_motion
-00017ca0: 5f73 656e 736f 725f 656e 6162 6c65 6428  _sensor_enabled(
-00017cb0: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
-00017cc0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00017cd0: 6c66 2e6d 6f75 6e74 5f74 7970 6520 213d  lf.mount_type !=
-00017ce0: 204d 6f75 6e74 5479 7065 2e4c 4541 4b20   MountType.LEAK 
-00017cf0: 616e 6420 7365 6c66 2e6d 6f74 696f 6e5f  and self.motion_
-00017d00: 7365 7474 696e 6773 2e69 735f 656e 6162  settings.is_enab
-00017d10: 6c65 640a 0a20 2020 2040 7072 6f70 6572  led..    @proper
-00017d20: 7479 0a20 2020 2064 6566 2069 735f 616c  ty.    def is_al
-00017d30: 6172 6d5f 7365 6e73 6f72 5f65 6e61 626c  arm_sensor_enabl
-00017d40: 6564 2873 656c 6629 202d 3e20 626f 6f6c  ed(self) -> bool
-00017d50: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00017d60: 2073 656c 662e 6d6f 756e 745f 7479 7065   self.mount_type
-00017d70: 2021 3d20 4d6f 756e 7454 7970 652e 4c45   != MountType.LE
-00017d80: 414b 2061 6e64 2073 656c 662e 616c 6172  AK and self.alar
-00017d90: 6d5f 7365 7474 696e 6773 2e69 735f 656e  m_settings.is_en
-00017da0: 6162 6c65 640a 0a20 2020 2040 7072 6f70  abled..    @prop
-00017db0: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
-00017dc0: 6c69 6768 745f 7365 6e73 6f72 5f65 6e61  light_sensor_ena
-00017dd0: 626c 6564 2873 656c 6629 202d 3e20 626f  bled(self) -> bo
-00017de0: 6f6c 3a0a 2020 2020 2020 2020 7265 7475  ol:.        retu
-00017df0: 726e 2073 656c 662e 6d6f 756e 745f 7479  rn self.mount_ty
-00017e00: 7065 2021 3d20 4d6f 756e 7454 7970 652e  pe != MountType.
-00017e10: 4c45 414b 2061 6e64 2073 656c 662e 6c69  LEAK and self.li
-00017e20: 6768 745f 7365 7474 696e 6773 2e69 735f  ght_settings.is_
-00017e30: 656e 6162 6c65 640a 0a20 2020 2040 7072  enabled..    @pr
-00017e40: 6f70 6572 7479 0a20 2020 2064 6566 2069  operty.    def i
-00017e50: 735f 7465 6d70 6572 6174 7572 655f 7365  s_temperature_se
-00017e60: 6e73 6f72 5f65 6e61 626c 6564 2873 656c  nsor_enabled(sel
-00017e70: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-00017e80: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
-00017e90: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00017ea0: 756e 745f 7479 7065 2021 3d20 4d6f 756e  unt_type != Moun
-00017eb0: 7454 7970 652e 4c45 414b 2061 6e64 2073  tType.LEAK and s
-00017ec0: 656c 662e 7465 6d70 6572 6174 7572 655f  elf.temperature_
-00017ed0: 7365 7474 696e 6773 2e69 735f 656e 6162  settings.is_enab
-00017ee0: 6c65 640a 2020 2020 2020 2020 290a 0a20  led.        ).. 
-00017ef0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00017f00: 2064 6566 2069 735f 6875 6d69 6469 7479   def is_humidity
-00017f10: 5f73 656e 736f 725f 656e 6162 6c65 6428  _sensor_enabled(
-00017f20: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
-00017f30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00017f40: 6c66 2e6d 6f75 6e74 5f74 7970 6520 213d  lf.mount_type !=
-00017f50: 204d 6f75 6e74 5479 7065 2e4c 4541 4b20   MountType.LEAK 
-00017f60: 616e 6420 7365 6c66 2e68 756d 6964 6974  and self.humidit
-00017f70: 795f 7365 7474 696e 6773 2e69 735f 656e  y_settings.is_en
-00017f80: 6162 6c65 640a 0a20 2020 2040 7072 6f70  abled..    @prop
-00017f90: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
-00017fa0: 6c65 616b 5f73 656e 736f 725f 656e 6162  leak_sensor_enab
-00017fb0: 6c65 6428 7365 6c66 2920 2d3e 2062 6f6f  led(self) -> boo
-00017fc0: 6c3a 0a20 2020 2020 2020 2072 6574 7572  l:.        retur
-00017fd0: 6e20 7365 6c66 2e6d 6f75 6e74 5f74 7970  n self.mount_typ
-00017fe0: 6520 6973 204d 6f75 6e74 5479 7065 2e4c  e is MountType.L
-00017ff0: 4541 4b0a 0a20 2020 2064 6566 2073 6574  EAK..    def set
-00018000: 5f61 6c61 726d 5f74 696d 656f 7574 2873  _alarm_timeout(s
-00018010: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00018020: 2020 2020 2020 7365 6c66 2e5f 616c 6172        self._alar
-00018030: 6d5f 7469 6d65 6f75 7420 3d20 7574 635f  m_timeout = utc_
-00018040: 6e6f 7728 2920 2b20 4556 454e 545f 5049  now() + EVENT_PI
-00018050: 4e47 5f49 4e54 4552 5641 4c0a 2020 2020  NG_INTERVAL.    
-00018060: 2020 2020 7365 6c66 2e5f 6576 656e 745f      self._event_
-00018070: 6361 6c6c 6261 636b 5f70 696e 6728 290a  callback_ping().
-00018080: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00018090: 2020 2064 6566 206c 6173 745f 6d6f 7469     def last_moti
-000180a0: 6f6e 5f65 7665 6e74 2873 656c 6629 202d  on_event(self) -
-000180b0: 3e20 4f70 7469 6f6e 616c 5b45 7665 6e74  > Optional[Event
-000180c0: 5d3a 0a20 2020 2020 2020 2069 6620 7365  ]:.        if se
-000180d0: 6c66 2e6c 6173 745f 6d6f 7469 6f6e 5f65  lf.last_motion_e
-000180e0: 7665 6e74 5f69 6420 6973 204e 6f6e 653a  vent_id is None:
-000180f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00018100: 7572 6e20 4e6f 6e65 0a0a 2020 2020 2020  urn None..      
-00018110: 2020 7265 7475 726e 2073 656c 662e 6170    return self.ap
-00018120: 692e 626f 6f74 7374 7261 702e 6576 656e  i.bootstrap.even
-00018130: 7473 2e67 6574 2873 656c 662e 6c61 7374  ts.get(self.last
-00018140: 5f6d 6f74 696f 6e5f 6576 656e 745f 6964  _motion_event_id
-00018150: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00018160: 0a20 2020 2064 6566 206c 6173 745f 636f  .    def last_co
-00018170: 6e74 6163 745f 6576 656e 7428 7365 6c66  ntact_event(self
-00018180: 2920 2d3e 204f 7074 696f 6e61 6c5b 4576  ) -> Optional[Ev
-00018190: 656e 745d 3a0a 2020 2020 2020 2020 6966  ent]:.        if
-000181a0: 2073 656c 662e 6c61 7374 5f63 6f6e 7461   self.last_conta
-000181b0: 6374 5f65 7665 6e74 5f69 6420 6973 204e  ct_event_id is N
-000181c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000181d0: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
-000181e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000181f0: 662e 6170 692e 626f 6f74 7374 7261 702e  f.api.bootstrap.
-00018200: 6576 656e 7473 2e67 6574 2873 656c 662e  events.get(self.
-00018210: 6c61 7374 5f63 6f6e 7461 6374 5f65 7665  last_contact_eve
-00018220: 6e74 5f69 6429 0a0a 2020 2020 4070 726f  nt_id)..    @pro
-00018230: 7065 7274 790a 2020 2020 6465 6620 6c61  perty.    def la
-00018240: 7374 5f76 616c 7565 5f65 7665 6e74 2873  st_value_event(s
-00018250: 656c 6629 202d 3e20 4f70 7469 6f6e 616c  elf) -> Optional
-00018260: 5b45 7665 6e74 5d3a 0a20 2020 2020 2020  [Event]:.       
-00018270: 2069 6620 7365 6c66 2e6c 6173 745f 7661   if self.last_va
-00018280: 6c75 655f 6576 656e 745f 6964 2069 7320  lue_event_id is 
-00018290: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000182a0: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
-000182b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000182c0: 6c66 2e61 7069 2e62 6f6f 7473 7472 6170  lf.api.bootstrap
-000182d0: 2e65 7665 6e74 732e 6765 7428 7365 6c66  .events.get(self
-000182e0: 2e6c 6173 745f 7661 6c75 655f 6576 656e  .last_value_even
-000182f0: 745f 6964 290a 0a20 2020 2040 7072 6f70  t_id)..    @prop
-00018300: 6572 7479 0a20 2020 2064 6566 206c 6173  erty.    def las
-00018310: 745f 616c 6172 6d5f 6576 656e 7428 7365  t_alarm_event(se
-00018320: 6c66 2920 2d3e 204f 7074 696f 6e61 6c5b  lf) -> Optional[
-00018330: 4576 656e 745d 3a0a 2020 2020 2020 2020  Event]:.        
-00018340: 6966 2073 656c 662e 6c61 7374 5f61 6c61  if self.last_ala
-00018350: 726d 5f65 7665 6e74 5f69 6420 6973 204e  rm_event_id is N
-00018360: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00018370: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
-00018380: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00018390: 662e 6170 692e 626f 6f74 7374 7261 702e  f.api.bootstrap.
-000183a0: 6576 656e 7473 2e67 6574 2873 656c 662e  events.get(self.
-000183b0: 6c61 7374 5f61 6c61 726d 5f65 7665 6e74  last_alarm_event
-000183c0: 5f69 6429 0a0a 2020 2020 4070 726f 7065  _id)..    @prope
-000183d0: 7274 790a 2020 2020 6465 6620 6973 5f6c  rty.    def is_l
-000183e0: 6561 6b5f 6465 7465 6374 6564 2873 656c  eak_detected(sel
-000183f0: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-00018400: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00018410: 6c65 616b 5f64 6574 6563 7465 645f 6174  leak_detected_at
-00018420: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
-00018430: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-00018440: 7374 6174 7573 5f6c 6967 6874 2873 656c  status_light(sel
-00018450: 662c 2065 6e61 626c 6564 3a20 626f 6f6c  f, enabled: bool
-00018460: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00018470: 2020 2022 2222 5365 7473 2074 6865 2073     """Sets the s
-00018480: 7461 7475 7320 696e 6469 6361 746f 7220  tatus indicator 
-00018490: 6c69 6768 7420 666f 7220 7468 6520 7365  light for the se
-000184a0: 6e73 6f72 2222 220a 0a20 2020 2020 2020  nsor"""..       
-000184b0: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
-000184c0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000184d0: 2020 2020 2073 656c 662e 6c65 645f 7365       self.led_se
-000184e0: 7474 696e 6773 2e69 735f 656e 6162 6c65  ttings.is_enable
-000184f0: 6420 3d20 656e 6162 6c65 640a 0a20 2020  d = enabled..   
-00018500: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
-00018510: 7175 6575 655f 7570 6461 7465 2863 616c  queue_update(cal
-00018520: 6c62 6163 6b29 0a0a 2020 2020 6173 796e  lback)..    asyn
-00018530: 6320 6465 6620 7365 745f 6d6f 756e 745f  c def set_mount_
-00018540: 7479 7065 2873 656c 662c 206d 6f75 6e74  type(self, mount
-00018550: 5f74 7970 653a 204d 6f75 6e74 5479 7065  _type: MountType
-00018560: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00018570: 2020 2022 2222 5365 7473 2063 7572 7265     """Sets curre
-00018580: 6e74 206d 6f75 6e74 2074 7970 6520 666f  nt mount type fo
-00018590: 7220 7365 6e73 6f72 2222 220a 0a20 2020  r sensor"""..   
-000185a0: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
-000185b0: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
-000185c0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-000185d0: 756e 745f 7479 7065 203d 206d 6f75 6e74  unt_type = mount
-000185e0: 5f74 7970 650a 0a20 2020 2020 2020 2061  _type..        a
-000185f0: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
-00018600: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
-00018610: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-00018620: 7365 745f 6d6f 7469 6f6e 5f73 7461 7475  set_motion_statu
-00018630: 7328 7365 6c66 2c20 656e 6162 6c65 643a  s(self, enabled:
-00018640: 2062 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a   bool) -> None:.
-00018650: 2020 2020 2020 2020 2222 2253 6574 7320          """Sets 
-00018660: 7468 6520 6d6f 7469 6f6e 2064 6574 6563  the motion detec
-00018670: 7469 6f6e 2074 7970 6520 666f 7220 7468  tion type for th
-00018680: 6520 7365 6e73 6f72 2222 220a 0a20 2020  e sensor"""..   
-00018690: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
-000186a0: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
-000186b0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-000186c0: 7469 6f6e 5f73 6574 7469 6e67 732e 6973  tion_settings.is
-000186d0: 5f65 6e61 626c 6564 203d 2065 6e61 626c  _enabled = enabl
-000186e0: 6564 0a0a 2020 2020 2020 2020 6177 6169  ed..        awai
-000186f0: 7420 7365 6c66 2e71 7565 7565 5f75 7064  t self.queue_upd
-00018700: 6174 6528 6361 6c6c 6261 636b 290a 0a20  ate(callback).. 
-00018710: 2020 2061 7379 6e63 2064 6566 2073 6574     async def set
-00018720: 5f6d 6f74 696f 6e5f 7365 6e73 6974 6976  _motion_sensitiv
-00018730: 6974 7928 7365 6c66 2c20 7365 6e73 6974  ity(self, sensit
-00018740: 6976 6974 793a 2069 6e74 2920 2d3e 204e  ivity: int) -> N
-00018750: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00018760: 5365 7473 2074 6865 206d 6f74 696f 6e20  Sets the motion 
-00018770: 7365 6e73 6974 6976 6974 7920 666f 7220  sensitivity for 
-00018780: 7468 6520 7365 6e73 6f72 2222 220a 0a20  the sensor""".. 
-00018790: 2020 2020 2020 2064 6566 2063 616c 6c62         def callb
-000187a0: 6163 6b28 2920 2d3e 204e 6f6e 653a 0a20  ack() -> None:. 
-000187b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000187c0: 6d6f 7469 6f6e 5f73 6574 7469 6e67 732e  motion_settings.
-000187d0: 7365 6e73 6974 6976 6974 7920 3d20 5065  sensitivity = Pe
-000187e0: 7263 656e 7449 6e74 2873 656e 7369 7469  rcentInt(sensiti
-000187f0: 7669 7479 290a 0a20 2020 2020 2020 2061  vity)..        a
-00018800: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
-00018810: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
-00018820: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
-00018830: 7365 745f 7465 6d70 6572 6174 7572 655f  set_temperature_
-00018840: 7374 6174 7573 2873 656c 662c 2065 6e61  status(self, ena
-00018850: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
-00018860: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00018870: 5365 7473 2074 6865 2074 656d 7065 7261  Sets the tempera
-00018880: 7475 7265 2064 6574 6563 7469 6f6e 2074  ture detection t
-00018890: 7970 6520 666f 7220 7468 6520 7365 6e73  ype for the sens
-000188a0: 6f72 2222 220a 0a20 2020 2020 2020 2064  or"""..        d
-000188b0: 6566 2063 616c 6c62 6163 6b28 2920 2d3e  ef callback() ->
-000188c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000188d0: 2020 2073 656c 662e 7465 6d70 6572 6174     self.temperat
-000188e0: 7572 655f 7365 7474 696e 6773 2e69 735f  ure_settings.is_
-000188f0: 656e 6162 6c65 6420 3d20 656e 6162 6c65  enabled = enable
-00018900: 640a 0a20 2020 2020 2020 2061 7761 6974  d..        await
-00018910: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
-00018920: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
-00018930: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
-00018940: 7465 6d70 6572 6174 7572 655f 7361 6665  temperature_safe
-00018950: 5f72 616e 6765 2873 656c 662c 206c 6f77  _range(self, low
-00018960: 3a20 666c 6f61 742c 2068 6967 683a 2066  : float, high: f
-00018970: 6c6f 6174 2920 2d3e 204e 6f6e 653a 0a20  loat) -> None:. 
-00018980: 2020 2020 2020 2022 2222 5365 7473 2074         """Sets t
-00018990: 6865 2074 656d 7065 7261 7475 7265 2073  he temperature s
-000189a0: 6166 6520 7261 6e67 6520 666f 7220 7468  afe range for th
-000189b0: 6520 7365 6e73 6f72 2222 220a 0a20 2020  e sensor"""..   
-000189c0: 2020 2020 2069 6620 6c6f 7720 3c20 302e       if low < 0.
-000189d0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-000189e0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
-000189f0: 224d 696e 696d 756d 2076 616c 7565 2069  "Minimum value i
-00018a00: 7320 30c2 b043 2229 0a20 2020 2020 2020  s 0..C").       
-00018a10: 2069 6620 6869 6768 203e 2034 352e 303a   if high > 45.0:
-00018a20: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00018a30: 7365 2042 6164 5265 7175 6573 7428 224d  se BadRequest("M
-00018a40: 6178 696d 756d 2076 616c 7565 2069 7320  aximum value is 
-00018a50: 3435 c2b0 4322 290a 2020 2020 2020 2020  45..C").        
-00018a60: 6966 2068 6967 6820 3c3d 206c 6f77 3a0a  if high <= low:.
-00018a70: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00018a80: 6520 4261 6452 6571 7565 7374 2822 4869  e BadRequest("Hi
-00018a90: 6768 2076 616c 7565 206d 7573 7420 6265  gh value must be
-00018aa0: 2061 626f 7665 206c 6f77 2076 616c 7565   above low value
-00018ab0: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
-00018ac0: 6361 6c6c 6261 636b 2829 202d 3e20 4e6f  callback() -> No
-00018ad0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018ae0: 7365 6c66 2e74 656d 7065 7261 7475 7265  self.temperature
-00018af0: 5f73 6574 7469 6e67 732e 6c6f 775f 7468  _settings.low_th
-00018b00: 7265 7368 6f6c 6420 3d20 6c6f 770a 2020  reshold = low.  
-00018b10: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-00018b20: 656d 7065 7261 7475 7265 5f73 6574 7469  emperature_setti
-00018b30: 6e67 732e 6869 6768 5f74 6872 6573 686f  ngs.high_thresho
-00018b40: 6c64 203d 2068 6967 680a 0a20 2020 2020  ld = high..     
-00018b50: 2020 2061 7761 6974 2073 656c 662e 7175     await self.qu
-00018b60: 6575 655f 7570 6461 7465 2863 616c 6c62  eue_update(callb
-00018b70: 6163 6b29 0a0a 2020 2020 6173 796e 6320  ack)..    async 
-00018b80: 6465 6620 7265 6d6f 7665 5f74 656d 7065  def remove_tempe
-00018b90: 7261 7475 7265 5f73 6166 655f 7261 6e67  rature_safe_rang
-00018ba0: 6528 7365 6c66 2920 2d3e 204e 6f6e 653a  e(self) -> None:
-00018bb0: 0a20 2020 2020 2020 2022 2222 5265 6d6f  .        """Remo
-00018bc0: 7665 7320 7468 6520 7465 6d70 6572 6174  ves the temperat
-00018bd0: 7572 6520 7361 6665 2072 616e 6765 2066  ure safe range f
-00018be0: 6f72 2074 6865 2073 656e 736f 7222 2222  or the sensor"""
-00018bf0: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
-00018c00: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
-00018c10: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00018c20: 6c66 2e74 656d 7065 7261 7475 7265 5f73  lf.temperature_s
-00018c30: 6574 7469 6e67 732e 6c6f 775f 7468 7265  ettings.low_thre
-00018c40: 7368 6f6c 6420 3d20 4e6f 6e65 0a20 2020  shold = None.   
-00018c50: 2020 2020 2020 2020 2073 656c 662e 7465           self.te
-00018c60: 6d70 6572 6174 7572 655f 7365 7474 696e  mperature_settin
-00018c70: 6773 2e68 6967 685f 7468 7265 7368 6f6c  gs.high_threshol
-00018c80: 6420 3d20 4e6f 6e65 0a0a 2020 2020 2020  d = None..      
-00018c90: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
-00018ca0: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
-00018cb0: 636b 290a 0a20 2020 2061 7379 6e63 2064  ck)..    async d
-00018cc0: 6566 2073 6574 5f68 756d 6964 6974 795f  ef set_humidity_
-00018cd0: 7374 6174 7573 2873 656c 662c 2065 6e61  status(self, ena
-00018ce0: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
-00018cf0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00018d00: 5365 7473 2074 6865 2068 756d 6964 6974  Sets the humidit
-00018d10: 7920 6465 7465 6374 696f 6e20 7479 7065  y detection type
-00018d20: 2066 6f72 2074 6865 2073 656e 736f 7222   for the sensor"
-00018d30: 2222 0a0a 2020 2020 2020 2020 6465 6620  ""..        def 
-00018d40: 6361 6c6c 6261 636b 2829 202d 3e20 4e6f  callback() -> No
-00018d50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018d60: 7365 6c66 2e68 756d 6964 6974 795f 7365  self.humidity_se
-00018d70: 7474 696e 6773 2e69 735f 656e 6162 6c65  ttings.is_enable
-00018d80: 6420 3d20 656e 6162 6c65 640a 0a20 2020  d = enabled..   
-00018d90: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
-00018da0: 7175 6575 655f 7570 6461 7465 2863 616c  queue_update(cal
-00018db0: 6c62 6163 6b29 0a0a 2020 2020 6173 796e  lback)..    asyn
-00018dc0: 6320 6465 6620 7365 745f 6875 6d69 6469  c def set_humidi
-00018dd0: 7479 5f73 6166 655f 7261 6e67 6528 7365  ty_safe_range(se
-00018de0: 6c66 2c20 6c6f 773a 2066 6c6f 6174 2c20  lf, low: float, 
-00018df0: 6869 6768 3a20 666c 6f61 7429 202d 3e20  high: float) -> 
-00018e00: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-00018e10: 2253 6574 7320 7468 6520 6875 6d69 6469  "Sets the humidi
-00018e20: 7479 2073 6166 6520 7261 6e67 6520 666f  ty safe range fo
-00018e30: 7220 7468 6520 7365 6e73 6f72 2222 220a  r the sensor""".
-00018e40: 0a20 2020 2020 2020 2069 6620 6c6f 7720  .        if low 
-00018e50: 3c20 312e 303a 0a20 2020 2020 2020 2020  < 1.0:.         
-00018e60: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
-00018e70: 6573 7428 224d 696e 696d 756d 2076 616c  est("Minimum val
-00018e80: 7565 2069 7320 3125 2229 0a20 2020 2020  ue is 1%").     
-00018e90: 2020 2069 6620 6869 6768 203e 2039 392e     if high > 99.
-00018ea0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-00018eb0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
-00018ec0: 224d 6178 696d 756d 2076 616c 7565 2069  "Maximum value i
-00018ed0: 7320 3939 2522 290a 2020 2020 2020 2020  s 99%").        
-00018ee0: 6966 2068 6967 6820 3c3d 206c 6f77 3a0a  if high <= low:.
-00018ef0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00018f00: 6520 4261 6452 6571 7565 7374 2822 4869  e BadRequest("Hi
-00018f10: 6768 2076 616c 7565 206d 7573 7420 6265  gh value must be
-00018f20: 2061 626f 7665 206c 6f77 2076 616c 7565   above low value
-00018f30: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
-00018f40: 6361 6c6c 6261 636b 2829 202d 3e20 4e6f  callback() -> No
-00018f50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018f60: 7365 6c66 2e68 756d 6964 6974 795f 7365  self.humidity_se
-00018f70: 7474 696e 6773 2e6c 6f77 5f74 6872 6573  ttings.low_thres
-00018f80: 686f 6c64 203d 206c 6f77 0a20 2020 2020  hold = low.     
-00018f90: 2020 2020 2020 2073 656c 662e 6875 6d69         self.humi
-00018fa0: 6469 7479 5f73 6574 7469 6e67 732e 6869  dity_settings.hi
-00018fb0: 6768 5f74 6872 6573 686f 6c64 203d 2068  gh_threshold = h
-00018fc0: 6967 680a 0a20 2020 2020 2020 2061 7761  igh..        awa
-00018fd0: 6974 2073 656c 662e 7175 6575 655f 7570  it self.queue_up
-00018fe0: 6461 7465 2863 616c 6c62 6163 6b29 0a0a  date(callback)..
-00018ff0: 2020 2020 6173 796e 6320 6465 6620 7265      async def re
-00019000: 6d6f 7665 5f68 756d 6964 6974 795f 7361  move_humidity_sa
-00019010: 6665 5f72 616e 6765 2873 656c 6629 202d  fe_range(self) -
-00019020: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00019030: 2222 2252 656d 6f76 6573 2074 6865 2068  """Removes the h
-00019040: 756d 6964 6974 7920 7361 6665 2072 616e  umidity safe ran
-00019050: 6765 2066 6f72 2074 6865 2073 656e 736f  ge for the senso
-00019060: 7222 2222 0a0a 2020 2020 2020 2020 6465  r"""..        de
-00019070: 6620 6361 6c6c 6261 636b 2829 202d 3e20  f callback() -> 
-00019080: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00019090: 2020 7365 6c66 2e68 756d 6964 6974 795f    self.humidity_
-000190a0: 7365 7474 696e 6773 2e6c 6f77 5f74 6872  settings.low_thr
-000190b0: 6573 686f 6c64 203d 204e 6f6e 650a 2020  eshold = None.  
-000190c0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
-000190d0: 756d 6964 6974 795f 7365 7474 696e 6773  umidity_settings
-000190e0: 2e68 6967 685f 7468 7265 7368 6f6c 6420  .high_threshold 
-000190f0: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
-00019100: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
-00019110: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
-00019120: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
-00019130: 2073 6574 5f6c 6967 6874 5f73 7461 7475   set_light_statu
-00019140: 7328 7365 6c66 2c20 656e 6162 6c65 643a  s(self, enabled:
-00019150: 2062 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a   bool) -> None:.
-00019160: 2020 2020 2020 2020 2222 2253 6574 7320          """Sets 
-00019170: 7468 6520 6c69 6768 7420 6465 7465 6374  the light detect
-00019180: 696f 6e20 7479 7065 2066 6f72 2074 6865  ion type for the
-00019190: 2073 656e 736f 7222 2222 0a0a 2020 2020   sensor"""..    
-000191a0: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
-000191b0: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
-000191c0: 2020 2020 2020 2020 7365 6c66 2e6c 6967          self.lig
-000191d0: 6874 5f73 6574 7469 6e67 732e 6973 5f65  ht_settings.is_e
-000191e0: 6e61 626c 6564 203d 2065 6e61 626c 6564  nabled = enabled
-000191f0: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
-00019200: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
-00019210: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
-00019220: 2061 7379 6e63 2064 6566 2073 6574 5f6c   async def set_l
-00019230: 6967 6874 5f73 6166 655f 7261 6e67 6528  ight_safe_range(
-00019240: 7365 6c66 2c20 6c6f 773a 2066 6c6f 6174  self, low: float
-00019250: 2c20 6869 6768 3a20 666c 6f61 7429 202d  , high: float) -
+000027b0: 2020 2069 735f 6c6f 676f 5f65 6e61 626c     is_logo_enabl
+000027c0: 6564 3a20 626f 6f6c 0a20 2020 2069 735f  ed: bool.    is_
+000027d0: 6465 6275 675f 656e 6162 6c65 643a 2062  debug_enabled: b
+000027e0: 6f6f 6c0a 0a0a 636c 6173 7320 4c45 4453  ool...class LEDS
+000027f0: 6574 7469 6e67 7328 5072 6f74 6563 7442  ettings(ProtectB
+00002800: 6173 654f 626a 6563 7429 3a0a 2020 2020  aseObject):.    
+00002810: 2320 5374 6174 7573 204c 6967 6874 0a20  # Status Light. 
+00002820: 2020 2069 735f 656e 6162 6c65 643a 2062     is_enabled: b
+00002830: 6f6f 6c0a 2020 2020 626c 696e 6b5f 7261  ool.    blink_ra
+00002840: 7465 3a20 696e 7420 2023 2069 6e20 6d69  te: int  # in mi
+00002850: 6c6c 6973 6563 6f6e 6473 2062 6574 7765  lliseconds betwe
+00002860: 6565 6e20 626c 696e 6b73 2c20 3020 3d20  een blinks, 0 = 
+00002870: 736f 6c69 640a 0a0a 636c 6173 7320 5370  solid...class Sp
+00002880: 6561 6b65 7253 6574 7469 6e67 7328 5072  eakerSettings(Pr
+00002890: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
+000028a0: 3a0a 2020 2020 6973 5f65 6e61 626c 6564  :.    is_enabled
+000028b0: 3a20 626f 6f6c 0a20 2020 2023 2053 7461  : bool.    # Sta
+000028c0: 7475 7320 536f 756e 6473 0a20 2020 2061  tus Sounds.    a
+000028d0: 7265 5f73 7973 7465 6d5f 736f 756e 6473  re_system_sounds
+000028e0: 5f65 6e61 626c 6564 3a20 626f 6f6c 0a20  _enabled: bool. 
+000028f0: 2020 2076 6f6c 756d 653a 2050 6572 6365     volume: Perce
+00002900: 6e74 496e 740a 0a0a 636c 6173 7320 5265  ntInt...class Re
+00002910: 636f 7264 696e 6753 6574 7469 6e67 7328  cordingSettings(
+00002920: 5072 6f74 6563 7442 6173 654f 626a 6563  ProtectBaseObjec
+00002930: 7429 3a0a 2020 2020 2320 5365 636f 6e64  t):.    # Second
+00002940: 7320 746f 2072 6563 6f72 6420 6265 666f  s to record befo
+00002950: 7265 204d 6f74 696f 6e0a 2020 2020 7072  re Motion.    pr
+00002960: 655f 7061 6464 696e 673a 2074 696d 6564  e_padding: timed
+00002970: 656c 7461 0a20 2020 2023 2053 6563 6f6e  elta.    # Secon
+00002980: 6473 2074 6f20 7265 636f 7264 2061 6674  ds to record aft
+00002990: 6572 204d 6f74 696f 6e0a 2020 2020 706f  er Motion.    po
+000029a0: 7374 5f70 6164 6469 6e67 3a20 7469 6d65  st_padding: time
+000029b0: 6465 6c74 610a 2020 2020 2320 5365 636f  delta.    # Seco
+000029c0: 6e64 7320 6f66 204d 6f74 696f 6e20 4e65  nds of Motion Ne
+000029d0: 6564 6564 0a20 2020 206d 696e 5f6d 6f74  eded.    min_mot
+000029e0: 696f 6e5f 6576 656e 745f 7472 6967 6765  ion_event_trigge
+000029f0: 723a 2074 696d 6564 656c 7461 0a20 2020  r: timedelta.   
+00002a00: 2065 6e64 5f6d 6f74 696f 6e5f 6576 656e   end_motion_even
+00002a10: 745f 6465 6c61 793a 2074 696d 6564 656c  t_delay: timedel
+00002a20: 7461 0a20 2020 2073 7570 7072 6573 735f  ta.    suppress_
+00002a30: 696c 6c75 6d69 6e61 7469 6f6e 5f73 7572  illumination_sur
+00002a40: 6765 3a20 626f 6f6c 0a20 2020 2023 2048  ge: bool.    # H
+00002a50: 6967 6820 4672 616d 6520 5261 7465 204d  igh Frame Rate M
+00002a60: 6f64 650a 2020 2020 6d6f 6465 3a20 5265  ode.    mode: Re
+00002a70: 636f 7264 696e 674d 6f64 650a 2020 2020  cordingMode.    
+00002a80: 6765 6f66 656e 6369 6e67 3a20 4765 6f66  geofencing: Geof
+00002a90: 656e 6369 6e67 5365 7474 696e 670a 2020  encingSetting.  
+00002aa0: 2020 6d6f 7469 6f6e 5f61 6c67 6f72 6974    motion_algorit
+00002ab0: 686d 3a20 4d6f 7469 6f6e 416c 676f 7269  hm: MotionAlgori
+00002ac0: 7468 6d0a 2020 2020 656e 6162 6c65 5f6d  thm.    enable_m
+00002ad0: 6f74 696f 6e5f 6465 7465 6374 696f 6e3a  otion_detection:
+00002ae0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00002af0: 3d20 4e6f 6e65 0a20 2020 2075 7365 5f6e  = None.    use_n
+00002b00: 6577 5f6d 6f74 696f 6e5f 616c 676f 7269  ew_motion_algori
+00002b10: 7468 6d3a 2062 6f6f 6c0a 2020 2020 2320  thm: bool.    # 
+00002b20: 7265 7175 6972 6573 2032 2e39 2e32 302b  requires 2.9.20+
+00002b30: 0a20 2020 2069 6e5f 7363 6865 6475 6c65  .    in_schedule
+00002b40: 5f6d 6f64 653a 204f 7074 696f 6e61 6c5b  _mode: Optional[
+00002b50: 7374 725d 203d 204e 6f6e 650a 2020 2020  str] = None.    
+00002b60: 6f75 745f 7363 6865 6475 6c65 5f6d 6f64  out_schedule_mod
+00002b70: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
+00002b80: 203d 204e 6f6e 650a 2020 2020 2320 322e   = None.    # 2.
+00002b90: 3131 2e31 332b 0a20 2020 2072 6574 656e  11.13+.    reten
+00002ba0: 7469 6f6e 5f64 7572 6174 696f 6e3a 204f  tion_duration: O
+00002bb0: 7074 696f 6e61 6c5b 6461 7465 7469 6d65  ptional[datetime
+00002bc0: 5d20 3d20 4e6f 6e65 0a20 2020 2073 6d61  ] = None.    sma
+00002bd0: 7274 5f64 6574 6563 745f 706f 7374 5f70  rt_detect_post_p
+00002be0: 6164 6469 6e67 3a20 4f70 7469 6f6e 616c  adding: Optional
+00002bf0: 5b74 696d 6564 656c 7461 5d20 3d20 4e6f  [timedelta] = No
+00002c00: 6e65 0a20 2020 2073 6d61 7274 5f64 6574  ne.    smart_det
+00002c10: 6563 745f 7072 655f 7061 6464 696e 673a  ect_pre_padding:
+00002c20: 204f 7074 696f 6e61 6c5b 7469 6d65 6465   Optional[timede
+00002c30: 6c74 615d 203d 204e 6f6e 650a 0a20 2020  lta] = None..   
+00002c40: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+00002c50: 2020 4063 6163 6865 0a20 2020 2064 6566    @cache.    def
+00002c60: 205f 6765 745f 756e 6966 695f 7265 6d61   _get_unifi_rema
+00002c70: 7073 2863 6c73 2920 2d3e 2064 6963 745b  ps(cls) -> dict[
+00002c80: 7374 722c 2073 7472 5d3a 0a20 2020 2020  str, str]:.     
+00002c90: 2020 2072 6574 7572 6e20 7b0a 2020 2020     return {.    
+00002ca0: 2020 2020 2020 2020 2a2a 7375 7065 7228          **super(
+00002cb0: 292e 5f67 6574 5f75 6e69 6669 5f72 656d  )._get_unifi_rem
+00002cc0: 6170 7328 292c 0a20 2020 2020 2020 2020  aps(),.         
+00002cd0: 2020 2022 7265 7465 6e74 696f 6e44 7572     "retentionDur
+00002ce0: 6174 696f 6e4d 7322 3a20 2272 6574 656e  ationMs": "reten
+00002cf0: 7469 6f6e 4475 7261 7469 6f6e 222c 0a20  tionDuration",. 
+00002d00: 2020 2020 2020 207d 0a0a 2020 2020 4063         }..    @c
+00002d10: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00002d20: 6566 2075 6e69 6669 5f64 6963 745f 746f  ef unifi_dict_to
+00002d30: 5f64 6963 7428 636c 732c 2064 6174 613a  _dict(cls, data:
+00002d40: 2064 6963 745b 7374 722c 2041 6e79 5d29   dict[str, Any])
+00002d50: 202d 3e20 6469 6374 5b73 7472 2c20 416e   -> dict[str, An
+00002d60: 795d 3a0a 2020 2020 2020 2020 6966 2022  y]:.        if "
+00002d70: 7072 6550 6164 6469 6e67 5365 6373 2220  prePaddingSecs" 
+00002d80: 696e 2064 6174 613a 0a20 2020 2020 2020  in data:.       
+00002d90: 2020 2020 2064 6174 615b 2270 7265 5061       data["prePa
+00002da0: 6464 696e 6722 5d20 3d20 7469 6d65 6465  dding"] = timede
+00002db0: 6c74 6128 7365 636f 6e64 733d 6461 7461  lta(seconds=data
+00002dc0: 2e70 6f70 2822 7072 6550 6164 6469 6e67  .pop("prePadding
+00002dd0: 5365 6373 2229 290a 2020 2020 2020 2020  Secs")).        
+00002de0: 6966 2022 706f 7374 5061 6464 696e 6753  if "postPaddingS
+00002df0: 6563 7322 2069 6e20 6461 7461 3a0a 2020  ecs" in data:.  
+00002e00: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+00002e10: 706f 7374 5061 6464 696e 6722 5d20 3d20  postPadding"] = 
+00002e20: 7469 6d65 6465 6c74 6128 7365 636f 6e64  timedelta(second
+00002e30: 733d 6461 7461 2e70 6f70 2822 706f 7374  s=data.pop("post
+00002e40: 5061 6464 696e 6753 6563 7322 2929 0a20  PaddingSecs")). 
+00002e50: 2020 2020 2020 2069 6620 2273 6d61 7274         if "smart
+00002e60: 4465 7465 6374 5072 6550 6164 6469 6e67  DetectPrePadding
+00002e70: 5365 6373 2220 696e 2064 6174 613a 0a20  Secs" in data:. 
+00002e80: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+00002e90: 2273 6d61 7274 4465 7465 6374 5072 6550  "smartDetectPreP
+00002ea0: 6164 6469 6e67 225d 203d 2074 696d 6564  adding"] = timed
+00002eb0: 656c 7461 280a 2020 2020 2020 2020 2020  elta(.          
+00002ec0: 2020 2020 2020 7365 636f 6e64 733d 6461        seconds=da
+00002ed0: 7461 2e70 6f70 2822 736d 6172 7444 6574  ta.pop("smartDet
+00002ee0: 6563 7450 7265 5061 6464 696e 6753 6563  ectPrePaddingSec
+00002ef0: 7322 292c 0a20 2020 2020 2020 2020 2020  s"),.           
+00002f00: 2029 0a20 2020 2020 2020 2069 6620 2273   ).        if "s
+00002f10: 6d61 7274 4465 7465 6374 506f 7374 5061  martDetectPostPa
+00002f20: 6464 696e 6753 6563 7322 2069 6e20 6461  ddingSecs" in da
+00002f30: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
+00002f40: 6461 7461 5b22 736d 6172 7444 6574 6563  data["smartDetec
+00002f50: 7450 6f73 7450 6164 6469 6e67 225d 203d  tPostPadding"] =
+00002f60: 2074 696d 6564 656c 7461 280a 2020 2020   timedelta(.    
+00002f70: 2020 2020 2020 2020 2020 2020 7365 636f              seco
+00002f80: 6e64 733d 6461 7461 2e70 6f70 2822 736d  nds=data.pop("sm
+00002f90: 6172 7444 6574 6563 7450 6f73 7450 6164  artDetectPostPad
+00002fa0: 6469 6e67 5365 6373 2229 2c0a 2020 2020  dingSecs"),.    
+00002fb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00002fc0: 2020 6966 2022 6d69 6e4d 6f74 696f 6e45    if "minMotionE
+00002fd0: 7665 6e74 5472 6967 6765 7222 2069 6e20  ventTrigger" in 
+00002fe0: 6461 7461 2061 6e64 206e 6f74 2069 7369  data and not isi
+00002ff0: 6e73 7461 6e63 6528 0a20 2020 2020 2020  nstance(.       
+00003000: 2020 2020 2064 6174 615b 226d 696e 4d6f       data["minMo
+00003010: 7469 6f6e 4576 656e 7454 7269 6767 6572  tionEventTrigger
+00003020: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+00003030: 7469 6d65 6465 6c74 612c 0a20 2020 2020  timedelta,.     
+00003040: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00003050: 2020 6461 7461 5b22 6d69 6e4d 6f74 696f    data["minMotio
+00003060: 6e45 7665 6e74 5472 6967 6765 7222 5d20  nEventTrigger"] 
+00003070: 3d20 7469 6d65 6465 6c74 6128 0a20 2020  = timedelta(.   
+00003080: 2020 2020 2020 2020 2020 2020 2073 6563               sec
+00003090: 6f6e 6473 3d64 6174 615b 226d 696e 4d6f  onds=data["minMo
+000030a0: 7469 6f6e 4576 656e 7454 7269 6767 6572  tionEventTrigger
+000030b0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+000030c0: 290a 2020 2020 2020 2020 6966 2022 656e  ).        if "en
+000030d0: 644d 6f74 696f 6e45 7665 6e74 4465 6c61  dMotionEventDela
+000030e0: 7922 2069 6e20 6461 7461 2061 6e64 206e  y" in data and n
+000030f0: 6f74 2069 7369 6e73 7461 6e63 6528 0a20  ot isinstance(. 
+00003100: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+00003110: 2265 6e64 4d6f 7469 6f6e 4576 656e 7444  "endMotionEventD
+00003120: 656c 6179 225d 2c0a 2020 2020 2020 2020  elay"],.        
+00003130: 2020 2020 7469 6d65 6465 6c74 612c 0a20      timedelta,. 
+00003140: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00003150: 2020 2020 2020 6461 7461 5b22 656e 644d        data["endM
+00003160: 6f74 696f 6e45 7665 6e74 4465 6c61 7922  otionEventDelay"
+00003170: 5d20 3d20 7469 6d65 6465 6c74 6128 7365  ] = timedelta(se
+00003180: 636f 6e64 733d 6461 7461 5b22 656e 644d  conds=data["endM
+00003190: 6f74 696f 6e45 7665 6e74 4465 6c61 7922  otionEventDelay"
+000031a0: 5d29 0a0a 2020 2020 2020 2020 7265 7475  ])..        retu
+000031b0: 726e 2073 7570 6572 2829 2e75 6e69 6669  rn super().unifi
+000031c0: 5f64 6963 745f 746f 5f64 6963 7428 6461  _dict_to_dict(da
+000031d0: 7461 290a 0a20 2020 2064 6566 2075 6e69  ta)..    def uni
+000031e0: 6669 5f64 6963 7428 0a20 2020 2020 2020  fi_dict(.       
+000031f0: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+00003200: 6174 613a 204f 7074 696f 6e61 6c5b 6469  ata: Optional[di
+00003210: 6374 5b73 7472 2c20 416e 795d 5d20 3d20  ct[str, Any]] = 
+00003220: 4e6f 6e65 2c0a 2020 2020 2020 2020 6578  None,.        ex
+00003230: 636c 7564 653a 204f 7074 696f 6e61 6c5b  clude: Optional[
+00003240: 7365 745b 7374 725d 5d20 3d20 4e6f 6e65  set[str]] = None
+00003250: 2c0a 2020 2020 2920 2d3e 2064 6963 745b  ,.    ) -> dict[
+00003260: 7374 722c 2041 6e79 5d3a 0a20 2020 2020  str, Any]:.     
+00003270: 2020 2064 6174 6120 3d20 7375 7065 7228     data = super(
+00003280: 292e 756e 6966 695f 6469 6374 2864 6174  ).unifi_dict(dat
+00003290: 613d 6461 7461 2c20 6578 636c 7564 653d  a=data, exclude=
+000032a0: 6578 636c 7564 6529 0a0a 2020 2020 2020  exclude)..      
+000032b0: 2020 6966 2022 7072 6550 6164 6469 6e67    if "prePadding
+000032c0: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
+000032d0: 2020 2020 2020 2064 6174 615b 2270 7265         data["pre
+000032e0: 5061 6464 696e 6753 6563 7322 5d20 3d20  PaddingSecs"] = 
+000032f0: 6461 7461 2e70 6f70 2822 7072 6550 6164  data.pop("prePad
+00003300: 6469 6e67 2229 202f 2f20 3130 3030 0a20  ding") // 1000. 
+00003310: 2020 2020 2020 2069 6620 2270 6f73 7450         if "postP
+00003320: 6164 6469 6e67 2220 696e 2064 6174 613a  adding" in data:
+00003330: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00003340: 615b 2270 6f73 7450 6164 6469 6e67 5365  a["postPaddingSe
+00003350: 6373 225d 203d 2064 6174 612e 706f 7028  cs"] = data.pop(
+00003360: 2270 6f73 7450 6164 6469 6e67 2229 202f  "postPadding") /
+00003370: 2f20 3130 3030 0a20 2020 2020 2020 2069  / 1000.        i
+00003380: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+00003390: 2273 6d61 7274 4465 7465 6374 5072 6550  "smartDetectPreP
+000033a0: 6164 6469 6e67 2220 696e 2064 6174 610a  adding" in data.
+000033b0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000033c0: 6461 7461 5b22 736d 6172 7444 6574 6563  data["smartDetec
+000033d0: 7450 7265 5061 6464 696e 6722 5d20 6973  tPrePadding"] is
+000033e0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+000033f0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00003400: 2064 6174 615b 2273 6d61 7274 4465 7465   data["smartDete
+00003410: 6374 5072 6550 6164 6469 6e67 5365 6373  ctPrePaddingSecs
+00003420: 225d 203d 2028 0a20 2020 2020 2020 2020  "] = (.         
+00003430: 2020 2020 2020 2064 6174 612e 706f 7028         data.pop(
+00003440: 2273 6d61 7274 4465 7465 6374 5072 6550  "smartDetectPreP
+00003450: 6164 6469 6e67 2229 202f 2f20 3130 3030  adding") // 1000
+00003460: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00003470: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
+00003480: 2020 2020 2020 2020 2273 6d61 7274 4465          "smartDe
+00003490: 7465 6374 506f 7374 5061 6464 696e 6722  tectPostPadding"
+000034a0: 2069 6e20 6461 7461 0a20 2020 2020 2020   in data.       
+000034b0: 2020 2020 2061 6e64 2064 6174 615b 2273       and data["s
+000034c0: 6d61 7274 4465 7465 6374 506f 7374 5061  martDetectPostPa
+000034d0: 6464 696e 6722 5d20 6973 206e 6f74 204e  dding"] is not N
+000034e0: 6f6e 650a 2020 2020 2020 2020 293a 0a20  one.        ):. 
+000034f0: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+00003500: 2273 6d61 7274 4465 7465 6374 506f 7374  "smartDetectPost
+00003510: 5061 6464 696e 6753 6563 7322 5d20 3d20  PaddingSecs"] = 
+00003520: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00003530: 2020 6461 7461 2e70 6f70 2822 736d 6172    data.pop("smar
+00003540: 7444 6574 6563 7450 6f73 7450 6164 6469  tDetectPostPaddi
+00003550: 6e67 2229 202f 2f20 3130 3030 0a20 2020  ng") // 1000.   
+00003560: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00003570: 2020 2069 6620 226d 696e 4d6f 7469 6f6e     if "minMotion
+00003580: 4576 656e 7454 7269 6767 6572 2220 696e  EventTrigger" in
+00003590: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
+000035a0: 2020 2064 6174 615b 226d 696e 4d6f 7469     data["minMoti
+000035b0: 6f6e 4576 656e 7454 7269 6767 6572 225d  onEventTrigger"]
+000035c0: 203d 2064 6174 612e 706f 7028 226d 696e   = data.pop("min
+000035d0: 4d6f 7469 6f6e 4576 656e 7454 7269 6767  MotionEventTrigg
+000035e0: 6572 2229 202f 2f20 3130 3030 0a20 2020  er") // 1000.   
+000035f0: 2020 2020 2069 6620 2265 6e64 4d6f 7469       if "endMoti
+00003600: 6f6e 4576 656e 7444 656c 6179 2220 696e  onEventDelay" in
+00003610: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
+00003620: 2020 2064 6174 615b 2265 6e64 4d6f 7469     data["endMoti
+00003630: 6f6e 4576 656e 7444 656c 6179 225d 203d  onEventDelay"] =
+00003640: 2064 6174 612e 706f 7028 2265 6e64 4d6f   data.pop("endMo
+00003650: 7469 6f6e 4576 656e 7444 656c 6179 2229  tionEventDelay")
+00003660: 202f 2f20 3130 3030 0a0a 2020 2020 2020   // 1000..      
+00003670: 2020 7265 7475 726e 2064 6174 610a 0a0a    return data...
+00003680: 636c 6173 7320 4465 7465 6374 696f 6e52  class DetectionR
+00003690: 616e 6765 2850 726f 7465 6374 4261 7365  ange(ProtectBase
+000036a0: 4f62 6a65 6374 293a 0a20 2020 206d 6178  Object):.    max
+000036b0: 3a20 4f70 7469 6f6e 616c 5b41 6e79 5d0a  : Optional[Any].
+000036c0: 2020 2020 6d69 6e3a 204f 7074 696f 6e61      min: Optiona
+000036d0: 6c5b 416e 795d 0a0a 0a63 6c61 7373 2053  l[Any]...class S
+000036e0: 6d61 7274 4465 7465 6374 5365 7474 696e  martDetectSettin
+000036f0: 6773 2850 726f 7465 6374 4261 7365 4f62  gs(ProtectBaseOb
+00003700: 6a65 6374 293a 0a20 2020 206f 626a 6563  ject):.    objec
+00003710: 745f 7479 7065 733a 206c 6973 745b 536d  t_types: list[Sm
+00003720: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
+00003730: 7970 655d 0a20 2020 2061 7564 696f 5f74  ype].    audio_t
+00003740: 7970 6573 3a20 4f70 7469 6f6e 616c 5b6c  ypes: Optional[l
+00003750: 6973 745b 536d 6172 7444 6574 6563 7441  ist[SmartDetectA
+00003760: 7564 696f 5479 7065 5d5d 203d 204e 6f6e  udioType]] = Non
+00003770: 650a 2020 2020 2320 7265 7175 6972 6573  e.    # requires
+00003780: 2032 2e38 2e32 322b 0a20 2020 2061 7574   2.8.22+.    aut
+00003790: 6f5f 7472 6163 6b69 6e67 5f6f 626a 6563  o_tracking_objec
+000037a0: 745f 7479 7065 733a 204f 7074 696f 6e61  t_types: Optiona
+000037b0: 6c5b 6c69 7374 5b53 6d61 7274 4465 7465  l[list[SmartDete
+000037c0: 6374 4f62 6a65 6374 5479 7065 5d5d 203d  ctObjectType]] =
+000037d0: 204e 6f6e 650a 2020 2020 2320 7265 7175   None.    # requ
+000037e0: 6972 6573 2034 2e30 2e37 2b0a 2020 2020  ires 4.0.7+.    
+000037f0: 6465 7465 6374 696f 6e5f 7261 6e67 653a  detection_range:
+00003800: 204f 7074 696f 6e61 6c5b 4465 7465 6374   Optional[Detect
+00003810: 696f 6e52 616e 6765 5d20 3d20 4e6f 6e65  ionRange] = None
+00003820: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00003830: 6f64 0a20 2020 2064 6566 2075 6e69 6669  od.    def unifi
+00003840: 5f64 6963 745f 746f 5f64 6963 7428 636c  _dict_to_dict(cl
+00003850: 732c 2064 6174 613a 2064 6963 745b 7374  s, data: dict[st
+00003860: 722c 2041 6e79 5d29 202d 3e20 6469 6374  r, Any]) -> dict
+00003870: 5b73 7472 2c20 416e 795d 3a0a 2020 2020  [str, Any]:.    
+00003880: 2020 2020 6966 2022 6f62 6a65 6374 5479      if "objectTy
+00003890: 7065 7322 2069 6e20 6461 7461 3a0a 2020  pes" in data:.  
+000038a0: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+000038b0: 6f62 6a65 6374 5479 7065 7322 5d20 3d20  objectTypes"] = 
+000038c0: 636f 6e76 6572 745f 736d 6172 745f 7479  convert_smart_ty
+000038d0: 7065 7328 6461 7461 2e70 6f70 2822 6f62  pes(data.pop("ob
+000038e0: 6a65 6374 5479 7065 7322 2929 0a20 2020  jectTypes")).   
+000038f0: 2020 2020 2069 6620 2261 7564 696f 5479       if "audioTy
+00003900: 7065 7322 2069 6e20 6461 7461 3a0a 2020  pes" in data:.  
+00003910: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+00003920: 6175 6469 6f54 7970 6573 225d 203d 2063  audioTypes"] = c
+00003930: 6f6e 7665 7274 5f73 6d61 7274 5f61 7564  onvert_smart_aud
+00003940: 696f 5f74 7970 6573 2864 6174 612e 706f  io_types(data.po
+00003950: 7028 2261 7564 696f 5479 7065 7322 2929  p("audioTypes"))
+00003960: 0a20 2020 2020 2020 2069 6620 2261 7574  .        if "aut
+00003970: 6f54 7261 636b 696e 674f 626a 6563 7454  oTrackingObjectT
+00003980: 7970 6573 2220 696e 2064 6174 613a 0a20  ypes" in data:. 
+00003990: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+000039a0: 2261 7574 6f54 7261 636b 696e 674f 626a  "autoTrackingObj
+000039b0: 6563 7454 7970 6573 225d 203d 2063 6f6e  ectTypes"] = con
+000039c0: 7665 7274 5f73 6d61 7274 5f74 7970 6573  vert_smart_types
+000039d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000039e0: 2020 6461 7461 2e70 6f70 2822 6175 746f    data.pop("auto
+000039f0: 5472 6163 6b69 6e67 4f62 6a65 6374 5479  TrackingObjectTy
+00003a00: 7065 7322 292c 0a20 2020 2020 2020 2020  pes"),.         
+00003a10: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
+00003a20: 7475 726e 2073 7570 6572 2829 2e75 6e69  turn super().uni
+00003a30: 6669 5f64 6963 745f 746f 5f64 6963 7428  fi_dict_to_dict(
+00003a40: 6461 7461 290a 0a0a 636c 6173 7320 4c43  data)...class LC
+00003a50: 444d 6573 7361 6765 2850 726f 7465 6374  DMessage(Protect
+00003a60: 4261 7365 4f62 6a65 6374 293a 0a20 2020  BaseObject):.   
+00003a70: 2074 7970 653a 2044 6f6f 7262 656c 6c4d   type: DoorbellM
+00003a80: 6573 7361 6765 5479 7065 0a20 2020 2074  essageType.    t
+00003a90: 6578 743a 2073 7472 0a20 2020 2072 6573  ext: str.    res
+00003aa0: 6574 5f61 743a 204f 7074 696f 6e61 6c5b  et_at: Optional[
+00003ab0: 6461 7465 7469 6d65 5d20 3d20 4e6f 6e65  datetime] = None
+00003ac0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00003ad0: 6f64 0a20 2020 2064 6566 2075 6e69 6669  od.    def unifi
+00003ae0: 5f64 6963 745f 746f 5f64 6963 7428 636c  _dict_to_dict(cl
+00003af0: 732c 2064 6174 613a 2064 6963 745b 7374  s, data: dict[st
+00003b00: 722c 2041 6e79 5d29 202d 3e20 6469 6374  r, Any]) -> dict
+00003b10: 5b73 7472 2c20 416e 795d 3a0a 2020 2020  [str, Any]:.    
+00003b20: 2020 2020 6966 2022 7265 7365 7441 7422      if "resetAt"
+00003b30: 2069 6e20 6461 7461 3a0a 2020 2020 2020   in data:.      
+00003b40: 2020 2020 2020 6461 7461 5b22 7265 7365        data["rese
+00003b50: 7441 7422 5d20 3d20 7072 6f63 6573 735f  tAt"] = process_
+00003b60: 6461 7465 7469 6d65 2864 6174 612c 2022  datetime(data, "
+00003b70: 7265 7365 7441 7422 290a 2020 2020 2020  resetAt").      
+00003b80: 2020 6966 2022 7465 7874 2220 696e 2064    if "text" in d
+00003b90: 6174 613a 0a20 2020 2020 2020 2020 2020  ata:.           
+00003ba0: 2023 2055 6e69 4669 2050 726f 7465 6374   # UniFi Protect
+00003bb0: 2062 7567 3a20 736f 6d65 2074 696d 6573   bug: some times
+00003bc0: 204c 4344 206d 6573 7361 6765 7320 6361   LCD messages ca
+00003bd0: 6e20 6765 7420 696e 746f 2061 2062 6164  n get into a bad
+00003be0: 2073 7461 7465 2077 6865 7265 206d 6573   state where mes
+00003bf0: 7361 6765 203d 2044 4546 4155 4c54 204d  sage = DEFAULT M
+00003c00: 4553 5341 4745 2c20 6275 7420 6e6f 2074  ESSAGE, but no t
+00003c10: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+00003c20: 6966 2022 7479 7065 2220 6e6f 7420 696e  if "type" not in
+00003c30: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
+00003c40: 2020 2020 2020 2064 6174 615b 2274 7970         data["typ
+00003c50: 6522 5d20 3d20 446f 6f72 6265 6c6c 4d65  e"] = DoorbellMe
+00003c60: 7373 6167 6554 7970 652e 4355 5354 4f4d  ssageType.CUSTOM
+00003c70: 5f4d 4553 5341 4745 2e76 616c 7565 0a0a  _MESSAGE.value..
+00003c80: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00003c90: 5b22 7465 7874 225d 203d 2063 6c73 2e5f  ["text"] = cls._
+00003ca0: 6669 785f 7465 7874 2864 6174 615b 2274  fix_text(data["t
+00003cb0: 6578 7422 5d2c 2064 6174 615b 2274 7970  ext"], data["typ
+00003cc0: 6522 5d29 0a0a 2020 2020 2020 2020 7265  e"])..        re
+00003cd0: 7475 726e 2073 7570 6572 2829 2e75 6e69  turn super().uni
+00003ce0: 6669 5f64 6963 745f 746f 5f64 6963 7428  fi_dict_to_dict(
+00003cf0: 6461 7461 290a 0a20 2020 2040 636c 6173  data)..    @clas
+00003d00: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
+00003d10: 5f66 6978 5f74 6578 7428 636c 732c 2074  _fix_text(cls, t
+00003d20: 6578 743a 2073 7472 2c20 7465 7874 5f74  ext: str, text_t
+00003d30: 7970 653a 204f 7074 696f 6e61 6c5b 7374  ype: Optional[st
+00003d40: 725d 2920 2d3e 2073 7472 3a0a 2020 2020  r]) -> str:.    
+00003d50: 2020 2020 6966 2074 6578 745f 7479 7065      if text_type
+00003d60: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00003d70: 2020 2020 2020 7465 7874 5f74 7970 6520        text_type 
+00003d80: 3d20 636c 732e 7479 7065 2e76 616c 7565  = cls.type.value
+00003d90: 0a0a 2020 2020 2020 2020 6966 2074 6578  ..        if tex
+00003da0: 745f 7479 7065 2021 3d20 446f 6f72 6265  t_type != Doorbe
+00003db0: 6c6c 4d65 7373 6167 6554 7970 652e 4355  llMessageType.CU
+00003dc0: 5354 4f4d 5f4d 4553 5341 4745 2e76 616c  STOM_MESSAGE.val
+00003dd0: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
+00003de0: 7465 7874 203d 2074 6578 745f 7479 7065  text = text_type
+00003df0: 2e72 6570 6c61 6365 2822 5f22 2c20 2220  .replace("_", " 
+00003e00: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
+00003e10: 726e 2074 6578 740a 0a20 2020 2064 6566  rn text..    def
+00003e20: 2075 6e69 6669 5f64 6963 7428 0a20 2020   unifi_dict(.   
+00003e30: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00003e40: 2020 2064 6174 613a 204f 7074 696f 6e61     data: Optiona
+00003e50: 6c5b 6469 6374 5b73 7472 2c20 416e 795d  l[dict[str, Any]
+00003e60: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00003e70: 2020 6578 636c 7564 653a 204f 7074 696f    exclude: Optio
+00003e80: 6e61 6c5b 7365 745b 7374 725d 5d20 3d20  nal[set[str]] = 
+00003e90: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2064  None,.    ) -> d
+00003ea0: 6963 745b 7374 722c 2041 6e79 5d3a 0a20  ict[str, Any]:. 
+00003eb0: 2020 2020 2020 2064 6174 6120 3d20 7375         data = su
+00003ec0: 7065 7228 292e 756e 6966 695f 6469 6374  per().unifi_dict
+00003ed0: 2864 6174 613d 6461 7461 2c20 6578 636c  (data=data, excl
+00003ee0: 7564 653d 6578 636c 7564 6529 0a0a 2020  ude=exclude)..  
+00003ef0: 2020 2020 2020 6966 2022 7465 7874 2220        if "text" 
+00003f00: 696e 2064 6174 613a 0a20 2020 2020 2020  in data:.       
+00003f10: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00003f20: 2020 2020 2020 2020 2020 6d73 675f 7479            msg_ty
+00003f30: 7065 203d 2073 656c 662e 7479 7065 2e76  pe = self.type.v
+00003f40: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+00003f50: 2065 7863 6570 7420 4174 7472 6962 7574   except Attribut
+00003f60: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+00003f70: 2020 2020 2020 2020 6d73 675f 7479 7065          msg_type
+00003f80: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+00003f90: 2020 2020 2064 6174 615b 2274 6578 7422       data["text"
+00003fa0: 5d20 3d20 7365 6c66 2e5f 6669 785f 7465  ] = self._fix_te
+00003fb0: 7874 2864 6174 615b 2274 6578 7422 5d2c  xt(data["text"],
+00003fc0: 2064 6174 612e 6765 7428 2274 7970 6522   data.get("type"
+00003fd0: 2c20 6d73 675f 7479 7065 2929 0a20 2020  , msg_type)).   
+00003fe0: 2020 2020 2069 6620 2272 6573 6574 4174       if "resetAt
+00003ff0: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
+00004000: 2020 2020 2020 2064 6174 615b 2272 6573         data["res
+00004010: 6574 4174 225d 203d 2074 6f5f 6a73 5f74  etAt"] = to_js_t
+00004020: 696d 6528 6461 7461 5b22 7265 7365 7441  ime(data["resetA
+00004030: 7422 5d29 0a0a 2020 2020 2020 2020 7265  t"])..        re
+00004040: 7475 726e 2064 6174 610a 0a0a 636c 6173  turn data...clas
+00004050: 7320 5461 6c6b 6261 636b 5365 7474 696e  s TalkbackSettin
+00004060: 6773 2850 726f 7465 6374 4261 7365 4f62  gs(ProtectBaseOb
+00004070: 6a65 6374 293a 0a20 2020 2074 7970 655f  ject):.    type_
+00004080: 666d 743a 2041 7564 696f 436f 6465 6373  fmt: AudioCodecs
+00004090: 0a20 2020 2074 7970 655f 696e 3a20 7374  .    type_in: st
+000040a0: 720a 2020 2020 6269 6e64 5f61 6464 723a  r.    bind_addr:
+000040b0: 2049 5076 3441 6464 7265 7373 0a20 2020   IPv4Address.   
+000040c0: 2062 696e 645f 706f 7274 3a20 696e 740a   bind_port: int.
+000040d0: 2020 2020 6669 6c74 6572 5f61 6464 723a      filter_addr:
+000040e0: 204f 7074 696f 6e61 6c5b 7374 725d 2020   Optional[str]  
+000040f0: 2320 6361 6e20 6265 2075 7365 6420 746f  # can be used to
+00004100: 2072 6573 7472 6963 7420 7365 6e64 6572   restrict sender
+00004110: 2061 6464 7265 7373 0a20 2020 2066 696c   address.    fil
+00004120: 7465 725f 706f 7274 3a20 4f70 7469 6f6e  ter_port: Option
+00004130: 616c 5b69 6e74 5d20 2023 2063 616e 2062  al[int]  # can b
+00004140: 6520 7573 6564 2074 6f20 7265 7374 7269  e used to restri
+00004150: 6374 2073 656e 6465 7220 706f 7274 0a20  ct sender port. 
+00004160: 2020 2063 6861 6e6e 656c 733a 2069 6e74     channels: int
+00004170: 2020 2320 3120 6f72 2032 0a20 2020 2073    # 1 or 2.    s
+00004180: 616d 706c 696e 675f 7261 7465 3a20 696e  ampling_rate: in
+00004190: 7420 2023 2038 3030 302c 2031 3130 3235  t  # 8000, 11025
+000041a0: 2c20 3232 3035 302c 2034 3431 3030 2c20  , 22050, 44100, 
+000041b0: 3438 3030 300a 2020 2020 6269 7473 5f70  48000.    bits_p
+000041c0: 6572 5f73 616d 706c 653a 2069 6e74 0a20  er_sample: int. 
+000041d0: 2020 2071 7561 6c69 7479 3a20 5065 7263     quality: Perc
+000041e0: 656e 7449 6e74 2020 2320 6f6e 6c79 2066  entInt  # only f
+000041f0: 6f72 2076 6f72 6269 730a 0a0a 636c 6173  or vorbis...clas
+00004200: 7320 5769 6669 5374 6174 7328 5072 6f74  s WifiStats(Prot
+00004210: 6563 7442 6173 654f 626a 6563 7429 3a0a  ectBaseObject):.
+00004220: 2020 2020 6368 616e 6e65 6c3a 204f 7074      channel: Opt
+00004230: 696f 6e61 6c5b 696e 745d 0a20 2020 2066  ional[int].    f
+00004240: 7265 7175 656e 6379 3a20 4f70 7469 6f6e  requency: Option
+00004250: 616c 5b69 6e74 5d0a 2020 2020 6c69 6e6b  al[int].    link
+00004260: 5f73 7065 6564 5f6d 6270 733a 204f 7074  _speed_mbps: Opt
+00004270: 696f 6e61 6c5b 7374 725d 0a20 2020 2073  ional[str].    s
+00004280: 6967 6e61 6c5f 7175 616c 6974 793a 2050  ignal_quality: P
+00004290: 6572 6365 6e74 496e 740a 2020 2020 7369  ercentInt.    si
+000042a0: 676e 616c 5f73 7472 656e 6774 683a 2069  gnal_strength: i
+000042b0: 6e74 0a0a 0a63 6c61 7373 2056 6964 656f  nt...class Video
+000042c0: 5374 6174 7328 5072 6f74 6563 7442 6173  Stats(ProtectBas
+000042d0: 654f 626a 6563 7429 3a0a 2020 2020 7265  eObject):.    re
+000042e0: 636f 7264 696e 675f 7374 6172 743a 204f  cording_start: O
+000042f0: 7074 696f 6e61 6c5b 6461 7465 7469 6d65  ptional[datetime
+00004300: 5d0a 2020 2020 7265 636f 7264 696e 675f  ].    recording_
+00004310: 656e 643a 204f 7074 696f 6e61 6c5b 6461  end: Optional[da
+00004320: 7465 7469 6d65 5d0a 2020 2020 7265 636f  tetime].    reco
+00004330: 7264 696e 675f 7374 6172 745f 6c71 3a20  rding_start_lq: 
+00004340: 4f70 7469 6f6e 616c 5b64 6174 6574 696d  Optional[datetim
+00004350: 655d 0a20 2020 2072 6563 6f72 6469 6e67  e].    recording
+00004360: 5f65 6e64 5f6c 713a 204f 7074 696f 6e61  _end_lq: Optiona
+00004370: 6c5b 6461 7465 7469 6d65 5d0a 2020 2020  l[datetime].    
+00004380: 7469 6d65 6c61 7073 655f 7374 6172 743a  timelapse_start:
+00004390: 204f 7074 696f 6e61 6c5b 6461 7465 7469   Optional[dateti
+000043a0: 6d65 5d0a 2020 2020 7469 6d65 6c61 7073  me].    timelaps
+000043b0: 655f 656e 643a 204f 7074 696f 6e61 6c5b  e_end: Optional[
+000043c0: 6461 7465 7469 6d65 5d0a 2020 2020 7469  datetime].    ti
+000043d0: 6d65 6c61 7073 655f 7374 6172 745f 6c71  melapse_start_lq
+000043e0: 3a20 4f70 7469 6f6e 616c 5b64 6174 6574  : Optional[datet
+000043f0: 696d 655d 0a20 2020 2074 696d 656c 6170  ime].    timelap
+00004400: 7365 5f65 6e64 5f6c 713a 204f 7074 696f  se_end_lq: Optio
+00004410: 6e61 6c5b 6461 7465 7469 6d65 5d0a 0a20  nal[datetime].. 
+00004420: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+00004430: 2020 2020 4063 6163 6865 0a20 2020 2064      @cache.    d
+00004440: 6566 205f 6765 745f 756e 6966 695f 7265  ef _get_unifi_re
+00004450: 6d61 7073 2863 6c73 2920 2d3e 2064 6963  maps(cls) -> dic
+00004460: 745b 7374 722c 2073 7472 5d3a 0a20 2020  t[str, str]:.   
+00004470: 2020 2020 2072 6574 7572 6e20 7b0a 2020       return {.  
+00004480: 2020 2020 2020 2020 2020 2a2a 7375 7065            **supe
+00004490: 7228 292e 5f67 6574 5f75 6e69 6669 5f72  r()._get_unifi_r
+000044a0: 656d 6170 7328 292c 0a20 2020 2020 2020  emaps(),.       
+000044b0: 2020 2020 2022 7265 636f 7264 696e 6753       "recordingS
+000044c0: 7461 7274 4c51 223a 2022 7265 636f 7264  tartLQ": "record
+000044d0: 696e 6753 7461 7274 4c71 222c 0a20 2020  ingStartLq",.   
+000044e0: 2020 2020 2020 2020 2022 7265 636f 7264           "record
+000044f0: 696e 6745 6e64 4c51 223a 2022 7265 636f  ingEndLQ": "reco
+00004500: 7264 696e 6745 6e64 4c71 222c 0a20 2020  rdingEndLq",.   
+00004510: 2020 2020 2020 2020 2022 7469 6d65 6c61           "timela
+00004520: 7073 6553 7461 7274 4c51 223a 2022 7469  pseStartLQ": "ti
+00004530: 6d65 6c61 7073 6553 7461 7274 4c71 222c  melapseStartLq",
+00004540: 0a20 2020 2020 2020 2020 2020 2022 7469  .            "ti
+00004550: 6d65 6c61 7073 6545 6e64 4c51 223a 2022  melapseEndLQ": "
+00004560: 7469 6d65 6c61 7073 6545 6e64 4c71 222c  timelapseEndLq",
+00004570: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+00004580: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+00004590: 2064 6566 2075 6e69 6669 5f64 6963 745f   def unifi_dict_
+000045a0: 746f 5f64 6963 7428 636c 732c 2064 6174  to_dict(cls, dat
+000045b0: 613a 2064 6963 745b 7374 722c 2041 6e79  a: dict[str, Any
+000045c0: 5d29 202d 3e20 6469 6374 5b73 7472 2c20  ]) -> dict[str, 
+000045d0: 416e 795d 3a0a 2020 2020 2020 2020 6966  Any]:.        if
+000045e0: 2022 7265 636f 7264 696e 6753 7461 7274   "recordingStart
+000045f0: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
+00004600: 2020 2020 2020 2064 6174 615b 2272 6563         data["rec
+00004610: 6f72 6469 6e67 5374 6172 7422 5d20 3d20  ordingStart"] = 
+00004620: 7072 6f63 6573 735f 6461 7465 7469 6d65  process_datetime
+00004630: 2864 6174 612c 2022 7265 636f 7264 696e  (data, "recordin
+00004640: 6753 7461 7274 2229 0a20 2020 2020 2020  gStart").       
+00004650: 2069 6620 2272 6563 6f72 6469 6e67 456e   if "recordingEn
+00004660: 6422 2069 6e20 6461 7461 3a0a 2020 2020  d" in data:.    
+00004670: 2020 2020 2020 2020 6461 7461 5b22 7265          data["re
+00004680: 636f 7264 696e 6745 6e64 225d 203d 2070  cordingEnd"] = p
+00004690: 726f 6365 7373 5f64 6174 6574 696d 6528  rocess_datetime(
+000046a0: 6461 7461 2c20 2272 6563 6f72 6469 6e67  data, "recording
+000046b0: 456e 6422 290a 2020 2020 2020 2020 6966  End").        if
+000046c0: 2022 7265 636f 7264 696e 6753 7461 7274   "recordingStart
+000046d0: 4c51 2220 696e 2064 6174 613a 0a20 2020  LQ" in data:.   
+000046e0: 2020 2020 2020 2020 2064 6174 615b 2272           data["r
+000046f0: 6563 6f72 6469 6e67 5374 6172 744c 5122  ecordingStartLQ"
+00004700: 5d20 3d20 7072 6f63 6573 735f 6461 7465  ] = process_date
+00004710: 7469 6d65 2864 6174 612c 2022 7265 636f  time(data, "reco
+00004720: 7264 696e 6753 7461 7274 4c51 2229 0a20  rdingStartLQ"). 
+00004730: 2020 2020 2020 2069 6620 2272 6563 6f72         if "recor
+00004740: 6469 6e67 456e 644c 5122 2069 6e20 6461  dingEndLQ" in da
+00004750: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
+00004760: 6461 7461 5b22 7265 636f 7264 696e 6745  data["recordingE
+00004770: 6e64 4c51 225d 203d 2070 726f 6365 7373  ndLQ"] = process
+00004780: 5f64 6174 6574 696d 6528 6461 7461 2c20  _datetime(data, 
+00004790: 2272 6563 6f72 6469 6e67 456e 644c 5122  "recordingEndLQ"
+000047a0: 290a 2020 2020 2020 2020 6966 2022 7469  ).        if "ti
+000047b0: 6d65 6c61 7073 6553 7461 7274 2220 696e  melapseStart" in
+000047c0: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
+000047d0: 2020 2064 6174 615b 2274 696d 656c 6170     data["timelap
+000047e0: 7365 5374 6172 7422 5d20 3d20 7072 6f63  seStart"] = proc
+000047f0: 6573 735f 6461 7465 7469 6d65 2864 6174  ess_datetime(dat
+00004800: 612c 2022 7469 6d65 6c61 7073 6553 7461  a, "timelapseSta
+00004810: 7274 2229 0a20 2020 2020 2020 2069 6620  rt").        if 
+00004820: 2274 696d 656c 6170 7365 456e 6422 2069  "timelapseEnd" i
+00004830: 6e20 6461 7461 3a0a 2020 2020 2020 2020  n data:.        
+00004840: 2020 2020 6461 7461 5b22 7469 6d65 6c61      data["timela
+00004850: 7073 6545 6e64 225d 203d 2070 726f 6365  pseEnd"] = proce
+00004860: 7373 5f64 6174 6574 696d 6528 6461 7461  ss_datetime(data
+00004870: 2c20 2274 696d 656c 6170 7365 456e 6422  , "timelapseEnd"
+00004880: 290a 2020 2020 2020 2020 6966 2022 7469  ).        if "ti
+00004890: 6d65 6c61 7073 6553 7461 7274 4c51 2220  melapseStartLQ" 
+000048a0: 696e 2064 6174 613a 0a20 2020 2020 2020  in data:.       
+000048b0: 2020 2020 2064 6174 615b 2274 696d 656c       data["timel
+000048c0: 6170 7365 5374 6172 744c 5122 5d20 3d20  apseStartLQ"] = 
+000048d0: 7072 6f63 6573 735f 6461 7465 7469 6d65  process_datetime
+000048e0: 2864 6174 612c 2022 7469 6d65 6c61 7073  (data, "timelaps
+000048f0: 6553 7461 7274 4c51 2229 0a20 2020 2020  eStartLQ").     
+00004900: 2020 2069 6620 2274 696d 656c 6170 7365     if "timelapse
+00004910: 456e 644c 5122 2069 6e20 6461 7461 3a0a  EndLQ" in data:.
+00004920: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00004930: 5b22 7469 6d65 6c61 7073 6545 6e64 4c51  ["timelapseEndLQ
+00004940: 225d 203d 2070 726f 6365 7373 5f64 6174  "] = process_dat
+00004950: 6574 696d 6528 6461 7461 2c20 2274 696d  etime(data, "tim
+00004960: 656c 6170 7365 456e 644c 5122 290a 0a20  elapseEndLQ").. 
+00004970: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00004980: 7065 7228 292e 756e 6966 695f 6469 6374  per().unifi_dict
+00004990: 5f74 6f5f 6469 6374 2864 6174 6129 0a0a  _to_dict(data)..
+000049a0: 0a63 6c61 7373 2053 746f 7261 6765 5374  .class StorageSt
+000049b0: 6174 7328 5072 6f74 6563 7442 6173 654f  ats(ProtectBaseO
+000049c0: 626a 6563 7429 3a0a 2020 2020 7573 6564  bject):.    used
+000049d0: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
+000049e0: 2023 2062 7974 6573 0a20 2020 2072 6174   # bytes.    rat
+000049f0: 653a 204f 7074 696f 6e61 6c5b 666c 6f61  e: Optional[floa
+00004a00: 745d 2020 2320 6279 7465 7320 2f20 6d69  t]  # bytes / mi
+00004a10: 6c6c 6973 6563 6f6e 640a 0a20 2020 2040  llisecond..    @
+00004a20: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00004a30: 2072 6174 655f 7065 725f 7365 636f 6e64   rate_per_second
+00004a40: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
+00004a50: 616c 5b66 6c6f 6174 5d3a 0a20 2020 2020  al[float]:.     
+00004a60: 2020 2069 6620 7365 6c66 2e72 6174 6520     if self.rate 
+00004a70: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00004a80: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+00004a90: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00004aa0: 2073 656c 662e 7261 7465 202a 2031 3030   self.rate * 100
+00004ab0: 300a 0a20 2020 2040 636c 6173 736d 6574  0..    @classmet
+00004ac0: 686f 640a 2020 2020 6465 6620 756e 6966  hod.    def unif
+00004ad0: 695f 6469 6374 5f74 6f5f 6469 6374 2863  i_dict_to_dict(c
+00004ae0: 6c73 2c20 6461 7461 3a20 6469 6374 5b73  ls, data: dict[s
+00004af0: 7472 2c20 416e 795d 2920 2d3e 2064 6963  tr, Any]) -> dic
+00004b00: 745b 7374 722c 2041 6e79 5d3a 0a20 2020  t[str, Any]:.   
+00004b10: 2020 2020 2069 6620 2272 6174 6522 206e       if "rate" n
+00004b20: 6f74 2069 6e20 6461 7461 3a0a 2020 2020  ot in data:.    
+00004b30: 2020 2020 2020 2020 6461 7461 5b22 7261          data["ra
+00004b40: 7465 225d 203d 204e 6f6e 650a 0a20 2020  te"] = None..   
+00004b50: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
+00004b60: 7228 292e 756e 6966 695f 6469 6374 5f74  r().unifi_dict_t
+00004b70: 6f5f 6469 6374 2864 6174 6129 0a0a 2020  o_dict(data)..  
+00004b80: 2020 6465 6620 756e 6966 695f 6469 6374    def unifi_dict
+00004b90: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00004ba0: 2020 2020 2020 2020 6461 7461 3a20 4f70          data: Op
+00004bb0: 7469 6f6e 616c 5b64 6963 745b 7374 722c  tional[dict[str,
+00004bc0: 2041 6e79 5d5d 203d 204e 6f6e 652c 0a20   Any]] = None,. 
+00004bd0: 2020 2020 2020 2065 7863 6c75 6465 3a20         exclude: 
+00004be0: 4f70 7469 6f6e 616c 5b73 6574 5b73 7472  Optional[set[str
+00004bf0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
+00004c00: 202d 3e20 6469 6374 5b73 7472 2c20 416e   -> dict[str, An
+00004c10: 795d 3a0a 2020 2020 2020 2020 6461 7461  y]:.        data
+00004c20: 203d 2073 7570 6572 2829 2e75 6e69 6669   = super().unifi
+00004c30: 5f64 6963 7428 6461 7461 3d64 6174 612c  _dict(data=data,
+00004c40: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
+00004c50: 290a 0a20 2020 2020 2020 2069 6620 2272  )..        if "r
+00004c60: 6174 6522 2069 6e20 6461 7461 2061 6e64  ate" in data and
+00004c70: 2064 6174 615b 2272 6174 6522 5d20 6973   data["rate"] is
+00004c80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00004c90: 2020 2064 656c 2064 6174 615b 2272 6174     del data["rat
+00004ca0: 6522 5d0a 0a20 2020 2020 2020 2072 6574  e"]..        ret
+00004cb0: 7572 6e20 6461 7461 0a0a 0a63 6c61 7373  urn data...class
+00004cc0: 2043 616d 6572 6153 7461 7473 2850 726f   CameraStats(Pro
+00004cd0: 7465 6374 4261 7365 4f62 6a65 6374 293a  tectBaseObject):
+00004ce0: 0a20 2020 2072 785f 6279 7465 733a 2069  .    rx_bytes: i
+00004cf0: 6e74 0a20 2020 2074 785f 6279 7465 733a  nt.    tx_bytes:
+00004d00: 2069 6e74 0a20 2020 2077 6966 693a 2057   int.    wifi: W
+00004d10: 6966 6953 7461 7473 0a20 2020 2076 6964  ifiStats.    vid
+00004d20: 656f 3a20 5669 6465 6f53 7461 7473 0a20  eo: VideoStats. 
+00004d30: 2020 2073 746f 7261 6765 3a20 4f70 7469     storage: Opti
+00004d40: 6f6e 616c 5b53 746f 7261 6765 5374 6174  onal[StorageStat
+00004d50: 735d 0a20 2020 2077 6966 695f 7175 616c  s].    wifi_qual
+00004d60: 6974 793a 2050 6572 6365 6e74 496e 740a  ity: PercentInt.
+00004d70: 2020 2020 7769 6669 5f73 7472 656e 6774      wifi_strengt
+00004d80: 683a 2069 6e74 0a0a 2020 2020 4063 6c61  h: int..    @cla
+00004d90: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00004da0: 2075 6e69 6669 5f64 6963 745f 746f 5f64   unifi_dict_to_d
+00004db0: 6963 7428 636c 732c 2064 6174 613a 2064  ict(cls, data: d
+00004dc0: 6963 745b 7374 722c 2041 6e79 5d29 202d  ict[str, Any]) -
+00004dd0: 3e20 6469 6374 5b73 7472 2c20 416e 795d  > dict[str, Any]
+00004de0: 3a0a 2020 2020 2020 2020 6966 2022 7374  :.        if "st
+00004df0: 6f72 6167 6522 2069 6e20 6461 7461 2061  orage" in data a
+00004e00: 6e64 2064 6174 615b 2273 746f 7261 6765  nd data["storage
+00004e10: 225d 203d 3d20 7b7d 3a0a 2020 2020 2020  "] == {}:.      
+00004e20: 2020 2020 2020 6465 6c20 6461 7461 5b22        del data["
+00004e30: 7374 6f72 6167 6522 5d0a 0a20 2020 2020  storage"]..     
+00004e40: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
+00004e50: 292e 756e 6966 695f 6469 6374 5f74 6f5f  ).unifi_dict_to_
+00004e60: 6469 6374 2864 6174 6129 0a0a 2020 2020  dict(data)..    
+00004e70: 6465 6620 756e 6966 695f 6469 6374 280a  def unifi_dict(.
+00004e80: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00004e90: 2020 2020 2020 6461 7461 3a20 4f70 7469        data: Opti
+00004ea0: 6f6e 616c 5b64 6963 745b 7374 722c 2041  onal[dict[str, A
+00004eb0: 6e79 5d5d 203d 204e 6f6e 652c 0a20 2020  ny]] = None,.   
+00004ec0: 2020 2020 2065 7863 6c75 6465 3a20 4f70       exclude: Op
+00004ed0: 7469 6f6e 616c 5b73 6574 5b73 7472 5d5d  tional[set[str]]
+00004ee0: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+00004ef0: 3e20 6469 6374 5b73 7472 2c20 416e 795d  > dict[str, Any]
+00004f00: 3a0a 2020 2020 2020 2020 6461 7461 203d  :.        data =
+00004f10: 2073 7570 6572 2829 2e75 6e69 6669 5f64   super().unifi_d
+00004f20: 6963 7428 6461 7461 3d64 6174 612c 2065  ict(data=data, e
+00004f30: 7863 6c75 6465 3d65 7863 6c75 6465 290a  xclude=exclude).
+00004f40: 0a20 2020 2020 2020 2069 6620 2273 746f  .        if "sto
+00004f50: 7261 6765 2220 696e 2064 6174 6120 616e  rage" in data an
+00004f60: 6420 6461 7461 5b22 7374 6f72 6167 6522  d data["storage"
+00004f70: 5d20 6973 204e 6f6e 653a 0a20 2020 2020  ] is None:.     
+00004f80: 2020 2020 2020 2064 6174 615b 2273 746f         data["sto
+00004f90: 7261 6765 225d 203d 207b 7d0a 0a20 2020  rage"] = {}..   
+00004fa0: 2020 2020 2072 6574 7572 6e20 6461 7461       return data
+00004fb0: 0a0a 0a63 6c61 7373 2043 616d 6572 615a  ...class CameraZ
+00004fc0: 6f6e 6528 5072 6f74 6563 7442 6173 654f  one(ProtectBaseO
+00004fd0: 626a 6563 7429 3a0a 2020 2020 6964 3a20  bject):.    id: 
+00004fe0: 696e 740a 2020 2020 6e61 6d65 3a20 7374  int.    name: st
+00004ff0: 720a 2020 2020 636f 6c6f 723a 2043 6f6c  r.    color: Col
+00005000: 6f72 0a20 2020 2070 6f69 6e74 733a 206c  or.    points: l
+00005010: 6973 745b 7475 706c 655b 5065 7263 656e  ist[tuple[Percen
+00005020: 742c 2050 6572 6365 6e74 5d5d 0a0a 2020  t, Percent]]..  
+00005030: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
+00005040: 2020 2064 6566 2075 6e69 6669 5f64 6963     def unifi_dic
+00005050: 745f 746f 5f64 6963 7428 636c 732c 2064  t_to_dict(cls, d
+00005060: 6174 613a 2064 6963 745b 7374 722c 2041  ata: dict[str, A
+00005070: 6e79 5d29 202d 3e20 6469 6374 5b73 7472  ny]) -> dict[str
+00005080: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
+00005090: 6461 7461 203d 2073 7570 6572 2829 2e75  data = super().u
+000050a0: 6e69 6669 5f64 6963 745f 746f 5f64 6963  nifi_dict_to_dic
+000050b0: 7428 6461 7461 290a 2020 2020 2020 2020  t(data).        
+000050c0: 6966 2022 706f 696e 7473 2220 696e 2064  if "points" in d
+000050d0: 6174 6120 616e 6420 6973 696e 7374 616e  ata and isinstan
+000050e0: 6365 2864 6174 615b 2270 6f69 6e74 7322  ce(data["points"
+000050f0: 5d2c 2049 7465 7261 626c 6529 3a0a 2020  ], Iterable):.  
+00005100: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+00005110: 706f 696e 7473 225d 203d 205b 2870 5b30  points"] = [(p[0
+00005120: 5d2c 2070 5b31 5d29 2066 6f72 2070 2069  ], p[1]) for p i
+00005130: 6e20 6461 7461 5b22 706f 696e 7473 225d  n data["points"]
+00005140: 5d0a 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
+00005150: 6e20 6461 7461 0a0a 2020 2020 6465 6620  n data..    def 
+00005160: 756e 6966 695f 6469 6374 280a 2020 2020  unifi_dict(.    
+00005170: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00005180: 2020 6461 7461 3a20 4f70 7469 6f6e 616c    data: Optional
+00005190: 5b64 6963 745b 7374 722c 2041 6e79 5d5d  [dict[str, Any]]
+000051a0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+000051b0: 2065 7863 6c75 6465 3a20 4f70 7469 6f6e   exclude: Option
+000051c0: 616c 5b73 6574 5b73 7472 5d5d 203d 204e  al[set[str]] = N
+000051d0: 6f6e 652c 0a20 2020 2029 202d 3e20 6469  one,.    ) -> di
+000051e0: 6374 5b73 7472 2c20 416e 795d 3a0a 2020  ct[str, Any]:.  
+000051f0: 2020 2020 2020 6461 7461 203d 2073 7570        data = sup
+00005200: 6572 2829 2e75 6e69 6669 5f64 6963 7428  er().unifi_dict(
+00005210: 6461 7461 3d64 6174 612c 2065 7863 6c75  data=data, exclu
+00005220: 6465 3d65 7863 6c75 6465 290a 0a20 2020  de=exclude)..   
+00005230: 2020 2020 2069 6620 2270 6f69 6e74 7322       if "points"
+00005240: 2069 6e20 6461 7461 3a0a 2020 2020 2020   in data:.      
+00005250: 2020 2020 2020 6461 7461 5b22 706f 696e        data["poin
+00005260: 7473 225d 203d 205b 7365 7269 616c 697a  ts"] = [serializ
+00005270: 655f 706f 696e 7428 7029 2066 6f72 2070  e_point(p) for p
+00005280: 2069 6e20 6461 7461 5b22 706f 696e 7473   in data["points
+00005290: 225d 5d0a 0a20 2020 2020 2020 2072 6574  "]]..        ret
+000052a0: 7572 6e20 6461 7461 0a0a 2020 2020 4073  urn data..    @s
+000052b0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+000052c0: 6465 6620 6372 6561 7465 5f70 7269 7661  def create_priva
+000052d0: 6379 5f7a 6f6e 6528 7a6f 6e65 5f69 643a  cy_zone(zone_id:
+000052e0: 2069 6e74 2920 2d3e 2043 616d 6572 615a   int) -> CameraZ
+000052f0: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
+00005300: 7572 6e20 4361 6d65 7261 5a6f 6e65 280a  urn CameraZone(.
+00005310: 2020 2020 2020 2020 2020 2020 6964 3d7a              id=z
+00005320: 6f6e 655f 6964 2c0a 2020 2020 2020 2020  one_id,.        
+00005330: 2020 2020 6e61 6d65 3d50 5249 5641 4359      name=PRIVACY
+00005340: 5f5a 4f4e 455f 4e41 4d45 2c0a 2020 2020  _ZONE_NAME,.    
+00005350: 2020 2020 2020 2020 636f 6c6f 723d 436f          color=Co
+00005360: 6c6f 7228 2223 3835 4243 4543 2229 2c0a  lor("#85BCEC"),.
+00005370: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00005380: 7473 3d5b 5b30 2c20 305d 2c20 5b31 2c20  ts=[[0, 0], [1, 
+00005390: 305d 2c20 5b31 2c20 315d 2c20 5b30 2c20  0], [1, 1], [0, 
+000053a0: 315d 5d2c 2020 2320 7479 7065 3a20 6967  1]],  # type: ig
+000053b0: 6e6f 7265 5b6c 6973 742d 6974 656d 5d0a  nore[list-item].
+000053c0: 2020 2020 2020 2020 290a 0a0a 636c 6173          )...clas
+000053d0: 7320 4d6f 7469 6f6e 5a6f 6e65 2843 616d  s MotionZone(Cam
+000053e0: 6572 615a 6f6e 6529 3a0a 2020 2020 7365  eraZone):.    se
+000053f0: 6e73 6974 6976 6974 793a 2050 6572 6365  nsitivity: Perce
+00005400: 6e74 496e 740a 0a0a 636c 6173 7320 536d  ntInt...class Sm
+00005410: 6172 744d 6f74 696f 6e5a 6f6e 6528 4d6f  artMotionZone(Mo
+00005420: 7469 6f6e 5a6f 6e65 293a 0a20 2020 206f  tionZone):.    o
+00005430: 626a 6563 745f 7479 7065 733a 206c 6973  bject_types: lis
+00005440: 745b 536d 6172 7444 6574 6563 744f 626a  t[SmartDetectObj
+00005450: 6563 7454 7970 655d 0a0a 2020 2020 4063  ectType]..    @c
+00005460: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00005470: 6566 2075 6e69 6669 5f64 6963 745f 746f  ef unifi_dict_to
+00005480: 5f64 6963 7428 636c 732c 2064 6174 613a  _dict(cls, data:
+00005490: 2064 6963 745b 7374 722c 2041 6e79 5d29   dict[str, Any])
+000054a0: 202d 3e20 6469 6374 5b73 7472 2c20 416e   -> dict[str, An
+000054b0: 795d 3a0a 2020 2020 2020 2020 6966 2022  y]:.        if "
+000054c0: 6f62 6a65 6374 5479 7065 7322 2069 6e20  objectTypes" in 
+000054d0: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
+000054e0: 2020 6461 7461 5b22 6f62 6a65 6374 5479    data["objectTy
+000054f0: 7065 7322 5d20 3d20 636f 6e76 6572 745f  pes"] = convert_
+00005500: 736d 6172 745f 7479 7065 7328 6461 7461  smart_types(data
+00005510: 2e70 6f70 2822 6f62 6a65 6374 5479 7065  .pop("objectType
+00005520: 7322 2929 0a0a 2020 2020 2020 2020 7265  s"))..        re
+00005530: 7475 726e 2073 7570 6572 2829 2e75 6e69  turn super().uni
+00005540: 6669 5f64 6963 745f 746f 5f64 6963 7428  fi_dict_to_dict(
+00005550: 6461 7461 290a 0a0a 636c 6173 7320 5072  data)...class Pr
+00005560: 6976 6163 794d 6173 6b43 6170 6162 696c  ivacyMaskCapabil
+00005570: 6974 7928 5072 6f74 6563 7442 6173 654f  ity(ProtectBaseO
+00005580: 626a 6563 7429 3a0a 2020 2020 6d61 785f  bject):.    max_
+00005590: 6d61 736b 733a 204f 7074 696f 6e61 6c5b  masks: Optional[
+000055a0: 696e 745d 0a20 2020 2072 6563 7461 6e67  int].    rectang
+000055b0: 6c65 5f6f 6e6c 793a 2062 6f6f 6c0a 0a0a  le_only: bool...
+000055c0: 636c 6173 7320 486f 7470 6c75 6745 7874  class HotplugExt
+000055d0: 656e 6465 7228 5072 6f74 6563 7442 6173  ender(ProtectBas
+000055e0: 654f 626a 6563 7429 3a0a 2020 2020 6861  eObject):.    ha
+000055f0: 735f 666c 6173 683a 204f 7074 696f 6e61  s_flash: Optiona
+00005600: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 0a20  l[bool] = None. 
+00005610: 2020 2068 6173 5f69 723a 204f 7074 696f     has_ir: Optio
+00005620: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+00005630: 0a20 2020 2068 6173 5f72 6164 6172 3a20  .    has_radar: 
+00005640: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00005650: 204e 6f6e 650a 2020 2020 6973 5f61 7474   None.    is_att
+00005660: 6163 6865 643a 204f 7074 696f 6e61 6c5b  ached: Optional[
+00005670: 626f 6f6c 5d20 3d20 4e6f 6e65 0a20 2020  bool] = None.   
+00005680: 2023 2033 2e30 2e32 322b 0a20 2020 2066   # 3.0.22+.    f
+00005690: 6c61 7368 5f72 616e 6765 3a20 4f70 7469  lash_range: Opti
+000056a0: 6f6e 616c 5b41 6e79 5d20 3d20 4e6f 6e65  onal[Any] = None
+000056b0: 0a20 2020 2023 2034 2e30 2e37 2b0a 2020  .    # 4.0.7+.  
+000056c0: 2020 7261 6461 725f 7261 6e67 655f 6d61    radar_range_ma
+000056d0: 783a 204f 7074 696f 6e61 6c5b 416e 795d  x: Optional[Any]
+000056e0: 203d 204e 6f6e 650a 2020 2020 7261 6461   = None.    rada
+000056f0: 725f 7261 6e67 655f 6d69 6e3a 204f 7074  r_range_min: Opt
+00005700: 696f 6e61 6c5b 416e 795d 203d 204e 6f6e  ional[Any] = Non
+00005710: 650a 0a20 2020 2040 636c 6173 736d 6574  e..    @classmet
+00005720: 686f 640a 2020 2020 4063 6163 6865 0a20  hod.    @cache. 
+00005730: 2020 2064 6566 205f 6765 745f 756e 6966     def _get_unif
+00005740: 695f 7265 6d61 7073 2863 6c73 2920 2d3e  i_remaps(cls) ->
+00005750: 2064 6963 745b 7374 722c 2073 7472 5d3a   dict[str, str]:
+00005760: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00005770: 7b2a 2a73 7570 6572 2829 2e5f 6765 745f  {**super()._get_
+00005780: 756e 6966 695f 7265 6d61 7073 2829 2c20  unifi_remaps(), 
+00005790: 2268 6173 4952 223a 2022 6861 7349 7222  "hasIR": "hasIr"
+000057a0: 7d0a 0a0a 636c 6173 7320 486f 7470 6c75  }...class Hotplu
+000057b0: 6728 5072 6f74 6563 7442 6173 654f 626a  g(ProtectBaseObj
+000057c0: 6563 7429 3a0a 2020 2020 6175 6469 6f3a  ect):.    audio:
+000057d0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+000057e0: 3d20 4e6f 6e65 0a20 2020 2076 6964 656f  = None.    video
+000057f0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+00005800: 203d 204e 6f6e 650a 2020 2020 6578 7465   = None.    exte
+00005810: 6e64 6572 3a20 4f70 7469 6f6e 616c 5b48  nder: Optional[H
+00005820: 6f74 706c 7567 4578 7465 6e64 6572 5d20  otplugExtender] 
+00005830: 3d20 4e6f 6e65 0a20 2020 2023 2032 2e38  = None.    # 2.8
+00005840: 2e33 352b 0a20 2020 2073 7461 6e64 616c  .35+.    standal
+00005850: 6f6e 655f 6164 6f70 7469 6f6e 3a20 4f70  one_adoption: Op
+00005860: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+00005870: 6f6e 650a 0a0a 636c 6173 7320 5054 5a52  one...class PTZR
+00005880: 616e 6765 5369 6e67 6c65 2850 726f 7465  angeSingle(Prote
+00005890: 6374 4261 7365 4f62 6a65 6374 293a 0a20  ctBaseObject):. 
+000058a0: 2020 206d 6178 3a20 4f70 7469 6f6e 616c     max: Optional
+000058b0: 5b66 6c6f 6174 5d0a 2020 2020 6d69 6e3a  [float].    min:
+000058c0: 204f 7074 696f 6e61 6c5b 666c 6f61 745d   Optional[float]
+000058d0: 0a20 2020 2073 7465 703a 204f 7074 696f  .    step: Optio
+000058e0: 6e61 6c5b 666c 6f61 745d 0a0a 0a63 6c61  nal[float]...cla
+000058f0: 7373 2050 545a 5261 6e67 6528 5072 6f74  ss PTZRange(Prot
+00005900: 6563 7442 6173 654f 626a 6563 7429 3a0a  ectBaseObject):.
+00005910: 2020 2020 7374 6570 733a 2050 545a 5261      steps: PTZRa
+00005920: 6e67 6553 696e 676c 650a 2020 2020 6465  ngeSingle.    de
+00005930: 6772 6565 733a 2050 545a 5261 6e67 6553  grees: PTZRangeS
+00005940: 696e 676c 650a 0a20 2020 2064 6566 2074  ingle..    def t
+00005950: 6f5f 6e61 7469 7665 5f76 616c 7565 2873  o_native_value(s
+00005960: 656c 662c 2064 6567 7265 655f 7661 6c75  elf, degree_valu
+00005970: 653a 2066 6c6f 6174 2c20 6973 5f72 656c  e: float, is_rel
+00005980: 6174 6976 653a 2062 6f6f 6c20 3d20 4661  ative: bool = Fa
+00005990: 6c73 6529 202d 3e20 666c 6f61 743a 0a20  lse) -> float:. 
+000059a0: 2020 2020 2020 2022 2222 436f 6e76 6572         """Conver
+000059b0: 7420 6465 6772 6565 2076 616c 7565 7320  t degree values 
+000059c0: 746f 2073 7465 7020 7661 6c75 6573 2e22  to step values."
+000059d0: 2222 0a0a 2020 2020 2020 2020 6966 2028  ""..        if (
+000059e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000059f0: 662e 6465 6772 6565 732e 6d61 7820 6973  f.degrees.max is
+00005a00: 204e 6f6e 6520 2023 206e 6f71 613a 2050   None  # noqa: P
+00005a10: 4c52 3039 3136 0a20 2020 2020 2020 2020  LR0916.         
+00005a20: 2020 206f 7220 7365 6c66 2e64 6567 7265     or self.degre
+00005a30: 6573 2e6d 696e 2069 7320 4e6f 6e65 0a20  es.min is None. 
+00005a40: 2020 2020 2020 2020 2020 206f 7220 7365             or se
+00005a50: 6c66 2e64 6567 7265 6573 2e73 7465 7020  lf.degrees.step 
+00005a60: 6973 204e 6f6e 650a 2020 2020 2020 2020  is None.        
+00005a70: 2020 2020 6f72 2073 656c 662e 7374 6570      or self.step
+00005a80: 732e 6d61 7820 6973 204e 6f6e 650a 2020  s.max is None.  
+00005a90: 2020 2020 2020 2020 2020 6f72 2073 656c            or sel
+00005aa0: 662e 7374 6570 732e 6d69 6e20 6973 204e  f.steps.min is N
+00005ab0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00005ac0: 6f72 2073 656c 662e 7374 6570 732e 7374  or self.steps.st
+00005ad0: 6570 2069 7320 4e6f 6e65 0a20 2020 2020  ep is None.     
+00005ae0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00005af0: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
+00005b00: 7374 2822 6465 6772 6565 2074 6f20 7374  st("degree to st
+00005b10: 6570 2063 6f6e 7665 7273 696f 6e20 6e6f  ep conversion no
+00005b20: 7420 7375 7070 6f72 7465 642e 2229 0a0a  t supported.")..
+00005b30: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00005b40: 735f 7265 6c61 7469 7665 3a0a 2020 2020  s_relative:.    
+00005b50: 2020 2020 2020 2020 6465 6772 6565 5f76          degree_v
+00005b60: 616c 7565 202d 3d20 7365 6c66 2e64 6567  alue -= self.deg
+00005b70: 7265 6573 2e6d 696e 0a0a 2020 2020 2020  rees.min..      
+00005b80: 2020 7374 6570 5f72 616e 6765 203d 2073    step_range = s
+00005b90: 656c 662e 7374 6570 732e 6d61 7820 2d20  elf.steps.max - 
+00005ba0: 7365 6c66 2e73 7465 7073 2e6d 696e 0a20  self.steps.min. 
+00005bb0: 2020 2020 2020 2064 6567 7265 655f 7261         degree_ra
+00005bc0: 6e67 6520 3d20 7365 6c66 2e64 6567 7265  nge = self.degre
+00005bd0: 6573 2e6d 6178 202d 2073 656c 662e 6465  es.max - self.de
+00005be0: 6772 6565 732e 6d69 6e0a 2020 2020 2020  grees.min.      
+00005bf0: 2020 7261 7469 6f20 3d20 7374 6570 5f72    ratio = step_r
+00005c00: 616e 6765 202f 2064 6567 7265 655f 7261  ange / degree_ra
+00005c10: 6e67 650a 0a20 2020 2020 2020 2073 7465  nge..        ste
+00005c20: 705f 7661 6c75 6520 3d20 636c 616d 705f  p_value = clamp_
+00005c30: 7661 6c75 6528 6465 6772 6565 5f76 616c  value(degree_val
+00005c40: 7565 202a 2072 6174 696f 2c20 7365 6c66  ue * ratio, self
+00005c50: 2e73 7465 7073 2e73 7465 7029 0a20 2020  .steps.step).   
+00005c60: 2020 2020 2069 6620 6e6f 7420 6973 5f72       if not is_r
+00005c70: 656c 6174 6976 653a 0a20 2020 2020 2020  elative:.       
+00005c80: 2020 2020 2073 7465 705f 7661 6c75 6520       step_value 
+00005c90: 3d20 7365 6c66 2e73 7465 7073 2e6d 696e  = self.steps.min
+00005ca0: 202b 2073 7465 705f 7661 6c75 650a 0a20   + step_value.. 
+00005cb0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+00005cc0: 6570 5f76 616c 7565 0a0a 0a63 6c61 7373  ep_value...class
+00005cd0: 2050 545a 5a6f 6f6d 5261 6e67 6528 5054   PTZZoomRange(PT
+00005ce0: 5a52 616e 6765 293a 0a20 2020 2072 6174  ZRange):.    rat
+00005cf0: 696f 3a20 666c 6f61 740a 0a20 2020 2064  io: float..    d
+00005d00: 6566 2074 6f5f 6e61 7469 7665 5f76 616c  ef to_native_val
+00005d10: 7565 2873 656c 662c 207a 6f6f 6d5f 7661  ue(self, zoom_va
+00005d20: 6c75 653a 2066 6c6f 6174 2c20 6973 5f72  lue: float, is_r
+00005d30: 656c 6174 6976 653a 2062 6f6f 6c20 3d20  elative: bool = 
+00005d40: 4661 6c73 6529 202d 3e20 666c 6f61 743a  False) -> float:
+00005d50: 0a20 2020 2020 2020 2022 2222 436f 6e76  .        """Conv
+00005d60: 6572 7420 7a6f 6f6d 2076 616c 7565 7320  ert zoom values 
+00005d70: 746f 2073 7465 7020 7661 6c75 6573 2e22  to step values."
+00005d80: 2222 0a0a 2020 2020 2020 2020 6966 2073  ""..        if s
+00005d90: 656c 662e 7374 6570 732e 6d61 7820 6973  elf.steps.max is
+00005da0: 204e 6f6e 6520 6f72 2073 656c 662e 7374   None or self.st
+00005db0: 6570 732e 6d69 6e20 6973 204e 6f6e 6520  eps.min is None 
+00005dc0: 6f72 2073 656c 662e 7374 6570 732e 7374  or self.steps.st
+00005dd0: 6570 2069 7320 4e6f 6e65 3a0a 2020 2020  ep is None:.    
+00005de0: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
+00005df0: 6452 6571 7565 7374 2822 7374 6570 2063  dRequest("step c
+00005e00: 6f6e 7665 7273 696f 6e20 6e6f 7420 7375  onversion not su
+00005e10: 7070 6f72 7465 642e 2229 0a0a 2020 2020  pported.")..    
+00005e20: 2020 2020 7374 6570 5f72 616e 6765 203d      step_range =
+00005e30: 2073 656c 662e 7374 6570 732e 6d61 7820   self.steps.max 
+00005e40: 2d20 7365 6c66 2e73 7465 7073 2e6d 696e  - self.steps.min
+00005e50: 0a20 2020 2020 2020 2023 207a 6f6f 6d20  .        # zoom 
+00005e60: 6c65 7665 6c73 2073 7461 7274 2061 7420  levels start at 
+00005e70: 310a 2020 2020 2020 2020 7261 7469 6f20  1.        ratio 
+00005e80: 3d20 7374 6570 5f72 616e 6765 202f 2028  = step_range / (
+00005e90: 7365 6c66 2e72 6174 696f 202d 2031 290a  self.ratio - 1).
+00005ea0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00005eb0: 735f 7265 6c61 7469 7665 3a0a 2020 2020  s_relative:.    
+00005ec0: 2020 2020 2020 2020 7a6f 6f6d 5f76 616c          zoom_val
+00005ed0: 7565 202d 3d20 310a 0a20 2020 2020 2020  ue -= 1..       
+00005ee0: 2073 7465 705f 7661 6c75 6520 3d20 636c   step_value = cl
+00005ef0: 616d 705f 7661 6c75 6528 7a6f 6f6d 5f76  amp_value(zoom_v
+00005f00: 616c 7565 202a 2072 6174 696f 2c20 7365  alue * ratio, se
+00005f10: 6c66 2e73 7465 7073 2e73 7465 7029 0a20  lf.steps.step). 
+00005f20: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00005f30: 5f72 656c 6174 6976 653a 0a20 2020 2020  _relative:.     
+00005f40: 2020 2020 2020 2073 7465 705f 7661 6c75         step_valu
+00005f50: 6520 3d20 7365 6c66 2e73 7465 7073 2e6d  e = self.steps.m
+00005f60: 696e 202b 2073 7465 705f 7661 6c75 650a  in + step_value.
+00005f70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00005f80: 7374 6570 5f76 616c 7565 0a0a 0a63 6c61  step_value...cla
+00005f90: 7373 2043 616d 6572 6146 6561 7475 7265  ss CameraFeature
+00005fa0: 466c 6167 7328 5072 6f74 6563 7442 6173  Flags(ProtectBas
+00005fb0: 654f 626a 6563 7429 3a0a 2020 2020 6361  eObject):.    ca
+00005fc0: 6e5f 6164 6a75 7374 5f69 725f 6c65 645f  n_adjust_ir_led_
+00005fd0: 6c65 7665 6c3a 2062 6f6f 6c0a 2020 2020  level: bool.    
+00005fe0: 6361 6e5f 6d61 6769 635f 7a6f 6f6d 3a20  can_magic_zoom: 
+00005ff0: 626f 6f6c 0a20 2020 2063 616e 5f6f 7074  bool.    can_opt
+00006000: 6963 616c 5f7a 6f6f 6d3a 2062 6f6f 6c0a  ical_zoom: bool.
+00006010: 2020 2020 6361 6e5f 746f 7563 685f 666f      can_touch_fo
+00006020: 6375 733a 2062 6f6f 6c0a 2020 2020 6861  cus: bool.    ha
+00006030: 735f 6163 6365 6c65 726f 6d65 7465 723a  s_accelerometer:
+00006040: 2062 6f6f 6c0a 2020 2020 6861 735f 6165   bool.    has_ae
+00006050: 633a 2062 6f6f 6c0a 2020 2020 6861 735f  c: bool.    has_
+00006060: 626c 7565 746f 6f74 683a 2062 6f6f 6c0a  bluetooth: bool.
+00006070: 2020 2020 6861 735f 6368 696d 653a 2062      has_chime: b
+00006080: 6f6f 6c0a 2020 2020 6861 735f 6578 7465  ool.    has_exte
+00006090: 726e 616c 5f69 723a 2062 6f6f 6c0a 2020  rnal_ir: bool.  
+000060a0: 2020 6861 735f 6963 725f 7365 6e73 6974    has_icr_sensit
+000060b0: 6976 6974 793a 2062 6f6f 6c0a 2020 2020  ivity: bool.    
+000060c0: 6861 735f 6c64 633a 2062 6f6f 6c0a 2020  has_ldc: bool.  
+000060d0: 2020 6861 735f 6c65 645f 6972 3a20 626f    has_led_ir: bo
+000060e0: 6f6c 0a20 2020 2068 6173 5f6c 6564 5f73  ol.    has_led_s
+000060f0: 7461 7475 733a 2062 6f6f 6c0a 2020 2020  tatus: bool.    
+00006100: 6861 735f 6c69 6e65 5f69 6e3a 2062 6f6f  has_line_in: boo
+00006110: 6c0a 2020 2020 6861 735f 6d69 633a 2062  l.    has_mic: b
+00006120: 6f6f 6c0a 2020 2020 6861 735f 7072 6976  ool.    has_priv
+00006130: 6163 795f 6d61 736b 3a20 626f 6f6c 0a20  acy_mask: bool. 
+00006140: 2020 2068 6173 5f72 7463 3a20 626f 6f6c     has_rtc: bool
+00006150: 0a20 2020 2068 6173 5f73 645f 6361 7264  .    has_sd_card
+00006160: 3a20 626f 6f6c 0a20 2020 2068 6173 5f73  : bool.    has_s
+00006170: 7065 616b 6572 3a20 626f 6f6c 0a20 2020  peaker: bool.   
+00006180: 2068 6173 5f77 6966 693a 2062 6f6f 6c0a   has_wifi: bool.
+00006190: 2020 2020 6861 735f 6864 723a 2062 6f6f      has_hdr: boo
+000061a0: 6c0a 2020 2020 6861 735f 6175 746f 5f69  l.    has_auto_i
+000061b0: 6372 5f6f 6e6c 793a 2062 6f6f 6c0a 2020  cr_only: bool.  
+000061c0: 2020 7669 6465 6f5f 6d6f 6465 733a 206c    video_modes: l
+000061d0: 6973 745b 5669 6465 6f4d 6f64 655d 0a20  ist[VideoMode]. 
+000061e0: 2020 2076 6964 656f 5f6d 6f64 655f 6d61     video_mode_ma
+000061f0: 785f 6670 733a 206c 6973 745b 696e 745d  x_fps: list[int]
+00006200: 0a20 2020 2068 6173 5f6d 6f74 696f 6e5f  .    has_motion_
+00006210: 7a6f 6e65 733a 2062 6f6f 6c0a 2020 2020  zones: bool.    
+00006220: 6861 735f 6c63 645f 7363 7265 656e 3a20  has_lcd_screen: 
+00006230: 626f 6f6c 0a20 2020 2073 6d61 7274 5f64  bool.    smart_d
+00006240: 6574 6563 745f 7479 7065 733a 206c 6973  etect_types: lis
+00006250: 745b 536d 6172 7444 6574 6563 744f 626a  t[SmartDetectObj
+00006260: 6563 7454 7970 655d 0a20 2020 206d 6f74  ectType].    mot
+00006270: 696f 6e5f 616c 676f 7269 7468 6d73 3a20  ion_algorithms: 
+00006280: 6c69 7374 5b4d 6f74 696f 6e41 6c67 6f72  list[MotionAlgor
+00006290: 6974 686d 5d0a 2020 2020 6861 735f 7371  ithm].    has_sq
+000062a0: 7561 7265 5f65 7665 6e74 5f74 6875 6d62  uare_event_thumb
+000062b0: 6e61 696c 3a20 626f 6f6c 0a20 2020 2068  nail: bool.    h
+000062c0: 6173 5f70 6163 6b61 6765 5f63 616d 6572  as_package_camer
+000062d0: 613a 2062 6f6f 6c0a 2020 2020 7072 6976  a: bool.    priv
+000062e0: 6163 795f 6d61 736b 5f63 6170 6162 696c  acy_mask_capabil
+000062f0: 6974 793a 2050 7269 7661 6379 4d61 736b  ity: PrivacyMask
+00006300: 4361 7061 6269 6c69 7479 0a20 2020 2068  Capability.    h
+00006310: 6173 5f73 6d61 7274 5f64 6574 6563 743a  as_smart_detect:
+00006320: 2062 6f6f 6c0a 2020 2020 6175 6469 6f3a   bool.    audio:
+00006330: 206c 6973 745b 7374 725d 203d 205b 5d0a   list[str] = [].
+00006340: 2020 2020 6175 6469 6f5f 636f 6465 6373      audio_codecs
+00006350: 3a20 6c69 7374 5b41 7564 696f 436f 6465  : list[AudioCode
+00006360: 6373 5d20 3d20 5b5d 0a20 2020 206d 6f75  cs] = [].    mou
+00006370: 6e74 5f70 6f73 6974 696f 6e73 3a20 6c69  nt_positions: li
+00006380: 7374 5b4d 6f75 6e74 506f 7369 7469 6f6e  st[MountPosition
+00006390: 5d20 3d20 5b5d 0a20 2020 2068 6173 5f69  ] = [].    has_i
+000063a0: 6e66 7261 7265 643a 204f 7074 696f 6e61  nfrared: Optiona
+000063b0: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 0a20  l[bool] = None. 
+000063c0: 2020 206c 656e 735f 7479 7065 3a20 4f70     lens_type: Op
+000063d0: 7469 6f6e 616c 5b4c 656e 7354 7970 655d  tional[LensType]
+000063e0: 203d 204e 6f6e 650a 2020 2020 686f 7470   = None.    hotp
+000063f0: 6c75 673a 204f 7074 696f 6e61 6c5b 486f  lug: Optional[Ho
+00006400: 7470 6c75 675d 203d 204e 6f6e 650a 2020  tplug] = None.  
+00006410: 2020 736d 6172 745f 6465 7465 6374 5f61    smart_detect_a
+00006420: 7564 696f 5f74 7970 6573 3a20 4f70 7469  udio_types: Opti
+00006430: 6f6e 616c 5b6c 6973 745b 536d 6172 7444  onal[list[SmartD
+00006440: 6574 6563 7441 7564 696f 5479 7065 5d5d  etectAudioType]]
+00006450: 203d 204e 6f6e 650a 2020 2020 2320 322e   = None.    # 2.
+00006460: 372e 3138 2b0a 2020 2020 6973 5f64 6f6f  7.18+.    is_doo
+00006470: 7262 656c 6c3a 2062 6f6f 6c0a 2020 2020  rbell: bool.    
+00006480: 2320 322e 382e 3232 2b0a 2020 2020 6c65  # 2.8.22+.    le
+00006490: 6e73 5f6d 6f64 656c 3a20 4f70 7469 6f6e  ns_model: Option
+000064a0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 0a20  al[str] = None. 
+000064b0: 2020 2023 2032 2e39 2e32 302b 0a20 2020     # 2.9.20+.   
+000064c0: 2068 6173 5f63 6f6c 6f72 5f6c 6364 5f73   has_color_lcd_s
+000064d0: 6372 6565 6e3a 204f 7074 696f 6e61 6c5b  creen: Optional[
+000064e0: 626f 6f6c 5d20 3d20 4e6f 6e65 0a20 2020  bool] = None.   
+000064f0: 2068 6173 5f6c 696e 655f 6372 6f73 7369   has_line_crossi
+00006500: 6e67 3a20 4f70 7469 6f6e 616c 5b62 6f6f  ng: Optional[boo
+00006510: 6c5d 203d 204e 6f6e 650a 2020 2020 6861  l] = None.    ha
+00006520: 735f 6c69 6e65 5f63 726f 7373 696e 675f  s_line_crossing_
+00006530: 636f 756e 7469 6e67 3a20 4f70 7469 6f6e  counting: Option
+00006540: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 650a  al[bool] = None.
+00006550: 2020 2020 6861 735f 6c69 7665 7669 6577      has_liveview
+00006560: 5f74 7261 636b 696e 673a 204f 7074 696f  _tracking: Optio
+00006570: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+00006580: 0a20 2020 2023 2032 2e31 302e 3130 2b0a  .    # 2.10.10+.
+00006590: 2020 2020 6861 735f 666c 6173 683a 204f      has_flash: O
+000065a0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+000065b0: 4e6f 6e65 0a20 2020 2069 735f 7074 7a3a  None.    is_ptz:
+000065c0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+000065d0: 3d20 4e6f 6e65 0a20 2020 2023 2032 2e31  = None.    # 2.1
+000065e0: 312e 3133 2b0a 2020 2020 6175 6469 6f5f  1.13+.    audio_
+000065f0: 7374 796c 653a 204f 7074 696f 6e61 6c5b  style: Optional[
+00006600: 6c69 7374 5b41 7564 696f 5374 796c 655d  list[AudioStyle]
+00006610: 5d20 3d20 4e6f 6e65 0a20 2020 2068 6173  ] = None.    has
+00006620: 5f76 6572 7469 6361 6c5f 666c 6970 3a20  _vertical_flip: 
+00006630: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00006640: 204e 6f6e 650a 2020 2020 2320 332e 302e   None.    # 3.0.
+00006650: 3232 2b0a 2020 2020 666c 6173 685f 7261  22+.    flash_ra
+00006660: 6e67 653a 204f 7074 696f 6e61 6c5b 416e  nge: Optional[An
+00006670: 795d 203d 204e 6f6e 650a 2020 2020 2320  y] = None.    # 
+00006680: 342e 302e 372b 0a20 2020 2076 6964 656f  4.0.7+.    video
+00006690: 5f63 6f64 6563 733a 204f 7074 696f 6e61  _codecs: Optiona
+000066a0: 6c5b 6c69 7374 5b73 7472 5d5d 203d 204e  l[list[str]] = N
+000066b0: 6f6e 650a 2020 2020 7375 7070 6f72 745f  one.    support_
+000066c0: 646f 6f72 5f61 6363 6573 735f 636f 6e66  door_access_conf
+000066d0: 6967 3a20 4f70 7469 6f6e 616c 5b62 6f6f  ig: Optional[boo
+000066e0: 6c5d 203d 204e 6f6e 650a 2020 2020 7072  l] = None.    pr
+000066f0: 6573 6574 5f74 6f75 723a 204f 7074 696f  eset_tour: Optio
+00006700: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+00006710: 0a20 2020 206d 6178 5f73 6361 6c65 5f64  .    max_scale_d
+00006720: 6f77 6e5f 6c65 7665 6c3a 204f 7074 696f  own_level: Optio
+00006730: 6e61 6c5b 416e 795d 203d 204e 6f6e 650a  nal[Any] = None.
+00006740: 2020 2020 6861 735f 6c75 785f 6368 6563      has_lux_chec
+00006750: 6b3a 204f 7074 696f 6e61 6c5b 626f 6f6c  k: Optional[bool
+00006760: 5d20 3d20 4e6f 6e65 0a0a 2020 2020 666f  ] = None..    fo
+00006770: 6375 733a 2050 545a 5261 6e67 650a 2020  cus: PTZRange.  
+00006780: 2020 7061 6e3a 2050 545a 5261 6e67 650a    pan: PTZRange.
+00006790: 2020 2020 7469 6c74 3a20 5054 5a52 616e      tilt: PTZRan
+000067a0: 6765 0a20 2020 207a 6f6f 6d3a 2050 545a  ge.    zoom: PTZ
+000067b0: 5a6f 6f6d 5261 6e67 650a 0a20 2020 2040  ZoomRange..    @
+000067c0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+000067d0: 6465 6620 756e 6966 695f 6469 6374 5f74  def unifi_dict_t
+000067e0: 6f5f 6469 6374 2863 6c73 2c20 6461 7461  o_dict(cls, data
+000067f0: 3a20 6469 6374 5b73 7472 2c20 416e 795d  : dict[str, Any]
+00006800: 2920 2d3e 2064 6963 745b 7374 722c 2041  ) -> dict[str, A
+00006810: 6e79 5d3a 0a20 2020 2020 2020 2069 6620  ny]:.        if 
+00006820: 2273 6d61 7274 4465 7465 6374 5479 7065  "smartDetectType
+00006830: 7322 2069 6e20 6461 7461 3a0a 2020 2020  s" in data:.    
+00006840: 2020 2020 2020 2020 6461 7461 5b22 736d          data["sm
+00006850: 6172 7444 6574 6563 7454 7970 6573 225d  artDetectTypes"]
+00006860: 203d 2063 6f6e 7665 7274 5f73 6d61 7274   = convert_smart
+00006870: 5f74 7970 6573 2864 6174 612e 706f 7028  _types(data.pop(
+00006880: 2273 6d61 7274 4465 7465 6374 5479 7065  "smartDetectType
+00006890: 7322 2929 0a20 2020 2020 2020 2069 6620  s")).        if 
+000068a0: 2273 6d61 7274 4465 7465 6374 4175 6469  "smartDetectAudi
+000068b0: 6f54 7970 6573 2220 696e 2064 6174 613a  oTypes" in data:
+000068c0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+000068d0: 615b 2273 6d61 7274 4465 7465 6374 4175  a["smartDetectAu
+000068e0: 6469 6f54 7970 6573 225d 203d 2063 6f6e  dioTypes"] = con
+000068f0: 7665 7274 5f73 6d61 7274 5f61 7564 696f  vert_smart_audio
+00006900: 5f74 7970 6573 280a 2020 2020 2020 2020  _types(.        
+00006910: 2020 2020 2020 2020 6461 7461 2e70 6f70          data.pop
+00006920: 2822 736d 6172 7444 6574 6563 7441 7564  ("smartDetectAud
+00006930: 696f 5479 7065 7322 292c 0a20 2020 2020  ioTypes"),.     
+00006940: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00006950: 2069 6620 2276 6964 656f 4d6f 6465 7322   if "videoModes"
+00006960: 2069 6e20 6461 7461 3a0a 2020 2020 2020   in data:.      
+00006970: 2020 2020 2020 6461 7461 5b22 7669 6465        data["vide
+00006980: 6f4d 6f64 6573 225d 203d 2063 6f6e 7665  oModes"] = conve
+00006990: 7274 5f76 6964 656f 5f6d 6f64 6573 2864  rt_video_modes(d
+000069a0: 6174 612e 706f 7028 2276 6964 656f 4d6f  ata.pop("videoMo
+000069b0: 6465 7322 2929 0a0a 2020 2020 2020 2020  des"))..        
+000069c0: 2320 6261 636b 706f 7274 2073 7570 706f  # backport suppo
+000069d0: 7274 2066 6f72 2060 6973 5f64 6f6f 7262  rt for `is_doorb
+000069e0: 656c 6c60 2074 6f20 6f6c 6465 7220 7665  ell` to older ve
+000069f0: 7273 696f 6e73 206f 6620 5072 6f74 6563  rsions of Protec
+00006a00: 740a 2020 2020 2020 2020 6966 2022 6861  t.        if "ha
+00006a10: 7343 6869 6d65 2220 696e 2064 6174 6120  sChime" in data 
+00006a20: 616e 6420 2269 7344 6f6f 7262 656c 6c22  and "isDoorbell"
+00006a30: 206e 6f74 2069 6e20 6461 7461 3a0a 2020   not in data:.  
+00006a40: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
+00006a50: 6973 446f 6f72 6265 6c6c 225d 203d 2064  isDoorbell"] = d
+00006a60: 6174 615b 2268 6173 4368 696d 6522 5d0a  ata["hasChime"].
+00006a70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006a80: 7375 7065 7228 292e 756e 6966 695f 6469  super().unifi_di
+00006a90: 6374 5f74 6f5f 6469 6374 2864 6174 6129  ct_to_dict(data)
+00006aa0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00006ab0: 6f64 0a20 2020 2040 6361 6368 650a 2020  od.    @cache.  
+00006ac0: 2020 6465 6620 5f67 6574 5f75 6e69 6669    def _get_unifi
+00006ad0: 5f72 656d 6170 7328 636c 7329 202d 3e20  _remaps(cls) -> 
+00006ae0: 6469 6374 5b73 7472 2c20 7374 725d 3a0a  dict[str, str]:.
+00006af0: 2020 2020 2020 2020 7265 7475 726e 207b          return {
+00006b00: 2a2a 7375 7065 7228 292e 5f67 6574 5f75  **super()._get_u
+00006b10: 6e69 6669 5f72 656d 6170 7328 292c 2022  nifi_remaps(), "
+00006b20: 6861 7341 7574 6f49 4352 4f6e 6c79 223a  hasAutoICROnly":
+00006b30: 2022 6861 7341 7574 6f49 6372 4f6e 6c79   "hasAutoIcrOnly
+00006b40: 227d 0a0a 2020 2020 4070 726f 7065 7274  "}..    @propert
+00006b50: 790a 2020 2020 6465 6620 6861 735f 6869  y.    def has_hi
+00006b60: 6768 6670 7328 7365 6c66 2920 2d3e 2062  ghfps(self) -> b
+00006b70: 6f6f 6c3a 0a20 2020 2020 2020 2072 6574  ool:.        ret
+00006b80: 7572 6e20 5669 6465 6f4d 6f64 652e 4849  urn VideoMode.HI
+00006b90: 4748 5f46 5053 2069 6e20 7365 6c66 2e76  GH_FPS in self.v
+00006ba0: 6964 656f 5f6d 6f64 6573 0a0a 2020 2020  ideo_modes..    
+00006bb0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00006bc0: 6620 6861 735f 7764 7228 7365 6c66 2920  f has_wdr(self) 
+00006bd0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+00006be0: 2072 6574 7572 6e20 6e6f 7420 7365 6c66   return not self
+00006bf0: 2e68 6173 5f68 6472 0a0a 0a63 6c61 7373  .has_hdr...class
+00006c00: 2043 616d 6572 614c 656e 7365 7328 5072   CameraLenses(Pr
+00006c10: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
+00006c20: 3a0a 2020 2020 6964 3a20 696e 740a 2020  :.    id: int.  
+00006c30: 2020 7669 6465 6f3a 2056 6964 656f 5374    video: VideoSt
+00006c40: 6174 730a 0a0a 636c 6173 7320 4361 6d65  ats...class Came
+00006c50: 7261 486f 6d65 6b69 7453 6574 7469 6e67  raHomekitSetting
+00006c60: 7328 5072 6f74 6563 7442 6173 654f 626a  s(ProtectBaseObj
+00006c70: 6563 7429 3a0a 2020 2020 6d69 6372 6f70  ect):.    microp
+00006c80: 686f 6e65 5f6d 7574 6564 3a20 626f 6f6c  hone_muted: bool
+00006c90: 0a20 2020 2073 7065 616b 6572 5f6d 7574  .    speaker_mut
+00006ca0: 6564 3a20 626f 6f6c 0a20 2020 2073 7472  ed: bool.    str
+00006cb0: 6561 6d5f 696e 5f70 726f 6772 6573 733a  eam_in_progress:
+00006cc0: 2062 6f6f 6c0a 2020 2020 7461 6c6b 6261   bool.    talkba
+00006cd0: 636b 5f73 6574 7469 6e67 735f 6163 7469  ck_settings_acti
+00006ce0: 7665 3a20 626f 6f6c 0a0a 0a63 6c61 7373  ve: bool...class
+00006cf0: 2043 616d 6572 6141 7564 696f 5365 7474   CameraAudioSett
+00006d00: 696e 6773 2850 726f 7465 6374 4261 7365  ings(ProtectBase
+00006d10: 4f62 6a65 6374 293a 0a20 2020 2073 7479  Object):.    sty
+00006d20: 6c65 3a20 6c69 7374 5b41 7564 696f 5374  le: list[AudioSt
+00006d30: 796c 655d 0a0a 0a63 6c61 7373 2043 616d  yle]...class Cam
+00006d40: 6572 6154 696c 744c 696d 6974 7328 5072  eraTiltLimits(Pr
+00006d50: 6f74 6563 7442 6173 654f 626a 6563 7429  otectBaseObject)
+00006d60: 3a0a 2020 2020 6c69 6d69 743a 2069 6e74  :.    limit: int
+00006d70: 0a20 2020 2073 6964 653a 2073 7472 0a0a  .    side: str..
+00006d80: 0a63 6c61 7373 2043 616d 6572 6128 5072  .class Camera(Pr
+00006d90: 6f74 6563 744d 6f74 696f 6e44 6576 6963  otectMotionDevic
+00006da0: 654d 6f64 656c 293a 0a20 2020 2069 735f  eModel):.    is_
+00006db0: 6465 6c65 7469 6e67 3a20 626f 6f6c 0a20  deleting: bool. 
+00006dc0: 2020 2023 204d 6963 726f 7068 6f6e 6520     # Microphone 
+00006dd0: 5365 6e73 6974 6976 6974 790a 2020 2020  Sensitivity.    
+00006de0: 6d69 635f 766f 6c75 6d65 3a20 5065 7263  mic_volume: Perc
+00006df0: 656e 7449 6e74 0a20 2020 2069 735f 6d69  entInt.    is_mi
+00006e00: 635f 656e 6162 6c65 643a 2062 6f6f 6c0a  c_enabled: bool.
+00006e10: 2020 2020 6973 5f72 6563 6f72 6469 6e67      is_recording
+00006e20: 3a20 626f 6f6c 0a20 2020 2069 735f 6d6f  : bool.    is_mo
+00006e30: 7469 6f6e 5f64 6574 6563 7465 643a 2062  tion_detected: b
+00006e40: 6f6f 6c0a 2020 2020 6973 5f73 6d61 7274  ool.    is_smart
+00006e50: 5f64 6574 6563 7465 643a 2062 6f6f 6c0a  _detected: bool.
+00006e60: 2020 2020 7068 795f 7261 7465 3a20 4f70      phy_rate: Op
+00006e70: 7469 6f6e 616c 5b66 6c6f 6174 5d0a 2020  tional[float].  
+00006e80: 2020 6864 725f 6d6f 6465 3a20 626f 6f6c    hdr_mode: bool
+00006e90: 0a20 2020 2023 2052 6563 6f72 6469 6e67  .    # Recording
+00006ea0: 2051 7561 6c69 7479 202d 3e20 4869 6768   Quality -> High
+00006eb0: 2046 7261 6d65 0a20 2020 2076 6964 656f   Frame.    video
+00006ec0: 5f6d 6f64 653a 2056 6964 656f 4d6f 6465  _mode: VideoMode
+00006ed0: 0a20 2020 2069 735f 7072 6f62 696e 675f  .    is_probing_
+00006ee0: 666f 725f 7769 6669 3a20 626f 6f6c 0a20  for_wifi: bool. 
+00006ef0: 2020 2063 6869 6d65 5f64 7572 6174 696f     chime_duratio
+00006f00: 6e3a 2074 696d 6564 656c 7461 0a20 2020  n: timedelta.   
+00006f10: 206c 6173 745f 7269 6e67 3a20 4f70 7469   last_ring: Opti
+00006f20: 6f6e 616c 5b64 6174 6574 696d 655d 0a20  onal[datetime]. 
+00006f30: 2020 2069 735f 6c69 7665 5f68 6561 746d     is_live_heatm
+00006f40: 6170 5f65 6e61 626c 6564 3a20 626f 6f6c  ap_enabled: bool
+00006f50: 0a20 2020 2076 6964 656f 5f72 6563 6f6e  .    video_recon
+00006f60: 6669 6775 7261 7469 6f6e 5f69 6e5f 7072  figuration_in_pr
+00006f70: 6f67 7265 7373 3a20 626f 6f6c 0a20 2020  ogress: bool.   
+00006f80: 2063 6861 6e6e 656c 733a 206c 6973 745b   channels: list[
+00006f90: 4361 6d65 7261 4368 616e 6e65 6c5d 0a20  CameraChannel]. 
+00006fa0: 2020 2069 7370 5f73 6574 7469 6e67 733a     isp_settings:
+00006fb0: 2049 5350 5365 7474 696e 6773 0a20 2020   ISPSettings.   
+00006fc0: 2074 616c 6b62 6163 6b5f 7365 7474 696e   talkback_settin
+00006fd0: 6773 3a20 5461 6c6b 6261 636b 5365 7474  gs: TalkbackSett
+00006fe0: 696e 6773 0a20 2020 206f 7364 5f73 6574  ings.    osd_set
+00006ff0: 7469 6e67 733a 204f 5344 5365 7474 696e  tings: OSDSettin
+00007000: 6773 0a20 2020 206c 6564 5f73 6574 7469  gs.    led_setti
+00007010: 6e67 733a 204c 4544 5365 7474 696e 6773  ngs: LEDSettings
+00007020: 0a20 2020 2073 7065 616b 6572 5f73 6574  .    speaker_set
+00007030: 7469 6e67 733a 2053 7065 616b 6572 5365  tings: SpeakerSe
+00007040: 7474 696e 6773 0a20 2020 2072 6563 6f72  ttings.    recor
+00007050: 6469 6e67 5f73 6574 7469 6e67 733a 2052  ding_settings: R
+00007060: 6563 6f72 6469 6e67 5365 7474 696e 6773  ecordingSettings
+00007070: 0a20 2020 2073 6d61 7274 5f64 6574 6563  .    smart_detec
+00007080: 745f 7365 7474 696e 6773 3a20 536d 6172  t_settings: Smar
+00007090: 7444 6574 6563 7453 6574 7469 6e67 730a  tDetectSettings.
+000070a0: 2020 2020 6d6f 7469 6f6e 5f7a 6f6e 6573      motion_zones
+000070b0: 3a20 6c69 7374 5b4d 6f74 696f 6e5a 6f6e  : list[MotionZon
+000070c0: 655d 0a20 2020 2070 7269 7661 6379 5f7a  e].    privacy_z
+000070d0: 6f6e 6573 3a20 6c69 7374 5b43 616d 6572  ones: list[Camer
+000070e0: 615a 6f6e 655d 0a20 2020 2073 6d61 7274  aZone].    smart
+000070f0: 5f64 6574 6563 745f 7a6f 6e65 733a 206c  _detect_zones: l
+00007100: 6973 745b 536d 6172 744d 6f74 696f 6e5a  ist[SmartMotionZ
+00007110: 6f6e 655d 0a20 2020 2073 7461 7473 3a20  one].    stats: 
+00007120: 4361 6d65 7261 5374 6174 730a 2020 2020  CameraStats.    
+00007130: 6665 6174 7572 655f 666c 6167 733a 2043  feature_flags: C
+00007140: 616d 6572 6146 6561 7475 7265 466c 6167  ameraFeatureFlag
+00007150: 730a 2020 2020 6c63 645f 6d65 7373 6167  s.    lcd_messag
+00007160: 653a 204f 7074 696f 6e61 6c5b 4c43 444d  e: Optional[LCDM
+00007170: 6573 7361 6765 5d0a 2020 2020 6c65 6e73  essage].    lens
+00007180: 6573 3a20 6c69 7374 5b43 616d 6572 614c  es: list[CameraL
+00007190: 656e 7365 735d 0a20 2020 2070 6c61 7466  enses].    platf
+000071a0: 6f72 6d3a 2073 7472 0a20 2020 2068 6173  orm: str.    has
+000071b0: 5f73 7065 616b 6572 3a20 626f 6f6c 0a20  _speaker: bool. 
+000071c0: 2020 2068 6173 5f77 6966 693a 2062 6f6f     has_wifi: boo
+000071d0: 6c0a 2020 2020 6175 6469 6f5f 6269 7472  l.    audio_bitr
+000071e0: 6174 653a 2069 6e74 0a20 2020 2063 616e  ate: int.    can
+000071f0: 5f6d 616e 6167 653a 2062 6f6f 6c0a 2020  _manage: bool.  
+00007200: 2020 6973 5f6d 616e 6167 6564 3a20 626f    is_managed: bo
+00007210: 6f6c 0a20 2020 2076 6f6c 7461 6765 3a20  ol.    voltage: 
+00007220: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d0a  Optional[float].
+00007230: 2020 2020 2320 7265 7175 6972 6573 2031      # requires 1
+00007240: 2e32 312b 0a20 2020 2069 735f 706f 6f72  .21+.    is_poor
+00007250: 5f6e 6574 776f 726b 3a20 4f70 7469 6f6e  _network: Option
+00007260: 616c 5b62 6f6f 6c5d 0a20 2020 2069 735f  al[bool].    is_
+00007270: 7769 7265 6c65 7373 5f75 706c 696e 6b5f  wireless_uplink_
+00007280: 656e 6162 6c65 643a 204f 7074 696f 6e61  enabled: Optiona
+00007290: 6c5b 626f 6f6c 5d0a 2020 2020 2320 7265  l[bool].    # re
+000072a0: 7175 6972 6573 2032 2e36 2e31 332b 0a20  quires 2.6.13+. 
+000072b0: 2020 2068 6f6d 656b 6974 5f73 6574 7469     homekit_setti
+000072c0: 6e67 733a 204f 7074 696f 6e61 6c5b 4361  ngs: Optional[Ca
+000072d0: 6d65 7261 486f 6d65 6b69 7453 6574 7469  meraHomekitSetti
+000072e0: 6e67 735d 203d 204e 6f6e 650a 2020 2020  ngs] = None.    
+000072f0: 2320 7265 7175 6972 6573 2032 2e36 2e31  # requires 2.6.1
+00007300: 372b 0a20 2020 2061 705f 6d67 6d74 5f69  7+.    ap_mgmt_i
+00007310: 703a 204f 7074 696f 6e61 6c5b 4950 7634  p: Optional[IPv4
+00007320: 4164 6472 6573 735d 203d 204e 6f6e 650a  Address] = None.
+00007330: 2020 2020 2320 7265 7175 6972 6573 2032      # requires 2
+00007340: 2e37 2e35 2b0a 2020 2020 6973 5f77 6174  .7.5+.    is_wat
+00007350: 6572 7072 6f6f 665f 6361 7365 5f61 7474  erproof_case_att
+00007360: 6163 6865 643a 204f 7074 696f 6e61 6c5b  ached: Optional[
+00007370: 626f 6f6c 5d20 3d20 4e6f 6e65 0a20 2020  bool] = None.   
+00007380: 206c 6173 745f 6469 7363 6f6e 6e65 6374   last_disconnect
+00007390: 3a20 4f70 7469 6f6e 616c 5b64 6174 6574  : Optional[datet
+000073a0: 696d 655d 203d 204e 6f6e 650a 2020 2020  ime] = None.    
+000073b0: 2320 7265 7175 6972 6573 2032 2e38 2e31  # requires 2.8.1
+000073c0: 342b 0a20 2020 2069 735f 326b 3a20 4f70  4+.    is_2k: Op
+000073d0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+000073e0: 6f6e 650a 2020 2020 6973 5f34 6b3a 204f  one.    is_4k: O
+000073f0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+00007400: 4e6f 6e65 0a20 2020 2075 7365 5f67 6c6f  None.    use_glo
+00007410: 6261 6c3a 204f 7074 696f 6e61 6c5b 626f  bal: Optional[bo
+00007420: 6f6c 5d20 3d20 4e6f 6e65 0a20 2020 2023  ol] = None.    #
+00007430: 2072 6571 7569 7265 7320 322e 382e 3232   requires 2.8.22
+00007440: 2b0a 2020 2020 7573 6572 5f63 6f6e 6669  +.    user_confi
+00007450: 6775 7265 645f 6170 3a20 4f70 7469 6f6e  gured_ap: Option
+00007460: 616c 5b62 6f6f 6c5d 203d 204e 6f6e 650a  al[bool] = None.
+00007470: 2020 2020 2320 7265 7175 6972 6573 2032      # requires 2
+00007480: 2e39 2e32 302b 0a20 2020 2068 6173 5f72  .9.20+.    has_r
+00007490: 6563 6f72 6469 6e67 733a 204f 7074 696f  ecordings: Optio
+000074a0: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+000074b0: 0a20 2020 2023 2072 6571 7569 7265 7320  .    # requires 
+000074c0: 322e 3130 2e31 302b 0a20 2020 2069 735f  2.10.10+.    is_
+000074d0: 7074 7a3a 204f 7074 696f 6e61 6c5b 626f  ptz: Optional[bo
+000074e0: 6f6c 5d20 3d20 4e6f 6e65 0a20 2020 2023  ol] = None.    #
+000074f0: 2072 6571 7569 7265 7320 322e 3131 2e31   requires 2.11.1
+00007500: 332b 0a20 2020 2061 7564 696f 5f73 6574  3+.    audio_set
+00007510: 7469 6e67 733a 204f 7074 696f 6e61 6c5b  tings: Optional[
+00007520: 4361 6d65 7261 4175 6469 6f53 6574 7469  CameraAudioSetti
+00007530: 6e67 735d 203d 204e 6f6e 650a 2020 2020  ngs] = None.    
+00007540: 2320 7265 7175 6972 6573 2034 2e30 2e31  # requires 4.0.1
+00007550: 392b 0a20 2020 2076 6964 656f 5f63 6f64  9+.    video_cod
+00007560: 6563 3a20 4f70 7469 6f6e 616c 5b73 7472  ec: Optional[str
+00007570: 5d20 3d20 4e6f 6e65 0a20 2020 2076 6964  ] = None.    vid
+00007580: 656f 5f63 6f64 6563 5f73 7461 7465 3a20  eo_codec_state: 
+00007590: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
+000075a0: 4e6f 6e65 0a20 2020 2069 735f 6578 7465  None.    is_exte
+000075b0: 6e64 6572 5f69 6e73 7461 6c6c 6564 5f65  nder_installed_e
+000075c0: 7665 723a 204f 7074 696f 6e61 6c5b 626f  ver: Optional[bo
+000075d0: 6f6c 5d20 3d20 4e6f 6e65 0a20 2020 2063  ol] = None.    c
+000075e0: 7572 7265 6e74 5f72 6573 6f6c 7574 696f  urrent_resolutio
+000075f0: 6e3a 204f 7074 696f 6e61 6c5b 7374 725d  n: Optional[str]
+00007600: 203d 204e 6f6e 650a 2020 2020 646f 776e   = None.    down
+00007610: 5f73 6361 6c65 5f6d 6f64 653a 204f 7074  _scale_mode: Opt
+00007620: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
+00007630: 650a 2020 2020 6163 7469 7665 5f70 6174  e.    active_pat
+00007640: 726f 6c5f 736c 6f74 3a20 4f70 7469 6f6e  rol_slot: Option
+00007650: 616c 5b41 6e79 5d20 3d20 4e6f 6e65 0a20  al[Any] = None. 
+00007660: 2020 2074 696c 745f 6c69 6d69 7473 5f6f     tilt_limits_o
+00007670: 665f 7072 6976 6163 795f 7a6f 6e65 733a  f_privacy_zones:
+00007680: 204f 7074 696f 6e61 6c5b 4361 6d65 7261   Optional[Camera
+00007690: 5469 6c74 4c69 6d69 7473 5d20 3d20 4e6f  TiltLimits] = No
+000076a0: 6e65 0a0a 2020 2020 2320 544f 444f 3a20  ne..    # TODO: 
+000076b0: 7573 6564 2066 6f72 2061 646f 7074 696e  used for adoptin
+000076c0: 670a 2020 2020 2320 6170 4d61 6320 7265  g.    # apMac re
+000076d0: 6164 206f 6e6c 790a 2020 2020 2320 6170  ad only.    # ap
+000076e0: 5273 7369 2072 6561 6420 6f6e 6c79 0a20  Rssi read only. 
+000076f0: 2020 2023 2065 6c65 6d65 6e74 496e 666f     # elementInfo
+00007700: 2072 6561 6420 6f6e 6c79 0a0a 2020 2020   read only..    
+00007710: 2320 544f 444f 3a0a 2020 2020 2320 6c61  # TODO:.    # la
+00007720: 7374 5072 6976 6163 795a 6f6e 6550 6f73  stPrivacyZonePos
+00007730: 6974 696f 6e49 640a 2020 2020 2320 736d  itionId.    # sm
+00007740: 6172 7444 6574 6563 744c 696e 6573 0a20  artDetectLines. 
+00007750: 2020 2023 2073 7472 6561 6d53 6861 7269     # streamShari
+00007760: 6e67 2072 6561 6420 6f6e 6c79 0a20 2020  ng read only.   
+00007770: 2023 2073 746f 7053 7472 6561 6d4c 6576   # stopStreamLev
+00007780: 656c 0a20 2020 2023 2075 706c 696e 6b44  el.    # uplinkD
+00007790: 6576 6963 650a 2020 2020 2320 7265 636f  evice.    # reco
+000077a0: 7264 696e 6753 6368 6564 756c 6573 5632  rdingSchedulesV2
+000077b0: 0a20 2020 2023 2073 7570 706f 7274 6564  .    # supported
+000077c0: 5363 616c 696e 6752 6573 6f6c 7574 696f  ScalingResolutio
+000077d0: 6e73 0a20 2020 2023 2073 686f 7274 6375  ns.    # shortcu
+000077e0: 7473 0a20 2020 2023 2068 7562 4d61 630a  ts.    # hubMac.
+000077f0: 2020 2020 2320 616c 6172 6d73 0a0a 2020      # alarms..  
+00007800: 2020 2320 6e6f 7420 6469 7265 6374 6c79    # not directly
+00007810: 2066 726f 6d20 556e 6946 690a 2020 2020   from UniFi.    
+00007820: 6c61 7374 5f72 696e 675f 6576 656e 745f  last_ring_event_
+00007830: 6964 3a20 4f70 7469 6f6e 616c 5b73 7472  id: Optional[str
+00007840: 5d20 3d20 4e6f 6e65 0a20 2020 206c 6173  ] = None.    las
+00007850: 745f 736d 6172 745f 6465 7465 6374 3a20  t_smart_detect: 
+00007860: 4f70 7469 6f6e 616c 5b64 6174 6574 696d  Optional[datetim
+00007870: 655d 203d 204e 6f6e 650a 2020 2020 6c61  e] = None.    la
+00007880: 7374 5f73 6d61 7274 5f61 7564 696f 5f64  st_smart_audio_d
+00007890: 6574 6563 743a 204f 7074 696f 6e61 6c5b  etect: Optional[
+000078a0: 6461 7465 7469 6d65 5d20 3d20 4e6f 6e65  datetime] = None
+000078b0: 0a20 2020 206c 6173 745f 736d 6172 745f  .    last_smart_
+000078c0: 6465 7465 6374 5f65 7665 6e74 5f69 643a  detect_event_id:
+000078d0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+000078e0: 204e 6f6e 650a 2020 2020 6c61 7374 5f73   None.    last_s
+000078f0: 6d61 7274 5f61 7564 696f 5f64 6574 6563  mart_audio_detec
+00007900: 745f 6576 656e 745f 6964 3a20 4f70 7469  t_event_id: Opti
+00007910: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+00007920: 0a20 2020 206c 6173 745f 736d 6172 745f  .    last_smart_
+00007930: 6465 7465 6374 733a 2064 6963 745b 536d  detects: dict[Sm
+00007940: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
+00007950: 7970 652c 2064 6174 6574 696d 655d 203d  ype, datetime] =
+00007960: 207b 7d0a 2020 2020 6c61 7374 5f73 6d61   {}.    last_sma
+00007970: 7274 5f61 7564 696f 5f64 6574 6563 7473  rt_audio_detects
+00007980: 3a20 6469 6374 5b53 6d61 7274 4465 7465  : dict[SmartDete
+00007990: 6374 4175 6469 6f54 7970 652c 2064 6174  ctAudioType, dat
+000079a0: 6574 696d 655d 203d 207b 7d0a 2020 2020  etime] = {}.    
+000079b0: 6c61 7374 5f73 6d61 7274 5f64 6574 6563  last_smart_detec
+000079c0: 745f 6576 656e 745f 6964 733a 2064 6963  t_event_ids: dic
+000079d0: 745b 536d 6172 7444 6574 6563 744f 626a  t[SmartDetectObj
+000079e0: 6563 7454 7970 652c 2073 7472 5d20 3d20  ectType, str] = 
+000079f0: 7b7d 0a20 2020 206c 6173 745f 736d 6172  {}.    last_smar
+00007a00: 745f 6175 6469 6f5f 6465 7465 6374 5f65  t_audio_detect_e
+00007a10: 7665 6e74 5f69 6473 3a20 6469 6374 5b53  vent_ids: dict[S
+00007a20: 6d61 7274 4465 7465 6374 4175 6469 6f54  martDetectAudioT
+00007a30: 7970 652c 2073 7472 5d20 3d20 7b7d 0a20  ype, str] = {}. 
+00007a40: 2020 2074 616c 6b62 6163 6b5f 7374 7265     talkback_stre
+00007a50: 616d 3a20 4f70 7469 6f6e 616c 5b54 616c  am: Optional[Tal
+00007a60: 6b62 6163 6b53 7472 6561 6d5d 203d 204e  kbackStream] = N
+00007a70: 6f6e 650a 2020 2020 5f6c 6173 745f 7269  one.    _last_ri
+00007a80: 6e67 5f74 696d 656f 7574 3a20 4f70 7469  ng_timeout: Opti
+00007a90: 6f6e 616c 5b64 6174 6574 696d 655d 203d  onal[datetime] =
+00007aa0: 2050 7269 7661 7465 4174 7472 284e 6f6e   PrivateAttr(Non
+00007ab0: 6529 0a0a 2020 2020 4063 6c61 7373 6d65  e)..    @classme
+00007ac0: 7468 6f64 0a20 2020 2040 6361 6368 650a  thod.    @cache.
+00007ad0: 2020 2020 6465 6620 5f67 6574 5f75 6e69      def _get_uni
+00007ae0: 6669 5f72 656d 6170 7328 636c 7329 202d  fi_remaps(cls) -
+00007af0: 3e20 6469 6374 5b73 7472 2c20 7374 725d  > dict[str, str]
+00007b00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00007b10: 207b 2a2a 7375 7065 7228 292e 5f67 6574   {**super()._get
+00007b20: 5f75 6e69 6669 5f72 656d 6170 7328 292c  _unifi_remaps(),
+00007b30: 2022 6973 324b 223a 2022 6973 326b 222c   "is2K": "is2k",
+00007b40: 2022 6973 344b 223a 2022 6973 346b 227d   "is4K": "is4k"}
+00007b50: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00007b60: 6f64 0a20 2020 2040 6361 6368 650a 2020  od.    @cache.  
+00007b70: 2020 6465 6620 5f67 6574 5f65 7863 6c75    def _get_exclu
+00007b80: 6465 645f 6368 616e 6765 645f 6669 656c  ded_changed_fiel
+00007b90: 6473 2863 6c73 2920 2d3e 2073 6574 5b73  ds(cls) -> set[s
+00007ba0: 7472 5d3a 0a20 2020 2020 2020 2072 6574  tr]:.        ret
+00007bb0: 7572 6e20 7375 7065 7228 292e 5f67 6574  urn super()._get
+00007bc0: 5f65 7863 6c75 6465 645f 6368 616e 6765  _excluded_change
+00007bd0: 645f 6669 656c 6473 2829 207c 207b 0a20  d_fields() | {. 
+00007be0: 2020 2020 2020 2020 2020 2022 6c61 7374             "last
+00007bf0: 5f72 696e 675f 6576 656e 745f 6964 222c  _ring_event_id",
+00007c00: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
+00007c10: 7374 5f73 6d61 7274 5f64 6574 6563 7422  st_smart_detect"
+00007c20: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00007c30: 6173 745f 736d 6172 745f 6175 6469 6f5f  ast_smart_audio_
+00007c40: 6465 7465 6374 222c 0a20 2020 2020 2020  detect",.       
+00007c50: 2020 2020 2022 6c61 7374 5f73 6d61 7274       "last_smart
+00007c60: 5f64 6574 6563 745f 6576 656e 745f 6964  _detect_event_id
+00007c70: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00007c80: 6c61 7374 5f73 6d61 7274 5f61 7564 696f  last_smart_audio
+00007c90: 5f64 6574 6563 745f 6576 656e 745f 6964  _detect_event_id
+00007ca0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00007cb0: 6c61 7374 5f73 6d61 7274 5f64 6574 6563  last_smart_detec
+00007cc0: 7473 222c 0a20 2020 2020 2020 2020 2020  ts",.           
+00007cd0: 2022 6c61 7374 5f73 6d61 7274 5f61 7564   "last_smart_aud
+00007ce0: 696f 5f64 6574 6563 7473 222c 0a20 2020  io_detects",.   
+00007cf0: 2020 2020 2020 2020 2022 6c61 7374 5f73           "last_s
+00007d00: 6d61 7274 5f64 6574 6563 745f 6576 656e  mart_detect_even
+00007d10: 745f 6964 7322 2c0a 2020 2020 2020 2020  t_ids",.        
+00007d20: 2020 2020 226c 6173 745f 736d 6172 745f      "last_smart_
+00007d30: 6175 6469 6f5f 6465 7465 6374 5f65 7665  audio_detect_eve
+00007d40: 6e74 5f69 6473 222c 0a20 2020 2020 2020  nt_ids",.       
+00007d50: 2020 2020 2022 7461 6c6b 6261 636b 5f73       "talkback_s
+00007d60: 7472 6561 6d22 2c0a 2020 2020 2020 2020  tream",.        
+00007d70: 7d0a 0a20 2020 2040 636c 6173 736d 6574  }..    @classmet
+00007d80: 686f 640a 2020 2020 4063 6163 6865 0a20  hod.    @cache. 
+00007d90: 2020 2064 6566 205f 6765 745f 7265 6164     def _get_read
+00007da0: 5f6f 6e6c 795f 6669 656c 6473 2863 6c73  _only_fields(cls
+00007db0: 2920 2d3e 2073 6574 5b73 7472 5d3a 0a20  ) -> set[str]:. 
+00007dc0: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00007dd0: 7065 7228 292e 5f67 6574 5f72 6561 645f  per()._get_read_
+00007de0: 6f6e 6c79 5f66 6965 6c64 7328 2920 7c20  only_fields() | 
+00007df0: 7b0a 2020 2020 2020 2020 2020 2020 2273  {.            "s
+00007e00: 7461 7473 222c 0a20 2020 2020 2020 2020  tats",.         
+00007e10: 2020 2022 6973 4465 6c65 7469 6e67 222c     "isDeleting",
+00007e20: 0a20 2020 2020 2020 2020 2020 2022 6973  .            "is
+00007e30: 5265 636f 7264 696e 6722 2c0a 2020 2020  Recording",.    
+00007e40: 2020 2020 2020 2020 2269 734d 6f74 696f          "isMotio
+00007e50: 6e44 6574 6563 7465 6422 2c0a 2020 2020  nDetected",.    
+00007e60: 2020 2020 2020 2020 2269 7353 6d61 7274          "isSmart
+00007e70: 4465 7465 6374 6564 222c 0a20 2020 2020  Detected",.     
+00007e80: 2020 2020 2020 2022 7068 7952 6174 6522         "phyRate"
+00007e90: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
+00007ea0: 7350 726f 6269 6e67 466f 7257 6966 6922  sProbingForWifi"
+00007eb0: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00007ec0: 6173 7452 696e 6722 2c0a 2020 2020 2020  astRing",.      
+00007ed0: 2020 2020 2020 2269 734c 6976 6548 6561        "isLiveHea
+00007ee0: 746d 6170 456e 6162 6c65 6422 2c0a 2020  tmapEnabled",.  
+00007ef0: 2020 2020 2020 2020 2020 2276 6964 656f            "video
+00007f00: 5265 636f 6e66 6967 7572 6174 696f 6e49  ReconfigurationI
+00007f10: 6e50 726f 6772 6573 7322 2c0a 2020 2020  nProgress",.    
+00007f20: 2020 2020 2020 2020 226c 656e 7365 7322          "lenses"
+00007f30: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
+00007f40: 7350 6f6f 724e 6574 776f 726b 222c 0a20  sPoorNetwork",. 
+00007f50: 2020 2020 2020 2020 2020 2022 6665 6174             "feat
+00007f60: 7572 6546 6c61 6773 222c 0a20 2020 2020  ureFlags",.     
+00007f70: 2020 207d 0a0a 2020 2020 4063 6c61 7373     }..    @class
+00007f80: 6d65 7468 6f64 0a20 2020 2064 6566 2075  method.    def u
+00007f90: 6e69 6669 5f64 6963 745f 746f 5f64 6963  nifi_dict_to_dic
+00007fa0: 7428 636c 732c 2064 6174 613a 2064 6963  t(cls, data: dic
+00007fb0: 745b 7374 722c 2041 6e79 5d29 202d 3e20  t[str, Any]) -> 
+00007fc0: 6469 6374 5b73 7472 2c20 416e 795d 3a0a  dict[str, Any]:.
+00007fd0: 2020 2020 2020 2020 2320 4c43 4420 6d65          # LCD me
+00007fe0: 7373 6167 6573 2063 6f6d 6573 2062 6163  ssages comes bac
+00007ff0: 6b20 6173 2065 6d70 7479 2064 6963 7420  k as empty dict 
+00008000: 7b7d 0a20 2020 2020 2020 2069 6620 226c  {}.        if "l
+00008010: 6364 4d65 7373 6167 6522 2069 6e20 6461  cdMessage" in da
+00008020: 7461 2061 6e64 206c 656e 2864 6174 615b  ta and len(data[
+00008030: 226c 6364 4d65 7373 6167 6522 5d2e 6b65  "lcdMessage"].ke
+00008040: 7973 2829 2920 3d3d 2030 3a0a 2020 2020  ys()) == 0:.    
+00008050: 2020 2020 2020 2020 6465 6c20 6461 7461          del data
+00008060: 5b22 6c63 644d 6573 7361 6765 225d 0a20  ["lcdMessage"]. 
+00008070: 2020 2020 2020 2069 6620 2263 6869 6d65         if "chime
+00008080: 4475 7261 7469 6f6e 2220 696e 2064 6174  Duration" in dat
+00008090: 6120 616e 6420 6e6f 7420 6973 696e 7374  a and not isinst
+000080a0: 616e 6365 2864 6174 615b 2263 6869 6d65  ance(data["chime
+000080b0: 4475 7261 7469 6f6e 225d 2c20 7469 6d65  Duration"], time
+000080c0: 6465 6c74 6129 3a0a 2020 2020 2020 2020  delta):.        
+000080d0: 2020 2020 6461 7461 5b22 6368 696d 6544      data["chimeD
+000080e0: 7572 6174 696f 6e22 5d20 3d20 7469 6d65  uration"] = time
+000080f0: 6465 6c74 6128 6d69 6c6c 6973 6563 6f6e  delta(millisecon
+00008100: 6473 3d64 6174 615b 2263 6869 6d65 4475  ds=data["chimeDu
+00008110: 7261 7469 6f6e 225d 290a 0a20 2020 2020  ration"])..     
+00008120: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
+00008130: 292e 756e 6966 695f 6469 6374 5f74 6f5f  ).unifi_dict_to_
+00008140: 6469 6374 2864 6174 6129 0a0a 2020 2020  dict(data)..    
+00008150: 6465 6620 756e 6966 695f 6469 6374 280a  def unifi_dict(.
+00008160: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00008170: 2020 2020 2020 6461 7461 3a20 4f70 7469        data: Opti
+00008180: 6f6e 616c 5b64 6963 745b 7374 722c 2041  onal[dict[str, A
+00008190: 6e79 5d5d 203d 204e 6f6e 652c 0a20 2020  ny]] = None,.   
+000081a0: 2020 2020 2065 7863 6c75 6465 3a20 4f70       exclude: Op
+000081b0: 7469 6f6e 616c 5b73 6574 5b73 7472 5d5d  tional[set[str]]
+000081c0: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+000081d0: 3e20 6469 6374 5b73 7472 2c20 416e 795d  > dict[str, Any]
+000081e0: 3a0a 2020 2020 2020 2020 6966 2064 6174  :.        if dat
+000081f0: 6120 6973 206e 6f74 204e 6f6e 653a 0a20  a is not None:. 
+00008200: 2020 2020 2020 2020 2020 2069 6620 226d             if "m
+00008210: 6f74 696f 6e5f 7a6f 6e65 7322 2069 6e20  otion_zones" in 
+00008220: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
+00008230: 2020 2020 2020 6461 7461 5b22 6d6f 7469        data["moti
+00008240: 6f6e 5f7a 6f6e 6573 225d 203d 205b 0a20  on_zones"] = [. 
+00008250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008260: 2020 204d 6f74 696f 6e5a 6f6e 6528 2a2a     MotionZone(**
+00008270: 7a29 2e75 6e69 6669 5f64 6963 7428 2920  z).unifi_dict() 
+00008280: 666f 7220 7a20 696e 2064 6174 615b 226d  for z in data["m
+00008290: 6f74 696f 6e5f 7a6f 6e65 7322 5d0a 2020  otion_zones"].  
+000082a0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+000082b0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
+000082c0: 7072 6976 6163 795f 7a6f 6e65 7322 2069  privacy_zones" i
+000082d0: 6e20 6461 7461 3a0a 2020 2020 2020 2020  n data:.        
+000082e0: 2020 2020 2020 2020 6461 7461 5b22 7072          data["pr
+000082f0: 6976 6163 795f 7a6f 6e65 7322 5d20 3d20  ivacy_zones"] = 
+00008300: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00008310: 2020 2020 2020 4361 6d65 7261 5a6f 6e65        CameraZone
+00008320: 282a 2a7a 292e 756e 6966 695f 6469 6374  (**z).unifi_dict
+00008330: 2829 2066 6f72 207a 2069 6e20 6461 7461  () for z in data
+00008340: 5b22 7072 6976 6163 795f 7a6f 6e65 7322  ["privacy_zones"
+00008350: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00008360: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+00008370: 6966 2022 736d 6172 745f 6465 7465 6374  if "smart_detect
+00008380: 5f7a 6f6e 6573 2220 696e 2064 6174 613a  _zones" in data:
+00008390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000083a0: 2064 6174 615b 2273 6d61 7274 5f64 6574   data["smart_det
+000083b0: 6563 745f 7a6f 6e65 7322 5d20 3d20 5b0a  ect_zones"] = [.
+000083c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083d0: 2020 2020 536d 6172 744d 6f74 696f 6e5a      SmartMotionZ
+000083e0: 6f6e 6528 2a2a 7a29 2e75 6e69 6669 5f64  one(**z).unifi_d
+000083f0: 6963 7428 290a 2020 2020 2020 2020 2020  ict().          
+00008400: 2020 2020 2020 2020 2020 666f 7220 7a20            for z 
+00008410: 696e 2064 6174 615b 2273 6d61 7274 5f64  in data["smart_d
+00008420: 6574 6563 745f 7a6f 6e65 7322 5d0a 2020  etect_zones"].  
+00008430: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+00008440: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+00008450: 7375 7065 7228 292e 756e 6966 695f 6469  super().unifi_di
+00008460: 6374 2864 6174 613d 6461 7461 2c20 6578  ct(data=data, ex
+00008470: 636c 7564 653d 6578 636c 7564 6529 0a0a  clude=exclude)..
+00008480: 2020 2020 2020 2020 6966 2022 6c61 7374          if "last
+00008490: 5269 6e67 4576 656e 7449 6422 2069 6e20  RingEventId" in 
+000084a0: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
+000084b0: 2020 6465 6c20 6461 7461 5b22 6c61 7374    del data["last
+000084c0: 5269 6e67 4576 656e 7449 6422 5d0a 2020  RingEventId"].  
+000084d0: 2020 2020 2020 6966 2022 6c61 7374 536d        if "lastSm
+000084e0: 6172 7444 6574 6563 7422 2069 6e20 6461  artDetect" in da
+000084f0: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
+00008500: 6465 6c20 6461 7461 5b22 6c61 7374 536d  del data["lastSm
+00008510: 6172 7444 6574 6563 7422 5d0a 2020 2020  artDetect"].    
+00008520: 2020 2020 6966 2022 6c61 7374 536d 6172      if "lastSmar
+00008530: 7441 7564 696f 4465 7465 6374 2220 696e  tAudioDetect" in
+00008540: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
+00008550: 2020 2064 656c 2064 6174 615b 226c 6173     del data["las
+00008560: 7453 6d61 7274 4175 6469 6f44 6574 6563  tSmartAudioDetec
+00008570: 7422 5d0a 2020 2020 2020 2020 6966 2022  t"].        if "
+00008580: 6c61 7374 536d 6172 7444 6574 6563 7445  lastSmartDetectE
+00008590: 7665 6e74 4964 2220 696e 2064 6174 613a  ventId" in data:
+000085a0: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
+000085b0: 2064 6174 615b 226c 6173 7453 6d61 7274   data["lastSmart
+000085c0: 4465 7465 6374 4576 656e 7449 6422 5d0a  DetectEventId"].
+000085d0: 2020 2020 2020 2020 6966 2022 6c61 7374          if "last
+000085e0: 536d 6172 7441 7564 696f 4465 7465 6374  SmartAudioDetect
+000085f0: 4576 656e 7449 6422 2069 6e20 6461 7461  EventId" in data
+00008600: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+00008610: 6c20 6461 7461 5b22 6c61 7374 536d 6172  l data["lastSmar
+00008620: 7441 7564 696f 4465 7465 6374 4576 656e  tAudioDetectEven
+00008630: 7449 6422 5d0a 2020 2020 2020 2020 6966  tId"].        if
+00008640: 2022 6c61 7374 536d 6172 7444 6574 6563   "lastSmartDetec
+00008650: 7473 2220 696e 2064 6174 613a 0a20 2020  ts" in data:.   
+00008660: 2020 2020 2020 2020 2064 656c 2064 6174           del dat
+00008670: 615b 226c 6173 7453 6d61 7274 4465 7465  a["lastSmartDete
+00008680: 6374 7322 5d0a 2020 2020 2020 2020 6966  cts"].        if
+00008690: 2022 6c61 7374 536d 6172 7441 7564 696f   "lastSmartAudio
+000086a0: 4465 7465 6374 7322 2069 6e20 6461 7461  Detects" in data
+000086b0: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+000086c0: 6c20 6461 7461 5b22 6c61 7374 536d 6172  l data["lastSmar
+000086d0: 7441 7564 696f 4465 7465 6374 7322 5d0a  tAudioDetects"].
+000086e0: 2020 2020 2020 2020 6966 2022 6c61 7374          if "last
+000086f0: 536d 6172 7444 6574 6563 7445 7665 6e74  SmartDetectEvent
+00008700: 4964 7322 2069 6e20 6461 7461 3a0a 2020  Ids" in data:.  
+00008710: 2020 2020 2020 2020 2020 6465 6c20 6461            del da
+00008720: 7461 5b22 6c61 7374 536d 6172 7444 6574  ta["lastSmartDet
+00008730: 6563 7445 7665 6e74 4964 7322 5d0a 2020  ectEventIds"].  
+00008740: 2020 2020 2020 6966 2022 6c61 7374 536d        if "lastSm
+00008750: 6172 7441 7564 696f 4465 7465 6374 4576  artAudioDetectEv
+00008760: 656e 7449 6473 2220 696e 2064 6174 613a  entIds" in data:
+00008770: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
+00008780: 2064 6174 615b 226c 6173 7453 6d61 7274   data["lastSmart
+00008790: 4175 6469 6f44 6574 6563 7445 7665 6e74  AudioDetectEvent
+000087a0: 4964 7322 5d0a 2020 2020 2020 2020 6966  Ids"].        if
+000087b0: 2022 7461 6c6b 6261 636b 5374 7265 616d   "talkbackStream
+000087c0: 2220 696e 2064 6174 613a 0a20 2020 2020  " in data:.     
+000087d0: 2020 2020 2020 2064 656c 2064 6174 615b         del data[
+000087e0: 2274 616c 6b62 6163 6b53 7472 6561 6d22  "talkbackStream"
+000087f0: 5d0a 2020 2020 2020 2020 6966 2022 6c63  ].        if "lc
+00008800: 644d 6573 7361 6765 2220 696e 2064 6174  dMessage" in dat
+00008810: 6120 616e 6420 6461 7461 5b22 6c63 644d  a and data["lcdM
+00008820: 6573 7361 6765 225d 2069 7320 4e6f 6e65  essage"] is None
+00008830: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+00008840: 7461 5b22 6c63 644d 6573 7361 6765 225d  ta["lcdMessage"]
+00008850: 203d 207b 7d0a 0a20 2020 2020 2020 2072   = {}..        r
+00008860: 6574 7572 6e20 6461 7461 0a0a 2020 2020  eturn data..    
+00008870: 6465 6620 6765 745f 6368 616e 6765 6428  def get_changed(
+00008880: 7365 6c66 2c20 6461 7461 5f62 6566 6f72  self, data_befor
+00008890: 655f 6368 616e 6765 733a 2064 6963 745b  e_changes: dict[
+000088a0: 7374 722c 2041 6e79 5d29 202d 3e20 6469  str, Any]) -> di
+000088b0: 6374 5b73 7472 2c20 416e 795d 3a0a 2020  ct[str, Any]:.  
+000088c0: 2020 2020 2020 7570 6461 7465 6420 3d20        updated = 
+000088d0: 7375 7065 7228 292e 6765 745f 6368 616e  super().get_chan
+000088e0: 6765 6428 6461 7461 5f62 6566 6f72 655f  ged(data_before_
+000088f0: 6368 616e 6765 7329 0a0a 2020 2020 2020  changes)..      
+00008900: 2020 6966 2022 6c63 645f 6d65 7373 6167    if "lcd_messag
+00008910: 6522 2069 6e20 7570 6461 7465 643a 0a20  e" in updated:. 
+00008920: 2020 2020 2020 2020 2020 206c 6364 5f6d             lcd_m
+00008930: 6573 7361 6765 203d 2075 7064 6174 6564  essage = updated
+00008940: 5b22 6c63 645f 6d65 7373 6167 6522 5d0a  ["lcd_message"].
+00008950: 2020 2020 2020 2020 2020 2020 2320 746f              # to
+00008960: 2022 636c 6561 7222 204c 4344 206d 6573   "clear" LCD mes
+00008970: 7361 6765 2c20 7365 7420 7265 7365 745f  sage, set reset_
+00008980: 6174 2074 6f20 6120 7469 6d65 2069 6e20  at to a time in 
+00008990: 7468 6520 7061 7374 0a20 2020 2020 2020  the past.       
+000089a0: 2020 2020 2069 6620 6c63 645f 6d65 7373       if lcd_mess
+000089b0: 6167 6520 6973 204e 6f6e 653a 0a20 2020  age is None:.   
+000089c0: 2020 2020 2020 2020 2020 2020 2075 7064               upd
+000089d0: 6174 6564 5b22 6c63 645f 6d65 7373 6167  ated["lcd_messag
+000089e0: 6522 5d20 3d20 7b22 7265 7365 745f 6174  e"] = {"reset_at
+000089f0: 223a 2075 7463 5f6e 6f77 2829 202d 2074  ": utc_now() - t
+00008a00: 696d 6564 656c 7461 2873 6563 6f6e 6473  imedelta(seconds
+00008a10: 3d31 3029 7d0a 2020 2020 2020 2020 2020  =10)}.          
+00008a20: 2020 2320 6f74 6865 7277 6973 652c 2070    # otherwise, p
+00008a30: 6173 7320 6675 6c6c 204c 4344 206d 6573  ass full LCD mes
+00008a40: 7361 6765 2074 6f20 7072 6576 656e 7420  sage to prevent 
+00008a50: 6973 7375 6573 0a20 2020 2020 2020 2020  issues.         
+00008a60: 2020 2065 6c69 6620 7365 6c66 2e6c 6364     elif self.lcd
+00008a70: 5f6d 6573 7361 6765 2069 7320 6e6f 7420  _message is not 
+00008a80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00008a90: 2020 2020 2020 7570 6461 7465 645b 226c        updated["l
+00008aa0: 6364 5f6d 6573 7361 6765 225d 203d 2073  cd_message"] = s
+00008ab0: 656c 662e 6c63 645f 6d65 7373 6167 652e  elf.lcd_message.
+00008ac0: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
+00008ad0: 2020 2020 2320 6966 2072 6573 6574 5f61      # if reset_a
+00008ae0: 7420 6973 206e 6f74 2070 6173 7365 6420  t is not passed 
+00008af0: 696e 2c20 6974 2077 696c 6c20 6465 6661  in, it will defa
+00008b00: 756c 7420 746f 2072 6573 6574 2069 6e20  ult to reset in 
+00008b10: 3120 6d69 6e75 7465 0a20 2020 2020 2020  1 minute.       
+00008b20: 2020 2020 2069 6620 6c63 645f 6d65 7373       if lcd_mess
+00008b30: 6167 6520 6973 206e 6f74 204e 6f6e 6520  age is not None 
+00008b40: 616e 6420 2272 6573 6574 5f61 7422 206e  and "reset_at" n
+00008b50: 6f74 2069 6e20 6c63 645f 6d65 7373 6167  ot in lcd_messag
+00008b60: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00008b70: 2020 2069 6620 7365 6c66 2e6c 6364 5f6d     if self.lcd_m
+00008b80: 6573 7361 6765 2069 7320 4e6f 6e65 3a0a  essage is None:.
+00008b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ba0: 2020 2020 7570 6461 7465 645b 226c 6364      updated["lcd
+00008bb0: 5f6d 6573 7361 6765 225d 5b22 7265 7365  _message"]["rese
+00008bc0: 745f 6174 225d 203d 204e 6f6e 650a 2020  t_at"] = None.  
+00008bd0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00008be0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00008bf0: 2020 2020 2020 2020 7570 6461 7465 645b          updated[
+00008c00: 226c 6364 5f6d 6573 7361 6765 225d 5b22  "lcd_message"]["
+00008c10: 7265 7365 745f 6174 225d 203d 2073 656c  reset_at"] = sel
+00008c20: 662e 6c63 645f 6d65 7373 6167 652e 7265  f.lcd_message.re
+00008c30: 7365 745f 6174 0a0a 2020 2020 2020 2020  set_at..        
+00008c40: 7265 7475 726e 2075 7064 6174 6564 0a0a  return updated..
+00008c50: 2020 2020 6465 6620 7570 6461 7465 5f66      def update_f
+00008c60: 726f 6d5f 6469 6374 2873 656c 662c 2064  rom_dict(self, d
+00008c70: 6174 613a 2064 6963 745b 7374 722c 2041  ata: dict[str, A
+00008c80: 6e79 5d29 202d 3e20 4361 6d65 7261 3a0a  ny]) -> Camera:.
+00008c90: 2020 2020 2020 2020 2320 6120 6d65 7373          # a mess
+00008ca0: 6167 6520 696e 2074 6865 2070 6173 7420  age in the past 
+00008cb0: 6973 2061 6374 7561 6c6c 7920 6120 7369  is actually a si
+00008cc0: 6e67 616c 2074 6f20 7769 7065 2074 6865  ngal to wipe the
+00008cd0: 206d 6573 7361 6765 0a20 2020 2020 2020   message.       
+00008ce0: 2072 6573 6574 5f61 7420 3d20 6461 7461   reset_at = data
+00008cf0: 2e67 6574 2822 6c63 645f 6d65 7373 6167  .get("lcd_messag
+00008d00: 6522 2c20 7b7d 292e 6765 7428 2272 6573  e", {}).get("res
+00008d10: 6574 5f61 7422 290a 2020 2020 2020 2020  et_at").        
+00008d20: 6966 2072 6573 6574 5f61 7420 6973 206e  if reset_at is n
+00008d30: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00008d40: 2020 2020 2072 6573 6574 5f61 7420 3d20       reset_at = 
+00008d50: 6672 6f6d 5f6a 735f 7469 6d65 2872 6573  from_js_time(res
+00008d60: 6574 5f61 7429 0a20 2020 2020 2020 2020  et_at).         
+00008d70: 2020 2069 6620 7574 635f 6e6f 7728 2920     if utc_now() 
+00008d80: 3e20 7265 7365 745f 6174 3a0a 2020 2020  > reset_at:.    
+00008d90: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00008da0: 5b22 6c63 645f 6d65 7373 6167 6522 5d20  ["lcd_message"] 
+00008db0: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
+00008dc0: 7265 7475 726e 2073 7570 6572 2829 2e75  return super().u
+00008dd0: 7064 6174 655f 6672 6f6d 5f64 6963 7428  pdate_from_dict(
+00008de0: 6461 7461 290a 0a20 2020 2040 7072 6f70  data)..    @prop
+00008df0: 6572 7479 0a20 2020 2064 6566 206c 6173  erty.    def las
+00008e00: 745f 7269 6e67 5f65 7665 6e74 2873 656c  t_ring_event(sel
+00008e10: 6629 202d 3e20 4f70 7469 6f6e 616c 5b45  f) -> Optional[E
+00008e20: 7665 6e74 5d3a 0a20 2020 2020 2020 2069  vent]:.        i
+00008e30: 6620 7365 6c66 2e6c 6173 745f 7269 6e67  f self.last_ring
+00008e40: 5f65 7665 6e74 5f69 6420 6973 204e 6f6e  _event_id is Non
+00008e50: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00008e60: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
+00008e70: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00008e80: 6170 692e 626f 6f74 7374 7261 702e 6576  api.bootstrap.ev
+00008e90: 656e 7473 2e67 6574 2873 656c 662e 6c61  ents.get(self.la
+00008ea0: 7374 5f72 696e 675f 6576 656e 745f 6964  st_ring_event_id
+00008eb0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00008ec0: 0a20 2020 2064 6566 206c 6173 745f 736d  .    def last_sm
+00008ed0: 6172 745f 6465 7465 6374 5f65 7665 6e74  art_detect_event
+00008ee0: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
+00008ef0: 616c 5b45 7665 6e74 5d3a 0a20 2020 2020  al[Event]:.     
+00008f00: 2020 2022 2222 4765 7420 7468 6520 6c61     """Get the la
+00008f10: 7374 2073 6d61 7274 2064 6574 6563 7420  st smart detect 
+00008f20: 6576 656e 7420 6964 2e22 2222 0a0a 2020  event id."""..  
+00008f30: 2020 2020 2020 6966 2073 656c 662e 6c61        if self.la
+00008f40: 7374 5f73 6d61 7274 5f64 6574 6563 745f  st_smart_detect_
+00008f50: 6576 656e 745f 6964 2069 7320 4e6f 6e65  event_id is None
+00008f60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00008f70: 7475 726e 204e 6f6e 650a 0a20 2020 2020  turn None..     
+00008f80: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
+00008f90: 7069 2e62 6f6f 7473 7472 6170 2e65 7665  pi.bootstrap.eve
+00008fa0: 6e74 732e 6765 7428 7365 6c66 2e6c 6173  nts.get(self.las
+00008fb0: 745f 736d 6172 745f 6465 7465 6374 5f65  t_smart_detect_e
+00008fc0: 7665 6e74 5f69 6429 0a0a 2020 2020 4070  vent_id)..    @p
+00008fd0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00008fe0: 6864 725f 6d6f 6465 5f64 6973 706c 6179  hdr_mode_display
+00008ff0: 2873 656c 6629 202d 3e20 4c69 7465 7261  (self) -> Litera
+00009000: 6c5b 2261 7574 6f22 2c20 226f 6666 222c  l["auto", "off",
+00009010: 2022 616c 7761 7973 225d 3a0a 2020 2020   "always"]:.    
+00009020: 2020 2020 2222 2247 6574 2048 4452 206d      """Get HDR m
+00009030: 6f64 6520 7369 6d69 6c61 7220 746f 2068  ode similar to h
+00009040: 6f77 2050 726f 7465 6374 2069 6e74 6572  ow Protect inter
+00009050: 6661 6365 2077 6f72 6b73 2e22 2222 0a0a  face works."""..
+00009060: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00009070: 656c 662e 6864 725f 6d6f 6465 3a0a 2020  elf.hdr_mode:.  
+00009080: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00009090: 2022 6f66 6622 0a20 2020 2020 2020 2069   "off".        i
+000090a0: 6620 7365 6c66 2e69 7370 5f73 6574 7469  f self.isp_setti
+000090b0: 6e67 732e 6864 725f 6d6f 6465 203d 3d20  ngs.hdr_mode == 
+000090c0: 4844 524d 6f64 652e 4e4f 524d 414c 3a0a  HDRMode.NORMAL:.
+000090d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000090e0: 726e 2022 6175 746f 220a 2020 2020 2020  rn "auto".      
+000090f0: 2020 7265 7475 726e 2022 616c 7761 7973    return "always
+00009100: 220a 0a20 2020 2040 7072 6f70 6572 7479  "..    @property
+00009110: 0a20 2020 2064 6566 2069 6372 5f6c 7578  .    def icr_lux
+00009120: 5f64 6973 706c 6179 2873 656c 6629 202d  _display(self) -
+00009130: 3e20 696e 7420 7c20 4e6f 6e65 3a0a 2020  > int | None:.  
+00009140: 2020 2020 2020 2222 2247 6574 2049 4352        """Get ICR
+00009150: 2043 7573 746f 6d20 4c75 7820 7661 6c75   Custom Lux valu
+00009160: 6520 7369 6d69 6c61 7220 746f 2068 6f77  e similar to how
+00009170: 2074 6865 2050 726f 7465 6374 2069 6e74   the Protect int
+00009180: 6572 6661 6365 2077 6f72 6b73 2e22 2222  erface works."""
+00009190: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+000091a0: 662e 6973 705f 7365 7474 696e 6773 2e69  f.isp_settings.i
+000091b0: 6372 5f63 7573 746f 6d5f 7661 6c75 6520  cr_custom_value 
+000091c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000091d0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+000091e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000091f0: 204c 5558 5f4d 4150 5049 4e47 5f56 414c   LUX_MAPPING_VAL
+00009200: 5545 535b 3130 202d 2073 656c 662e 6973  UES[10 - self.is
+00009210: 705f 7365 7474 696e 6773 2e69 6372 5f63  p_settings.icr_c
+00009220: 7573 746f 6d5f 7661 6c75 655d 0a0a 2020  ustom_value]..  
+00009230: 2020 6465 6620 6765 745f 6c61 7374 5f73    def get_last_s
+00009240: 6d61 7274 5f64 6574 6563 745f 6576 656e  mart_detect_even
+00009250: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00009260: 0a20 2020 2020 2020 2073 6d61 7274 5f74  .        smart_t
+00009270: 7970 653a 2053 6d61 7274 4465 7465 6374  ype: SmartDetect
+00009280: 4f62 6a65 6374 5479 7065 2c0a 2020 2020  ObjectType,.    
+00009290: 2920 2d3e 204f 7074 696f 6e61 6c5b 4576  ) -> Optional[Ev
+000092a0: 656e 745d 3a0a 2020 2020 2020 2020 2222  ent]:.        ""
+000092b0: 2247 6574 2074 6865 206c 6173 7420 736d  "Get the last sm
+000092c0: 6172 7420 6465 7465 6374 2065 7665 6e74  art detect event
+000092d0: 2066 6f72 2067 6976 656e 2074 7970 652e   for given type.
+000092e0: 2222 220a 0a20 2020 2020 2020 2065 7665  """..        eve
+000092f0: 6e74 5f69 6420 3d20 7365 6c66 2e6c 6173  nt_id = self.las
+00009300: 745f 736d 6172 745f 6465 7465 6374 5f65  t_smart_detect_e
+00009310: 7665 6e74 5f69 6473 2e67 6574 2873 6d61  vent_ids.get(sma
+00009320: 7274 5f74 7970 6529 0a20 2020 2020 2020  rt_type).       
+00009330: 2069 6620 6576 656e 745f 6964 2069 7320   if event_id is 
+00009340: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00009350: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
+00009360: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00009370: 6c66 2e61 7069 2e62 6f6f 7473 7472 6170  lf.api.bootstrap
+00009380: 2e65 7665 6e74 732e 6765 7428 6576 656e  .events.get(even
+00009390: 745f 6964 290a 0a20 2020 2040 7072 6f70  t_id)..    @prop
+000093a0: 6572 7479 0a20 2020 2064 6566 206c 6173  erty.    def las
+000093b0: 745f 736d 6172 745f 6175 6469 6f5f 6465  t_smart_audio_de
+000093c0: 7465 6374 5f65 7665 6e74 2873 656c 6629  tect_event(self)
+000093d0: 202d 3e20 4f70 7469 6f6e 616c 5b45 7665   -> Optional[Eve
+000093e0: 6e74 5d3a 0a20 2020 2020 2020 2022 2222  nt]:.        """
+000093f0: 4765 7420 7468 6520 6c61 7374 2073 6d61  Get the last sma
+00009400: 7274 2061 7564 696f 2064 6574 6563 7420  rt audio detect 
+00009410: 6576 656e 7420 6964 2e22 2222 0a0a 2020  event id."""..  
+00009420: 2020 2020 2020 6966 2073 656c 662e 6c61        if self.la
+00009430: 7374 5f73 6d61 7274 5f61 7564 696f 5f64  st_smart_audio_d
+00009440: 6574 6563 745f 6576 656e 745f 6964 2069  etect_event_id i
+00009450: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00009460: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+00009470: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00009480: 7365 6c66 2e61 7069 2e62 6f6f 7473 7472  self.api.bootstr
+00009490: 6170 2e65 7665 6e74 732e 6765 7428 7365  ap.events.get(se
+000094a0: 6c66 2e6c 6173 745f 736d 6172 745f 6175  lf.last_smart_au
+000094b0: 6469 6f5f 6465 7465 6374 5f65 7665 6e74  dio_detect_event
+000094c0: 5f69 6429 0a0a 2020 2020 6465 6620 6765  _id)..    def ge
+000094d0: 745f 6c61 7374 5f73 6d61 7274 5f61 7564  t_last_smart_aud
+000094e0: 696f 5f64 6574 6563 745f 6576 656e 7428  io_detect_event(
+000094f0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00009500: 2020 2020 2020 2073 6d61 7274 5f74 7970         smart_typ
+00009510: 653a 2053 6d61 7274 4465 7465 6374 4175  e: SmartDetectAu
+00009520: 6469 6f54 7970 652c 0a20 2020 2029 202d  dioType,.    ) -
+00009530: 3e20 4f70 7469 6f6e 616c 5b45 7665 6e74  > Optional[Event
+00009540: 5d3a 0a20 2020 2020 2020 2022 2222 4765  ]:.        """Ge
+00009550: 7420 7468 6520 6c61 7374 2073 6d61 7274  t the last smart
+00009560: 2061 7564 696f 2064 6574 6563 7420 6576   audio detect ev
+00009570: 656e 7420 666f 7220 6769 7665 6e20 7479  ent for given ty
+00009580: 7065 2e22 2222 0a0a 2020 2020 2020 2020  pe."""..        
+00009590: 6576 656e 745f 6964 203d 2073 656c 662e  event_id = self.
+000095a0: 6c61 7374 5f73 6d61 7274 5f61 7564 696f  last_smart_audio
+000095b0: 5f64 6574 6563 745f 6576 656e 745f 6964  _detect_event_id
+000095c0: 732e 6765 7428 736d 6172 745f 7479 7065  s.get(smart_type
+000095d0: 290a 2020 2020 2020 2020 6966 2065 7665  ).        if eve
+000095e0: 6e74 5f69 6420 6973 204e 6f6e 653a 0a20  nt_id is None:. 
+000095f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00009600: 6e20 4e6f 6e65 0a0a 2020 2020 2020 2020  n None..        
+00009610: 7265 7475 726e 2073 656c 662e 6170 692e  return self.api.
+00009620: 626f 6f74 7374 7261 702e 6576 656e 7473  bootstrap.events
+00009630: 2e67 6574 2865 7665 6e74 5f69 6429 0a0a  .get(event_id)..
+00009640: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00009650: 2020 6465 6620 7469 6d65 6c61 7073 655f    def timelapse_
+00009660: 7572 6c28 7365 6c66 2920 2d3e 2073 7472  url(self) -> str
+00009670: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00009680: 2066 227b 7365 6c66 2e61 7069 2e70 726f   f"{self.api.pro
+00009690: 7465 6374 5f75 726c 7d2f 7469 6d65 6c61  tect_url}/timela
+000096a0: 7073 652f 7b73 656c 662e 6964 7d22 0a0a  pse/{self.id}"..
+000096b0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+000096c0: 2020 6465 6620 6973 5f70 7269 7661 6379    def is_privacy
+000096d0: 5f6f 6e28 7365 6c66 2920 2d3e 2062 6f6f  _on(self) -> boo
+000096e0: 6c3a 0a20 2020 2020 2020 2069 6e64 6578  l:.        index
+000096f0: 2c20 5f20 3d20 7365 6c66 2e67 6574 5f70  , _ = self.get_p
+00009700: 7269 7661 6379 5f7a 6f6e 6528 290a 2020  rivacy_zone().  
+00009710: 2020 2020 2020 7265 7475 726e 2069 6e64        return ind
+00009720: 6578 2069 7320 6e6f 7420 4e6f 6e65 0a0a  ex is not None..
+00009730: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00009740: 2020 6465 6620 6973 5f72 6563 6f72 6469    def is_recordi
+00009750: 6e67 5f65 6e61 626c 6564 2873 656c 6629  ng_enabled(self)
+00009760: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+00009770: 2020 2222 2249 7320 7265 636f 7264 696e    """Is recordin
+00009780: 6720 666f 6f74 6167 652f 6576 656e 7473  g footage/events
+00009790: 2066 726f 6d20 7468 6520 6361 6d65 7261   from the camera
+000097a0: 2065 6e61 626c 6564 3f0a 0a20 2020 2020   enabled?..     
+000097b0: 2020 2049 6620 7265 636f 7264 696e 6720     If recording 
+000097c0: 6973 206e 6f74 2065 6e61 626c 6564 2c20  is not enabled, 
+000097d0: 6361 6d65 7261 7320 7769 6c6c 206e 6f74  cameras will not
+000097e0: 2070 726f 6475 6365 2061 6e79 2066 6f6f   produce any foo
+000097f0: 7461 6765 2c20 7468 756d 626e 6169 6c73  tage, thumbnails
+00009800: 2c0a 2020 2020 2020 2020 6d6f 7469 6f6e  ,.        motion
+00009810: 2f73 6d61 7274 2064 6574 6563 7469 6f6e  /smart detection
+00009820: 2065 7665 6e74 732e 0a20 2020 2020 2020   events..       
+00009830: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
+00009840: 7475 726e 2073 656c 662e 7265 636f 7264  turn self.record
+00009850: 696e 675f 7365 7474 696e 6773 2e6d 6f64  ing_settings.mod
+00009860: 6520 6973 206e 6f74 2052 6563 6f72 6469  e is not Recordi
+00009870: 6e67 4d6f 6465 2e4e 4556 4552 0a0a 2020  ngMode.NEVER..  
+00009880: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00009890: 6465 6620 6973 5f73 6d61 7274 5f64 6574  def is_smart_det
+000098a0: 6563 7469 6f6e 735f 616c 6c6f 7765 6428  ections_allowed(
+000098b0: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+000098c0: 2020 2020 2020 2022 2222 4973 2073 6d61         """Is sma
+000098d0: 7274 2064 6574 6563 7469 6f6e 7320 616c  rt detections al
+000098e0: 6c6f 7765 6420 666f 7220 7468 6973 2063  lowed for this c
+000098f0: 616d 6572 613f 2222 220a 0a20 2020 2020  amera?"""..     
+00009900: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
+00009910: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
+00009920: 7265 636f 7264 696e 675f 656e 6162 6c65  recording_enable
+00009930: 640a 2020 2020 2020 2020 2020 2020 616e  d.            an
+00009940: 6420 7365 6c66 2e61 7069 2e62 6f6f 7473  d self.api.boots
+00009950: 7472 6170 2e6e 7672 2e69 735f 736d 6172  trap.nvr.is_smar
+00009960: 745f 6465 7465 6374 696f 6e73 5f65 6e61  t_detections_ena
+00009970: 626c 6564 0a20 2020 2020 2020 2029 0a0a  bled.        )..
+00009980: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00009990: 2020 6465 6620 6973 5f6c 6963 656e 7365    def is_license
+000099a0: 5f70 6c61 7465 5f64 6574 6563 7469 6f6e  _plate_detection
+000099b0: 735f 616c 6c6f 7765 6428 7365 6c66 2920  s_allowed(self) 
+000099c0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+000099d0: 2022 2222 4973 206c 6963 656e 7365 2070   """Is license p
+000099e0: 6c61 7465 2064 6574 6563 7469 6f6e 7320  late detections 
+000099f0: 616c 6c6f 7765 6420 666f 7220 7468 6973  allowed for this
+00009a00: 2063 616d 6572 613f 2222 220a 0a20 2020   camera?"""..   
+00009a10: 2020 2020 2072 6574 7572 6e20 280a 2020       return (.  
+00009a20: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+00009a30: 735f 7265 636f 7264 696e 675f 656e 6162  s_recording_enab
+00009a40: 6c65 640a 2020 2020 2020 2020 2020 2020  led.            
+00009a50: 616e 6420 7365 6c66 2e61 7069 2e62 6f6f  and self.api.boo
+00009a60: 7473 7472 6170 2e6e 7672 2e69 735f 6c69  tstrap.nvr.is_li
+00009a70: 6365 6e73 655f 706c 6174 655f 6465 7465  cense_plate_dete
+00009a80: 6374 696f 6e73 5f65 6e61 626c 6564 0a20  ctions_enabled. 
+00009a90: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
+00009aa0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00009ab0: 6973 5f66 6163 655f 6465 7465 6374 696f  is_face_detectio
+00009ac0: 6e73 5f61 6c6c 6f77 6564 2873 656c 6629  ns_allowed(self)
+00009ad0: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+00009ae0: 2020 2222 2249 7320 6661 6365 2064 6574    """Is face det
+00009af0: 6563 7469 6f6e 7320 616c 6c6f 7765 6420  ections allowed 
+00009b00: 666f 7220 7468 6973 2063 616d 6572 613f  for this camera?
+00009b10: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+00009b20: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+00009b30: 2020 7365 6c66 2e69 735f 7265 636f 7264    self.is_record
+00009b40: 696e 675f 656e 6162 6c65 640a 2020 2020  ing_enabled.    
+00009b50: 2020 2020 2020 2020 616e 6420 7365 6c66          and self
+00009b60: 2e61 7069 2e62 6f6f 7473 7472 6170 2e6e  .api.bootstrap.n
+00009b70: 7672 2e69 735f 6661 6365 5f64 6574 6563  vr.is_face_detec
+00009b80: 7469 6f6e 735f 656e 6162 6c65 640a 2020  tions_enabled.  
+00009b90: 2020 2020 2020 290a 0a20 2020 2040 7072        )..    @pr
+00009ba0: 6f70 6572 7479 0a20 2020 2064 6566 2061  operty.    def a
+00009bb0: 6374 6976 655f 7265 636f 7264 696e 675f  ctive_recording_
+00009bc0: 7365 7474 696e 6773 2873 656c 6629 202d  settings(self) -
+00009bd0: 3e20 5265 636f 7264 696e 6753 6574 7469  > RecordingSetti
+00009be0: 6e67 733a 0a20 2020 2020 2020 2022 2222  ngs:.        """
+00009bf0: 4765 7420 6163 7469 7665 2072 6563 6f72  Get active recor
+00009c00: 6469 6e67 2073 6574 7469 6e67 732e 2222  ding settings.""
+00009c10: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+00009c20: 6e20 7365 6c66 2e72 6563 6f72 6469 6e67  n self.recording
+00009c30: 5f73 6574 7469 6e67 730a 0a20 2020 2040  _settings..    @
+00009c40: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00009c50: 2061 6374 6976 655f 736d 6172 745f 6465   active_smart_de
+00009c60: 7465 6374 5f73 6574 7469 6e67 7328 7365  tect_settings(se
+00009c70: 6c66 2920 2d3e 2053 6d61 7274 4465 7465  lf) -> SmartDete
+00009c80: 6374 5365 7474 696e 6773 3a0a 2020 2020  ctSettings:.    
+00009c90: 2020 2020 2222 2247 6574 2061 6374 6976      """Get activ
+00009ca0: 6520 736d 6172 7420 6465 7465 6374 696f  e smart detectio
+00009cb0: 6e20 7365 7474 696e 6773 2e22 2222 0a0a  n settings."""..
+00009cc0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00009cd0: 656c 662e 736d 6172 745f 6465 7465 6374  elf.smart_detect
+00009ce0: 5f73 6574 7469 6e67 730a 0a20 2020 2040  _settings..    @
+00009cf0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00009d00: 2061 6374 6976 655f 736d 6172 745f 6465   active_smart_de
+00009d10: 7465 6374 5f74 7970 6573 2873 656c 6629  tect_types(self)
+00009d20: 202d 3e20 7365 745b 536d 6172 7444 6574   -> set[SmartDet
+00009d30: 6563 744f 626a 6563 7454 7970 655d 3a0a  ectObjectType]:.
+00009d40: 2020 2020 2020 2020 2222 2247 6574 2061          """Get a
+00009d50: 6374 6976 6520 736d 6172 7420 6465 7465  ctive smart dete
+00009d60: 6374 696f 6e20 7479 7065 732e 2222 220a  ction types.""".
+00009d70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00009d80: 7365 7428 7365 6c66 2e73 6d61 7274 5f64  set(self.smart_d
+00009d90: 6574 6563 745f 7365 7474 696e 6773 2e6f  etect_settings.o
+00009da0: 626a 6563 745f 7479 7065 7329 0a0a 2020  bject_types)..  
+00009db0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00009dc0: 6465 6620 6163 7469 7665 5f61 7564 696f  def active_audio
+00009dd0: 5f64 6574 6563 745f 7479 7065 7328 7365  _detect_types(se
+00009de0: 6c66 2920 2d3e 2073 6574 5b53 6d61 7274  lf) -> set[Smart
+00009df0: 4465 7465 6374 4175 6469 6f54 7970 655d  DetectAudioType]
+00009e00: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+00009e10: 2061 6374 6976 6520 6175 6469 6f20 6465   active audio de
+00009e20: 7465 6374 696f 6e20 7479 7065 732e 2222  tection types.""
+00009e30: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+00009e40: 6e20 7365 7428 7365 6c66 2e73 6d61 7274  n set(self.smart
+00009e50: 5f64 6574 6563 745f 7365 7474 696e 6773  _detect_settings
+00009e60: 2e61 7564 696f 5f74 7970 6573 206f 7220  .audio_types or 
+00009e70: 5b5d 290a 0a20 2020 2040 7072 6f70 6572  [])..    @proper
+00009e80: 7479 0a20 2020 2064 6566 2069 735f 6d6f  ty.    def is_mo
+00009e90: 7469 6f6e 5f64 6574 6563 7469 6f6e 5f6f  tion_detection_o
+00009ea0: 6e28 7365 6c66 2920 2d3e 2062 6f6f 6c3a  n(self) -> bool:
+00009eb0: 0a20 2020 2020 2020 2022 2222 4973 204d  .        """Is M
+00009ec0: 6f74 696f 6e20 4465 7465 6374 696f 6e20  otion Detection 
+00009ed0: 6176 6169 6c61 626c 6520 616e 6420 656e  available and en
+00009ee0: 6162 6c65 6420 2863 616d 6572 6120 7769  abled (camera wi
+00009ef0: 6c6c 2070 726f 6475 6365 206d 6f74 696f  ll produce motio
+00009f00: 6e20 6576 656e 7473 293f 2222 220a 0a20  n events)?""".. 
+00009f10: 2020 2020 2020 2072 6574 7572 6e20 280a         return (.
+00009f20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009f30: 2e69 735f 7265 636f 7264 696e 675f 656e  .is_recording_en
+00009f40: 6162 6c65 640a 2020 2020 2020 2020 2020  abled.          
+00009f50: 2020 616e 6420 7365 6c66 2e61 6374 6976    and self.activ
+00009f60: 655f 7265 636f 7264 696e 675f 7365 7474  e_recording_sett
+00009f70: 696e 6773 2e65 6e61 626c 655f 6d6f 7469  ings.enable_moti
+00009f80: 6f6e 5f64 6574 6563 7469 6f6e 2069 7320  on_detection is 
+00009f90: 6e6f 7420 4661 6c73 650a 2020 2020 2020  not False.      
+00009fa0: 2020 290a 0a20 2020 2040 7072 6f70 6572    )..    @proper
+00009fb0: 7479 0a20 2020 2064 6566 2069 735f 6d6f  ty.    def is_mo
+00009fc0: 7469 6f6e 5f63 7572 7265 6e74 6c79 5f64  tion_currently_d
+00009fd0: 6574 6563 7465 6428 7365 6c66 2920 2d3e  etected(self) ->
+00009fe0: 2062 6f6f 6c3a 0a20 2020 2020 2020 2022   bool:.        "
+00009ff0: 2222 4973 206d 6f74 696f 6e20 6375 7272  ""Is motion curr
+0000a000: 656e 746c 7920 6265 696e 6720 6465 7465  ently being dete
+0000a010: 6374 6564 2222 220a 0a20 2020 2020 2020  cted"""..       
+0000a020: 2072 6574 7572 6e20 280a 2020 2020 2020   return (.      
+0000a030: 2020 2020 2020 7365 6c66 2e69 735f 6d6f        self.is_mo
+0000a040: 7469 6f6e 5f64 6574 6563 7469 6f6e 5f6f  tion_detection_o
+0000a050: 6e0a 2020 2020 2020 2020 2020 2020 616e  n.            an
+0000a060: 6420 7365 6c66 2e69 735f 6d6f 7469 6f6e  d self.is_motion
+0000a070: 5f64 6574 6563 7465 640a 2020 2020 2020  _detected.      
+0000a080: 2020 2020 2020 616e 6420 7365 6c66 2e6c        and self.l
+0000a090: 6173 745f 6d6f 7469 6f6e 5f65 7665 6e74  ast_motion_event
+0000a0a0: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+0000a0b0: 2020 2020 2020 2020 2061 6e64 2073 656c           and sel
+0000a0c0: 662e 6c61 7374 5f6d 6f74 696f 6e5f 6576  f.last_motion_ev
+0000a0d0: 656e 742e 656e 6420 6973 204e 6f6e 650a  ent.end is None.
+0000a0e0: 2020 2020 2020 2020 290a 0a20 2020 2061          )..    a
+0000a0f0: 7379 6e63 2064 6566 2073 6574 5f6d 6f74  sync def set_mot
+0000a100: 696f 6e5f 6465 7465 6374 696f 6e28 7365  ion_detection(se
+0000a110: 6c66 2c20 656e 6162 6c65 643a 2062 6f6f  lf, enabled: boo
+0000a120: 6c29 202d 3e20 4e6f 6e65 3a0a 2020 2020  l) -> None:.    
+0000a130: 2020 2020 2222 2253 6574 7320 6d6f 7469      """Sets moti
+0000a140: 6f6e 2064 6574 6563 7469 6f6e 206f 6e20  on detection on 
+0000a150: 6361 6d65 7261 2222 220a 0a20 2020 2020  camera"""..     
+0000a160: 2020 2064 6566 2063 616c 6c62 6163 6b28     def callback(
+0000a170: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0000a180: 2020 2020 2020 2073 656c 662e 7265 636f         self.reco
+0000a190: 7264 696e 675f 7365 7474 696e 6773 2e65  rding_settings.e
+0000a1a0: 6e61 626c 655f 6d6f 7469 6f6e 5f64 6574  nable_motion_det
+0000a1b0: 6563 7469 6f6e 203d 2065 6e61 626c 6564  ection = enabled
+0000a1c0: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+0000a1d0: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+0000a1e0: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+0000a1f0: 2023 2072 6567 696f 6e20 4f62 6a65 6374   # region Object
+0000a200: 2053 6d61 7274 2044 6574 6563 7469 6f6e   Smart Detection
+0000a210: 730a 0a20 2020 2064 6566 205f 6973 5f73  s..    def _is_s
+0000a220: 6d61 7274 5f65 6e61 626c 6564 2873 656c  mart_enabled(sel
+0000a230: 662c 2073 6d61 7274 5f74 7970 653a 2053  f, smart_type: S
+0000a240: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
+0000a250: 5479 7065 2920 2d3e 2062 6f6f 6c3a 0a20  Type) -> bool:. 
+0000a260: 2020 2020 2020 2072 6574 7572 6e20 280a         return (.
+0000a270: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a280: 2e69 735f 7265 636f 7264 696e 675f 656e  .is_recording_en
+0000a290: 6162 6c65 6420 616e 6420 736d 6172 745f  abled and smart_
+0000a2a0: 7479 7065 2069 6e20 7365 6c66 2e61 6374  type in self.act
+0000a2b0: 6976 655f 736d 6172 745f 6465 7465 6374  ive_smart_detect
+0000a2c0: 5f74 7970 6573 0a20 2020 2020 2020 2029  _types.        )
+0000a2d0: 0a0a 2020 2020 6465 6620 5f69 735f 736d  ..    def _is_sm
+0000a2e0: 6172 745f 6465 7465 6374 6564 2873 656c  art_detected(sel
+0000a2f0: 662c 2073 6d61 7274 5f74 7970 653a 2053  f, smart_type: S
+0000a300: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
+0000a310: 5479 7065 2920 2d3e 2062 6f6f 6c3a 0a20  Type) -> bool:. 
+0000a320: 2020 2020 2020 2065 7665 6e74 203d 2073         event = s
+0000a330: 656c 662e 6765 745f 6c61 7374 5f73 6d61  elf.get_last_sma
+0000a340: 7274 5f64 6574 6563 745f 6576 656e 7428  rt_detect_event(
+0000a350: 736d 6172 745f 7479 7065 290a 2020 2020  smart_type).    
+0000a360: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
+0000a370: 2020 2020 2020 2020 2073 656c 662e 5f69           self._i
+0000a380: 735f 736d 6172 745f 656e 6162 6c65 6428  s_smart_enabled(
+0000a390: 736d 6172 745f 7479 7065 290a 2020 2020  smart_type).    
+0000a3a0: 2020 2020 2020 2020 616e 6420 7365 6c66          and self
+0000a3b0: 2e69 735f 736d 6172 745f 6465 7465 6374  .is_smart_detect
+0000a3c0: 6564 0a20 2020 2020 2020 2020 2020 2061  ed.            a
+0000a3d0: 6e64 2065 7665 6e74 2069 7320 6e6f 7420  nd event is not 
+0000a3e0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+0000a3f0: 2061 6e64 2065 7665 6e74 2e65 6e64 2069   and event.end i
+0000a400: 7320 4e6f 6e65 0a20 2020 2020 2020 2020  s None.         
+0000a410: 2020 2061 6e64 2073 6d61 7274 5f74 7970     and smart_typ
+0000a420: 6520 696e 2065 7665 6e74 2e73 6d61 7274  e in event.smart
+0000a430: 5f64 6574 6563 745f 7479 7065 730a 2020  _detect_types.  
+0000a440: 2020 2020 2020 290a 0a20 2020 2040 7072        )..    @pr
+0000a450: 6f70 6572 7479 0a20 2020 2064 6566 2069  operty.    def i
+0000a460: 735f 736d 6172 745f 6375 7272 656e 746c  s_smart_currentl
+0000a470: 795f 6465 7465 6374 6564 2873 656c 6629  y_detected(self)
+0000a480: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+0000a490: 2020 2222 2249 7320 736d 6172 7420 6465    """Is smart de
+0000a4a0: 7465 6374 696f 6e20 6375 7272 656e 746c  tection currentl
+0000a4b0: 7920 6265 696e 6720 6465 7465 6374 6564  y being detected
+0000a4c0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000a4d0: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+0000a4e0: 2020 7365 6c66 2e69 735f 7265 636f 7264    self.is_record
+0000a4f0: 696e 675f 656e 6162 6c65 640a 2020 2020  ing_enabled.    
+0000a500: 2020 2020 2020 2020 616e 6420 626f 6f6c          and bool
+0000a510: 2873 656c 662e 6163 7469 7665 5f73 6d61  (self.active_sma
+0000a520: 7274 5f64 6574 6563 745f 7479 7065 7329  rt_detect_types)
+0000a530: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+0000a540: 2073 656c 662e 6973 5f73 6d61 7274 5f64   self.is_smart_d
+0000a550: 6574 6563 7465 640a 2020 2020 2020 2020  etected.        
+0000a560: 2020 2020 616e 6420 7365 6c66 2e6c 6173      and self.las
+0000a570: 745f 736d 6172 745f 6465 7465 6374 5f65  t_smart_detect_e
+0000a580: 7665 6e74 2069 7320 6e6f 7420 4e6f 6e65  vent is not None
+0000a590: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+0000a5a0: 2073 656c 662e 6c61 7374 5f73 6d61 7274   self.last_smart
+0000a5b0: 5f64 6574 6563 745f 6576 656e 742e 656e  _detect_event.en
+0000a5c0: 6420 6973 204e 6f6e 650a 2020 2020 2020  d is None.      
+0000a5d0: 2020 290a 0a20 2020 2023 2072 6567 696f    )..    # regio
+0000a5e0: 6e20 5065 7273 6f6e 0a0a 2020 2020 4070  n Person..    @p
+0000a5f0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000a600: 6361 6e5f 6465 7465 6374 5f70 6572 736f  can_detect_perso
+0000a610: 6e28 7365 6c66 2920 2d3e 2062 6f6f 6c3a  n(self) -> bool:
+0000a620: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000a630: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
+0000a640: 7454 7970 652e 5045 5253 4f4e 2069 6e20  tType.PERSON in 
+0000a650: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
+0000a660: 6773 2e73 6d61 7274 5f64 6574 6563 745f  gs.smart_detect_
+0000a670: 7479 7065 730a 0a20 2020 2040 7072 6f70  types..    @prop
+0000a680: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
+0000a690: 7065 7273 6f6e 5f64 6574 6563 7469 6f6e  person_detection
+0000a6a0: 5f6f 6e28 7365 6c66 2920 2d3e 2062 6f6f  _on(self) -> boo
+0000a6b0: 6c3a 0a20 2020 2020 2020 2022 2222 4973  l:.        """Is
+0000a6c0: 2050 6572 736f 6e20 4465 7465 6374 696f   Person Detectio
+0000a6d0: 6e20 6176 6169 6c61 626c 6520 616e 6420  n available and 
+0000a6e0: 656e 6162 6c65 6420 2863 616d 6572 6120  enabled (camera 
+0000a6f0: 7769 6c6c 2070 726f 6475 6365 2070 6572  will produce per
+0000a700: 736f 6e20 736d 6172 740a 2020 2020 2020  son smart.      
+0000a710: 2020 6465 7465 6374 696f 6e20 6576 656e    detection even
+0000a720: 7473 293f 0a20 2020 2020 2020 2022 2222  ts)?.        """
+0000a730: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000a740: 2073 656c 662e 5f69 735f 736d 6172 745f   self._is_smart_
+0000a750: 656e 6162 6c65 6428 536d 6172 7444 6574  enabled(SmartDet
+0000a760: 6563 744f 626a 6563 7454 7970 652e 5045  ectObjectType.PE
+0000a770: 5253 4f4e 290a 0a20 2020 2040 7072 6f70  RSON)..    @prop
+0000a780: 6572 7479 0a20 2020 2064 6566 206c 6173  erty.    def las
+0000a790: 745f 7065 7273 6f6e 5f64 6574 6563 745f  t_person_detect_
+0000a7a0: 6576 656e 7428 7365 6c66 2920 2d3e 204f  event(self) -> O
+0000a7b0: 7074 696f 6e61 6c5b 4576 656e 745d 3a0a  ptional[Event]:.
+0000a7c0: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
+0000a7d0: 6865 206c 6173 7420 7065 7273 6f6e 2073  he last person s
+0000a7e0: 6d61 7274 2064 6574 6563 7469 6f6e 2065  mart detection e
+0000a7f0: 7665 6e74 2e22 2222 0a0a 2020 2020 2020  vent."""..      
+0000a800: 2020 7265 7475 726e 2073 656c 662e 6765    return self.ge
+0000a810: 745f 6c61 7374 5f73 6d61 7274 5f64 6574  t_last_smart_det
+0000a820: 6563 745f 6576 656e 7428 536d 6172 7444  ect_event(SmartD
+0000a830: 6574 6563 744f 626a 6563 7454 7970 652e  etectObjectType.
+0000a840: 5045 5253 4f4e 290a 0a20 2020 2040 7072  PERSON)..    @pr
+0000a850: 6f70 6572 7479 0a20 2020 2064 6566 206c  operty.    def l
+0000a860: 6173 745f 7065 7273 6f6e 5f64 6574 6563  ast_person_detec
+0000a870: 7428 7365 6c66 2920 2d3e 204f 7074 696f  t(self) -> Optio
+0000a880: 6e61 6c5b 6461 7465 7469 6d65 5d3a 0a20  nal[datetime]:. 
+0000a890: 2020 2020 2020 2022 2222 4765 7420 7468         """Get th
+0000a8a0: 6520 6c61 7374 2070 6572 736f 6e20 736d  e last person sm
+0000a8b0: 6172 7420 6465 7465 6374 696f 6e20 6576  art detection ev
+0000a8c0: 656e 742e 2222 220a 0a20 2020 2020 2020  ent."""..       
+0000a8d0: 2072 6574 7572 6e20 7365 6c66 2e6c 6173   return self.las
+0000a8e0: 745f 736d 6172 745f 6465 7465 6374 732e  t_smart_detects.
+0000a8f0: 6765 7428 536d 6172 7444 6574 6563 744f  get(SmartDetectO
+0000a900: 626a 6563 7454 7970 652e 5045 5253 4f4e  bjectType.PERSON
+0000a910: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0000a920: 0a20 2020 2064 6566 2069 735f 7065 7273  .    def is_pers
+0000a930: 6f6e 5f63 7572 7265 6e74 6c79 5f64 6574  on_currently_det
+0000a940: 6563 7465 6428 7365 6c66 2920 2d3e 2062  ected(self) -> b
+0000a950: 6f6f 6c3a 0a20 2020 2020 2020 2022 2222  ool:.        """
+0000a960: 4973 2070 6572 736f 6e20 6375 7272 656e  Is person curren
+0000a970: 746c 7920 6265 696e 6720 6465 7465 6374  tly being detect
+0000a980: 6564 2222 220a 0a20 2020 2020 2020 2072  ed"""..        r
+0000a990: 6574 7572 6e20 7365 6c66 2e5f 6973 5f73  eturn self._is_s
+0000a9a0: 6d61 7274 5f64 6574 6563 7465 6428 536d  mart_detected(Sm
+0000a9b0: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
+0000a9c0: 7970 652e 5045 5253 4f4e 290a 0a20 2020  ype.PERSON)..   
+0000a9d0: 2061 7379 6e63 2064 6566 2073 6574 5f70   async def set_p
+0000a9e0: 6572 736f 6e5f 6465 7465 6374 696f 6e28  erson_detection(
+0000a9f0: 7365 6c66 2c20 656e 6162 6c65 643a 2062  self, enabled: b
+0000aa00: 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a 2020  ool) -> None:.  
+0000aa10: 2020 2020 2020 2222 2254 6f67 676c 6573        """Toggles
+0000aa20: 2070 6572 736f 6e20 736d 6172 7420 6465   person smart de
+0000aa30: 7465 6374 696f 6e2e 2052 6571 7569 7265  tection. Require
+0000aa40: 7320 6361 6d65 7261 2074 6f20 6861 7665  s camera to have
+0000aa50: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+0000aa60: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000aa70: 7572 6e20 6177 6169 7420 7365 6c66 2e5f  urn await self._
+0000aa80: 7365 745f 6f62 6a65 6374 5f64 6574 6563  set_object_detec
+0000aa90: 7428 536d 6172 7444 6574 6563 744f 626a  t(SmartDetectObj
+0000aaa0: 6563 7454 7970 652e 5045 5253 4f4e 2c20  ectType.PERSON, 
+0000aab0: 656e 6162 6c65 6429 0a0a 2020 2020 4070  enabled)..    @p
+0000aac0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000aad0: 6973 5f70 6572 736f 6e5f 7472 6163 6b69  is_person_tracki
+0000aae0: 6e67 5f65 6e61 626c 6564 2873 656c 6629  ng_enabled(self)
+0000aaf0: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+0000ab00: 2020 2222 2249 7320 7065 7273 6f6e 2074    """Is person t
+0000ab10: 7261 636b 696e 6720 656e 6162 6c65 6422  racking enabled"
+0000ab20: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0000ab30: 6e20 280a 2020 2020 2020 2020 2020 2020  n (.            
+0000ab40: 7365 6c66 2e61 6374 6976 655f 736d 6172  self.active_smar
+0000ab50: 745f 6465 7465 6374 5f73 6574 7469 6e67  t_detect_setting
+0000ab60: 732e 6175 746f 5f74 7261 636b 696e 675f  s.auto_tracking_
+0000ab70: 6f62 6a65 6374 5f74 7970 6573 2069 7320  object_types is 
+0000ab80: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+0000ab90: 2020 2020 2061 6e64 2053 6d61 7274 4465       and SmartDe
+0000aba0: 7465 6374 4f62 6a65 6374 5479 7065 2e50  tectObjectType.P
+0000abb0: 4552 534f 4e0a 2020 2020 2020 2020 2020  ERSON.          
+0000abc0: 2020 696e 2073 656c 662e 6163 7469 7665    in self.active
+0000abd0: 5f73 6d61 7274 5f64 6574 6563 745f 7365  _smart_detect_se
+0000abe0: 7474 696e 6773 2e61 7574 6f5f 7472 6163  ttings.auto_trac
+0000abf0: 6b69 6e67 5f6f 626a 6563 745f 7479 7065  king_object_type
+0000ac00: 730a 2020 2020 2020 2020 290a 0a20 2020  s.        )..   
+0000ac10: 2023 2065 6e64 7265 6769 6f6e 0a20 2020   # endregion.   
+0000ac20: 2023 2072 6567 696f 6e20 5665 6869 636c   # region Vehicl
+0000ac30: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+0000ac40: 0a20 2020 2064 6566 2063 616e 5f64 6574  .    def can_det
+0000ac50: 6563 745f 7665 6869 636c 6528 7365 6c66  ect_vehicle(self
+0000ac60: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+0000ac70: 2020 2072 6574 7572 6e20 536d 6172 7444     return SmartD
+0000ac80: 6574 6563 744f 626a 6563 7454 7970 652e  etectObjectType.
+0000ac90: 5645 4849 434c 4520 696e 2073 656c 662e  VEHICLE in self.
+0000aca0: 6665 6174 7572 655f 666c 6167 732e 736d  feature_flags.sm
+0000acb0: 6172 745f 6465 7465 6374 5f74 7970 6573  art_detect_types
+0000acc0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000acd0: 2020 2020 6465 6620 6973 5f76 6568 6963      def is_vehic
+0000ace0: 6c65 5f64 6574 6563 7469 6f6e 5f6f 6e28  le_detection_on(
+0000acf0: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+0000ad00: 2020 2020 2020 2022 2222 4973 2056 6568         """Is Veh
+0000ad10: 6963 6c65 2044 6574 6563 7469 6f6e 2061  icle Detection a
+0000ad20: 7661 696c 6162 6c65 2061 6e64 2065 6e61  vailable and ena
+0000ad30: 626c 6564 2028 6361 6d65 7261 2077 696c  bled (camera wil
+0000ad40: 6c20 7072 6f64 7563 6520 7665 6869 636c  l produce vehicl
+0000ad50: 6520 736d 6172 740a 2020 2020 2020 2020  e smart.        
+0000ad60: 6465 7465 6374 696f 6e20 6576 656e 7473  detection events
+0000ad70: 293f 0a20 2020 2020 2020 2022 2222 0a0a  )?.        """..
+0000ad80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000ad90: 656c 662e 5f69 735f 736d 6172 745f 656e  elf._is_smart_en
+0000ada0: 6162 6c65 6428 536d 6172 7444 6574 6563  abled(SmartDetec
+0000adb0: 744f 626a 6563 7454 7970 652e 5645 4849  tObjectType.VEHI
+0000adc0: 434c 4529 0a0a 2020 2020 4070 726f 7065  CLE)..    @prope
+0000add0: 7274 790a 2020 2020 6465 6620 6c61 7374  rty.    def last
+0000ade0: 5f76 6568 6963 6c65 5f64 6574 6563 745f  _vehicle_detect_
+0000adf0: 6576 656e 7428 7365 6c66 2920 2d3e 204f  event(self) -> O
+0000ae00: 7074 696f 6e61 6c5b 4576 656e 745d 3a0a  ptional[Event]:.
+0000ae10: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
+0000ae20: 6865 206c 6173 7420 7665 6869 636c 6520  he last vehicle 
+0000ae30: 736d 6172 7420 6465 7465 6374 696f 6e20  smart detection 
+0000ae40: 6576 656e 742e 2222 220a 0a20 2020 2020  event."""..     
+0000ae50: 2020 2072 6574 7572 6e20 7365 6c66 2e67     return self.g
+0000ae60: 6574 5f6c 6173 745f 736d 6172 745f 6465  et_last_smart_de
+0000ae70: 7465 6374 5f65 7665 6e74 2853 6d61 7274  tect_event(Smart
+0000ae80: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
+0000ae90: 2e56 4548 4943 4c45 290a 0a20 2020 2040  .VEHICLE)..    @
+0000aea0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000aeb0: 206c 6173 745f 7665 6869 636c 655f 6465   last_vehicle_de
+0000aec0: 7465 6374 2873 656c 6629 202d 3e20 4f70  tect(self) -> Op
+0000aed0: 7469 6f6e 616c 5b64 6174 6574 696d 655d  tional[datetime]
+0000aee0: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+0000aef0: 2074 6865 206c 6173 7420 7665 6869 636c   the last vehicl
+0000af00: 6520 736d 6172 7420 6465 7465 6374 696f  e smart detectio
+0000af10: 6e20 6576 656e 742e 2222 220a 0a20 2020  n event."""..   
+0000af20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000af30: 2e6c 6173 745f 736d 6172 745f 6465 7465  .last_smart_dete
+0000af40: 6374 732e 6765 7428 536d 6172 7444 6574  cts.get(SmartDet
+0000af50: 6563 744f 626a 6563 7454 7970 652e 5645  ectObjectType.VE
+0000af60: 4849 434c 4529 0a0a 2020 2020 4070 726f  HICLE)..    @pro
+0000af70: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
+0000af80: 5f76 6568 6963 6c65 5f63 7572 7265 6e74  _vehicle_current
+0000af90: 6c79 5f64 6574 6563 7465 6428 7365 6c66  ly_detected(self
+0000afa0: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+0000afb0: 2020 2022 2222 4973 2076 6568 6963 6c65     """Is vehicle
+0000afc0: 2063 7572 7265 6e74 6c79 2062 6569 6e67   currently being
+0000afd0: 2064 6574 6563 7465 6422 2222 0a0a 2020   detected"""..  
+0000afe0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000aff0: 662e 5f69 735f 736d 6172 745f 6465 7465  f._is_smart_dete
+0000b000: 6374 6564 2853 6d61 7274 4465 7465 6374  cted(SmartDetect
+0000b010: 4f62 6a65 6374 5479 7065 2e56 4548 4943  ObjectType.VEHIC
+0000b020: 4c45 290a 0a20 2020 2061 7379 6e63 2064  LE)..    async d
+0000b030: 6566 2073 6574 5f76 6568 6963 6c65 5f64  ef set_vehicle_d
+0000b040: 6574 6563 7469 6f6e 2873 656c 662c 2065  etection(self, e
+0000b050: 6e61 626c 6564 3a20 626f 6f6c 2920 2d3e  nabled: bool) ->
+0000b060: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+0000b070: 2222 546f 6767 6c65 7320 7665 6869 636c  ""Toggles vehicl
+0000b080: 6520 736d 6172 7420 6465 7465 6374 696f  e smart detectio
+0000b090: 6e2e 2052 6571 7569 7265 7320 6361 6d65  n. Requires came
+0000b0a0: 7261 2074 6f20 6861 7665 2073 6d61 7274  ra to have smart
+0000b0b0: 2064 6574 6563 7469 6f6e 2222 220a 0a20   detection""".. 
+0000b0c0: 2020 2020 2020 2072 6574 7572 6e20 6177         return aw
+0000b0d0: 6169 7420 7365 6c66 2e5f 7365 745f 6f62  ait self._set_ob
+0000b0e0: 6a65 6374 5f64 6574 6563 7428 536d 6172  ject_detect(Smar
+0000b0f0: 7444 6574 6563 744f 626a 6563 7454 7970  tDetectObjectTyp
+0000b100: 652e 5645 4849 434c 452c 2065 6e61 626c  e.VEHICLE, enabl
+0000b110: 6564 290a 0a20 2020 2023 2065 6e64 7265  ed)..    # endre
+0000b120: 6769 6f6e 0a20 2020 2023 2072 6567 696f  gion.    # regio
+0000b130: 6e20 4c69 6365 6e73 6520 506c 6174 650a  n License Plate.
+0000b140: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000b150: 2020 2064 6566 2063 616e 5f64 6574 6563     def can_detec
+0000b160: 745f 6c69 6365 6e73 655f 706c 6174 6528  t_license_plate(
+0000b170: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+0000b180: 2020 2020 2020 2072 6574 7572 6e20 280a         return (.
+0000b190: 2020 2020 2020 2020 2020 2020 536d 6172              Smar
+0000b1a0: 7444 6574 6563 744f 626a 6563 7454 7970  tDetectObjectTyp
+0000b1b0: 652e 4c49 4345 4e53 455f 504c 4154 4520  e.LICENSE_PLATE 
+0000b1c0: 696e 2073 656c 662e 6665 6174 7572 655f  in self.feature_
+0000b1d0: 666c 6167 732e 736d 6172 745f 6465 7465  flags.smart_dete
+0000b1e0: 6374 5f74 7970 6573 0a20 2020 2020 2020  ct_types.       
+0000b1f0: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
+0000b200: 790a 2020 2020 6465 6620 6973 5f6c 6963  y.    def is_lic
+0000b210: 656e 7365 5f70 6c61 7465 5f64 6574 6563  ense_plate_detec
+0000b220: 7469 6f6e 5f6f 6e28 7365 6c66 2920 2d3e  tion_on(self) ->
+0000b230: 2062 6f6f 6c3a 0a20 2020 2020 2020 2022   bool:.        "
+0000b240: 2222 4973 204c 6963 656e 7365 2050 6c61  ""Is License Pla
+0000b250: 7465 2044 6574 6563 7469 6f6e 2061 7661  te Detection ava
+0000b260: 696c 6162 6c65 2061 6e64 2065 6e61 626c  ilable and enabl
+0000b270: 6564 2028 6361 6d65 7261 2077 696c 6c20  ed (camera will 
+0000b280: 7072 6f64 7563 6520 6661 6365 206c 6963  produce face lic
+0000b290: 656e 7365 0a20 2020 2020 2020 2070 6c61  ense.        pla
+0000b2a0: 7465 2064 6574 6563 7469 6f6e 2065 7665  te detection eve
+0000b2b0: 6e74 7329 3f0a 2020 2020 2020 2020 2222  nts)?.        ""
+0000b2c0: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+0000b2d0: 6e20 280a 2020 2020 2020 2020 2020 2020  n (.            
+0000b2e0: 7365 6c66 2e5f 6973 5f73 6d61 7274 5f65  self._is_smart_e
+0000b2f0: 6e61 626c 6564 2853 6d61 7274 4465 7465  nabled(SmartDete
+0000b300: 6374 4f62 6a65 6374 5479 7065 2e4c 4943  ctObjectType.LIC
+0000b310: 454e 5345 5f50 4c41 5445 290a 2020 2020  ENSE_PLATE).    
+0000b320: 2020 2020 2020 2020 616e 6420 7365 6c66          and self
+0000b330: 2e69 735f 6c69 6365 6e73 655f 706c 6174  .is_license_plat
+0000b340: 655f 6465 7465 6374 696f 6e73 5f61 6c6c  e_detections_all
+0000b350: 6f77 6564 0a20 2020 2020 2020 2029 0a0a  owed.        )..
+0000b360: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000b370: 2020 6465 6620 6c61 7374 5f6c 6963 656e    def last_licen
+0000b380: 7365 5f70 6c61 7465 5f64 6574 6563 745f  se_plate_detect_
+0000b390: 6576 656e 7428 7365 6c66 2920 2d3e 204f  event(self) -> O
+0000b3a0: 7074 696f 6e61 6c5b 4576 656e 745d 3a0a  ptional[Event]:.
+0000b3b0: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
+0000b3c0: 6865 206c 6173 7420 6c69 6365 6e73 6520  he last license 
+0000b3d0: 706c 6174 6520 736d 6172 7420 6465 7465  plate smart dete
+0000b3e0: 6374 696f 6e20 6576 656e 742e 2222 220a  ction event.""".
+0000b3f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000b400: 7365 6c66 2e67 6574 5f6c 6173 745f 736d  self.get_last_sm
+0000b410: 6172 745f 6465 7465 6374 5f65 7665 6e74  art_detect_event
+0000b420: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
+0000b430: 6374 5479 7065 2e4c 4943 454e 5345 5f50  ctType.LICENSE_P
+0000b440: 4c41 5445 290a 0a20 2020 2040 7072 6f70  LATE)..    @prop
+0000b450: 6572 7479 0a20 2020 2064 6566 206c 6173  erty.    def las
+0000b460: 745f 6c69 6365 6e73 655f 706c 6174 655f  t_license_plate_
+0000b470: 6465 7465 6374 2873 656c 6629 202d 3e20  detect(self) -> 
+0000b480: 4f70 7469 6f6e 616c 5b64 6174 6574 696d  Optional[datetim
+0000b490: 655d 3a0a 2020 2020 2020 2020 2222 2247  e]:.        """G
+0000b4a0: 6574 2074 6865 206c 6173 7420 6c69 6365  et the last lice
+0000b4b0: 6e73 6520 706c 6174 6520 736d 6172 7420  nse plate smart 
+0000b4c0: 6465 7465 6374 696f 6e20 6576 656e 742e  detection event.
+0000b4d0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000b4e0: 7572 6e20 7365 6c66 2e6c 6173 745f 736d  urn self.last_sm
+0000b4f0: 6172 745f 6465 7465 6374 732e 6765 7428  art_detects.get(
+0000b500: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
+0000b510: 7454 7970 652e 4c49 4345 4e53 455f 504c  tType.LICENSE_PL
+0000b520: 4154 4529 0a0a 2020 2020 4070 726f 7065  ATE)..    @prope
+0000b530: 7274 790a 2020 2020 6465 6620 6973 5f6c  rty.    def is_l
+0000b540: 6963 656e 7365 5f70 6c61 7465 5f63 7572  icense_plate_cur
+0000b550: 7265 6e74 6c79 5f64 6574 6563 7465 6428  rently_detected(
+0000b560: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+0000b570: 2020 2020 2020 2022 2222 4973 206c 6963         """Is lic
+0000b580: 656e 7365 2070 6c61 7465 2063 7572 7265  ense plate curre
+0000b590: 6e74 6c79 2062 6569 6e67 2064 6574 6563  ntly being detec
+0000b5a0: 7465 6422 2222 0a0a 2020 2020 2020 2020  ted"""..        
+0000b5b0: 7265 7475 726e 2073 656c 662e 5f69 735f  return self._is_
+0000b5c0: 736d 6172 745f 6465 7465 6374 6564 2853  smart_detected(S
+0000b5d0: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
+0000b5e0: 5479 7065 2e4c 4943 454e 5345 5f50 4c41  Type.LICENSE_PLA
+0000b5f0: 5445 290a 0a20 2020 2061 7379 6e63 2064  TE)..    async d
+0000b600: 6566 2073 6574 5f6c 6963 656e 7365 5f70  ef set_license_p
+0000b610: 6c61 7465 5f64 6574 6563 7469 6f6e 2873  late_detection(s
+0000b620: 656c 662c 2065 6e61 626c 6564 3a20 626f  elf, enabled: bo
+0000b630: 6f6c 2920 2d3e 204e 6f6e 653a 0a20 2020  ol) -> None:.   
+0000b640: 2020 2020 2022 2222 546f 6767 6c65 7320       """Toggles 
+0000b650: 6c69 6365 6e73 6520 706c 6174 6520 736d  license plate sm
+0000b660: 6172 7420 6465 7465 6374 696f 6e2e 2052  art detection. R
+0000b670: 6571 7569 7265 7320 6361 6d65 7261 2074  equires camera t
+0000b680: 6f20 6861 7665 2073 6d61 7274 2064 6574  o have smart det
+0000b690: 6563 7469 6f6e 2222 220a 0a20 2020 2020  ection"""..     
+0000b6a0: 2020 2072 6574 7572 6e20 6177 6169 7420     return await 
+0000b6b0: 7365 6c66 2e5f 7365 745f 6f62 6a65 6374  self._set_object
+0000b6c0: 5f64 6574 6563 7428 0a20 2020 2020 2020  _detect(.       
+0000b6d0: 2020 2020 2053 6d61 7274 4465 7465 6374       SmartDetect
+0000b6e0: 4f62 6a65 6374 5479 7065 2e4c 4943 454e  ObjectType.LICEN
+0000b6f0: 5345 5f50 4c41 5445 2c0a 2020 2020 2020  SE_PLATE,.      
+0000b700: 2020 2020 2020 656e 6162 6c65 642c 0a20        enabled,. 
+0000b710: 2020 2020 2020 2029 0a0a 2020 2020 2320         )..    # 
+0000b720: 656e 6472 6567 696f 6e0a 2020 2020 2320  endregion.    # 
+0000b730: 7265 6769 6f6e 2046 6163 650a 0a20 2020  region Face..   
+0000b740: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000b750: 6566 2063 616e 5f64 6574 6563 745f 6661  ef can_detect_fa
+0000b760: 6365 2873 656c 6629 202d 3e20 626f 6f6c  ce(self) -> bool
+0000b770: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000b780: 2053 6d61 7274 4465 7465 6374 4f62 6a65   SmartDetectObje
+0000b790: 6374 5479 7065 2e46 4143 4520 696e 2073  ctType.FACE in s
+0000b7a0: 656c 662e 6665 6174 7572 655f 666c 6167  elf.feature_flag
+0000b7b0: 732e 736d 6172 745f 6465 7465 6374 5f74  s.smart_detect_t
+0000b7c0: 7970 6573 0a0a 2020 2020 4070 726f 7065  ypes..    @prope
+0000b7d0: 7274 790a 2020 2020 6465 6620 6973 5f66  rty.    def is_f
+0000b7e0: 6163 655f 6465 7465 6374 696f 6e5f 6f6e  ace_detection_on
+0000b7f0: 2873 656c 6629 202d 3e20 626f 6f6c 3a0a  (self) -> bool:.
+0000b800: 2020 2020 2020 2020 2222 2249 7320 4661          """Is Fa
+0000b810: 6365 2044 6574 6563 7469 6f6e 2061 7661  ce Detection ava
+0000b820: 696c 6162 6c65 2061 6e64 2065 6e61 626c  ilable and enabl
+0000b830: 6564 2028 6361 6d65 7261 2077 696c 6c20  ed (camera will 
+0000b840: 7072 6f64 7563 6520 6661 6365 206c 6963  produce face lic
+0000b850: 656e 7365 0a20 2020 2020 2020 2070 6c61  ense.        pla
+0000b860: 7465 2064 6574 6563 7469 6f6e 2065 7665  te detection eve
+0000b870: 6e74 7329 3f0a 2020 2020 2020 2020 2222  nts)?.        ""
+0000b880: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+0000b890: 6e20 280a 2020 2020 2020 2020 2020 2020  n (.            
+0000b8a0: 7365 6c66 2e5f 6973 5f73 6d61 7274 5f65  self._is_smart_e
+0000b8b0: 6e61 626c 6564 2853 6d61 7274 4465 7465  nabled(SmartDete
+0000b8c0: 6374 4f62 6a65 6374 5479 7065 2e46 4143  ctObjectType.FAC
+0000b8d0: 4529 0a20 2020 2020 2020 2020 2020 2061  E).            a
+0000b8e0: 6e64 2073 656c 662e 6973 5f66 6163 655f  nd self.is_face_
+0000b8f0: 6465 7465 6374 696f 6e73 5f61 6c6c 6f77  detections_allow
+0000b900: 6564 0a20 2020 2020 2020 2029 0a0a 2020  ed.        )..  
+0000b910: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000b920: 6465 6620 6c61 7374 5f66 6163 655f 6465  def last_face_de
+0000b930: 7465 6374 5f65 7665 6e74 2873 656c 6629  tect_event(self)
+0000b940: 202d 3e20 4f70 7469 6f6e 616c 5b45 7665   -> Optional[Eve
+0000b950: 6e74 5d3a 0a20 2020 2020 2020 2022 2222  nt]:.        """
+0000b960: 4765 7420 7468 6520 6c61 7374 206c 6963  Get the last lic
+0000b970: 656e 7365 2070 6c61 7465 2073 6d61 7274  ense plate smart
+0000b980: 2064 6574 6563 7469 6f6e 2065 7665 6e74   detection event
+0000b990: 2e22 2222 0a0a 2020 2020 2020 2020 7265  ."""..        re
+0000b9a0: 7475 726e 2073 656c 662e 6765 745f 6c61  turn self.get_la
+0000b9b0: 7374 5f73 6d61 7274 5f64 6574 6563 745f  st_smart_detect_
+0000b9c0: 6576 656e 7428 536d 6172 7444 6574 6563  event(SmartDetec
+0000b9d0: 744f 626a 6563 7454 7970 652e 4641 4345  tObjectType.FACE
+0000b9e0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0000b9f0: 0a20 2020 2064 6566 206c 6173 745f 6661  .    def last_fa
+0000ba00: 6365 5f64 6574 6563 7428 7365 6c66 2920  ce_detect(self) 
+0000ba10: 2d3e 204f 7074 696f 6e61 6c5b 6461 7465  -> Optional[date
+0000ba20: 7469 6d65 5d3a 0a20 2020 2020 2020 2022  time]:.        "
+0000ba30: 2222 4765 7420 7468 6520 6c61 7374 2066  ""Get the last f
+0000ba40: 6163 6520 706c 6174 6520 736d 6172 7420  ace plate smart 
+0000ba50: 6465 7465 6374 696f 6e20 6576 656e 742e  detection event.
+0000ba60: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000ba70: 7572 6e20 7365 6c66 2e6c 6173 745f 736d  urn self.last_sm
+0000ba80: 6172 745f 6465 7465 6374 732e 6765 7428  art_detects.get(
+0000ba90: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
+0000baa0: 7454 7970 652e 4641 4345 290a 0a20 2020  tType.FACE)..   
+0000bab0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000bac0: 6566 2069 735f 6661 6365 5f63 7572 7265  ef is_face_curre
+0000bad0: 6e74 6c79 5f64 6574 6563 7465 6428 7365  ntly_detected(se
+0000bae0: 6c66 2920 2d3e 2062 6f6f 6c3a 0a20 2020  lf) -> bool:.   
+0000baf0: 2020 2020 2022 2222 4973 2066 6163 6520       """Is face 
+0000bb00: 6375 7272 656e 746c 7920 6265 696e 6720  currently being 
+0000bb10: 6465 7465 6374 6564 2222 220a 0a20 2020  detected"""..   
+0000bb20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000bb30: 2e5f 6973 5f73 6d61 7274 5f64 6574 6563  ._is_smart_detec
+0000bb40: 7465 6428 536d 6172 7444 6574 6563 744f  ted(SmartDetectO
+0000bb50: 626a 6563 7454 7970 652e 4641 4345 290a  bjectType.FACE).
+0000bb60: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
+0000bb70: 6574 5f66 6163 655f 6465 7465 6374 696f  et_face_detectio
+0000bb80: 6e28 7365 6c66 2c20 656e 6162 6c65 643a  n(self, enabled:
+0000bb90: 2062 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a   bool) -> None:.
+0000bba0: 2020 2020 2020 2020 2222 2254 6f67 676c          """Toggl
+0000bbb0: 6573 2066 6163 6520 736d 6172 7420 6465  es face smart de
+0000bbc0: 7465 6374 696f 6e2e 2052 6571 7569 7265  tection. Require
+0000bbd0: 7320 6361 6d65 7261 2074 6f20 6861 7665  s camera to have
+0000bbe0: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+0000bbf0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000bc00: 7572 6e20 6177 6169 7420 7365 6c66 2e5f  urn await self._
+0000bc10: 7365 745f 6f62 6a65 6374 5f64 6574 6563  set_object_detec
+0000bc20: 7428 0a20 2020 2020 2020 2020 2020 2053  t(.            S
+0000bc30: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
+0000bc40: 5479 7065 2e46 4143 452c 0a20 2020 2020  Type.FACE,.     
+0000bc50: 2020 2020 2020 2065 6e61 626c 6564 2c0a         enabled,.
+0000bc60: 2020 2020 2020 2020 290a 0a20 2020 2023          )..    #
+0000bc70: 2065 6e64 7265 6769 6f6e 0a20 2020 2023   endregion.    #
+0000bc80: 2072 6567 696f 6e20 5061 636b 6167 650a   region Package.
+0000bc90: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000bca0: 2020 2064 6566 2063 616e 5f64 6574 6563     def can_detec
+0000bcb0: 745f 7061 636b 6167 6528 7365 6c66 2920  t_package(self) 
+0000bcc0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+0000bcd0: 2072 6574 7572 6e20 536d 6172 7444 6574   return SmartDet
+0000bce0: 6563 744f 626a 6563 7454 7970 652e 5041  ectObjectType.PA
+0000bcf0: 434b 4147 4520 696e 2073 656c 662e 6665  CKAGE in self.fe
+0000bd00: 6174 7572 655f 666c 6167 732e 736d 6172  ature_flags.smar
+0000bd10: 745f 6465 7465 6374 5f74 7970 6573 0a0a  t_detect_types..
+0000bd20: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000bd30: 2020 6465 6620 6973 5f70 6163 6b61 6765    def is_package
+0000bd40: 5f64 6574 6563 7469 6f6e 5f6f 6e28 7365  _detection_on(se
+0000bd50: 6c66 2920 2d3e 2062 6f6f 6c3a 0a20 2020  lf) -> bool:.   
+0000bd60: 2020 2020 2022 2222 4973 2050 6163 6b61       """Is Packa
+0000bd70: 6765 2044 6574 6563 7469 6f6e 2061 7661  ge Detection ava
+0000bd80: 696c 6162 6c65 2061 6e64 2065 6e61 626c  ilable and enabl
+0000bd90: 6564 2028 6361 6d65 7261 2077 696c 6c20  ed (camera will 
+0000bda0: 7072 6f64 7563 6520 7061 636b 6167 6520  produce package 
+0000bdb0: 736d 6172 740a 2020 2020 2020 2020 6465  smart.        de
+0000bdc0: 7465 6374 696f 6e20 6576 656e 7473 293f  tection events)?
+0000bdd0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0000bde0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000bdf0: 662e 5f69 735f 736d 6172 745f 656e 6162  f._is_smart_enab
+0000be00: 6c65 6428 536d 6172 7444 6574 6563 744f  led(SmartDetectO
+0000be10: 626a 6563 7454 7970 652e 5041 434b 4147  bjectType.PACKAG
+0000be20: 4529 0a0a 2020 2020 4070 726f 7065 7274  E)..    @propert
+0000be30: 790a 2020 2020 6465 6620 6c61 7374 5f70  y.    def last_p
+0000be40: 6163 6b61 6765 5f64 6574 6563 745f 6576  ackage_detect_ev
+0000be50: 656e 7428 7365 6c66 2920 2d3e 204f 7074  ent(self) -> Opt
+0000be60: 696f 6e61 6c5b 4576 656e 745d 3a0a 2020  ional[Event]:.  
+0000be70: 2020 2020 2020 2222 2247 6574 2074 6865        """Get the
+0000be80: 206c 6173 7420 7061 636b 6167 6520 736d   last package sm
+0000be90: 6172 7420 6465 7465 6374 696f 6e20 6576  art detection ev
+0000bea0: 656e 742e 2222 220a 0a20 2020 2020 2020  ent."""..       
+0000beb0: 2072 6574 7572 6e20 7365 6c66 2e67 6574   return self.get
+0000bec0: 5f6c 6173 745f 736d 6172 745f 6465 7465  _last_smart_dete
+0000bed0: 6374 5f65 7665 6e74 2853 6d61 7274 4465  ct_event(SmartDe
+0000bee0: 7465 6374 4f62 6a65 6374 5479 7065 2e50  tectObjectType.P
+0000bef0: 4143 4b41 4745 290a 0a20 2020 2040 7072  ACKAGE)..    @pr
+0000bf00: 6f70 6572 7479 0a20 2020 2064 6566 206c  operty.    def l
+0000bf10: 6173 745f 7061 636b 6167 655f 6465 7465  ast_package_dete
+0000bf20: 6374 2873 656c 6629 202d 3e20 4f70 7469  ct(self) -> Opti
+0000bf30: 6f6e 616c 5b64 6174 6574 696d 655d 3a0a  onal[datetime]:.
+0000bf40: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
+0000bf50: 6865 206c 6173 7420 7061 636b 6167 6520  he last package 
+0000bf60: 736d 6172 7420 6465 7465 6374 696f 6e20  smart detection 
+0000bf70: 6576 656e 742e 2222 220a 0a20 2020 2020  event."""..     
+0000bf80: 2020 2072 6574 7572 6e20 7365 6c66 2e6c     return self.l
+0000bf90: 6173 745f 736d 6172 745f 6465 7465 6374  ast_smart_detect
+0000bfa0: 732e 6765 7428 536d 6172 7444 6574 6563  s.get(SmartDetec
+0000bfb0: 744f 626a 6563 7454 7970 652e 5041 434b  tObjectType.PACK
+0000bfc0: 4147 4529 0a0a 2020 2020 4070 726f 7065  AGE)..    @prope
+0000bfd0: 7274 790a 2020 2020 6465 6620 6973 5f70  rty.    def is_p
+0000bfe0: 6163 6b61 6765 5f63 7572 7265 6e74 6c79  ackage_currently
+0000bff0: 5f64 6574 6563 7465 6428 7365 6c66 2920  _detected(self) 
+0000c000: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+0000c010: 2022 2222 4973 2070 6163 6b61 6765 2063   """Is package c
+0000c020: 7572 7265 6e74 6c79 2062 6569 6e67 2064  urrently being d
+0000c030: 6574 6563 7465 6422 2222 0a0a 2020 2020  etected"""..    
+0000c040: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000c050: 5f69 735f 736d 6172 745f 6465 7465 6374  _is_smart_detect
+0000c060: 6564 2853 6d61 7274 4465 7465 6374 4f62  ed(SmartDetectOb
+0000c070: 6a65 6374 5479 7065 2e50 4143 4b41 4745  jectType.PACKAGE
+0000c080: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
+0000c090: 2073 6574 5f70 6163 6b61 6765 5f64 6574   set_package_det
+0000c0a0: 6563 7469 6f6e 2873 656c 662c 2065 6e61  ection(self, ena
+0000c0b0: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
+0000c0c0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+0000c0d0: 546f 6767 6c65 7320 7061 636b 6167 6520  Toggles package 
+0000c0e0: 736d 6172 7420 6465 7465 6374 696f 6e2e  smart detection.
+0000c0f0: 2052 6571 7569 7265 7320 6361 6d65 7261   Requires camera
+0000c100: 2074 6f20 6861 7665 2073 6d61 7274 2064   to have smart d
+0000c110: 6574 6563 7469 6f6e 2222 220a 0a20 2020  etection"""..   
+0000c120: 2020 2020 2072 6574 7572 6e20 6177 6169       return awai
+0000c130: 7420 7365 6c66 2e5f 7365 745f 6f62 6a65  t self._set_obje
+0000c140: 6374 5f64 6574 6563 7428 536d 6172 7444  ct_detect(SmartD
+0000c150: 6574 6563 744f 626a 6563 7454 7970 652e  etectObjectType.
+0000c160: 5041 434b 4147 452c 2065 6e61 626c 6564  PACKAGE, enabled
+0000c170: 290a 0a20 2020 2023 2065 6e64 7265 6769  )..    # endregi
+0000c180: 6f6e 0a20 2020 2023 2072 6567 696f 6e20  on.    # region 
+0000c190: 416e 696d 616c 0a0a 2020 2020 4070 726f  Animal..    @pro
+0000c1a0: 7065 7274 790a 2020 2020 6465 6620 6361  perty.    def ca
+0000c1b0: 6e5f 6465 7465 6374 5f61 6e69 6d61 6c28  n_detect_animal(
+0000c1c0: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+0000c1d0: 2020 2020 2020 2072 6574 7572 6e20 536d         return Sm
+0000c1e0: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
+0000c1f0: 7970 652e 414e 494d 414c 2069 6e20 7365  ype.ANIMAL in se
+0000c200: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
+0000c210: 2e73 6d61 7274 5f64 6574 6563 745f 7479  .smart_detect_ty
+0000c220: 7065 730a 0a20 2020 2040 7072 6f70 6572  pes..    @proper
+0000c230: 7479 0a20 2020 2064 6566 2069 735f 616e  ty.    def is_an
+0000c240: 696d 616c 5f64 6574 6563 7469 6f6e 5f6f  imal_detection_o
+0000c250: 6e28 7365 6c66 2920 2d3e 2062 6f6f 6c3a  n(self) -> bool:
+0000c260: 0a20 2020 2020 2020 2022 2222 4973 2041  .        """Is A
+0000c270: 6e69 6d61 6c20 4465 7465 6374 696f 6e20  nimal Detection 
+0000c280: 6176 6169 6c61 626c 6520 616e 6420 656e  available and en
+0000c290: 6162 6c65 6420 2863 616d 6572 6120 7769  abled (camera wi
+0000c2a0: 6c6c 2070 726f 6475 6365 2070 6163 6b61  ll produce packa
+0000c2b0: 6765 2073 6d61 7274 0a20 2020 2020 2020  ge smart.       
+0000c2c0: 2064 6574 6563 7469 6f6e 2065 7665 6e74   detection event
+0000c2d0: 7329 3f0a 2020 2020 2020 2020 2222 220a  s)?.        """.
+0000c2e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000c2f0: 7365 6c66 2e5f 6973 5f73 6d61 7274 5f65  self._is_smart_e
+0000c300: 6e61 626c 6564 2853 6d61 7274 4465 7465  nabled(SmartDete
+0000c310: 6374 4f62 6a65 6374 5479 7065 2e41 4e49  ctObjectType.ANI
+0000c320: 4d41 4c29 0a0a 2020 2020 4070 726f 7065  MAL)..    @prope
+0000c330: 7274 790a 2020 2020 6465 6620 6c61 7374  rty.    def last
+0000c340: 5f61 6e69 6d61 6c5f 6465 7465 6374 5f65  _animal_detect_e
+0000c350: 7665 6e74 2873 656c 6629 202d 3e20 4f70  vent(self) -> Op
+0000c360: 7469 6f6e 616c 5b45 7665 6e74 5d3a 0a20  tional[Event]:. 
+0000c370: 2020 2020 2020 2022 2222 4765 7420 7468         """Get th
+0000c380: 6520 6c61 7374 2061 6e69 6d61 6c20 736d  e last animal sm
+0000c390: 6172 7420 6465 7465 6374 696f 6e20 6576  art detection ev
+0000c3a0: 656e 742e 2222 220a 0a20 2020 2020 2020  ent."""..       
+0000c3b0: 2072 6574 7572 6e20 7365 6c66 2e67 6574   return self.get
+0000c3c0: 5f6c 6173 745f 736d 6172 745f 6465 7465  _last_smart_dete
+0000c3d0: 6374 5f65 7665 6e74 2853 6d61 7274 4465  ct_event(SmartDe
+0000c3e0: 7465 6374 4f62 6a65 6374 5479 7065 2e41  tectObjectType.A
+0000c3f0: 4e49 4d41 4c29 0a0a 2020 2020 4070 726f  NIMAL)..    @pro
+0000c400: 7065 7274 790a 2020 2020 6465 6620 6c61  perty.    def la
+0000c410: 7374 5f61 6e69 6d61 6c5f 6465 7465 6374  st_animal_detect
+0000c420: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
+0000c430: 616c 5b64 6174 6574 696d 655d 3a0a 2020  al[datetime]:.  
+0000c440: 2020 2020 2020 2222 2247 6574 2074 6865        """Get the
+0000c450: 206c 6173 7420 616e 696d 616c 2073 6d61   last animal sma
+0000c460: 7274 2064 6574 6563 7469 6f6e 2065 7665  rt detection eve
+0000c470: 6e74 2e22 2222 0a0a 2020 2020 2020 2020  nt."""..        
+0000c480: 7265 7475 726e 2073 656c 662e 6c61 7374  return self.last
+0000c490: 5f73 6d61 7274 5f64 6574 6563 7473 2e67  _smart_detects.g
+0000c4a0: 6574 2853 6d61 7274 4465 7465 6374 4f62  et(SmartDetectOb
+0000c4b0: 6a65 6374 5479 7065 2e41 4e49 4d41 4c29  jectType.ANIMAL)
+0000c4c0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000c4d0: 2020 2020 6465 6620 6973 5f61 6e69 6d61      def is_anima
+0000c4e0: 6c5f 6375 7272 656e 746c 795f 6465 7465  l_currently_dete
+0000c4f0: 6374 6564 2873 656c 6629 202d 3e20 626f  cted(self) -> bo
+0000c500: 6f6c 3a0a 2020 2020 2020 2020 2222 2249  ol:.        """I
+0000c510: 7320 616e 696d 616c 2063 7572 7265 6e74  s animal current
+0000c520: 6c79 2062 6569 6e67 2064 6574 6563 7465  ly being detecte
+0000c530: 6422 2222 0a0a 2020 2020 2020 2020 7265  d"""..        re
+0000c540: 7475 726e 2073 656c 662e 5f69 735f 736d  turn self._is_sm
+0000c550: 6172 745f 6465 7465 6374 6564 2853 6d61  art_detected(Sma
+0000c560: 7274 4465 7465 6374 4f62 6a65 6374 5479  rtDetectObjectTy
+0000c570: 7065 2e41 4e49 4d41 4c29 0a0a 2020 2020  pe.ANIMAL)..    
+0000c580: 6173 796e 6320 6465 6620 7365 745f 616e  async def set_an
+0000c590: 696d 616c 5f64 6574 6563 7469 6f6e 2873  imal_detection(s
+0000c5a0: 656c 662c 2065 6e61 626c 6564 3a20 626f  elf, enabled: bo
+0000c5b0: 6f6c 2920 2d3e 204e 6f6e 653a 0a20 2020  ol) -> None:.   
+0000c5c0: 2020 2020 2022 2222 546f 6767 6c65 7320       """Toggles 
+0000c5d0: 616e 696d 616c 2073 6d61 7274 2064 6574  animal smart det
+0000c5e0: 6563 7469 6f6e 2e20 5265 7175 6972 6573  ection. Requires
+0000c5f0: 2063 616d 6572 6120 746f 2068 6176 6520   camera to have 
+0000c600: 736d 6172 7420 6465 7465 6374 696f 6e22  smart detection"
+0000c610: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
+0000c620: 726e 2061 7761 6974 2073 656c 662e 5f73  rn await self._s
+0000c630: 6574 5f6f 626a 6563 745f 6465 7465 6374  et_object_detect
+0000c640: 2853 6d61 7274 4465 7465 6374 4f62 6a65  (SmartDetectObje
+0000c650: 6374 5479 7065 2e41 4e49 4d41 4c2c 2065  ctType.ANIMAL, e
+0000c660: 6e61 626c 6564 290a 0a20 2020 2023 2065  nabled)..    # e
+0000c670: 6e64 7265 6769 6f6e 0a20 2020 2023 2065  ndregion.    # e
+0000c680: 6e64 7265 6769 6f6e 0a20 2020 2023 2072  ndregion.    # r
+0000c690: 6567 696f 6e20 4175 6469 6f20 536d 6172  egion Audio Smar
+0000c6a0: 7420 4465 7465 6374 696f 6e73 0a0a 2020  t Detections..  
+0000c6b0: 2020 6465 6620 5f63 616e 5f64 6574 6563    def _can_detec
+0000c6c0: 745f 6175 6469 6f28 7365 6c66 2c20 736d  t_audio(self, sm
+0000c6d0: 6172 745f 7479 7065 3a20 536d 6172 7444  art_type: SmartD
+0000c6e0: 6574 6563 744f 626a 6563 7454 7970 6529  etectObjectType)
+0000c6f0: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+0000c700: 2020 6175 6469 6f5f 7479 7065 203d 2073    audio_type = s
+0000c710: 6d61 7274 5f74 7970 652e 6175 6469 6f5f  mart_type.audio_
+0000c720: 7479 7065 0a20 2020 2020 2020 2072 6574  type.        ret
+0000c730: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+0000c740: 2020 6175 6469 6f5f 7479 7065 2069 7320    audio_type is 
+0000c750: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+0000c760: 2020 2020 2061 6e64 2073 656c 662e 6665       and self.fe
+0000c770: 6174 7572 655f 666c 6167 732e 736d 6172  ature_flags.smar
+0000c780: 745f 6465 7465 6374 5f61 7564 696f 5f74  t_detect_audio_t
+0000c790: 7970 6573 2069 7320 6e6f 7420 4e6f 6e65  ypes is not None
+0000c7a0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+0000c7b0: 2061 7564 696f 5f74 7970 6520 696e 2073   audio_type in s
+0000c7c0: 656c 662e 6665 6174 7572 655f 666c 6167  elf.feature_flag
+0000c7d0: 732e 736d 6172 745f 6465 7465 6374 5f61  s.smart_detect_a
+0000c7e0: 7564 696f 5f74 7970 6573 0a20 2020 2020  udio_types.     
+0000c7f0: 2020 2029 0a0a 2020 2020 6465 6620 5f69     )..    def _i
+0000c800: 735f 6175 6469 6f5f 656e 6162 6c65 6428  s_audio_enabled(
+0000c810: 7365 6c66 2c20 736d 6172 745f 7479 7065  self, smart_type
+0000c820: 3a20 536d 6172 7444 6574 6563 744f 626a  : SmartDetectObj
+0000c830: 6563 7454 7970 6529 202d 3e20 626f 6f6c  ectType) -> bool
+0000c840: 3a0a 2020 2020 2020 2020 6175 6469 6f5f  :.        audio_
+0000c850: 7479 7065 203d 2073 6d61 7274 5f74 7970  type = smart_typ
+0000c860: 652e 6175 6469 6f5f 7479 7065 0a20 2020  e.audio_type.   
+0000c870: 2020 2020 2072 6574 7572 6e20 280a 2020       return (.  
+0000c880: 2020 2020 2020 2020 2020 6175 6469 6f5f            audio_
+0000c890: 7479 7065 2069 7320 6e6f 7420 4e6f 6e65  type is not None
+0000c8a0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+0000c8b0: 2073 656c 662e 6973 5f72 6563 6f72 6469   self.is_recordi
+0000c8c0: 6e67 5f65 6e61 626c 6564 0a20 2020 2020  ng_enabled.     
+0000c8d0: 2020 2020 2020 2061 6e64 2061 7564 696f         and audio
+0000c8e0: 5f74 7970 6520 696e 2073 656c 662e 6163  _type in self.ac
+0000c8f0: 7469 7665 5f61 7564 696f 5f64 6574 6563  tive_audio_detec
+0000c900: 745f 7479 7065 730a 2020 2020 2020 2020  t_types.        
+0000c910: 290a 0a20 2020 2064 6566 205f 6973 5f61  )..    def _is_a
+0000c920: 7564 696f 5f64 6574 6563 7465 6428 7365  udio_detected(se
+0000c930: 6c66 2c20 736d 6172 745f 7479 7065 3a20  lf, smart_type: 
+0000c940: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
+0000c950: 7454 7970 6529 202d 3e20 626f 6f6c 3a0a  tType) -> bool:.
+0000c960: 2020 2020 2020 2020 6175 6469 6f5f 7479          audio_ty
+0000c970: 7065 203d 2073 6d61 7274 5f74 7970 652e  pe = smart_type.
+0000c980: 6175 6469 6f5f 7479 7065 0a20 2020 2020  audio_type.     
+0000c990: 2020 2069 6620 6175 6469 6f5f 7479 7065     if audio_type
+0000c9a0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0000c9b0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0000c9c0: 7365 0a0a 2020 2020 2020 2020 6576 656e  se..        even
+0000c9d0: 7420 3d20 7365 6c66 2e67 6574 5f6c 6173  t = self.get_las
+0000c9e0: 745f 736d 6172 745f 6175 6469 6f5f 6465  t_smart_audio_de
+0000c9f0: 7465 6374 5f65 7665 6e74 2861 7564 696f  tect_event(audio
+0000ca00: 5f74 7970 6529 0a20 2020 2020 2020 2072  _type).        r
+0000ca10: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
+0000ca20: 2020 2020 7365 6c66 2e5f 6973 5f61 7564      self._is_aud
+0000ca30: 696f 5f65 6e61 626c 6564 2873 6d61 7274  io_enabled(smart
+0000ca40: 5f74 7970 6529 0a20 2020 2020 2020 2020  _type).         
+0000ca50: 2020 2061 6e64 2065 7665 6e74 2069 7320     and event is 
+0000ca60: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+0000ca70: 2020 2020 2061 6e64 2065 7665 6e74 2e65       and event.e
+0000ca80: 6e64 2069 7320 4e6f 6e65 0a20 2020 2020  nd is None.     
+0000ca90: 2020 2020 2020 2061 6e64 2073 6d61 7274         and smart
+0000caa0: 5f74 7970 6520 696e 2065 7665 6e74 2e73  _type in event.s
+0000cab0: 6d61 7274 5f64 6574 6563 745f 7479 7065  mart_detect_type
+0000cac0: 730a 2020 2020 2020 2020 290a 0a20 2020  s.        )..   
+0000cad0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000cae0: 6566 2069 735f 6175 6469 6f5f 6375 7272  ef is_audio_curr
+0000caf0: 656e 746c 795f 6465 7465 6374 6564 2873  ently_detected(s
+0000cb00: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
+0000cb10: 2020 2020 2020 2222 2249 7320 6175 6469        """Is audi
+0000cb20: 6f20 6465 7465 6374 696f 6e20 6375 7272  o detection curr
+0000cb30: 656e 746c 7920 6265 696e 6720 6465 7465  ently being dete
+0000cb40: 6374 6564 2222 220a 0a20 2020 2020 2020  cted"""..       
+0000cb50: 2072 6574 7572 6e20 280a 2020 2020 2020   return (.      
+0000cb60: 2020 2020 2020 7365 6c66 2e69 735f 7265        self.is_re
+0000cb70: 636f 7264 696e 675f 656e 6162 6c65 640a  cording_enabled.
+0000cb80: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0000cb90: 626f 6f6c 2873 656c 662e 6163 7469 7665  bool(self.active
+0000cba0: 5f61 7564 696f 5f64 6574 6563 745f 7479  _audio_detect_ty
+0000cbb0: 7065 7329 0a20 2020 2020 2020 2020 2020  pes).           
+0000cbc0: 2061 6e64 2073 656c 662e 6c61 7374 5f73   and self.last_s
+0000cbd0: 6d61 7274 5f61 7564 696f 5f64 6574 6563  mart_audio_detec
+0000cbe0: 745f 6576 656e 7420 6973 206e 6f74 204e  t_event is not N
+0000cbf0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+0000cc00: 616e 6420 7365 6c66 2e6c 6173 745f 736d  and self.last_sm
+0000cc10: 6172 745f 6175 6469 6f5f 6465 7465 6374  art_audio_detect
+0000cc20: 5f65 7665 6e74 2e65 6e64 2069 7320 4e6f  _event.end is No
+0000cc30: 6e65 0a20 2020 2020 2020 2029 0a0a 2020  ne.        )..  
+0000cc40: 2020 2320 7265 6769 6f6e 2053 6d6f 6b65    # region Smoke
+0000cc50: 2041 6c61 726d 0a0a 2020 2020 4070 726f   Alarm..    @pro
+0000cc60: 7065 7274 790a 2020 2020 6465 6620 6361  perty.    def ca
+0000cc70: 6e5f 6465 7465 6374 5f73 6d6f 6b65 2873  n_detect_smoke(s
+0000cc80: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
+0000cc90: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000cca0: 662e 5f63 616e 5f64 6574 6563 745f 6175  f._can_detect_au
+0000ccb0: 6469 6f28 536d 6172 7444 6574 6563 744f  dio(SmartDetectO
+0000ccc0: 626a 6563 7454 7970 652e 534d 4f4b 4529  bjectType.SMOKE)
+0000ccd0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000cce0: 2020 2020 6465 6620 6973 5f73 6d6f 6b65      def is_smoke
+0000ccf0: 5f64 6574 6563 7469 6f6e 5f6f 6e28 7365  _detection_on(se
+0000cd00: 6c66 2920 2d3e 2062 6f6f 6c3a 0a20 2020  lf) -> bool:.   
+0000cd10: 2020 2020 2022 2222 4973 2053 6d6f 6b65       """Is Smoke
+0000cd20: 2041 6c61 726d 2044 6574 6563 7469 6f6e   Alarm Detection
+0000cd30: 2061 7661 696c 6162 6c65 2061 6e64 2065   available and e
+0000cd40: 6e61 626c 6564 2028 6361 6d65 7261 2077  nabled (camera w
+0000cd50: 696c 6c20 7072 6f64 7563 6520 736d 6f6b  ill produce smok
+0000cd60: 650a 2020 2020 2020 2020 736d 6172 7420  e.        smart 
+0000cd70: 6465 7465 6374 696f 6e20 6576 656e 7473  detection events
+0000cd80: 293f 0a20 2020 2020 2020 2022 2222 0a0a  )?.        """..
+0000cd90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000cda0: 656c 662e 5f69 735f 6175 6469 6f5f 656e  elf._is_audio_en
+0000cdb0: 6162 6c65 6428 536d 6172 7444 6574 6563  abled(SmartDetec
+0000cdc0: 744f 626a 6563 7454 7970 652e 534d 4f4b  tObjectType.SMOK
+0000cdd0: 4529 0a0a 2020 2020 4070 726f 7065 7274  E)..    @propert
+0000cde0: 790a 2020 2020 6465 6620 6c61 7374 5f73  y.    def last_s
+0000cdf0: 6d6f 6b65 5f64 6574 6563 745f 6576 656e  moke_detect_even
+0000ce00: 7428 7365 6c66 2920 2d3e 204f 7074 696f  t(self) -> Optio
+0000ce10: 6e61 6c5b 4576 656e 745d 3a0a 2020 2020  nal[Event]:.    
+0000ce20: 2020 2020 2222 2247 6574 2074 6865 206c      """Get the l
+0000ce30: 6173 7420 7065 7273 6f6e 2073 6d61 7274  ast person smart
+0000ce40: 2064 6574 6563 7469 6f6e 2065 7665 6e74   detection event
+0000ce50: 2e22 2222 0a0a 2020 2020 2020 2020 7265  ."""..        re
+0000ce60: 7475 726e 2073 656c 662e 6765 745f 6c61  turn self.get_la
+0000ce70: 7374 5f73 6d61 7274 5f61 7564 696f 5f64  st_smart_audio_d
+0000ce80: 6574 6563 745f 6576 656e 7428 536d 6172  etect_event(Smar
+0000ce90: 7444 6574 6563 7441 7564 696f 5479 7065  tDetectAudioType
+0000cea0: 2e53 4d4f 4b45 290a 0a20 2020 2040 7072  .SMOKE)..    @pr
+0000ceb0: 6f70 6572 7479 0a20 2020 2064 6566 206c  operty.    def l
+0000cec0: 6173 745f 736d 6f6b 655f 6465 7465 6374  ast_smoke_detect
+0000ced0: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
+0000cee0: 616c 5b64 6174 6574 696d 655d 3a0a 2020  al[datetime]:.  
+0000cef0: 2020 2020 2020 2222 2247 6574 2074 6865        """Get the
+0000cf00: 206c 6173 7420 736d 6f6b 6520 736d 6172   last smoke smar
+0000cf10: 7420 6465 7465 6374 696f 6e20 6576 656e  t detection even
+0000cf20: 742e 2222 220a 0a20 2020 2020 2020 2072  t."""..        r
+0000cf30: 6574 7572 6e20 7365 6c66 2e6c 6173 745f  eturn self.last_
+0000cf40: 736d 6172 745f 6175 6469 6f5f 6465 7465  smart_audio_dete
+0000cf50: 6374 732e 6765 7428 536d 6172 7444 6574  cts.get(SmartDet
+0000cf60: 6563 7441 7564 696f 5479 7065 2e53 4d4f  ectAudioType.SMO
+0000cf70: 4b45 290a 0a20 2020 2040 7072 6f70 6572  KE)..    @proper
+0000cf80: 7479 0a20 2020 2064 6566 2069 735f 736d  ty.    def is_sm
+0000cf90: 6f6b 655f 6375 7272 656e 746c 795f 6465  oke_currently_de
+0000cfa0: 7465 6374 6564 2873 656c 6629 202d 3e20  tected(self) -> 
+0000cfb0: 626f 6f6c 3a0a 2020 2020 2020 2020 2222  bool:.        ""
+0000cfc0: 2249 7320 736d 6f6b 6520 616c 6172 6d20  "Is smoke alarm 
+0000cfd0: 6375 7272 656e 746c 7920 6265 696e 6720  currently being 
+0000cfe0: 6465 7465 6374 6564 2222 220a 0a20 2020  detected"""..   
+0000cff0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000d000: 2e5f 6973 5f61 7564 696f 5f64 6574 6563  ._is_audio_detec
+0000d010: 7465 6428 536d 6172 7444 6574 6563 744f  ted(SmartDetectO
+0000d020: 626a 6563 7454 7970 652e 534d 4f4b 4529  bjectType.SMOKE)
+0000d030: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
+0000d040: 7365 745f 736d 6f6b 655f 6465 7465 6374  set_smoke_detect
+0000d050: 696f 6e28 7365 6c66 2c20 656e 6162 6c65  ion(self, enable
+0000d060: 643a 2062 6f6f 6c29 202d 3e20 4e6f 6e65  d: bool) -> None
+0000d070: 3a0a 2020 2020 2020 2020 2222 2254 6f67  :.        """Tog
+0000d080: 676c 6573 2073 6d6f 6b65 2073 6d61 7274  gles smoke smart
+0000d090: 2064 6574 6563 7469 6f6e 2e20 5265 7175   detection. Requ
+0000d0a0: 6972 6573 2063 616d 6572 6120 746f 2068  ires camera to h
+0000d0b0: 6176 6520 736d 6172 7420 6465 7465 6374  ave smart detect
+0000d0c0: 696f 6e22 2222 0a0a 2020 2020 2020 2020  ion"""..        
+0000d0d0: 7265 7475 726e 2061 7761 6974 2073 656c  return await sel
+0000d0e0: 662e 5f73 6574 5f61 7564 696f 5f64 6574  f._set_audio_det
+0000d0f0: 6563 7428 536d 6172 7444 6574 6563 7441  ect(SmartDetectA
+0000d100: 7564 696f 5479 7065 2e53 4d4f 4b45 2c20  udioType.SMOKE, 
+0000d110: 656e 6162 6c65 6429 0a0a 2020 2020 2320  enabled)..    # 
+0000d120: 656e 6472 6567 696f 6e0a 2020 2020 2320  endregion.    # 
+0000d130: 7265 6769 6f6e 2043 4f20 416c 6172 6d0a  region CO Alarm.
+0000d140: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000d150: 2020 2064 6566 2063 616e 5f64 6574 6563     def can_detec
+0000d160: 745f 636f 2873 656c 6629 202d 3e20 626f  t_co(self) -> bo
+0000d170: 6f6c 3a0a 2020 2020 2020 2020 7265 7475  ol:.        retu
+0000d180: 726e 2073 656c 662e 5f63 616e 5f64 6574  rn self._can_det
+0000d190: 6563 745f 6175 6469 6f28 536d 6172 7444  ect_audio(SmartD
+0000d1a0: 6574 6563 744f 626a 6563 7454 7970 652e  etectObjectType.
+0000d1b0: 434d 4f4e 5829 0a0a 2020 2020 4070 726f  CMONX)..    @pro
+0000d1c0: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
+0000d1d0: 5f63 6f5f 6465 7465 6374 696f 6e5f 6f6e  _co_detection_on
+0000d1e0: 2873 656c 6629 202d 3e20 626f 6f6c 3a0a  (self) -> bool:.
+0000d1f0: 2020 2020 2020 2020 2222 2249 7320 434f          """Is CO
+0000d200: 2041 6c61 726d 2044 6574 6563 7469 6f6e   Alarm Detection
+0000d210: 2061 7661 696c 6162 6c65 2061 6e64 2065   available and e
+0000d220: 6e61 626c 6564 2028 6361 6d65 7261 2077  nabled (camera w
+0000d230: 696c 6c20 7072 6f64 7563 6520 736d 6f6b  ill produce smok
+0000d240: 6520 736d 6172 740a 2020 2020 2020 2020  e smart.        
+0000d250: 6465 7465 6374 696f 6e20 6576 656e 7473  detection events
+0000d260: 293f 0a20 2020 2020 2020 2022 2222 0a0a  )?.        """..
+0000d270: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000d280: 656c 662e 5f69 735f 6175 6469 6f5f 656e  elf._is_audio_en
+0000d290: 6162 6c65 6428 536d 6172 7444 6574 6563  abled(SmartDetec
+0000d2a0: 744f 626a 6563 7454 7970 652e 434d 4f4e  tObjectType.CMON
+0000d2b0: 5829 0a0a 2020 2020 4070 726f 7065 7274  X)..    @propert
+0000d2c0: 790a 2020 2020 6465 6620 6c61 7374 5f63  y.    def last_c
+0000d2d0: 6d6f 6e78 5f64 6574 6563 745f 6576 656e  monx_detect_even
+0000d2e0: 7428 7365 6c66 2920 2d3e 204f 7074 696f  t(self) -> Optio
+0000d2f0: 6e61 6c5b 4576 656e 745d 3a0a 2020 2020  nal[Event]:.    
+0000d300: 2020 2020 2222 2247 6574 2074 6865 206c      """Get the l
+0000d310: 6173 7420 434f 2061 6c61 726d 2073 6d61  ast CO alarm sma
+0000d320: 7274 2064 6574 6563 7469 6f6e 2065 7665  rt detection eve
+0000d330: 6e74 2e22 2222 0a0a 2020 2020 2020 2020  nt."""..        
+0000d340: 7265 7475 726e 2073 656c 662e 6765 745f  return self.get_
+0000d350: 6c61 7374 5f73 6d61 7274 5f61 7564 696f  last_smart_audio
+0000d360: 5f64 6574 6563 745f 6576 656e 7428 536d  _detect_event(Sm
+0000d370: 6172 7444 6574 6563 7441 7564 696f 5479  artDetectAudioTy
+0000d380: 7065 2e43 4d4f 4e58 290a 0a20 2020 2040  pe.CMONX)..    @
+0000d390: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000d3a0: 206c 6173 745f 636d 6f6e 785f 6465 7465   last_cmonx_dete
+0000d3b0: 6374 2873 656c 6629 202d 3e20 4f70 7469  ct(self) -> Opti
+0000d3c0: 6f6e 616c 5b64 6174 6574 696d 655d 3a0a  onal[datetime]:.
+0000d3d0: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
+0000d3e0: 6865 206c 6173 7420 434f 2061 6c61 726d  he last CO alarm
+0000d3f0: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+0000d400: 2065 7665 6e74 2e22 2222 0a0a 2020 2020   event."""..    
+0000d410: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000d420: 6c61 7374 5f73 6d61 7274 5f61 7564 696f  last_smart_audio
+0000d430: 5f64 6574 6563 7473 2e67 6574 2853 6d61  _detects.get(Sma
+0000d440: 7274 4465 7465 6374 4175 6469 6f54 7970  rtDetectAudioTyp
+0000d450: 652e 434d 4f4e 5829 0a0a 2020 2020 4070  e.CMONX)..    @p
+0000d460: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000d470: 6973 5f63 6d6f 6e78 5f63 7572 7265 6e74  is_cmonx_current
+0000d480: 6c79 5f64 6574 6563 7465 6428 7365 6c66  ly_detected(self
+0000d490: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+0000d4a0: 2020 2022 2222 4973 2043 4f20 616c 6172     """Is CO alar
+0000d4b0: 6d20 6375 7272 656e 746c 7920 6265 696e  m currently bein
+0000d4c0: 6720 6465 7465 6374 6564 2222 220a 0a20  g detected""".. 
+0000d4d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000d4e0: 6c66 2e5f 6973 5f61 7564 696f 5f64 6574  lf._is_audio_det
+0000d4f0: 6563 7465 6428 536d 6172 7444 6574 6563  ected(SmartDetec
+0000d500: 744f 626a 6563 7454 7970 652e 434d 4f4e  tObjectType.CMON
+0000d510: 5829 0a0a 2020 2020 6173 796e 6320 6465  X)..    async de
+0000d520: 6620 7365 745f 636d 6f6e 785f 6465 7465  f set_cmonx_dete
+0000d530: 6374 696f 6e28 7365 6c66 2c20 656e 6162  ction(self, enab
+0000d540: 6c65 643a 2062 6f6f 6c29 202d 3e20 4e6f  led: bool) -> No
+0000d550: 6e65 3a0a 2020 2020 2020 2020 2222 2254  ne:.        """T
+0000d560: 6f67 676c 6573 2073 6d6f 6b65 2073 6d61  oggles smoke sma
+0000d570: 7274 2064 6574 6563 7469 6f6e 2e20 5265  rt detection. Re
+0000d580: 7175 6972 6573 2063 616d 6572 6120 746f  quires camera to
+0000d590: 2068 6176 6520 736d 6172 7420 6465 7465   have smart dete
+0000d5a0: 6374 696f 6e22 2222 0a0a 2020 2020 2020  ction"""..      
+0000d5b0: 2020 7265 7475 726e 2061 7761 6974 2073    return await s
+0000d5c0: 656c 662e 5f73 6574 5f61 7564 696f 5f64  elf._set_audio_d
+0000d5d0: 6574 6563 7428 536d 6172 7444 6574 6563  etect(SmartDetec
+0000d5e0: 7441 7564 696f 5479 7065 2e43 4d4f 4e58  tAudioType.CMONX
+0000d5f0: 2c20 656e 6162 6c65 6429 0a0a 2020 2020  , enabled)..    
+0000d600: 2320 656e 6472 6567 696f 6e0a 2020 2020  # endregion.    
+0000d610: 2320 7265 6769 6f6e 2053 6972 656e 0a0a  # region Siren..
+0000d620: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000d630: 2020 6465 6620 6361 6e5f 6465 7465 6374    def can_detect
+0000d640: 5f73 6972 656e 2873 656c 6629 202d 3e20  _siren(self) -> 
+0000d650: 626f 6f6c 3a0a 2020 2020 2020 2020 7265  bool:.        re
+0000d660: 7475 726e 2073 656c 662e 5f63 616e 5f64  turn self._can_d
+0000d670: 6574 6563 745f 6175 6469 6f28 536d 6172  etect_audio(Smar
+0000d680: 7444 6574 6563 744f 626a 6563 7454 7970  tDetectObjectTyp
+0000d690: 652e 5349 5245 4e29 0a0a 2020 2020 4070  e.SIREN)..    @p
+0000d6a0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000d6b0: 6973 5f73 6972 656e 5f64 6574 6563 7469  is_siren_detecti
+0000d6c0: 6f6e 5f6f 6e28 7365 6c66 2920 2d3e 2062  on_on(self) -> b
+0000d6d0: 6f6f 6c3a 0a20 2020 2020 2020 2022 2222  ool:.        """
+0000d6e0: 4973 2053 6972 656e 2044 6574 6563 7469  Is Siren Detecti
+0000d6f0: 6f6e 2061 7661 696c 6162 6c65 2061 6e64  on available and
+0000d700: 2065 6e61 626c 6564 2028 6361 6d65 7261   enabled (camera
+0000d710: 2077 696c 6c20 7072 6f64 7563 6520 7369   will produce si
+0000d720: 7265 6e20 736d 6172 740a 2020 2020 2020  ren smart.      
+0000d730: 2020 6465 7465 6374 696f 6e20 6576 656e    detection even
+0000d740: 7473 293f 0a20 2020 2020 2020 2022 2222  ts)?.        """
+0000d750: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000d760: 2073 656c 662e 5f69 735f 6175 6469 6f5f   self._is_audio_
+0000d770: 656e 6162 6c65 6428 536d 6172 7444 6574  enabled(SmartDet
+0000d780: 6563 744f 626a 6563 7454 7970 652e 5349  ectObjectType.SI
+0000d790: 5245 4e29 0a0a 2020 2020 4070 726f 7065  REN)..    @prope
+0000d7a0: 7274 790a 2020 2020 6465 6620 6c61 7374  rty.    def last
+0000d7b0: 5f73 6972 656e 5f64 6574 6563 745f 6576  _siren_detect_ev
+0000d7c0: 656e 7428 7365 6c66 2920 2d3e 204f 7074  ent(self) -> Opt
+0000d7d0: 696f 6e61 6c5b 4576 656e 745d 3a0a 2020  ional[Event]:.  
+0000d7e0: 2020 2020 2020 2222 2247 6574 2074 6865        """Get the
+0000d7f0: 206c 6173 7420 5369 7265 6e20 736d 6172   last Siren smar
+0000d800: 7420 6465 7465 6374 696f 6e20 6576 656e  t detection even
+0000d810: 742e 2222 220a 0a20 2020 2020 2020 2072  t."""..        r
+0000d820: 6574 7572 6e20 7365 6c66 2e67 6574 5f6c  eturn self.get_l
+0000d830: 6173 745f 736d 6172 745f 6175 6469 6f5f  ast_smart_audio_
+0000d840: 6465 7465 6374 5f65 7665 6e74 2853 6d61  detect_event(Sma
+0000d850: 7274 4465 7465 6374 4175 6469 6f54 7970  rtDetectAudioTyp
+0000d860: 652e 5349 5245 4e29 0a0a 2020 2020 4070  e.SIREN)..    @p
+0000d870: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000d880: 6c61 7374 5f73 6972 656e 5f64 6574 6563  last_siren_detec
+0000d890: 7428 7365 6c66 2920 2d3e 204f 7074 696f  t(self) -> Optio
+0000d8a0: 6e61 6c5b 6461 7465 7469 6d65 5d3a 0a20  nal[datetime]:. 
+0000d8b0: 2020 2020 2020 2022 2222 4765 7420 7468         """Get th
+0000d8c0: 6520 6c61 7374 2053 6972 656e 2073 6d61  e last Siren sma
+0000d8d0: 7274 2064 6574 6563 7469 6f6e 2065 7665  rt detection eve
+0000d8e0: 6e74 2e22 2222 0a0a 2020 2020 2020 2020  nt."""..        
+0000d8f0: 7265 7475 726e 2073 656c 662e 6c61 7374  return self.last
+0000d900: 5f73 6d61 7274 5f61 7564 696f 5f64 6574  _smart_audio_det
+0000d910: 6563 7473 2e67 6574 2853 6d61 7274 4465  ects.get(SmartDe
+0000d920: 7465 6374 4175 6469 6f54 7970 652e 5349  tectAudioType.SI
+0000d930: 5245 4e29 0a0a 2020 2020 4070 726f 7065  REN)..    @prope
+0000d940: 7274 790a 2020 2020 6465 6620 6973 5f73  rty.    def is_s
+0000d950: 6972 656e 5f63 7572 7265 6e74 6c79 5f64  iren_currently_d
+0000d960: 6574 6563 7465 6428 7365 6c66 2920 2d3e  etected(self) ->
+0000d970: 2062 6f6f 6c3a 0a20 2020 2020 2020 2022   bool:.        "
+0000d980: 2222 4973 2053 6972 656e 2063 7572 7265  ""Is Siren curre
+0000d990: 6e74 6c79 2062 6569 6e67 2064 6574 6563  ntly being detec
+0000d9a0: 7465 6422 2222 0a0a 2020 2020 2020 2020  ted"""..        
+0000d9b0: 7265 7475 726e 2073 656c 662e 5f69 735f  return self._is_
+0000d9c0: 6175 6469 6f5f 6465 7465 6374 6564 2853  audio_detected(S
+0000d9d0: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
+0000d9e0: 5479 7065 2e53 4952 454e 290a 0a20 2020  Type.SIREN)..   
+0000d9f0: 2061 7379 6e63 2064 6566 2073 6574 5f73   async def set_s
+0000da00: 6972 656e 5f64 6574 6563 7469 6f6e 2873  iren_detection(s
+0000da10: 656c 662c 2065 6e61 626c 6564 3a20 626f  elf, enabled: bo
+0000da20: 6f6c 2920 2d3e 204e 6f6e 653a 0a20 2020  ol) -> None:.   
+0000da30: 2020 2020 2022 2222 546f 6767 6c65 7320       """Toggles 
+0000da40: 7369 7265 6e20 736d 6172 7420 6465 7465  siren smart dete
+0000da50: 6374 696f 6e2e 2052 6571 7569 7265 7320  ction. Requires 
+0000da60: 6361 6d65 7261 2074 6f20 6861 7665 2073  camera to have s
+0000da70: 6d61 7274 2064 6574 6563 7469 6f6e 2222  mart detection""
+0000da80: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+0000da90: 6e20 6177 6169 7420 7365 6c66 2e5f 7365  n await self._se
+0000daa0: 745f 6175 6469 6f5f 6465 7465 6374 2853  t_audio_detect(S
+0000dab0: 6d61 7274 4465 7465 6374 4175 6469 6f54  martDetectAudioT
+0000dac0: 7970 652e 5349 5245 4e2c 2065 6e61 626c  ype.SIREN, enabl
+0000dad0: 6564 290a 0a20 2020 2023 2065 6e64 7265  ed)..    # endre
+0000dae0: 6769 6f6e 0a20 2020 2023 2072 6567 696f  gion.    # regio
+0000daf0: 6e20 4261 6279 2043 7279 0a0a 2020 2020  n Baby Cry..    
+0000db00: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000db10: 6620 6361 6e5f 6465 7465 6374 5f62 6162  f can_detect_bab
+0000db20: 795f 6372 7928 7365 6c66 2920 2d3e 2062  y_cry(self) -> b
+0000db30: 6f6f 6c3a 0a20 2020 2020 2020 2072 6574  ool:.        ret
+0000db40: 7572 6e20 7365 6c66 2e5f 6361 6e5f 6465  urn self._can_de
+0000db50: 7465 6374 5f61 7564 696f 2853 6d61 7274  tect_audio(Smart
+0000db60: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
+0000db70: 2e42 4142 595f 4352 5929 0a0a 2020 2020  .BABY_CRY)..    
+0000db80: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000db90: 6620 6973 5f62 6162 795f 6372 795f 6465  f is_baby_cry_de
+0000dba0: 7465 6374 696f 6e5f 6f6e 2873 656c 6629  tection_on(self)
+0000dbb0: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+0000dbc0: 2020 2222 2249 7320 4261 6279 2043 7279    """Is Baby Cry
+0000dbd0: 2044 6574 6563 7469 6f6e 2061 7661 696c   Detection avail
+0000dbe0: 6162 6c65 2061 6e64 2065 6e61 626c 6564  able and enabled
+0000dbf0: 2028 6361 6d65 7261 2077 696c 6c20 7072   (camera will pr
+0000dc00: 6f64 7563 6520 6261 6279 2063 7279 2073  oduce baby cry s
+0000dc10: 6d61 7274 0a20 2020 2020 2020 2064 6574  mart.        det
+0000dc20: 6563 7469 6f6e 2065 7665 6e74 7329 3f0a  ection events)?.
+0000dc30: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000dc40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000dc50: 2e5f 6973 5f61 7564 696f 5f65 6e61 626c  ._is_audio_enabl
+0000dc60: 6564 2853 6d61 7274 4465 7465 6374 4f62  ed(SmartDetectOb
+0000dc70: 6a65 6374 5479 7065 2e42 4142 595f 4352  jectType.BABY_CR
+0000dc80: 5929 0a0a 2020 2020 4070 726f 7065 7274  Y)..    @propert
+0000dc90: 790a 2020 2020 6465 6620 6c61 7374 5f62  y.    def last_b
+0000dca0: 6162 795f 6372 795f 6465 7465 6374 5f65  aby_cry_detect_e
+0000dcb0: 7665 6e74 2873 656c 6629 202d 3e20 4f70  vent(self) -> Op
+0000dcc0: 7469 6f6e 616c 5b45 7665 6e74 5d3a 0a20  tional[Event]:. 
+0000dcd0: 2020 2020 2020 2022 2222 4765 7420 7468         """Get th
+0000dce0: 6520 6c61 7374 2042 6162 7920 4372 7920  e last Baby Cry 
+0000dcf0: 736d 6172 7420 6465 7465 6374 696f 6e20  smart detection 
+0000dd00: 6576 656e 742e 2222 220a 0a20 2020 2020  event."""..     
+0000dd10: 2020 2072 6574 7572 6e20 7365 6c66 2e67     return self.g
+0000dd20: 6574 5f6c 6173 745f 736d 6172 745f 6175  et_last_smart_au
+0000dd30: 6469 6f5f 6465 7465 6374 5f65 7665 6e74  dio_detect_event
+0000dd40: 2853 6d61 7274 4465 7465 6374 4175 6469  (SmartDetectAudi
+0000dd50: 6f54 7970 652e 4241 4259 5f43 5259 290a  oType.BABY_CRY).
+0000dd60: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000dd70: 2020 2064 6566 206c 6173 745f 6261 6279     def last_baby
+0000dd80: 5f63 7279 5f64 6574 6563 7428 7365 6c66  _cry_detect(self
+0000dd90: 2920 2d3e 204f 7074 696f 6e61 6c5b 6461  ) -> Optional[da
+0000dda0: 7465 7469 6d65 5d3a 0a20 2020 2020 2020  tetime]:.       
+0000ddb0: 2022 2222 4765 7420 7468 6520 6c61 7374   """Get the last
+0000ddc0: 2042 6162 7920 4372 7920 736d 6172 7420   Baby Cry smart 
+0000ddd0: 6465 7465 6374 696f 6e20 6576 656e 742e  detection event.
+0000dde0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000ddf0: 7572 6e20 7365 6c66 2e6c 6173 745f 736d  urn self.last_sm
+0000de00: 6172 745f 6175 6469 6f5f 6465 7465 6374  art_audio_detect
+0000de10: 732e 6765 7428 536d 6172 7444 6574 6563  s.get(SmartDetec
+0000de20: 7441 7564 696f 5479 7065 2e42 4142 595f  tAudioType.BABY_
+0000de30: 4352 5929 0a0a 2020 2020 4070 726f 7065  CRY)..    @prope
+0000de40: 7274 790a 2020 2020 6465 6620 6973 5f62  rty.    def is_b
+0000de50: 6162 795f 6372 795f 6375 7272 656e 746c  aby_cry_currentl
+0000de60: 795f 6465 7465 6374 6564 2873 656c 6629  y_detected(self)
+0000de70: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+0000de80: 2020 2222 2249 7320 4261 6279 2043 7279    """Is Baby Cry
+0000de90: 2063 7572 7265 6e74 6c79 2062 6569 6e67   currently being
+0000dea0: 2064 6574 6563 7465 6422 2222 0a0a 2020   detected"""..  
+0000deb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000dec0: 662e 5f69 735f 6175 6469 6f5f 6465 7465  f._is_audio_dete
+0000ded0: 6374 6564 2853 6d61 7274 4465 7465 6374  cted(SmartDetect
+0000dee0: 4f62 6a65 6374 5479 7065 2e42 4142 595f  ObjectType.BABY_
+0000def0: 4352 5929 0a0a 2020 2020 6173 796e 6320  CRY)..    async 
+0000df00: 6465 6620 7365 745f 6261 6279 5f63 7279  def set_baby_cry
+0000df10: 5f64 6574 6563 7469 6f6e 2873 656c 662c  _detection(self,
+0000df20: 2065 6e61 626c 6564 3a20 626f 6f6c 2920   enabled: bool) 
+0000df30: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000df40: 2022 2222 546f 6767 6c65 7320 6261 6279   """Toggles baby
+0000df50: 5f63 7279 2073 6d61 7274 2064 6574 6563  _cry smart detec
+0000df60: 7469 6f6e 2e20 5265 7175 6972 6573 2063  tion. Requires c
+0000df70: 616d 6572 6120 746f 2068 6176 6520 736d  amera to have sm
+0000df80: 6172 7420 6465 7465 6374 696f 6e22 2222  art detection"""
+0000df90: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000dfa0: 2061 7761 6974 2073 656c 662e 5f73 6574   await self._set
+0000dfb0: 5f61 7564 696f 5f64 6574 6563 7428 536d  _audio_detect(Sm
+0000dfc0: 6172 7444 6574 6563 7441 7564 696f 5479  artDetectAudioTy
+0000dfd0: 7065 2e42 4142 595f 4352 592c 2065 6e61  pe.BABY_CRY, ena
+0000dfe0: 626c 6564 290a 0a20 2020 2023 2065 6e64  bled)..    # end
+0000dff0: 7265 6769 6f6e 0a20 2020 2023 2072 6567  region.    # reg
+0000e000: 696f 6e20 5370 6561 6b69 6e67 0a0a 2020  ion Speaking..  
+0000e010: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000e020: 6465 6620 6361 6e5f 6465 7465 6374 5f73  def can_detect_s
+0000e030: 7065 616b 696e 6728 7365 6c66 2920 2d3e  peaking(self) ->
+0000e040: 2062 6f6f 6c3a 0a20 2020 2020 2020 2072   bool:.        r
+0000e050: 6574 7572 6e20 7365 6c66 2e5f 6361 6e5f  eturn self._can_
+0000e060: 6465 7465 6374 5f61 7564 696f 2853 6d61  detect_audio(Sma
+0000e070: 7274 4465 7465 6374 4f62 6a65 6374 5479  rtDetectObjectTy
+0000e080: 7065 2e53 5045 414b 290a 0a20 2020 2040  pe.SPEAK)..    @
+0000e090: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000e0a0: 2069 735f 7370 6561 6b69 6e67 5f64 6574   is_speaking_det
+0000e0b0: 6563 7469 6f6e 5f6f 6e28 7365 6c66 2920  ection_on(self) 
+0000e0c0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+0000e0d0: 2022 2222 4973 2053 7065 616b 696e 6720   """Is Speaking 
+0000e0e0: 4465 7465 6374 696f 6e20 6176 6169 6c61  Detection availa
+0000e0f0: 626c 6520 616e 6420 656e 6162 6c65 6420  ble and enabled 
+0000e100: 2863 616d 6572 6120 7769 6c6c 2070 726f  (camera will pro
+0000e110: 6475 6365 2073 7065 616b 696e 6720 736d  duce speaking sm
+0000e120: 6172 740a 2020 2020 2020 2020 6465 7465  art.        dete
+0000e130: 6374 696f 6e20 6576 656e 7473 293f 0a20  ction events)?. 
+0000e140: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000e150: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000e160: 5f69 735f 6175 6469 6f5f 656e 6162 6c65  _is_audio_enable
+0000e170: 6428 536d 6172 7444 6574 6563 744f 626a  d(SmartDetectObj
+0000e180: 6563 7454 7970 652e 5350 4541 4b29 0a0a  ectType.SPEAK)..
+0000e190: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000e1a0: 2020 6465 6620 6c61 7374 5f73 7065 616b    def last_speak
+0000e1b0: 696e 675f 6465 7465 6374 5f65 7665 6e74  ing_detect_event
+0000e1c0: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
+0000e1d0: 616c 5b45 7665 6e74 5d3a 0a20 2020 2020  al[Event]:.     
+0000e1e0: 2020 2022 2222 4765 7420 7468 6520 6c61     """Get the la
+0000e1f0: 7374 2053 7065 616b 696e 6720 736d 6172  st Speaking smar
+0000e200: 7420 6465 7465 6374 696f 6e20 6576 656e  t detection even
+0000e210: 742e 2222 220a 0a20 2020 2020 2020 2072  t."""..        r
+0000e220: 6574 7572 6e20 7365 6c66 2e67 6574 5f6c  eturn self.get_l
+0000e230: 6173 745f 736d 6172 745f 6175 6469 6f5f  ast_smart_audio_
+0000e240: 6465 7465 6374 5f65 7665 6e74 2853 6d61  detect_event(Sma
+0000e250: 7274 4465 7465 6374 4175 6469 6f54 7970  rtDetectAudioTyp
+0000e260: 652e 5350 4541 4b29 0a0a 2020 2020 4070  e.SPEAK)..    @p
+0000e270: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000e280: 6c61 7374 5f73 7065 616b 696e 675f 6465  last_speaking_de
+0000e290: 7465 6374 2873 656c 6629 202d 3e20 4f70  tect(self) -> Op
+0000e2a0: 7469 6f6e 616c 5b64 6174 6574 696d 655d  tional[datetime]
+0000e2b0: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+0000e2c0: 2074 6865 206c 6173 7420 5370 6561 6b69   the last Speaki
+0000e2d0: 6e67 2073 6d61 7274 2064 6574 6563 7469  ng smart detecti
+0000e2e0: 6f6e 2065 7665 6e74 2e22 2222 0a0a 2020  on event."""..  
+0000e2f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000e300: 662e 6c61 7374 5f73 6d61 7274 5f61 7564  f.last_smart_aud
+0000e310: 696f 5f64 6574 6563 7473 2e67 6574 2853  io_detects.get(S
+0000e320: 6d61 7274 4465 7465 6374 4175 6469 6f54  martDetectAudioT
+0000e330: 7970 652e 5350 4541 4b29 0a0a 2020 2020  ype.SPEAK)..    
+0000e340: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000e350: 6620 6973 5f73 7065 616b 696e 675f 6375  f is_speaking_cu
+0000e360: 7272 656e 746c 795f 6465 7465 6374 6564  rrently_detected
+0000e370: 2873 656c 6629 202d 3e20 626f 6f6c 3a0a  (self) -> bool:.
+0000e380: 2020 2020 2020 2020 2222 2249 7320 5370          """Is Sp
+0000e390: 6561 6b69 6e67 2063 7572 7265 6e74 6c79  eaking currently
+0000e3a0: 2062 6569 6e67 2064 6574 6563 7465 6422   being detected"
+0000e3b0: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
+0000e3c0: 726e 2073 656c 662e 5f69 735f 6175 6469  rn self._is_audi
+0000e3d0: 6f5f 6465 7465 6374 6564 2853 6d61 7274  o_detected(Smart
+0000e3e0: 4465 7465 6374 4f62 6a65 6374 5479 7065  DetectObjectType
+0000e3f0: 2e53 5045 414b 290a 0a20 2020 2061 7379  .SPEAK)..    asy
+0000e400: 6e63 2064 6566 2073 6574 5f73 7065 616b  nc def set_speak
+0000e410: 696e 675f 6465 7465 6374 696f 6e28 7365  ing_detection(se
+0000e420: 6c66 2c20 656e 6162 6c65 643a 2062 6f6f  lf, enabled: boo
+0000e430: 6c29 202d 3e20 4e6f 6e65 3a0a 2020 2020  l) -> None:.    
+0000e440: 2020 2020 2222 2254 6f67 676c 6573 2073      """Toggles s
+0000e450: 7065 616b 696e 6720 736d 6172 7420 6465  peaking smart de
+0000e460: 7465 6374 696f 6e2e 2052 6571 7569 7265  tection. Require
+0000e470: 7320 6361 6d65 7261 2074 6f20 6861 7665  s camera to have
+0000e480: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+0000e490: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000e4a0: 7572 6e20 6177 6169 7420 7365 6c66 2e5f  urn await self._
+0000e4b0: 7365 745f 6175 6469 6f5f 6465 7465 6374  set_audio_detect
+0000e4c0: 2853 6d61 7274 4465 7465 6374 4175 6469  (SmartDetectAudi
+0000e4d0: 6f54 7970 652e 5350 4541 4b2c 2065 6e61  oType.SPEAK, ena
+0000e4e0: 626c 6564 290a 0a20 2020 2023 2065 6e64  bled)..    # end
+0000e4f0: 7265 6769 6f6e 0a20 2020 2023 2072 6567  region.    # reg
+0000e500: 696f 6e20 4261 726b 0a0a 2020 2020 4070  ion Bark..    @p
+0000e510: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000e520: 6361 6e5f 6465 7465 6374 5f62 6172 6b28  can_detect_bark(
+0000e530: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+0000e540: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000e550: 6c66 2e5f 6361 6e5f 6465 7465 6374 5f61  lf._can_detect_a
+0000e560: 7564 696f 2853 6d61 7274 4465 7465 6374  udio(SmartDetect
+0000e570: 4f62 6a65 6374 5479 7065 2e42 4152 4b29  ObjectType.BARK)
+0000e580: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000e590: 2020 2020 6465 6620 6973 5f62 6172 6b5f      def is_bark_
+0000e5a0: 6465 7465 6374 696f 6e5f 6f6e 2873 656c  detection_on(sel
+0000e5b0: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
+0000e5c0: 2020 2020 2222 2249 7320 4261 726b 2044      """Is Bark D
+0000e5d0: 6574 6563 7469 6f6e 2061 7661 696c 6162  etection availab
+0000e5e0: 6c65 2061 6e64 2065 6e61 626c 6564 2028  le and enabled (
+0000e5f0: 6361 6d65 7261 2077 696c 6c20 7072 6f64  camera will prod
+0000e600: 7563 6520 6261 726b 696e 6720 736d 6172  uce barking smar
+0000e610: 740a 2020 2020 2020 2020 6465 7465 6374  t.        detect
+0000e620: 696f 6e20 6576 656e 7473 293f 0a20 2020  ion events)?.   
+0000e630: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0000e640: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
+0000e650: 735f 6175 6469 6f5f 656e 6162 6c65 6428  s_audio_enabled(
+0000e660: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
+0000e670: 7454 7970 652e 4241 524b 290a 0a20 2020  tType.BARK)..   
+0000e680: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000e690: 6566 206c 6173 745f 6261 726b 5f64 6574  ef last_bark_det
+0000e6a0: 6563 745f 6576 656e 7428 7365 6c66 2920  ect_event(self) 
+0000e6b0: 2d3e 204f 7074 696f 6e61 6c5b 4576 656e  -> Optional[Even
+0000e6c0: 745d 3a0a 2020 2020 2020 2020 2222 2247  t]:.        """G
+0000e6d0: 6574 2074 6865 206c 6173 7420 4261 726b  et the last Bark
+0000e6e0: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+0000e6f0: 2065 7665 6e74 2e22 2222 0a0a 2020 2020   event."""..    
+0000e700: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000e710: 6765 745f 6c61 7374 5f73 6d61 7274 5f61  get_last_smart_a
+0000e720: 7564 696f 5f64 6574 6563 745f 6576 656e  udio_detect_even
+0000e730: 7428 536d 6172 7444 6574 6563 7441 7564  t(SmartDetectAud
+0000e740: 696f 5479 7065 2e42 4152 4b29 0a0a 2020  ioType.BARK)..  
+0000e750: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000e760: 6465 6620 6c61 7374 5f62 6172 6b5f 6465  def last_bark_de
+0000e770: 7465 6374 2873 656c 6629 202d 3e20 4f70  tect(self) -> Op
+0000e780: 7469 6f6e 616c 5b64 6174 6574 696d 655d  tional[datetime]
+0000e790: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+0000e7a0: 2074 6865 206c 6173 7420 4261 726b 2073   the last Bark s
+0000e7b0: 6d61 7274 2064 6574 6563 7469 6f6e 2065  mart detection e
+0000e7c0: 7665 6e74 2e22 2222 0a0a 2020 2020 2020  vent."""..      
+0000e7d0: 2020 7265 7475 726e 2073 656c 662e 6c61    return self.la
+0000e7e0: 7374 5f73 6d61 7274 5f61 7564 696f 5f64  st_smart_audio_d
+0000e7f0: 6574 6563 7473 2e67 6574 2853 6d61 7274  etects.get(Smart
+0000e800: 4465 7465 6374 4175 6469 6f54 7970 652e  DetectAudioType.
+0000e810: 4241 524b 290a 0a20 2020 2040 7072 6f70  BARK)..    @prop
+0000e820: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
+0000e830: 6261 726b 5f63 7572 7265 6e74 6c79 5f64  bark_currently_d
+0000e840: 6574 6563 7465 6428 7365 6c66 2920 2d3e  etected(self) ->
+0000e850: 2062 6f6f 6c3a 0a20 2020 2020 2020 2022   bool:.        "
+0000e860: 2222 4973 2042 6172 6b20 6375 7272 656e  ""Is Bark curren
+0000e870: 746c 7920 6265 696e 6720 6465 7465 6374  tly being detect
+0000e880: 6564 2222 220a 0a20 2020 2020 2020 2072  ed"""..        r
+0000e890: 6574 7572 6e20 7365 6c66 2e5f 6973 5f61  eturn self._is_a
+0000e8a0: 7564 696f 5f64 6574 6563 7465 6428 536d  udio_detected(Sm
+0000e8b0: 6172 7444 6574 6563 744f 626a 6563 7454  artDetectObjectT
+0000e8c0: 7970 652e 4241 524b 290a 0a20 2020 2061  ype.BARK)..    a
+0000e8d0: 7379 6e63 2064 6566 2073 6574 5f62 6172  sync def set_bar
+0000e8e0: 6b5f 6465 7465 6374 696f 6e28 7365 6c66  k_detection(self
+0000e8f0: 2c20 656e 6162 6c65 643a 2062 6f6f 6c29  , enabled: bool)
+0000e900: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0000e910: 2020 2222 2254 6f67 676c 6573 2062 6172    """Toggles bar
+0000e920: 6b20 736d 6172 7420 6465 7465 6374 696f  k smart detectio
+0000e930: 6e2e 2052 6571 7569 7265 7320 6361 6d65  n. Requires came
+0000e940: 7261 2074 6f20 6861 7665 2073 6d61 7274  ra to have smart
+0000e950: 2064 6574 6563 7469 6f6e 2222 220a 0a20   detection""".. 
+0000e960: 2020 2020 2020 2072 6574 7572 6e20 6177         return aw
+0000e970: 6169 7420 7365 6c66 2e5f 7365 745f 6175  ait self._set_au
+0000e980: 6469 6f5f 6465 7465 6374 2853 6d61 7274  dio_detect(Smart
+0000e990: 4465 7465 6374 4175 6469 6f54 7970 652e  DetectAudioType.
+0000e9a0: 4241 524b 2c20 656e 6162 6c65 6429 0a0a  BARK, enabled)..
+0000e9b0: 2020 2020 2320 656e 6472 6567 696f 6e0a      # endregion.
+0000e9c0: 2020 2020 2320 7265 6769 6f6e 2043 6172      # region Car
+0000e9d0: 2041 6c61 726d 0a20 2020 2023 2028 6275   Alarm.    # (bu
+0000e9e0: 7267 6c61 7220 696e 2063 6f64 652c 2063  rglar in code, c
+0000e9f0: 6172 2061 6c61 726d 2069 6e20 5072 6f74  ar alarm in Prot
+0000ea00: 6563 7420 5549 290a 0a20 2020 2040 7072  ect UI)..    @pr
+0000ea10: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
+0000ea20: 616e 5f64 6574 6563 745f 6361 725f 616c  an_detect_car_al
+0000ea30: 6172 6d28 7365 6c66 2920 2d3e 2062 6f6f  arm(self) -> boo
+0000ea40: 6c3a 0a20 2020 2020 2020 2072 6574 7572  l:.        retur
+0000ea50: 6e20 7365 6c66 2e5f 6361 6e5f 6465 7465  n self._can_dete
+0000ea60: 6374 5f61 7564 696f 2853 6d61 7274 4465  ct_audio(SmartDe
+0000ea70: 7465 6374 4f62 6a65 6374 5479 7065 2e42  tectObjectType.B
+0000ea80: 5552 474c 4152 290a 0a20 2020 2040 7072  URGLAR)..    @pr
+0000ea90: 6f70 6572 7479 0a20 2020 2064 6566 2069  operty.    def i
+0000eaa0: 735f 6361 725f 616c 6172 6d5f 6465 7465  s_car_alarm_dete
+0000eab0: 6374 696f 6e5f 6f6e 2873 656c 6629 202d  ction_on(self) -
+0000eac0: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
+0000ead0: 2222 2249 7320 4361 7220 416c 6172 6d20  """Is Car Alarm 
+0000eae0: 4465 7465 6374 696f 6e20 6176 6169 6c61  Detection availa
+0000eaf0: 626c 6520 616e 6420 656e 6162 6c65 6420  ble and enabled 
+0000eb00: 2863 616d 6572 6120 7769 6c6c 2070 726f  (camera will pro
+0000eb10: 6475 6365 2063 6172 2061 6c61 726d 2073  duce car alarm s
+0000eb20: 6d61 7274 0a20 2020 2020 2020 2064 6574  mart.        det
+0000eb30: 6563 7469 6f6e 2065 7665 6e74 7329 3f0a  ection events)?.
+0000eb40: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000eb50: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000eb60: 2e5f 6973 5f61 7564 696f 5f65 6e61 626c  ._is_audio_enabl
+0000eb70: 6564 2853 6d61 7274 4465 7465 6374 4f62  ed(SmartDetectOb
+0000eb80: 6a65 6374 5479 7065 2e42 5552 474c 4152  jectType.BURGLAR
+0000eb90: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0000eba0: 0a20 2020 2064 6566 206c 6173 745f 6361  .    def last_ca
+0000ebb0: 725f 616c 6172 6d5f 6465 7465 6374 5f65  r_alarm_detect_e
+0000ebc0: 7665 6e74 2873 656c 6629 202d 3e20 4f70  vent(self) -> Op
+0000ebd0: 7469 6f6e 616c 5b45 7665 6e74 5d3a 0a20  tional[Event]:. 
+0000ebe0: 2020 2020 2020 2022 2222 4765 7420 7468         """Get th
+0000ebf0: 6520 6c61 7374 2043 6172 2041 6c61 726d  e last Car Alarm
+0000ec00: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+0000ec10: 2065 7665 6e74 2e22 2222 0a0a 2020 2020   event."""..    
+0000ec20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000ec30: 6765 745f 6c61 7374 5f73 6d61 7274 5f61  get_last_smart_a
+0000ec40: 7564 696f 5f64 6574 6563 745f 6576 656e  udio_detect_even
+0000ec50: 7428 536d 6172 7444 6574 6563 7441 7564  t(SmartDetectAud
+0000ec60: 696f 5479 7065 2e42 5552 474c 4152 290a  ioType.BURGLAR).
+0000ec70: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000ec80: 2020 2064 6566 206c 6173 745f 6361 725f     def last_car_
+0000ec90: 616c 6172 6d5f 6465 7465 6374 2873 656c  alarm_detect(sel
+0000eca0: 6629 202d 3e20 4f70 7469 6f6e 616c 5b64  f) -> Optional[d
+0000ecb0: 6174 6574 696d 655d 3a0a 2020 2020 2020  atetime]:.      
+0000ecc0: 2020 2222 2247 6574 2074 6865 206c 6173    """Get the las
+0000ecd0: 7420 4361 7220 416c 6172 6d20 736d 6172  t Car Alarm smar
+0000ece0: 7420 6465 7465 6374 696f 6e20 6576 656e  t detection even
+0000ecf0: 742e 2222 220a 0a20 2020 2020 2020 2072  t."""..        r
+0000ed00: 6574 7572 6e20 7365 6c66 2e6c 6173 745f  eturn self.last_
+0000ed10: 736d 6172 745f 6175 6469 6f5f 6465 7465  smart_audio_dete
+0000ed20: 6374 732e 6765 7428 536d 6172 7444 6574  cts.get(SmartDet
+0000ed30: 6563 7441 7564 696f 5479 7065 2e42 5552  ectAudioType.BUR
+0000ed40: 474c 4152 290a 0a20 2020 2040 7072 6f70  GLAR)..    @prop
+0000ed50: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
+0000ed60: 6361 725f 616c 6172 6d5f 6375 7272 656e  car_alarm_curren
+0000ed70: 746c 795f 6465 7465 6374 6564 2873 656c  tly_detected(sel
+0000ed80: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
+0000ed90: 2020 2020 2222 2249 7320 4361 7220 416c      """Is Car Al
+0000eda0: 6172 6d20 6375 7272 656e 746c 7920 6265  arm currently be
+0000edb0: 696e 6720 6465 7465 6374 6564 2222 220a  ing detected""".
+0000edc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000edd0: 7365 6c66 2e5f 6973 5f61 7564 696f 5f64  self._is_audio_d
+0000ede0: 6574 6563 7465 6428 536d 6172 7444 6574  etected(SmartDet
+0000edf0: 6563 744f 626a 6563 7454 7970 652e 4255  ectObjectType.BU
+0000ee00: 5247 4c41 5229 0a0a 2020 2020 6173 796e  RGLAR)..    asyn
+0000ee10: 6320 6465 6620 7365 745f 6361 725f 616c  c def set_car_al
+0000ee20: 6172 6d5f 6465 7465 6374 696f 6e28 7365  arm_detection(se
+0000ee30: 6c66 2c20 656e 6162 6c65 643a 2062 6f6f  lf, enabled: boo
+0000ee40: 6c29 202d 3e20 4e6f 6e65 3a0a 2020 2020  l) -> None:.    
+0000ee50: 2020 2020 2222 2254 6f67 676c 6573 2063      """Toggles c
+0000ee60: 6172 5f61 6c61 726d 2073 6d61 7274 2064  ar_alarm smart d
+0000ee70: 6574 6563 7469 6f6e 2e20 5265 7175 6972  etection. Requir
+0000ee80: 6573 2063 616d 6572 6120 746f 2068 6176  es camera to hav
+0000ee90: 6520 736d 6172 7420 6465 7465 6374 696f  e smart detectio
+0000eea0: 6e22 2222 0a0a 2020 2020 2020 2020 7265  n"""..        re
+0000eeb0: 7475 726e 2061 7761 6974 2073 656c 662e  turn await self.
+0000eec0: 5f73 6574 5f61 7564 696f 5f64 6574 6563  _set_audio_detec
+0000eed0: 7428 536d 6172 7444 6574 6563 7441 7564  t(SmartDetectAud
+0000eee0: 696f 5479 7065 2e42 5552 474c 4152 2c20  ioType.BURGLAR, 
+0000eef0: 656e 6162 6c65 6429 0a0a 2020 2020 2320  enabled)..    # 
+0000ef00: 656e 6472 6567 696f 6e0a 2020 2020 2320  endregion.    # 
+0000ef10: 7265 6769 6f6e 2043 6172 2048 6f72 6e0a  region Car Horn.
+0000ef20: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000ef30: 2020 2064 6566 2063 616e 5f64 6574 6563     def can_detec
+0000ef40: 745f 6361 725f 686f 726e 2873 656c 6629  t_car_horn(self)
+0000ef50: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+0000ef60: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
+0000ef70: 616e 5f64 6574 6563 745f 6175 6469 6f28  an_detect_audio(
+0000ef80: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
+0000ef90: 7454 7970 652e 4341 525f 484f 524e 290a  tType.CAR_HORN).
+0000efa0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000efb0: 2020 2064 6566 2069 735f 6361 725f 686f     def is_car_ho
+0000efc0: 726e 5f64 6574 6563 7469 6f6e 5f6f 6e28  rn_detection_on(
+0000efd0: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+0000efe0: 2020 2020 2020 2022 2222 4973 2043 6172         """Is Car
+0000eff0: 2048 6f72 6e20 4465 7465 6374 696f 6e20   Horn Detection 
+0000f000: 6176 6169 6c61 626c 6520 616e 6420 656e  available and en
+0000f010: 6162 6c65 6420 2863 616d 6572 6120 7769  abled (camera wi
+0000f020: 6c6c 2070 726f 6475 6365 2063 6172 2068  ll produce car h
+0000f030: 6f72 6e20 736d 6172 740a 2020 2020 2020  orn smart.      
+0000f040: 2020 6465 7465 6374 696f 6e20 6576 656e    detection even
+0000f050: 7473 293f 0a20 2020 2020 2020 2022 2222  ts)?.        """
+0000f060: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000f070: 2073 656c 662e 5f69 735f 6175 6469 6f5f   self._is_audio_
+0000f080: 656e 6162 6c65 6428 536d 6172 7444 6574  enabled(SmartDet
+0000f090: 6563 744f 626a 6563 7454 7970 652e 4341  ectObjectType.CA
+0000f0a0: 525f 484f 524e 290a 0a20 2020 2040 7072  R_HORN)..    @pr
+0000f0b0: 6f70 6572 7479 0a20 2020 2064 6566 206c  operty.    def l
+0000f0c0: 6173 745f 6361 725f 686f 726e 5f64 6574  ast_car_horn_det
+0000f0d0: 6563 745f 6576 656e 7428 7365 6c66 2920  ect_event(self) 
+0000f0e0: 2d3e 204f 7074 696f 6e61 6c5b 4576 656e  -> Optional[Even
+0000f0f0: 745d 3a0a 2020 2020 2020 2020 2222 2247  t]:.        """G
+0000f100: 6574 2074 6865 206c 6173 7420 4361 7220  et the last Car 
+0000f110: 486f 726e 2073 6d61 7274 2064 6574 6563  Horn smart detec
+0000f120: 7469 6f6e 2065 7665 6e74 2e22 2222 0a0a  tion event."""..
+0000f130: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000f140: 656c 662e 6765 745f 6c61 7374 5f73 6d61  elf.get_last_sma
+0000f150: 7274 5f61 7564 696f 5f64 6574 6563 745f  rt_audio_detect_
+0000f160: 6576 656e 7428 536d 6172 7444 6574 6563  event(SmartDetec
+0000f170: 7441 7564 696f 5479 7065 2e43 4152 5f48  tAudioType.CAR_H
+0000f180: 4f52 4e29 0a0a 2020 2020 4070 726f 7065  ORN)..    @prope
+0000f190: 7274 790a 2020 2020 6465 6620 6c61 7374  rty.    def last
+0000f1a0: 5f63 6172 5f68 6f72 6e5f 6465 7465 6374  _car_horn_detect
+0000f1b0: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
+0000f1c0: 616c 5b64 6174 6574 696d 655d 3a0a 2020  al[datetime]:.  
+0000f1d0: 2020 2020 2020 2222 2247 6574 2074 6865        """Get the
+0000f1e0: 206c 6173 7420 4361 7220 486f 726e 2073   last Car Horn s
+0000f1f0: 6d61 7274 2064 6574 6563 7469 6f6e 2065  mart detection e
+0000f200: 7665 6e74 2e22 2222 0a0a 2020 2020 2020  vent."""..      
+0000f210: 2020 7265 7475 726e 2073 656c 662e 6c61    return self.la
+0000f220: 7374 5f73 6d61 7274 5f61 7564 696f 5f64  st_smart_audio_d
+0000f230: 6574 6563 7473 2e67 6574 2853 6d61 7274  etects.get(Smart
+0000f240: 4465 7465 6374 4175 6469 6f54 7970 652e  DetectAudioType.
+0000f250: 4341 525f 484f 524e 290a 0a20 2020 2040  CAR_HORN)..    @
+0000f260: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000f270: 2069 735f 6361 725f 686f 726e 5f63 7572   is_car_horn_cur
+0000f280: 7265 6e74 6c79 5f64 6574 6563 7465 6428  rently_detected(
+0000f290: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+0000f2a0: 2020 2020 2020 2022 2222 4973 2043 6172         """Is Car
+0000f2b0: 2048 6f72 6e20 6375 7272 656e 746c 7920   Horn currently 
+0000f2c0: 6265 696e 6720 6465 7465 6374 6564 2222  being detected""
+0000f2d0: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+0000f2e0: 6e20 7365 6c66 2e5f 6973 5f61 7564 696f  n self._is_audio
+0000f2f0: 5f64 6574 6563 7465 6428 536d 6172 7444  _detected(SmartD
+0000f300: 6574 6563 744f 626a 6563 7454 7970 652e  etectObjectType.
+0000f310: 4341 525f 484f 524e 290a 0a20 2020 2061  CAR_HORN)..    a
+0000f320: 7379 6e63 2064 6566 2073 6574 5f63 6172  sync def set_car
+0000f330: 5f68 6f72 6e5f 6465 7465 6374 696f 6e28  _horn_detection(
+0000f340: 7365 6c66 2c20 656e 6162 6c65 643a 2062  self, enabled: b
+0000f350: 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a 2020  ool) -> None:.  
+0000f360: 2020 2020 2020 2222 2254 6f67 676c 6573        """Toggles
+0000f370: 2063 6172 5f68 6f72 6e20 736d 6172 7420   car_horn smart 
+0000f380: 6465 7465 6374 696f 6e2e 2052 6571 7569  detection. Requi
+0000f390: 7265 7320 6361 6d65 7261 2074 6f20 6861  res camera to ha
+0000f3a0: 7665 2073 6d61 7274 2064 6574 6563 7469  ve smart detecti
+0000f3b0: 6f6e 2222 220a 0a20 2020 2020 2020 2072  on"""..        r
+0000f3c0: 6574 7572 6e20 6177 6169 7420 7365 6c66  eturn await self
+0000f3d0: 2e5f 7365 745f 6175 6469 6f5f 6465 7465  ._set_audio_dete
+0000f3e0: 6374 2853 6d61 7274 4465 7465 6374 4175  ct(SmartDetectAu
+0000f3f0: 6469 6f54 7970 652e 4341 525f 484f 524e  dioType.CAR_HORN
+0000f400: 2c20 656e 6162 6c65 6429 0a0a 2020 2020  , enabled)..    
+0000f410: 2320 656e 6472 6567 696f 6e0a 2020 2020  # endregion.    
+0000f420: 2320 7265 6769 6f6e 2047 6c61 7373 2042  # region Glass B
+0000f430: 7265 616b 0a0a 2020 2020 4070 726f 7065  reak..    @prope
+0000f440: 7274 790a 2020 2020 6465 6620 6361 6e5f  rty.    def can_
+0000f450: 6465 7465 6374 5f67 6c61 7373 5f62 7265  detect_glass_bre
+0000f460: 616b 2873 656c 6629 202d 3e20 626f 6f6c  ak(self) -> bool
+0000f470: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000f480: 2073 656c 662e 5f63 616e 5f64 6574 6563   self._can_detec
+0000f490: 745f 6175 6469 6f28 536d 6172 7444 6574  t_audio(SmartDet
+0000f4a0: 6563 744f 626a 6563 7454 7970 652e 474c  ectObjectType.GL
+0000f4b0: 4153 535f 4252 4541 4b29 0a0a 2020 2020  ASS_BREAK)..    
+0000f4c0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000f4d0: 6620 6973 5f67 6c61 7373 5f62 7265 616b  f is_glass_break
+0000f4e0: 5f64 6574 6563 7469 6f6e 5f6f 6e28 7365  _detection_on(se
+0000f4f0: 6c66 2920 2d3e 2062 6f6f 6c3a 0a20 2020  lf) -> bool:.   
+0000f500: 2020 2020 2022 2222 4973 2047 6c61 7373       """Is Glass
+0000f510: 2042 7265 616b 2061 7661 696c 6162 6c65   Break available
+0000f520: 2061 6e64 2065 6e61 626c 6564 2028 6361   and enabled (ca
+0000f530: 6d65 7261 2077 696c 6c20 7072 6f64 7563  mera will produc
+0000f540: 6520 676c 6173 7320 6272 6561 6b20 736d  e glass break sm
+0000f550: 6172 740a 2020 2020 2020 2020 6465 7465  art.        dete
+0000f560: 6374 696f 6e20 6576 656e 7473 293f 0a20  ction events)?. 
+0000f570: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000f580: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000f590: 5f69 735f 6175 6469 6f5f 656e 6162 6c65  _is_audio_enable
+0000f5a0: 6428 536d 6172 7444 6574 6563 744f 626a  d(SmartDetectObj
+0000f5b0: 6563 7454 7970 652e 474c 4153 535f 4252  ectType.GLASS_BR
+0000f5c0: 4541 4b29 0a0a 2020 2020 4070 726f 7065  EAK)..    @prope
+0000f5d0: 7274 790a 2020 2020 6465 6620 6c61 7374  rty.    def last
+0000f5e0: 5f67 6c61 7373 5f62 7265 616b 5f64 6574  _glass_break_det
+0000f5f0: 6563 745f 6576 656e 7428 7365 6c66 2920  ect_event(self) 
+0000f600: 2d3e 204f 7074 696f 6e61 6c5b 4576 656e  -> Optional[Even
+0000f610: 745d 3a0a 2020 2020 2020 2020 2222 2247  t]:.        """G
+0000f620: 6574 2074 6865 206c 6173 7420 476c 6173  et the last Glas
+0000f630: 7320 4272 6561 6b20 736d 6172 7420 6465  s Break smart de
+0000f640: 7465 6374 696f 6e20 6576 656e 742e 2222  tection event.""
+0000f650: 220a 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+0000f660: 6e20 7365 6c66 2e67 6574 5f6c 6173 745f  n self.get_last_
+0000f670: 736d 6172 745f 6175 6469 6f5f 6465 7465  smart_audio_dete
+0000f680: 6374 5f65 7665 6e74 2853 6d61 7274 4465  ct_event(SmartDe
+0000f690: 7465 6374 4175 6469 6f54 7970 652e 474c  tectAudioType.GL
+0000f6a0: 4153 535f 4252 4541 4b29 0a0a 2020 2020  ASS_BREAK)..    
+0000f6b0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000f6c0: 6620 6c61 7374 5f67 6c61 7373 5f62 7265  f last_glass_bre
+0000f6d0: 616b 5f64 6574 6563 7428 7365 6c66 2920  ak_detect(self) 
+0000f6e0: 2d3e 204f 7074 696f 6e61 6c5b 6461 7465  -> Optional[date
+0000f6f0: 7469 6d65 5d3a 0a20 2020 2020 2020 2022  time]:.        "
+0000f700: 2222 4765 7420 7468 6520 6c61 7374 2047  ""Get the last G
+0000f710: 6c61 7373 2042 7265 616b 2073 6d61 7274  lass Break smart
+0000f720: 2064 6574 6563 7469 6f6e 2065 7665 6e74   detection event
+0000f730: 2e22 2222 0a0a 2020 2020 2020 2020 7265  ."""..        re
+0000f740: 7475 726e 2073 656c 662e 6c61 7374 5f73  turn self.last_s
+0000f750: 6d61 7274 5f61 7564 696f 5f64 6574 6563  mart_audio_detec
+0000f760: 7473 2e67 6574 2853 6d61 7274 4465 7465  ts.get(SmartDete
+0000f770: 6374 4175 6469 6f54 7970 652e 474c 4153  ctAudioType.GLAS
+0000f780: 535f 4252 4541 4b29 0a0a 2020 2020 4070  S_BREAK)..    @p
+0000f790: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000f7a0: 6973 5f67 6c61 7373 5f62 7265 616b 5f63  is_glass_break_c
+0000f7b0: 7572 7265 6e74 6c79 5f64 6574 6563 7465  urrently_detecte
+0000f7c0: 6428 7365 6c66 2920 2d3e 2062 6f6f 6c3a  d(self) -> bool:
+0000f7d0: 0a20 2020 2020 2020 2022 2222 4973 2047  .        """Is G
+0000f7e0: 6c61 7373 2042 7265 616b 2063 7572 7265  lass Break curre
+0000f7f0: 6e74 6c79 2062 6569 6e67 2064 6574 6563  ntly being detec
+0000f800: 7465 6422 2222 0a0a 2020 2020 2020 2020  ted"""..        
+0000f810: 7265 7475 726e 2073 656c 662e 5f69 735f  return self._is_
+0000f820: 6175 6469 6f5f 6465 7465 6374 6564 2853  audio_detected(S
+0000f830: 6d61 7274 4465 7465 6374 4f62 6a65 6374  martDetectObject
+0000f840: 5479 7065 2e47 4c41 5353 5f42 5245 414b  Type.GLASS_BREAK
+0000f850: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
+0000f860: 2073 6574 5f67 6c61 7373 5f62 7265 616b   set_glass_break
+0000f870: 5f64 6574 6563 7469 6f6e 2873 656c 662c  _detection(self,
+0000f880: 2065 6e61 626c 6564 3a20 626f 6f6c 2920   enabled: bool) 
+0000f890: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000f8a0: 2022 2222 546f 6767 6c65 7320 676c 6173   """Toggles glas
+0000f8b0: 735f 6272 6561 6b20 736d 6172 7420 6465  s_break smart de
+0000f8c0: 7465 6374 696f 6e2e 2052 6571 7569 7265  tection. Require
+0000f8d0: 7320 6361 6d65 7261 2074 6f20 6861 7665  s camera to have
+0000f8e0: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+0000f8f0: 2222 220a 0a20 2020 2020 2020 2072 6574  """..        ret
+0000f900: 7572 6e20 6177 6169 7420 7365 6c66 2e5f  urn await self._
+0000f910: 7365 745f 6175 6469 6f5f 6465 7465 6374  set_audio_detect
+0000f920: 2853 6d61 7274 4465 7465 6374 4175 6469  (SmartDetectAudi
+0000f930: 6f54 7970 652e 474c 4153 535f 4252 4541  oType.GLASS_BREA
+0000f940: 4b2c 2065 6e61 626c 6564 290a 0a20 2020  K, enabled)..   
+0000f950: 2023 2065 6e64 7265 6769 6f6e 0a20 2020   # endregion.   
+0000f960: 2023 2065 6e64 7265 6769 6f6e 0a0a 2020   # endregion..  
+0000f970: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000f980: 6465 6620 6973 5f72 696e 6769 6e67 2873  def is_ringing(s
+0000f990: 656c 6629 202d 3e20 626f 6f6c 3a0a 2020  elf) -> bool:.  
+0000f9a0: 2020 2020 2020 6966 2073 656c 662e 5f6c        if self._l
+0000f9b0: 6173 745f 7269 6e67 5f74 696d 656f 7574  ast_ring_timeout
+0000f9c0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0000f9d0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0000f9e0: 7365 0a20 2020 2020 2020 2072 6574 7572  se.        retur
+0000f9f0: 6e20 7574 635f 6e6f 7728 2920 3c20 7365  n utc_now() < se
+0000fa00: 6c66 2e5f 6c61 7374 5f72 696e 675f 7469  lf._last_ring_ti
+0000fa10: 6d65 6f75 740a 0a20 2020 2040 7072 6f70  meout..    @prop
+0000fa20: 6572 7479 0a20 2020 2064 6566 2063 6869  erty.    def chi
+0000fa30: 6d65 5f74 7970 6528 7365 6c66 2920 2d3e  me_type(self) ->
+0000fa40: 2043 6869 6d65 5479 7065 3a0a 2020 2020   ChimeType:.    
+0000fa50: 2020 2020 6966 2073 656c 662e 6368 696d      if self.chim
+0000fa60: 655f 6475 7261 7469 6f6e 2e74 6f74 616c  e_duration.total
+0000fa70: 5f73 6563 6f6e 6473 2829 203d 3d20 302e  _seconds() == 0.
+0000fa80: 333a 0a20 2020 2020 2020 2020 2020 2072  3:.            r
+0000fa90: 6574 7572 6e20 4368 696d 6554 7970 652e  eturn ChimeType.
+0000faa0: 4d45 4348 414e 4943 414c 0a20 2020 2020  MECHANICAL.     
+0000fab0: 2020 2069 6620 7365 6c66 2e63 6869 6d65     if self.chime
+0000fac0: 5f64 7572 6174 696f 6e2e 746f 7461 6c5f  _duration.total_
+0000fad0: 7365 636f 6e64 7328 2920 3e20 302e 333a  seconds() > 0.3:
+0000fae0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000faf0: 7572 6e20 4368 696d 6554 7970 652e 4449  urn ChimeType.DI
+0000fb00: 4749 5441 4c0a 2020 2020 2020 2020 7265  GITAL.        re
+0000fb10: 7475 726e 2043 6869 6d65 5479 7065 2e4e  turn ChimeType.N
+0000fb20: 4f4e 450a 0a20 2020 2040 7072 6f70 6572  ONE..    @proper
+0000fb30: 7479 0a20 2020 2064 6566 2069 735f 6469  ty.    def is_di
+0000fb40: 6769 7461 6c5f 6368 696d 6528 7365 6c66  gital_chime(self
+0000fb50: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+0000fb60: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
+0000fb70: 6869 6d65 5f74 7970 6520 6973 2043 6869  hime_type is Chi
+0000fb80: 6d65 5479 7065 2e44 4947 4954 414c 0a0a  meType.DIGITAL..
+0000fb90: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000fba0: 2020 6465 6620 6869 6768 5f63 616d 6572    def high_camer
+0000fbb0: 615f 6368 616e 6e65 6c28 7365 6c66 2920  a_channel(self) 
+0000fbc0: 2d3e 204f 7074 696f 6e61 6c5b 4361 6d65  -> Optional[Came
+0000fbd0: 7261 4368 616e 6e65 6c5d 3a0a 2020 2020  raChannel]:.    
+0000fbe0: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+0000fbf0: 6368 616e 6e65 6c73 2920 3e3d 2033 3a0a  channels) >= 3:.
+0000fc00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000fc10: 726e 2073 656c 662e 6368 616e 6e65 6c73  rn self.channels
+0000fc20: 5b30 5d0a 2020 2020 2020 2020 7265 7475  [0].        retu
+0000fc30: 726e 204e 6f6e 650a 0a20 2020 2040 7072  rn None..    @pr
+0000fc40: 6f70 6572 7479 0a20 2020 2064 6566 206d  operty.    def m
+0000fc50: 6564 6975 6d5f 6361 6d65 7261 5f63 6861  edium_camera_cha
+0000fc60: 6e6e 656c 2873 656c 6629 202d 3e20 4f70  nnel(self) -> Op
+0000fc70: 7469 6f6e 616c 5b43 616d 6572 6143 6861  tional[CameraCha
+0000fc80: 6e6e 656c 5d3a 0a20 2020 2020 2020 2069  nnel]:.        i
+0000fc90: 6620 6c65 6e28 7365 6c66 2e63 6861 6e6e  f len(self.chann
+0000fca0: 656c 7329 203e 3d20 333a 0a20 2020 2020  els) >= 3:.     
+0000fcb0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000fcc0: 6c66 2e63 6861 6e6e 656c 735b 315d 0a20  lf.channels[1]. 
+0000fcd0: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+0000fce0: 6e65 0a0a 2020 2020 4070 726f 7065 7274  ne..    @propert
+0000fcf0: 790a 2020 2020 6465 6620 6c6f 775f 6361  y.    def low_ca
+0000fd00: 6d65 7261 5f63 6861 6e6e 656c 2873 656c  mera_channel(sel
+0000fd10: 6629 202d 3e20 4f70 7469 6f6e 616c 5b43  f) -> Optional[C
+0000fd20: 616d 6572 6143 6861 6e6e 656c 5d3a 0a20  ameraChannel]:. 
+0000fd30: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+0000fd40: 6c66 2e63 6861 6e6e 656c 7329 203e 3d20  lf.channels) >= 
+0000fd50: 333a 0a20 2020 2020 2020 2020 2020 2072  3:.            r
+0000fd60: 6574 7572 6e20 7365 6c66 2e63 6861 6e6e  eturn self.chann
+0000fd70: 656c 735b 325d 0a20 2020 2020 2020 2072  els[2].        r
+0000fd80: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
+0000fd90: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000fda0: 6620 6465 6661 756c 745f 6361 6d65 7261  f default_camera
+0000fdb0: 5f63 6861 6e6e 656c 2873 656c 6629 202d  _channel(self) -
+0000fdc0: 3e20 4f70 7469 6f6e 616c 5b43 616d 6572  > Optional[Camer
+0000fdd0: 6143 6861 6e6e 656c 5d3a 0a20 2020 2020  aChannel]:.     
+0000fde0: 2020 2066 6f72 2063 6861 6e6e 656c 2069     for channel i
+0000fdf0: 6e20 5b0a 2020 2020 2020 2020 2020 2020  n [.            
+0000fe00: 7365 6c66 2e68 6967 685f 6361 6d65 7261  self.high_camera
+0000fe10: 5f63 6861 6e6e 656c 2c0a 2020 2020 2020  _channel,.      
+0000fe20: 2020 2020 2020 7365 6c66 2e6d 6564 6975        self.mediu
+0000fe30: 6d5f 6361 6d65 7261 5f63 6861 6e6e 656c  m_camera_channel
+0000fe40: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
+0000fe50: 6c66 2e6c 6f77 5f63 616d 6572 615f 6368  lf.low_camera_ch
+0000fe60: 616e 6e65 6c2c 0a20 2020 2020 2020 205d  annel,.        ]
+0000fe70: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000fe80: 2063 6861 6e6e 656c 2069 7320 6e6f 7420   channel is not 
+0000fe90: 4e6f 6e65 2061 6e64 2063 6861 6e6e 656c  None and channel
+0000fea0: 2e69 735f 7274 7370 5f65 6e61 626c 6564  .is_rtsp_enabled
+0000feb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000fec0: 2020 7265 7475 726e 2063 6861 6e6e 656c    return channel
+0000fed0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000fee0: 7365 6c66 2e68 6967 685f 6361 6d65 7261  self.high_camera
+0000fef0: 5f63 6861 6e6e 656c 0a0a 2020 2020 4070  _channel..    @p
+0000ff00: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000ff10: 7061 636b 6167 655f 6361 6d65 7261 5f63  package_camera_c
+0000ff20: 6861 6e6e 656c 2873 656c 6629 202d 3e20  hannel(self) -> 
+0000ff30: 4f70 7469 6f6e 616c 5b43 616d 6572 6143  Optional[CameraC
+0000ff40: 6861 6e6e 656c 5d3a 0a20 2020 2020 2020  hannel]:.       
+0000ff50: 2069 6620 7365 6c66 2e66 6561 7475 7265   if self.feature
+0000ff60: 5f66 6c61 6773 2e68 6173 5f70 6163 6b61  _flags.has_packa
+0000ff70: 6765 5f63 616d 6572 6120 616e 6420 6c65  ge_camera and le
+0000ff80: 6e28 7365 6c66 2e63 6861 6e6e 656c 7329  n(self.channels)
+0000ff90: 203d 3d20 343a 0a20 2020 2020 2020 2020   == 4:.         
+0000ffa0: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
+0000ffb0: 6861 6e6e 656c 735b 335d 0a20 2020 2020  hannels[3].     
+0000ffc0: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
+0000ffd0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000ffe0: 2020 6465 6620 6973 5f68 6967 685f 6670    def is_high_fp
+0000fff0: 735f 656e 6162 6c65 6428 7365 6c66 2920  s_enabled(self) 
+00010000: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+00010010: 2072 6574 7572 6e20 7365 6c66 2e76 6964   return self.vid
+00010020: 656f 5f6d 6f64 6520 3d3d 2056 6964 656f  eo_mode == Video
+00010030: 4d6f 6465 2e48 4947 485f 4650 530a 0a20  Mode.HIGH_FPS.. 
+00010040: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00010050: 2064 6566 2069 735f 7669 6465 6f5f 7265   def is_video_re
+00010060: 6164 7928 7365 6c66 2920 2d3e 2062 6f6f  ady(self) -> boo
+00010070: 6c3a 0a20 2020 2020 2020 2072 6574 7572  l:.        retur
+00010080: 6e20 280a 2020 2020 2020 2020 2020 2020  n (.            
+00010090: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
+000100a0: 6773 2e6c 656e 735f 7479 7065 2069 7320  gs.lens_type is 
+000100b0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+000100c0: 206f 7220 7365 6c66 2e66 6561 7475 7265   or self.feature
+000100d0: 5f66 6c61 6773 2e6c 656e 735f 7479 7065  _flags.lens_type
+000100e0: 2021 3d20 4c65 6e73 5479 7065 2e4e 4f4e   != LensType.NON
+000100f0: 450a 2020 2020 2020 2020 290a 0a20 2020  E.        )..   
+00010100: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00010110: 6566 2068 6173 5f72 656d 6f76 6162 6c65  ef has_removable
+00010120: 5f6c 656e 7328 7365 6c66 2920 2d3e 2062  _lens(self) -> b
+00010130: 6f6f 6c3a 0a20 2020 2020 2020 2072 6574  ool:.        ret
+00010140: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+00010150: 2020 7365 6c66 2e66 6561 7475 7265 5f66    self.feature_f
+00010160: 6c61 6773 2e68 6f74 706c 7567 2069 7320  lags.hotplug is 
+00010170: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+00010180: 2020 2020 2061 6e64 2073 656c 662e 6665       and self.fe
+00010190: 6174 7572 655f 666c 6167 732e 686f 7470  ature_flags.hotp
+000101a0: 6c75 672e 7669 6465 6f20 6973 206e 6f74  lug.video is not
+000101b0: 204e 6f6e 650a 2020 2020 2020 2020 290a   None.        ).
+000101c0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+000101d0: 2020 2064 6566 2068 6173 5f72 656d 6f76     def has_remov
+000101e0: 6162 6c65 5f73 7065 616b 6572 2873 656c  able_speaker(sel
+000101f0: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
+00010200: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
+00010210: 2020 2020 2020 2020 2073 656c 662e 6665           self.fe
+00010220: 6174 7572 655f 666c 6167 732e 686f 7470  ature_flags.hotp
+00010230: 6c75 6720 6973 206e 6f74 204e 6f6e 650a  lug is not None.
+00010240: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00010250: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
+00010260: 6773 2e68 6f74 706c 7567 2e61 7564 696f  gs.hotplug.audio
+00010270: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+00010280: 2020 2020 2029 0a0a 2020 2020 4070 726f       )..    @pro
+00010290: 7065 7274 790a 2020 2020 6465 6620 6861  perty.    def ha
+000102a0: 735f 6d69 6328 7365 6c66 2920 2d3e 2062  s_mic(self) -> b
+000102b0: 6f6f 6c3a 0a20 2020 2020 2020 2072 6574  ool:.        ret
+000102c0: 7572 6e20 7365 6c66 2e66 6561 7475 7265  urn self.feature
+000102d0: 5f66 6c61 6773 2e68 6173 5f6d 6963 206f  _flags.has_mic o
+000102e0: 7220 7365 6c66 2e68 6173 5f72 656d 6f76  r self.has_remov
+000102f0: 6162 6c65 5f73 7065 616b 6572 0a0a 2020  able_speaker..  
+00010300: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00010310: 6465 6620 6861 735f 636f 6c6f 725f 6e69  def has_color_ni
+00010320: 6768 745f 7669 7369 6f6e 2873 656c 6629  ght_vision(self)
+00010330: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+00010340: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
+00010350: 2020 2073 656c 662e 6665 6174 7572 655f     self.feature_
+00010360: 666c 6167 732e 686f 7470 6c75 6720 6973  flags.hotplug is
+00010370: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+00010380: 2020 2020 2020 616e 6420 7365 6c66 2e66        and self.f
+00010390: 6561 7475 7265 5f66 6c61 6773 2e68 6f74  eature_flags.hot
+000103a0: 706c 7567 2e65 7874 656e 6465 7220 6973  plug.extender is
+000103b0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+000103c0: 2020 2020 2020 616e 6420 7365 6c66 2e66        and self.f
+000103d0: 6561 7475 7265 5f66 6c61 6773 2e68 6f74  eature_flags.hot
+000103e0: 706c 7567 2e65 7874 656e 6465 722e 6973  plug.extender.is
+000103f0: 5f61 7474 6163 6865 6420 6973 206e 6f74  _attached is not
+00010400: 204e 6f6e 650a 2020 2020 2020 2020 293a   None.        ):
+00010410: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00010420: 7572 6e20 7365 6c66 2e66 6561 7475 7265  urn self.feature
+00010430: 5f66 6c61 6773 2e68 6f74 706c 7567 2e65  _flags.hotplug.e
+00010440: 7874 656e 6465 722e 6973 5f61 7474 6163  xtender.is_attac
+00010450: 6865 640a 0a20 2020 2020 2020 2072 6574  hed..        ret
+00010460: 7572 6e20 4661 6c73 650a 0a20 2020 2064  urn False..    d
+00010470: 6566 2073 6574 5f72 696e 675f 7469 6d65  ef set_ring_time
+00010480: 6f75 7428 7365 6c66 2920 2d3e 204e 6f6e  out(self) -> Non
+00010490: 653a 0a20 2020 2020 2020 2073 656c 662e  e:.        self.
+000104a0: 5f6c 6173 745f 7269 6e67 5f74 696d 656f  _last_ring_timeo
+000104b0: 7574 203d 2075 7463 5f6e 6f77 2829 202b  ut = utc_now() +
+000104c0: 2045 5645 4e54 5f50 494e 475f 494e 5445   EVENT_PING_INTE
+000104d0: 5256 414c 0a20 2020 2020 2020 2073 656c  RVAL.        sel
+000104e0: 662e 5f65 7665 6e74 5f63 616c 6c62 6163  f._event_callbac
+000104f0: 6b5f 7069 6e67 2829 0a0a 2020 2020 6465  k_ping()..    de
+00010500: 6620 6765 745f 7072 6976 6163 795f 7a6f  f get_privacy_zo
+00010510: 6e65 2873 656c 6629 202d 3e20 7475 706c  ne(self) -> tupl
+00010520: 655b 4f70 7469 6f6e 616c 5b69 6e74 5d2c  e[Optional[int],
+00010530: 204f 7074 696f 6e61 6c5b 4361 6d65 7261   Optional[Camera
+00010540: 5a6f 6e65 5d5d 3a0a 2020 2020 2020 2020  Zone]]:.        
+00010550: 666f 7220 696e 6465 782c 207a 6f6e 6520  for index, zone 
+00010560: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
+00010570: 662e 7072 6976 6163 795f 7a6f 6e65 7329  f.privacy_zones)
+00010580: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00010590: 207a 6f6e 652e 6e61 6d65 203d 3d20 5052   zone.name == PR
+000105a0: 4956 4143 595f 5a4f 4e45 5f4e 414d 453a  IVACY_ZONE_NAME:
+000105b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000105c0: 2072 6574 7572 6e20 696e 6465 782c 207a   return index, z
+000105d0: 6f6e 650a 2020 2020 2020 2020 7265 7475  one.        retu
+000105e0: 726e 204e 6f6e 652c 204e 6f6e 650a 0a20  rn None, None.. 
+000105f0: 2020 2064 6566 2061 6464 5f70 7269 7661     def add_priva
+00010600: 6379 5f7a 6f6e 6528 7365 6c66 2920 2d3e  cy_zone(self) ->
+00010610: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+00010620: 6e64 6578 2c20 5f20 3d20 7365 6c66 2e67  ndex, _ = self.g
+00010630: 6574 5f70 7269 7661 6379 5f7a 6f6e 6528  et_privacy_zone(
+00010640: 290a 2020 2020 2020 2020 6966 2069 6e64  ).        if ind
+00010650: 6578 2069 7320 4e6f 6e65 3a0a 2020 2020  ex is None:.    
+00010660: 2020 2020 2020 2020 7a6f 6e65 5f69 6420          zone_id 
+00010670: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+00010680: 6966 206c 656e 2873 656c 662e 7072 6976  if len(self.priv
+00010690: 6163 795f 7a6f 6e65 7329 203e 2030 3a0a  acy_zones) > 0:.
+000106a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000106b0: 7a6f 6e65 5f69 6420 3d20 7365 6c66 2e70  zone_id = self.p
+000106c0: 7269 7661 6379 5f7a 6f6e 6573 5b2d 315d  rivacy_zones[-1]
+000106d0: 2e69 6420 2b20 310a 0a20 2020 2020 2020  .id + 1..       
+000106e0: 2020 2020 2073 656c 662e 7072 6976 6163       self.privac
+000106f0: 795f 7a6f 6e65 732e 6170 7065 6e64 2843  y_zones.append(C
+00010700: 616d 6572 615a 6f6e 652e 6372 6561 7465  ameraZone.create
+00010710: 5f70 7269 7661 6379 5f7a 6f6e 6528 7a6f  _privacy_zone(zo
+00010720: 6e65 5f69 6429 290a 0a20 2020 2064 6566  ne_id))..    def
+00010730: 2072 656d 6f76 655f 7072 6976 6163 795f   remove_privacy_
+00010740: 7a6f 6e65 2873 656c 6629 202d 3e20 4e6f  zone(self) -> No
+00010750: 6e65 3a0a 2020 2020 2020 2020 696e 6465  ne:.        inde
+00010760: 782c 205f 203d 2073 656c 662e 6765 745f  x, _ = self.get_
+00010770: 7072 6976 6163 795f 7a6f 6e65 2829 0a0a  privacy_zone()..
+00010780: 2020 2020 2020 2020 6966 2069 6e64 6578          if index
+00010790: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000107a0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000107b0: 7269 7661 6379 5f7a 6f6e 6573 2e70 6f70  rivacy_zones.pop
+000107c0: 2869 6e64 6578 290a 0a20 2020 2061 7379  (index)..    asy
+000107d0: 6e63 2064 6566 2067 6574 5f73 6e61 7073  nc def get_snaps
+000107e0: 686f 7428 0a20 2020 2020 2020 2073 656c  hot(.        sel
+000107f0: 662c 0a20 2020 2020 2020 2077 6964 7468  f,.        width
+00010800: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
+00010810: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00010820: 6865 6967 6874 3a20 4f70 7469 6f6e 616c  height: Optional
+00010830: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
+00010840: 2020 2020 2020 6474 3a20 4f70 7469 6f6e        dt: Option
+00010850: 616c 5b64 6174 6574 696d 655d 203d 204e  al[datetime] = N
+00010860: 6f6e 652c 0a20 2020 2029 202d 3e20 4f70  one,.    ) -> Op
+00010870: 7469 6f6e 616c 5b62 7974 6573 5d3a 0a20  tional[bytes]:. 
+00010880: 2020 2020 2020 2022 2222 4765 7473 2073         """Gets s
+00010890: 6e61 7073 686f 7420 666f 7220 6361 6d65  napshot for came
+000108a0: 7261 2e0a 0a20 2020 2020 2020 2044 6174  ra...        Dat
+000108b0: 6574 696d 6520 6f66 2073 6372 6565 6e73  etime of screens
+000108c0: 686f 7420 6973 2061 7070 726f 7869 6d61  hot is approxima
+000108d0: 7465 2e20 4974 206d 6179 2062 6520 2b2f  te. It may be +/
+000108e0: 2d20 6120 6665 7720 7365 636f 6e64 732e  - a few seconds.
+000108f0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00010900: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00010910: 662e 6170 692e 626f 6f74 7374 7261 702e  f.api.bootstrap.
+00010920: 6175 7468 5f75 7365 722e 6361 6e28 0a20  auth_user.can(. 
+00010930: 2020 2020 2020 2020 2020 204d 6f64 656c             Model
+00010940: 5479 7065 2e43 414d 4552 412c 0a20 2020  Type.CAMERA,.   
+00010950: 2020 2020 2020 2020 2050 6572 6d69 7373           Permiss
+00010960: 696f 6e4e 6f64 652e 5245 4144 5f4d 4544  ionNode.READ_MED
+00010970: 4941 2c0a 2020 2020 2020 2020 2020 2020  IA,.            
+00010980: 7365 6c66 2c0a 2020 2020 2020 2020 293a  self,.        ):
+00010990: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000109a0: 7365 204e 6f74 4175 7468 6f72 697a 6564  se NotAuthorized
+000109b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000109c0: 2020 6622 446f 206e 6f74 2068 6176 6520    f"Do not have 
+000109d0: 7065 726d 6973 7369 6f6e 2074 6f20 7265  permission to re
+000109e0: 6164 206d 6564 6961 2066 6f72 2063 616d  ad media for cam
+000109f0: 6572 613a 207b 7365 6c66 2e69 647d 222c  era: {self.id}",
+00010a00: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00010a10: 2020 2020 2020 2020 6966 2068 6569 6768          if heigh
+00010a20: 7420 6973 204e 6f6e 6520 616e 6420 7769  t is None and wi
+00010a30: 6474 6820 6973 204e 6f6e 6520 616e 6420  dth is None and 
+00010a40: 7365 6c66 2e68 6967 685f 6361 6d65 7261  self.high_camera
+00010a50: 5f63 6861 6e6e 656c 2069 7320 6e6f 7420  _channel is not 
+00010a60: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00010a70: 2020 6865 6967 6874 203d 2073 656c 662e    height = self.
+00010a80: 6869 6768 5f63 616d 6572 615f 6368 616e  high_camera_chan
+00010a90: 6e65 6c2e 6865 6967 6874 0a0a 2020 2020  nel.height..    
+00010aa0: 2020 2020 7265 7475 726e 2061 7761 6974      return await
+00010ab0: 2073 656c 662e 6170 692e 6765 745f 6361   self.api.get_ca
+00010ac0: 6d65 7261 5f73 6e61 7073 686f 7428 7365  mera_snapshot(se
+00010ad0: 6c66 2e69 642c 2077 6964 7468 2c20 6865  lf.id, width, he
+00010ae0: 6967 6874 2c20 6474 3d64 7429 0a0a 2020  ight, dt=dt)..  
+00010af0: 2020 6173 796e 6320 6465 6620 6765 745f    async def get_
+00010b00: 7061 636b 6167 655f 736e 6170 7368 6f74  package_snapshot
+00010b10: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00010b20: 2020 2020 2020 2020 7769 6474 683a 204f          width: O
+00010b30: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00010b40: 6f6e 652c 0a20 2020 2020 2020 2068 6569  one,.        hei
+00010b50: 6768 743a 204f 7074 696f 6e61 6c5b 696e  ght: Optional[in
+00010b60: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
+00010b70: 2020 2064 743a 204f 7074 696f 6e61 6c5b     dt: Optional[
+00010b80: 6461 7465 7469 6d65 5d20 3d20 4e6f 6e65  datetime] = None
+00010b90: 2c0a 2020 2020 2920 2d3e 204f 7074 696f  ,.    ) -> Optio
+00010ba0: 6e61 6c5b 6279 7465 735d 3a0a 2020 2020  nal[bytes]:.    
+00010bb0: 2020 2020 2222 2247 6574 7320 736e 6170      """Gets snap
+00010bc0: 7368 6f74 2066 726f 6d20 7468 6520 7061  shot from the pa
+00010bd0: 636b 6167 6520 6361 6d65 7261 2e0a 0a20  ckage camera... 
+00010be0: 2020 2020 2020 2044 6174 6574 696d 6520         Datetime 
+00010bf0: 6f66 2073 6372 6565 6e73 686f 7420 6973  of screenshot is
+00010c00: 2061 7070 726f 7869 6d61 7465 2e20 4974   approximate. It
+00010c10: 206d 6179 2062 6520 2b2f 2d20 6120 6665   may be +/- a fe
+00010c20: 7720 7365 636f 6e64 732e 0a20 2020 2020  w seconds..     
+00010c30: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00010c40: 6966 206e 6f74 2073 656c 662e 6665 6174  if not self.feat
+00010c50: 7572 655f 666c 6167 732e 6861 735f 7061  ure_flags.has_pa
+00010c60: 636b 6167 655f 6361 6d65 7261 3a0a 2020  ckage_camera:.  
+00010c70: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00010c80: 4261 6452 6571 7565 7374 2822 4465 7669  BadRequest("Devi
+00010c90: 6365 2064 6f65 7320 6e6f 7420 6861 7665  ce does not have
+00010ca0: 2070 6163 6b61 6765 2063 616d 6572 6122   package camera"
+00010cb0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+00010cc0: 7420 7365 6c66 2e61 7069 2e62 6f6f 7473  t self.api.boots
+00010cd0: 7472 6170 2e61 7574 685f 7573 6572 2e63  trap.auth_user.c
+00010ce0: 616e 280a 2020 2020 2020 2020 2020 2020  an(.            
+00010cf0: 4d6f 6465 6c54 7970 652e 4341 4d45 5241  ModelType.CAMERA
+00010d00: 2c0a 2020 2020 2020 2020 2020 2020 5065  ,.            Pe
+00010d10: 726d 6973 7369 6f6e 4e6f 6465 2e52 4541  rmissionNode.REA
+00010d20: 445f 4d45 4449 412c 0a20 2020 2020 2020  D_MEDIA,.       
+00010d30: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00010d40: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00010d50: 2020 7261 6973 6520 4e6f 7441 7574 686f    raise NotAutho
+00010d60: 7269 7a65 6428 0a20 2020 2020 2020 2020  rized(.         
+00010d70: 2020 2020 2020 2066 2244 6f20 6e6f 7420         f"Do not 
+00010d80: 6861 7665 2070 6572 6d69 7373 696f 6e20  have permission 
+00010d90: 746f 2072 6561 6420 6d65 6469 6120 666f  to read media fo
+00010da0: 7220 6361 6d65 7261 3a20 7b73 656c 662e  r camera: {self.
+00010db0: 6964 7d22 2c0a 2020 2020 2020 2020 2020  id}",.          
+00010dc0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+00010dd0: 6865 6967 6874 2069 7320 4e6f 6e65 2061  height is None a
+00010de0: 6e64 2077 6964 7468 2069 7320 4e6f 6e65  nd width is None
+00010df0: 2061 6e64 2073 656c 662e 7061 636b 6167   and self.packag
+00010e00: 655f 6361 6d65 7261 5f63 6861 6e6e 656c  e_camera_channel
+00010e10: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00010e20: 2020 2020 2020 2020 2020 6865 6967 6874            height
+00010e30: 203d 2073 656c 662e 7061 636b 6167 655f   = self.package_
+00010e40: 6361 6d65 7261 5f63 6861 6e6e 656c 2e68  camera_channel.h
+00010e50: 6569 6768 740a 0a20 2020 2020 2020 2072  eight..        r
+00010e60: 6574 7572 6e20 6177 6169 7420 7365 6c66  eturn await self
+00010e70: 2e61 7069 2e67 6574 5f70 6163 6b61 6765  .api.get_package
+00010e80: 5f63 616d 6572 615f 736e 6170 7368 6f74  _camera_snapshot
+00010e90: 2873 656c 662e 6964 2c20 7769 6474 682c  (self.id, width,
+00010ea0: 2068 6569 6768 742c 2064 743d 6474 290a   height, dt=dt).
+00010eb0: 0a20 2020 2061 7379 6e63 2064 6566 2067  .    async def g
+00010ec0: 6574 5f76 6964 656f 280a 2020 2020 2020  et_video(.      
+00010ed0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00010ee0: 7374 6172 743a 2064 6174 6574 696d 652c  start: datetime,
+00010ef0: 0a20 2020 2020 2020 2065 6e64 3a20 6461  .        end: da
+00010f00: 7465 7469 6d65 2c0a 2020 2020 2020 2020  tetime,.        
+00010f10: 6368 616e 6e65 6c5f 696e 6465 783a 2069  channel_index: i
+00010f20: 6e74 203d 2030 2c0a 2020 2020 2020 2020  nt = 0,.        
+00010f30: 6f75 7470 7574 5f66 696c 653a 204f 7074  output_file: Opt
+00010f40: 696f 6e61 6c5b 5061 7468 5d20 3d20 4e6f  ional[Path] = No
+00010f50: 6e65 2c0a 2020 2020 2020 2020 6974 6572  ne,.        iter
+00010f60: 6174 6f72 5f63 616c 6c62 6163 6b3a 204f  ator_callback: O
+00010f70: 7074 696f 6e61 6c5b 4974 6572 6174 6f72  ptional[Iterator
+00010f80: 4361 6c6c 6261 636b 5d20 3d20 4e6f 6e65  Callback] = None
+00010f90: 2c0a 2020 2020 2020 2020 7072 6f67 7265  ,.        progre
+00010fa0: 7373 5f63 616c 6c62 6163 6b3a 204f 7074  ss_callback: Opt
+00010fb0: 696f 6e61 6c5b 5072 6f67 7265 7373 4361  ional[ProgressCa
+00010fc0: 6c6c 6261 636b 5d20 3d20 4e6f 6e65 2c0a  llback] = None,.
+00010fd0: 2020 2020 2020 2020 6368 756e 6b5f 7369          chunk_si
+00010fe0: 7a65 3a20 696e 7420 3d20 3635 3533 362c  ze: int = 65536,
+00010ff0: 0a20 2020 2020 2020 2066 7073 3a20 4f70  .        fps: Op
+00011000: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+00011010: 6e65 2c0a 2020 2020 2920 2d3e 204f 7074  ne,.    ) -> Opt
+00011020: 696f 6e61 6c5b 6279 7465 735d 3a0a 2020  ional[bytes]:.  
+00011030: 2020 2020 2020 2222 2245 7870 6f72 7473        """Exports
+00011040: 204d 5034 2076 6964 656f 2066 726f 6d20   MP4 video from 
+00011050: 6120 6769 7665 6e20 6361 6d65 7261 2061  a given camera a
+00011060: 7420 6120 7370 6563 6966 6963 2074 696d  t a specific tim
+00011070: 652e 0a0a 2020 2020 2020 2020 5374 6172  e...        Star
+00011080: 742f 456e 6420 6f66 2076 6964 656f 2065  t/End of video e
+00011090: 7870 6f72 7420 6172 6520 6170 7072 6f78  xport are approx
+000110a0: 696d 6174 652e 2049 7420 6d61 7920 6265  imate. It may be
+000110b0: 202b 2f2d 2061 2066 6577 2073 6563 6f6e   +/- a few secon
+000110c0: 6473 2e0a 0a20 2020 2020 2020 2049 7420  ds...        It 
+000110d0: 6973 2072 6563 6f6d 6d65 6e64 6564 2074  is recommended t
+000110e0: 6f20 7072 6f76 6964 6520 6120 6f75 7470  o provide a outp
+000110f0: 7574 2066 696c 6520 6f72 2070 726f 6772  ut file or progr
+00011100: 6573 7320 6361 6c6c 6261 636b 2066 6f72  ess callback for
+00011110: 206c 6172 6765 720a 2020 2020 2020 2020   larger.        
+00011120: 7669 6465 6f20 636c 6970 732c 206f 7468  video clips, oth
+00011130: 6572 7769 7365 2074 6865 2066 756c 6c20  erwise the full 
+00011140: 7669 6465 6f20 6d75 7374 2062 6520 646f  video must be do
+00011150: 776e 6c6f 6164 6564 2074 6f20 6d65 6d6f  wnloaded to memo
+00011160: 7279 2062 6566 6f72 650a 2020 2020 2020  ry before.      
+00011170: 2020 6265 696e 6720 7772 6974 7465 6e2e    being written.
+00011180: 0a0a 2020 2020 2020 2020 5072 6f76 6964  ..        Provid
+00011190: 696e 6720 7468 6520 6066 7073 6020 7061  ing the `fps` pa
+000111a0: 7261 6d65 7465 7220 6372 6561 7465 7320  rameter creates 
+000111b0: 6120 2274 696d 656c 6170 7365 2220 6578  a "timelapse" ex
+000111c0: 706f 7274 2077 7469 6820 7468 6520 6769  port wtih the gi
+000111d0: 7665 6e20 4650 530a 2020 2020 2020 2020  ven FPS.        
+000111e0: 7661 6c75 652e 2050 726f 7465 6374 2061  value. Protect a
+000111f0: 7070 2067 6976 6573 2074 6865 206f 7074  pp gives the opt
+00011200: 696f 6e73 2066 6f72 2036 3078 2028 6670  ions for 60x (fp
+00011210: 733d 3429 2c20 3132 3078 2028 6670 733d  s=4), 120x (fps=
+00011220: 3829 2c20 3330 3078 0a20 2020 2020 2020  8), 300x.       
+00011230: 2028 6670 733d 3230 292c 2061 6e64 2036   (fps=20), and 6
+00011240: 3030 7820 2866 7073 3d34 3029 2e0a 2020  00x (fps=40)..  
+00011250: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00011260: 2020 2069 6620 6e6f 7420 7365 6c66 2e61     if not self.a
+00011270: 7069 2e62 6f6f 7473 7472 6170 2e61 7574  pi.bootstrap.aut
+00011280: 685f 7573 6572 2e63 616e 280a 2020 2020  h_user.can(.    
+00011290: 2020 2020 2020 2020 4d6f 6465 6c54 7970          ModelTyp
+000112a0: 652e 4341 4d45 5241 2c0a 2020 2020 2020  e.CAMERA,.      
+000112b0: 2020 2020 2020 5065 726d 6973 7369 6f6e        Permission
+000112c0: 4e6f 6465 2e52 4541 445f 4d45 4449 412c  Node.READ_MEDIA,
+000112d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000112e0: 662c 0a20 2020 2020 2020 2029 3a0a 2020  f,.        ):.  
+000112f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00011300: 4e6f 7441 7574 686f 7269 7a65 6428 0a20  NotAuthorized(. 
+00011310: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00011320: 2244 6f20 6e6f 7420 6861 7665 2070 6572  "Do not have per
+00011330: 6d69 7373 696f 6e20 746f 2072 6561 6420  mission to read 
+00011340: 6d65 6469 6120 666f 7220 6361 6d65 7261  media for camera
+00011350: 3a20 7b73 656c 662e 6964 7d22 2c0a 2020  : {self.id}",.  
+00011360: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00011370: 2020 2020 2072 6574 7572 6e20 6177 6169       return awai
+00011380: 7420 7365 6c66 2e61 7069 2e67 6574 5f63  t self.api.get_c
+00011390: 616d 6572 615f 7669 6465 6f28 0a20 2020  amera_video(.   
+000113a0: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
+000113b0: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+000113c0: 6172 742c 0a20 2020 2020 2020 2020 2020  art,.           
+000113d0: 2065 6e64 2c0a 2020 2020 2020 2020 2020   end,.          
+000113e0: 2020 6368 616e 6e65 6c5f 696e 6465 782c    channel_index,
+000113f0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+00011400: 7075 745f 6669 6c65 3d6f 7574 7075 745f  put_file=output_
+00011410: 6669 6c65 2c0a 2020 2020 2020 2020 2020  file,.          
+00011420: 2020 6974 6572 6174 6f72 5f63 616c 6c62    iterator_callb
+00011430: 6163 6b3d 6974 6572 6174 6f72 5f63 616c  ack=iterator_cal
+00011440: 6c62 6163 6b2c 0a20 2020 2020 2020 2020  lback,.         
+00011450: 2020 2070 726f 6772 6573 735f 6361 6c6c     progress_call
+00011460: 6261 636b 3d70 726f 6772 6573 735f 6361  back=progress_ca
+00011470: 6c6c 6261 636b 2c0a 2020 2020 2020 2020  llback,.        
+00011480: 2020 2020 6368 756e 6b5f 7369 7a65 3d63      chunk_size=c
+00011490: 6875 6e6b 5f73 697a 652c 0a20 2020 2020  hunk_size,.     
+000114a0: 2020 2020 2020 2066 7073 3d66 7073 2c0a         fps=fps,.
+000114b0: 2020 2020 2020 2020 290a 0a20 2020 2061          )..    a
+000114c0: 7379 6e63 2064 6566 2073 6574 5f72 6563  sync def set_rec
+000114d0: 6f72 6469 6e67 5f6d 6f64 6528 7365 6c66  ording_mode(self
+000114e0: 2c20 6d6f 6465 3a20 5265 636f 7264 696e  , mode: Recordin
+000114f0: 674d 6f64 6529 202d 3e20 4e6f 6e65 3a0a  gMode) -> None:.
+00011500: 2020 2020 2020 2020 2222 2253 6574 7320          """Sets 
+00011510: 7265 636f 7264 696e 6720 6d6f 6465 206f  recording mode o
+00011520: 6e20 6361 6d65 7261 2222 220a 0a20 2020  n camera"""..   
+00011530: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
+00011540: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
+00011550: 2020 2020 2020 2020 2073 656c 662e 7573           self.us
+00011560: 655f 676c 6f62 616c 203d 2046 616c 7365  e_global = False
+00011570: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011580: 662e 7265 636f 7264 696e 675f 7365 7474  f.recording_sett
+00011590: 696e 6773 2e6d 6f64 6520 3d20 6d6f 6465  ings.mode = mode
+000115a0: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+000115b0: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+000115c0: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+000115d0: 2061 7379 6e63 2064 6566 2073 6574 5f69   async def set_i
+000115e0: 725f 6c65 645f 6d6f 6465 6c28 7365 6c66  r_led_model(self
+000115f0: 2c20 6d6f 6465 3a20 4952 4c45 444d 6f64  , mode: IRLEDMod
+00011600: 6529 202d 3e20 4e6f 6e65 3a0a 2020 2020  e) -> None:.    
+00011610: 2020 2020 2222 2253 6574 7320 4952 204c      """Sets IR L
+00011620: 4544 206d 6f64 6520 6f6e 2063 616d 6572  ED mode on camer
+00011630: 6122 2222 0a0a 2020 2020 2020 2020 6966  a"""..        if
+00011640: 206e 6f74 2073 656c 662e 6665 6174 7572   not self.featur
+00011650: 655f 666c 6167 732e 6861 735f 6c65 645f  e_flags.has_led_
+00011660: 6972 3a0a 2020 2020 2020 2020 2020 2020  ir:.            
+00011670: 7261 6973 6520 4261 6452 6571 7565 7374  raise BadRequest
+00011680: 2822 4361 6d65 7261 2064 6f65 7320 6e6f  ("Camera does no
+00011690: 7420 6861 7665 2061 6e20 4c45 4420 4952  t have an LED IR
+000116a0: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
+000116b0: 6361 6c6c 6261 636b 2829 202d 3e20 4e6f  callback() -> No
+000116c0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000116d0: 7365 6c66 2e69 7370 5f73 6574 7469 6e67  self.isp_setting
+000116e0: 732e 6972 5f6c 6564 5f6d 6f64 6520 3d20  s.ir_led_mode = 
+000116f0: 6d6f 6465 0a0a 2020 2020 2020 2020 6177  mode..        aw
+00011700: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
+00011710: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
+00011720: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
+00011730: 6574 5f69 6372 5f63 7573 746f 6d5f 6c75  et_icr_custom_lu
+00011740: 7828 7365 6c66 2c20 7661 6c75 653a 2049  x(self, value: I
+00011750: 4352 4c75 7856 616c 7565 2920 2d3e 204e  CRLuxValue) -> N
+00011760: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+00011770: 5365 7420 4943 5243 7573 746f 6d56 616c  Set ICRCustomVal
+00011780: 7565 2066 726f 6d20 6c75 7820 7661 6c75  ue from lux valu
+00011790: 652e 2222 220a 0a20 2020 2020 2020 2069  e."""..        i
+000117a0: 6620 6e6f 7420 7365 6c66 2e66 6561 7475  f not self.featu
+000117b0: 7265 5f66 6c61 6773 2e68 6173 5f6c 6564  re_flags.has_led
+000117c0: 5f69 723a 0a20 2020 2020 2020 2020 2020  _ir:.           
+000117d0: 2072 6169 7365 2042 6164 5265 7175 6573   raise BadReques
+000117e0: 7428 2243 616d 6572 6120 646f 6573 206e  t("Camera does n
+000117f0: 6f74 2068 6176 6520 616e 204c 4544 2049  ot have an LED I
+00011800: 5222 290a 0a20 2020 2020 2020 2069 6372  R")..        icr
+00011810: 5f76 616c 7565 203d 2030 0a20 2020 2020  _value = 0.     
+00011820: 2020 2066 6f72 2069 6e64 6578 2c20 7468     for index, th
+00011830: 7265 7368 6f6c 6420 696e 2065 6e75 6d65  reshold in enume
+00011840: 7261 7465 284c 5558 5f4d 4150 5049 4e47  rate(LUX_MAPPING
+00011850: 5f56 414c 5545 5329 3a0a 2020 2020 2020  _VALUES):.      
+00011860: 2020 2020 2020 6966 2076 616c 7565 203e        if value >
+00011870: 3d20 7468 7265 7368 6f6c 643a 0a20 2020  = threshold:.   
+00011880: 2020 2020 2020 2020 2020 2020 2069 6372               icr
+00011890: 5f76 616c 7565 203d 2031 3020 2d20 696e  _value = 10 - in
+000118a0: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
+000118b0: 2020 2020 6272 6561 6b0a 0a20 2020 2020      break..     
+000118c0: 2020 2064 6566 2063 616c 6c62 6163 6b28     def callback(
+000118d0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000118e0: 2020 2020 2020 2073 656c 662e 6973 705f         self.isp_
+000118f0: 7365 7474 696e 6773 2e69 6372 5f63 7573  settings.icr_cus
+00011900: 746f 6d5f 7661 6c75 6520 3d20 6361 7374  tom_value = cast
+00011910: 2849 4352 4375 7374 6f6d 5661 6c75 652c  (ICRCustomValue,
+00011920: 2069 6372 5f76 616c 7565 290a 0a20 2020   icr_value)..   
+00011930: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
+00011940: 7175 6575 655f 7570 6461 7465 2863 616c  queue_update(cal
+00011950: 6c62 6163 6b29 0a0a 2020 2020 4070 726f  lback)..    @pro
+00011960: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
+00011970: 5f69 725f 6c65 645f 736c 6964 6572 5f65  _ir_led_slider_e
+00011980: 6e61 626c 6564 2873 656c 6629 202d 3e20  nabled(self) -> 
+00011990: 626f 6f6c 3a0a 2020 2020 2020 2020 2222  bool:.        ""
+000119a0: 2252 6574 7572 6e20 6966 2049 5220 4c45  "Return if IR LE
+000119b0: 4420 6375 7374 6f6d 2073 6c69 6465 7220  D custom slider 
+000119c0: 6973 2065 6e61 626c 6564 2e22 2222 0a0a  is enabled."""..
+000119d0: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+000119e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000119f0: 662e 6665 6174 7572 655f 666c 6167 732e  f.feature_flags.
+00011a00: 6861 735f 6c65 645f 6972 0a20 2020 2020  has_led_ir.     
+00011a10: 2020 2020 2020 2061 6e64 2073 656c 662e         and self.
+00011a20: 6973 705f 7365 7474 696e 6773 2e69 725f  isp_settings.ir_
+00011a30: 6c65 645f 6d6f 6465 203d 3d20 4952 4c45  led_mode == IRLE
+00011a40: 444d 6f64 652e 4355 5354 4f4d 0a20 2020  DMode.CUSTOM.   
+00011a50: 2020 2020 2029 0a0a 2020 2020 6173 796e       )..    asyn
+00011a60: 6320 6465 6620 7365 745f 7374 6174 7573  c def set_status
+00011a70: 5f6c 6967 6874 2873 656c 662c 2065 6e61  _light(self, ena
+00011a80: 626c 6564 3a20 626f 6f6c 2920 2d3e 204e  bled: bool) -> N
+00011a90: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+00011aa0: 5365 7473 2073 7461 7475 7320 696e 6469  Sets status indi
+00011ab0: 6369 6361 746f 7220 6c69 6768 7420 6f6e  cicator light on
+00011ac0: 2063 616d 6572 6122 2222 0a0a 2020 2020   camera"""..    
+00011ad0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00011ae0: 6665 6174 7572 655f 666c 6167 732e 6861  feature_flags.ha
+00011af0: 735f 6c65 645f 7374 6174 7573 3a0a 2020  s_led_status:.  
+00011b00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00011b10: 4261 6452 6571 7565 7374 2822 4361 6d65  BadRequest("Came
+00011b20: 7261 2064 6f65 7320 6e6f 7420 6861 7665  ra does not have
+00011b30: 2073 7461 7475 7320 6c69 6768 7422 290a   status light").
+00011b40: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
+00011b50: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
+00011b60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011b70: 662e 6c65 645f 7365 7474 696e 6773 2e69  f.led_settings.i
+00011b80: 735f 656e 6162 6c65 6420 3d20 656e 6162  s_enabled = enab
+00011b90: 6c65 640a 2020 2020 2020 2020 2020 2020  led.            
+00011ba0: 7365 6c66 2e6c 6564 5f73 6574 7469 6e67  self.led_setting
+00011bb0: 732e 626c 696e 6b5f 7261 7465 203d 2030  s.blink_rate = 0
+00011bc0: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+00011bd0: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+00011be0: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+00011bf0: 2061 7379 6e63 2064 6566 2073 6574 5f68   async def set_h
+00011c00: 6472 2873 656c 662c 2065 6e61 626c 6564  dr(self, enabled
+00011c10: 3a20 626f 6f6c 2920 2d3e 204e 6f6e 653a  : bool) -> None:
+00011c20: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
+00011c30: 2048 4452 2028 4869 6768 2044 796e 616d   HDR (High Dynam
+00011c40: 6963 2052 616e 6765 2920 6f6e 2063 616d  ic Range) on cam
+00011c50: 6572 6122 2222 0a0a 2020 2020 2020 2020  era"""..        
+00011c60: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+00011c70: 2020 2020 2020 2020 2020 2022 7365 745f             "set_
+00011c80: 6864 7220 6973 2064 6570 7265 6361 7465  hdr is deprecate
+00011c90: 6420 616e 6420 7265 706c 6163 6564 2077  d and replaced w
+00011ca0: 6974 6820 7365 745f 6864 725f 6d6f 6465  ith set_hdr_mode
+00011cb0: 2066 6f72 2076 6572 7369 6f6e 7320 6f66   for versions of
+00011cc0: 2055 6e69 4669 2050 726f 7465 6374 2076   UniFi Protect v
+00011cd0: 332e 302b 222c 0a20 2020 2020 2020 2020  3.0+",.         
+00011ce0: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
+00011cf0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
+00011d00: 2020 2073 7461 636b 6c65 7665 6c3d 322c     stacklevel=2,
+00011d10: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00011d20: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00011d30: 6665 6174 7572 655f 666c 6167 732e 6861  feature_flags.ha
+00011d40: 735f 6864 723a 0a20 2020 2020 2020 2020  s_hdr:.         
+00011d50: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
+00011d60: 6573 7428 2243 616d 6572 6120 646f 6573  est("Camera does
+00011d70: 206e 6f74 2068 6176 6520 4844 5222 290a   not have HDR").
+00011d80: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
+00011d90: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
+00011da0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011db0: 662e 6864 725f 6d6f 6465 203d 2065 6e61  f.hdr_mode = ena
+00011dc0: 626c 6564 0a0a 2020 2020 2020 2020 6177  bled..        aw
+00011dd0: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
+00011de0: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
+00011df0: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
+00011e00: 6574 5f68 6472 5f6d 6f64 6528 7365 6c66  et_hdr_mode(self
+00011e10: 2c20 6d6f 6465 3a20 4c69 7465 7261 6c5b  , mode: Literal[
+00011e20: 2261 7574 6f22 2c20 226f 6666 222c 2022  "auto", "off", "
+00011e30: 616c 7761 7973 225d 2920 2d3e 204e 6f6e  always"]) -> Non
+00011e40: 653a 0a20 2020 2020 2020 2022 2222 5365  e:.        """Se
+00011e50: 7473 2048 4452 206d 6f64 6520 7369 6d69  ts HDR mode simi
+00011e60: 6c61 7220 746f 2068 6f77 2050 726f 7465  lar to how Prote
+00011e70: 6374 2069 6e74 6572 6661 6365 2077 6f72  ct interface wor
+00011e80: 6b73 2e22 2222 0a0a 2020 2020 2020 2020  ks."""..        
+00011e90: 6966 206e 6f74 2073 656c 662e 6665 6174  if not self.feat
+00011ea0: 7572 655f 666c 6167 732e 6861 735f 6864  ure_flags.has_hd
+00011eb0: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+00011ec0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
+00011ed0: 2243 616d 6572 6120 646f 6573 206e 6f74  "Camera does not
+00011ee0: 2068 6176 6520 4844 5222 290a 0a20 2020   have HDR")..   
+00011ef0: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
+00011f00: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
+00011f10: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00011f20: 203d 3d20 226f 6666 223a 0a20 2020 2020   == "off":.     
+00011f30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011f40: 6864 725f 6d6f 6465 203d 2046 616c 7365  hdr_mode = False
+00011f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011f60: 2069 6620 7365 6c66 2e69 7370 5f73 6574   if self.isp_set
+00011f70: 7469 6e67 732e 6864 725f 6d6f 6465 2069  tings.hdr_mode i
+00011f80: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00011f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011fa0: 7365 6c66 2e69 7370 5f73 6574 7469 6e67  self.isp_setting
+00011fb0: 732e 6864 725f 6d6f 6465 203d 2048 4452  s.hdr_mode = HDR
+00011fc0: 4d6f 6465 2e4e 4f52 4d41 4c0a 2020 2020  Mode.NORMAL.    
+00011fd0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00011fe0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00011ff0: 6c66 2e68 6472 5f6d 6f64 6520 3d20 5472  lf.hdr_mode = Tr
+00012000: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+00012010: 2020 2069 6620 7365 6c66 2e69 7370 5f73     if self.isp_s
+00012020: 6574 7469 6e67 732e 6864 725f 6d6f 6465  ettings.hdr_mode
+00012030: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00012040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012050: 2020 7365 6c66 2e69 7370 5f73 6574 7469    self.isp_setti
+00012060: 6e67 732e 6864 725f 6d6f 6465 203d 2028  ngs.hdr_mode = (
+00012070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012080: 2020 2020 2020 2020 2048 4452 4d6f 6465           HDRMode
+00012090: 2e4e 4f52 4d41 4c20 6966 206d 6f64 6520  .NORMAL if mode 
+000120a0: 3d3d 2022 6175 746f 2220 656c 7365 2048  == "auto" else H
+000120b0: 4452 4d6f 6465 2e41 4c57 4159 535f 4f4e  DRMode.ALWAYS_ON
+000120c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000120d0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000120e0: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
+000120f0: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
+00012100: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
+00012110: 2073 6574 5f63 6f6c 6f72 5f6e 6967 6874   set_color_night
+00012120: 5f76 6973 696f 6e28 7365 6c66 2c20 656e  _vision(self, en
+00012130: 6162 6c65 643a 2062 6f6f 6c29 202d 3e20  abled: bool) -> 
+00012140: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00012150: 2253 6574 7320 436f 6c6f 7220 4e69 6768  "Sets Color Nigh
+00012160: 7420 5669 7369 6f6e 206f 6e20 6361 6d65  t Vision on came
+00012170: 7261 2222 220a 0a20 2020 2020 2020 2069  ra"""..        i
+00012180: 6620 6e6f 7420 7365 6c66 2e68 6173 5f63  f not self.has_c
+00012190: 6f6c 6f72 5f6e 6967 6874 5f76 6973 696f  olor_night_visio
+000121a0: 6e3a 0a20 2020 2020 2020 2020 2020 2072  n:.            r
+000121b0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
+000121c0: 2243 616d 6572 6120 646f 6573 206e 6f74  "Camera does not
+000121d0: 2068 6176 6520 436f 6c6f 7220 4e69 6768   have Color Nigh
+000121e0: 7420 5669 7369 6f6e 2229 0a0a 2020 2020  t Vision")..    
+000121f0: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
+00012200: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
+00012210: 2020 2020 2020 2020 7365 6c66 2e69 7370          self.isp
+00012220: 5f73 6574 7469 6e67 732e 6973 5f63 6f6c  _settings.is_col
+00012230: 6f72 5f6e 6967 6874 5f76 6973 696f 6e5f  or_night_vision_
+00012240: 656e 6162 6c65 6420 3d20 656e 6162 6c65  enabled = enable
+00012250: 640a 0a20 2020 2020 2020 2061 7761 6974  d..        await
+00012260: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
+00012270: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
+00012280: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
+00012290: 7669 6465 6f5f 6d6f 6465 2873 656c 662c  video_mode(self,
+000122a0: 206d 6f64 653a 2056 6964 656f 4d6f 6465   mode: VideoMode
+000122b0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000122c0: 2020 2022 2222 5365 7473 2076 6964 656f     """Sets video
+000122d0: 206d 6f64 6520 6f6e 2063 616d 6572 6122   mode on camera"
+000122e0: 2222 0a0a 2020 2020 2020 2020 6966 206d  ""..        if m
+000122f0: 6f64 6520 6e6f 7420 696e 2073 656c 662e  ode not in self.
+00012300: 6665 6174 7572 655f 666c 6167 732e 7669  feature_flags.vi
+00012310: 6465 6f5f 6d6f 6465 733a 0a20 2020 2020  deo_modes:.     
+00012320: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
+00012330: 5265 7175 6573 7428 6622 4361 6d65 7261  Request(f"Camera
+00012340: 2064 6f65 7320 6e6f 7420 6861 7665 207b   does not have {
+00012350: 6d6f 6465 7d22 290a 0a20 2020 2020 2020  mode}")..       
+00012360: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+00012370: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00012380: 2020 2020 2073 656c 662e 7669 6465 6f5f       self.video_
+00012390: 6d6f 6465 203d 206d 6f64 650a 0a20 2020  mode = mode..   
+000123a0: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
+000123b0: 7175 6575 655f 7570 6461 7465 2863 616c  queue_update(cal
+000123c0: 6c62 6163 6b29 0a0a 2020 2020 6173 796e  lback)..    asyn
+000123d0: 6320 6465 6620 7365 745f 6361 6d65 7261  c def set_camera
+000123e0: 5f7a 6f6f 6d28 7365 6c66 2c20 6c65 7665  _zoom(self, leve
+000123f0: 6c3a 2069 6e74 2920 2d3e 204e 6f6e 653a  l: int) -> None:
+00012400: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
+00012410: 207a 6f6f 6d20 6c65 7665 6c20 666f 7220   zoom level for 
+00012420: 6361 6d65 7261 2222 220a 0a20 2020 2020  camera"""..     
+00012430: 2020 2069 6620 6e6f 7420 7365 6c66 2e66     if not self.f
+00012440: 6561 7475 7265 5f66 6c61 6773 2e63 616e  eature_flags.can
+00012450: 5f6f 7074 6963 616c 5f7a 6f6f 6d3a 0a20  _optical_zoom:. 
+00012460: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00012470: 2042 6164 5265 7175 6573 7428 2243 616d   BadRequest("Cam
+00012480: 6572 6120 6361 6e6e 6f74 206f 7074 6963  era cannot optic
+00012490: 616c 207a 6f6f 6d22 290a 0a20 2020 2020  al zoom")..     
+000124a0: 2020 2064 6566 2063 616c 6c62 6163 6b28     def callback(
+000124b0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000124c0: 2020 2020 2020 2073 656c 662e 6973 705f         self.isp_
+000124d0: 7365 7474 696e 6773 2e7a 6f6f 6d5f 706f  settings.zoom_po
+000124e0: 7369 7469 6f6e 203d 2050 6572 6365 6e74  sition = Percent
+000124f0: 496e 7428 6c65 7665 6c29 0a0a 2020 2020  Int(level)..    
+00012500: 2020 2020 6177 6169 7420 7365 6c66 2e71      await self.q
+00012510: 7565 7565 5f75 7064 6174 6528 6361 6c6c  ueue_update(call
+00012520: 6261 636b 290a 0a20 2020 2061 7379 6e63  back)..    async
+00012530: 2064 6566 2073 6574 5f77 6472 5f6c 6576   def set_wdr_lev
+00012540: 656c 2873 656c 662c 206c 6576 656c 3a20  el(self, level: 
+00012550: 696e 7429 202d 3e20 4e6f 6e65 3a0a 2020  int) -> None:.  
+00012560: 2020 2020 2020 2222 2253 6574 7320 5744        """Sets WD
+00012570: 5220 2857 6964 6520 4479 6e61 6d69 6320  R (Wide Dynamic 
+00012580: 5261 6e67 6529 206f 6e20 6361 6d65 7261  Range) on camera
+00012590: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
+000125a0: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
+000125b0: 6773 2e68 6173 5f68 6472 3a0a 2020 2020  gs.has_hdr:.    
+000125c0: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
+000125d0: 6452 6571 7565 7374 2822 4361 6e6e 6f74  dRequest("Cannot
+000125e0: 2073 6574 2057 4452 206f 6e20 6361 6d65   set WDR on came
+000125f0: 7261 7320 7769 7468 2048 4452 2229 0a0a  ras with HDR")..
+00012600: 2020 2020 2020 2020 6465 6620 6361 6c6c          def call
+00012610: 6261 636b 2829 202d 3e20 4e6f 6e65 3a0a  back() -> None:.
+00012620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012630: 2e69 7370 5f73 6574 7469 6e67 732e 7764  .isp_settings.wd
+00012640: 7220 3d20 5744 524c 6576 656c 286c 6576  r = WDRLevel(lev
+00012650: 656c 290a 0a20 2020 2020 2020 2061 7761  el)..        awa
+00012660: 6974 2073 656c 662e 7175 6575 655f 7570  it self.queue_up
+00012670: 6461 7465 2863 616c 6c62 6163 6b29 0a0a  date(callback)..
+00012680: 2020 2020 6173 796e 6320 6465 6620 7365      async def se
+00012690: 745f 6d69 635f 766f 6c75 6d65 2873 656c  t_mic_volume(sel
+000126a0: 662c 206c 6576 656c 3a20 696e 7429 202d  f, level: int) -
+000126b0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000126c0: 2222 2253 6574 7320 7468 6520 6d69 6320  """Sets the mic 
+000126d0: 7365 6e73 6974 6976 6974 7920 6c65 7665  sensitivity leve
+000126e0: 6c20 6f6e 2063 616d 6572 6122 2222 0a0a  l on camera"""..
+000126f0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00012700: 656c 662e 6665 6174 7572 655f 666c 6167  elf.feature_flag
+00012710: 732e 6861 735f 6d69 633a 0a20 2020 2020  s.has_mic:.     
+00012720: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
+00012730: 5265 7175 6573 7428 2243 616d 6572 6120  Request("Camera 
+00012740: 646f 6573 206e 6f74 2068 6176 6520 6d69  does not have mi
+00012750: 6322 290a 0a20 2020 2020 2020 2064 6566  c")..        def
+00012760: 2063 616c 6c62 6163 6b28 2920 2d3e 204e   callback() -> N
+00012770: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00012780: 2073 656c 662e 6d69 635f 766f 6c75 6d65   self.mic_volume
+00012790: 203d 2050 6572 6365 6e74 496e 7428 6c65   = PercentInt(le
+000127a0: 7665 6c29 0a0a 2020 2020 2020 2020 6177  vel)..        aw
+000127b0: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
+000127c0: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
+000127d0: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
+000127e0: 6574 5f73 7065 616b 6572 5f76 6f6c 756d  et_speaker_volum
+000127f0: 6528 7365 6c66 2c20 6c65 7665 6c3a 2069  e(self, level: i
+00012800: 6e74 2920 2d3e 204e 6f6e 653a 0a20 2020  nt) -> None:.   
+00012810: 2020 2020 2022 2222 5365 7473 2074 6865       """Sets the
+00012820: 2073 7065 616b 6572 2073 656e 7369 7469   speaker sensiti
+00012830: 7669 7479 206c 6576 656c 206f 6e20 6361  vity level on ca
+00012840: 6d65 7261 2e20 5265 7175 6972 6573 2063  mera. Requires c
+00012850: 616d 6572 6120 746f 2068 6176 6520 7370  amera to have sp
+00012860: 6561 6b65 7273 2222 220a 0a20 2020 2020  eakers"""..     
+00012870: 2020 2069 6620 6e6f 7420 7365 6c66 2e66     if not self.f
+00012880: 6561 7475 7265 5f66 6c61 6773 2e68 6173  eature_flags.has
+00012890: 5f73 7065 616b 6572 3a0a 2020 2020 2020  _speaker:.      
+000128a0: 2020 2020 2020 7261 6973 6520 4261 6452        raise BadR
+000128b0: 6571 7565 7374 2822 4361 6d65 7261 2064  equest("Camera d
+000128c0: 6f65 7320 6e6f 7420 6861 7665 2073 7065  oes not have spe
+000128d0: 616b 6572 2229 0a0a 2020 2020 2020 2020  aker")..        
+000128e0: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
+000128f0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00012900: 2020 2020 7365 6c66 2e73 7065 616b 6572      self.speaker
+00012910: 5f73 6574 7469 6e67 732e 766f 6c75 6d65  _settings.volume
+00012920: 203d 2050 6572 6365 6e74 496e 7428 6c65   = PercentInt(le
+00012930: 7665 6c29 0a0a 2020 2020 2020 2020 6177  vel)..        aw
+00012940: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
+00012950: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
+00012960: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
+00012970: 6574 5f73 7973 7465 6d5f 736f 756e 6473  et_system_sounds
+00012980: 2873 656c 662c 2065 6e61 626c 6564 3a20  (self, enabled: 
+00012990: 626f 6f6c 2920 2d3e 204e 6f6e 653a 0a20  bool) -> None:. 
+000129a0: 2020 2020 2020 2022 2222 5365 7473 2073         """Sets s
+000129b0: 7973 7465 6d20 736f 756e 6420 706c 6179  ystem sound play
+000129c0: 6261 636b 2074 6872 6f75 6768 2073 7065  back through spe
+000129d0: 616b 6572 732e 2052 6571 7569 7265 7320  akers. Requires 
+000129e0: 6361 6d65 7261 2074 6f20 6861 7665 2073  camera to have s
+000129f0: 7065 616b 6572 7322 2222 0a0a 2020 2020  peakers"""..    
+00012a00: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00012a10: 6665 6174 7572 655f 666c 6167 732e 6861  feature_flags.ha
+00012a20: 735f 7370 6561 6b65 723a 0a20 2020 2020  s_speaker:.     
+00012a30: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
+00012a40: 5265 7175 6573 7428 2243 616d 6572 6120  Request("Camera 
+00012a50: 646f 6573 206e 6f74 2068 6176 6520 7370  does not have sp
+00012a60: 6561 6b65 7222 290a 0a20 2020 2020 2020  eaker")..       
+00012a70: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+00012a80: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00012a90: 2020 2020 2073 656c 662e 7370 6561 6b65       self.speake
+00012aa0: 725f 7365 7474 696e 6773 2e61 7265 5f73  r_settings.are_s
+00012ab0: 7973 7465 6d5f 736f 756e 6473 5f65 6e61  ystem_sounds_ena
+00012ac0: 626c 6564 203d 2065 6e61 626c 6564 0a0a  bled = enabled..
+00012ad0: 2020 2020 2020 2020 6177 6169 7420 7365          await se
+00012ae0: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
+00012af0: 6361 6c6c 6261 636b 290a 0a20 2020 2061  callback)..    a
+00012b00: 7379 6e63 2064 6566 2073 6574 5f6f 7364  sync def set_osd
+00012b10: 5f6e 616d 6528 7365 6c66 2c20 656e 6162  _name(self, enab
+00012b20: 6c65 643a 2062 6f6f 6c29 202d 3e20 4e6f  led: bool) -> No
+00012b30: 6e65 3a0a 2020 2020 2020 2020 2222 2253  ne:.        """S
+00012b40: 6574 7320 7768 6574 6865 7220 6361 6d65  ets whether came
+00012b50: 7261 206e 616d 6520 6973 2069 6e20 7468  ra name is in th
+00012b60: 6520 4f6e 2053 6372 6565 6e20 4469 7370  e On Screen Disp
+00012b70: 6c61 7922 2222 0a0a 2020 2020 2020 2020  lay"""..        
+00012b80: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
+00012b90: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00012ba0: 2020 2020 7365 6c66 2e75 7365 5f67 6c6f      self.use_glo
+00012bb0: 6261 6c20 3d20 4661 6c73 650a 2020 2020  bal = False.    
+00012bc0: 2020 2020 2020 2020 7365 6c66 2e6f 7364          self.osd
+00012bd0: 5f73 6574 7469 6e67 732e 6973 5f6e 616d  _settings.is_nam
+00012be0: 655f 656e 6162 6c65 6420 3d20 656e 6162  e_enabled = enab
+00012bf0: 6c65 640a 0a20 2020 2020 2020 2061 7761  led..        awa
+00012c00: 6974 2073 656c 662e 7175 6575 655f 7570  it self.queue_up
+00012c10: 6461 7465 2863 616c 6c62 6163 6b29 0a0a  date(callback)..
+00012c20: 2020 2020 6173 796e 6320 6465 6620 7365      async def se
+00012c30: 745f 6f73 645f 6461 7465 2873 656c 662c  t_osd_date(self,
+00012c40: 2065 6e61 626c 6564 3a20 626f 6f6c 2920   enabled: bool) 
+00012c50: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00012c60: 2022 2222 5365 7473 2077 6865 7468 6572   """Sets whether
+00012c70: 2063 7572 7265 6e74 2064 6174 6520 6973   current date is
+00012c80: 2069 6e20 7468 6520 4f6e 2053 6372 6565   in the On Scree
+00012c90: 6e20 4469 7370 6c61 7922 2222 0a0a 2020  n Display"""..  
+00012ca0: 2020 2020 2020 6465 6620 6361 6c6c 6261        def callba
+00012cb0: 636b 2829 202d 3e20 4e6f 6e65 3a0a 2020  ck() -> None:.  
+00012cc0: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
+00012cd0: 7365 5f67 6c6f 6261 6c20 3d20 4661 6c73  se_global = Fals
+00012ce0: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
+00012cf0: 6c66 2e6f 7364 5f73 6574 7469 6e67 732e  lf.osd_settings.
+00012d00: 6973 5f64 6174 655f 656e 6162 6c65 6420  is_date_enabled 
+00012d10: 3d20 656e 6162 6c65 640a 0a20 2020 2020  = enabled..     
+00012d20: 2020 2061 7761 6974 2073 656c 662e 7175     await self.qu
+00012d30: 6575 655f 7570 6461 7465 2863 616c 6c62  eue_update(callb
+00012d40: 6163 6b29 0a0a 2020 2020 6173 796e 6320  ack)..    async 
+00012d50: 6465 6620 7365 745f 6f73 645f 6c6f 676f  def set_osd_logo
+00012d60: 2873 656c 662c 2065 6e61 626c 6564 3a20  (self, enabled: 
+00012d70: 626f 6f6c 2920 2d3e 204e 6f6e 653a 0a20  bool) -> None:. 
+00012d80: 2020 2020 2020 2022 2222 5365 7473 2077         """Sets w
+00012d90: 6865 7468 6572 2074 6865 2055 6e69 4669  hether the UniFi
+00012da0: 206c 6f67 6f20 6973 2069 6e20 7468 6520   logo is in the 
+00012db0: 4f6e 2053 6372 6565 6e20 4469 7370 6c61  On Screen Displa
+00012dc0: 7922 2222 0a0a 2020 2020 2020 2020 6465  y"""..        de
+00012dd0: 6620 6361 6c6c 6261 636b 2829 202d 3e20  f callback() -> 
+00012de0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00012df0: 2020 7365 6c66 2e75 7365 5f67 6c6f 6261    self.use_globa
+00012e00: 6c20 3d20 4661 6c73 650a 2020 2020 2020  l = False.      
+00012e10: 2020 2020 2020 7365 6c66 2e6f 7364 5f73        self.osd_s
+00012e20: 6574 7469 6e67 732e 6973 5f6c 6f67 6f5f  ettings.is_logo_
+00012e30: 656e 6162 6c65 6420 3d20 656e 6162 6c65  enabled = enable
+00012e40: 640a 0a20 2020 2020 2020 2061 7761 6974  d..        await
+00012e50: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
+00012e60: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
+00012e70: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
+00012e80: 6f73 645f 6269 7472 6174 6528 7365 6c66  osd_bitrate(self
+00012e90: 2c20 656e 6162 6c65 643a 2062 6f6f 6c29  , enabled: bool)
+00012ea0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00012eb0: 2020 2222 2253 6574 7320 7768 6574 6865    """Sets whethe
+00012ec0: 7220 6361 6d65 7261 2062 6974 7261 7465  r camera bitrate
+00012ed0: 2069 7320 696e 2074 6865 204f 6e20 5363   is in the On Sc
+00012ee0: 7265 656e 2044 6973 706c 6179 2222 220a  reen Display""".
+00012ef0: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
+00012f00: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
+00012f10: 0a20 2020 2020 2020 2020 2020 2023 206d  .            # m
+00012f20: 6973 6d61 7463 6820 6265 7477 6565 6e20  ismatch between 
+00012f30: 5549 2069 6e74 6572 6e61 6c20 6461 7461  UI internal data
+00012f40: 2073 7472 7563 7475 7265 2064 6562 7567   structure debug
+00012f50: 203d 2062 6974 7261 7465 2064 6174 610a   = bitrate data.
+00012f60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012f70: 2e75 7365 5f67 6c6f 6261 6c20 3d20 4661  .use_global = Fa
+00012f80: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00012f90: 7365 6c66 2e6f 7364 5f73 6574 7469 6e67  self.osd_setting
+00012fa0: 732e 6973 5f64 6562 7567 5f65 6e61 626c  s.is_debug_enabl
+00012fb0: 6564 203d 2065 6e61 626c 6564 0a0a 2020  ed = enabled..  
+00012fc0: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+00012fd0: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
+00012fe0: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
+00012ff0: 6e63 2064 6566 2073 6574 5f73 6d61 7274  nc def set_smart
+00013000: 5f64 6574 6563 745f 7479 7065 7328 7365  _detect_types(se
+00013010: 6c66 2c20 7479 7065 733a 206c 6973 745b  lf, types: list[
+00013020: 536d 6172 7444 6574 6563 744f 626a 6563  SmartDetectObjec
+00013030: 7454 7970 655d 2920 2d3e 204e 6f6e 653a  tType]) -> None:
+00013040: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
+00013050: 2063 7572 7265 6e74 2065 6e61 626c 6564   current enabled
+00013060: 2073 6d61 7274 2064 6574 6563 7469 6f6e   smart detection
+00013070: 2074 7970 6573 2e20 5265 7175 6972 6573   types. Requires
+00013080: 2063 616d 6572 6120 746f 2068 6176 6520   camera to have 
+00013090: 736d 6172 7420 6465 7465 6374 696f 6e22  smart detection"
+000130a0: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
+000130b0: 6f74 2073 656c 662e 6665 6174 7572 655f  ot self.feature_
+000130c0: 666c 6167 732e 6861 735f 736d 6172 745f  flags.has_smart_
+000130d0: 6465 7465 6374 3a0a 2020 2020 2020 2020  detect:.        
+000130e0: 2020 2020 7261 6973 6520 4261 6452 6571      raise BadReq
+000130f0: 7565 7374 2822 4361 6d65 7261 2064 6f65  uest("Camera doe
+00013100: 7320 6e6f 7420 6861 7665 2061 2073 6d61  s not have a sma
+00013110: 7274 2064 6574 6563 7469 6f6e 7322 290a  rt detections").
+00013120: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
+00013130: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
+00013140: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00013150: 662e 7573 655f 676c 6f62 616c 203d 2046  f.use_global = F
+00013160: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00013170: 2073 656c 662e 736d 6172 745f 6465 7465   self.smart_dete
+00013180: 6374 5f73 6574 7469 6e67 732e 6f62 6a65  ct_settings.obje
+00013190: 6374 5f74 7970 6573 203d 2074 7970 6573  ct_types = types
+000131a0: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+000131b0: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+000131c0: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+000131d0: 2061 7379 6e63 2064 6566 2073 6574 5f73   async def set_s
+000131e0: 6d61 7274 5f61 7564 696f 5f64 6574 6563  mart_audio_detec
+000131f0: 745f 7479 7065 7328 0a20 2020 2020 2020  t_types(.       
+00013200: 2073 656c 662c 0a20 2020 2020 2020 2074   self,.        t
+00013210: 7970 6573 3a20 6c69 7374 5b53 6d61 7274  ypes: list[Smart
+00013220: 4465 7465 6374 4175 6469 6f54 7970 655d  DetectAudioType]
+00013230: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+00013240: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
+00013250: 2063 7572 7265 6e74 2065 6e61 626c 6564   current enabled
+00013260: 2073 6d61 7274 2061 7564 696f 2064 6574   smart audio det
+00013270: 6563 7469 6f6e 2074 7970 6573 2e20 5265  ection types. Re
+00013280: 7175 6972 6573 2063 616d 6572 6120 746f  quires camera to
+00013290: 2068 6176 6520 736d 6172 7420 6465 7465   have smart dete
+000132a0: 6374 696f 6e22 2222 0a0a 2020 2020 2020  ction"""..      
+000132b0: 2020 6966 206e 6f74 2073 656c 662e 6665    if not self.fe
+000132c0: 6174 7572 655f 666c 6167 732e 6861 735f  ature_flags.has_
+000132d0: 736d 6172 745f 6465 7465 6374 3a0a 2020  smart_detect:.  
+000132e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000132f0: 4261 6452 6571 7565 7374 2822 4361 6d65  BadRequest("Came
+00013300: 7261 2064 6f65 7320 6e6f 7420 6861 7665  ra does not have
+00013310: 2061 2073 6d61 7274 2064 6574 6563 7469   a smart detecti
+00013320: 6f6e 7322 290a 0a20 2020 2020 2020 2064  ons")..        d
+00013330: 6566 2063 616c 6c62 6163 6b28 2920 2d3e  ef callback() ->
+00013340: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00013350: 2020 2073 656c 662e 7573 655f 676c 6f62     self.use_glob
+00013360: 616c 203d 2046 616c 7365 0a20 2020 2020  al = False.     
+00013370: 2020 2020 2020 2073 656c 662e 736d 6172         self.smar
+00013380: 745f 6465 7465 6374 5f73 6574 7469 6e67  t_detect_setting
+00013390: 732e 6175 6469 6f5f 7479 7065 7320 3d20  s.audio_types = 
+000133a0: 7479 7065 730a 0a20 2020 2020 2020 2061  types..        a
+000133b0: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
+000133c0: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
+000133d0: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
+000133e0: 5f73 6574 5f6f 626a 6563 745f 6465 7465  _set_object_dete
+000133f0: 6374 280a 2020 2020 2020 2020 7365 6c66  ct(.        self
+00013400: 2c0a 2020 2020 2020 2020 6f62 6a5f 746f  ,.        obj_to
+00013410: 5f6d 6f64 3a20 536d 6172 7444 6574 6563  _mod: SmartDetec
+00013420: 744f 626a 6563 7454 7970 652c 0a20 2020  tObjectType,.   
+00013430: 2020 2020 2065 6e61 626c 6564 3a20 626f       enabled: bo
+00013440: 6f6c 2c0a 2020 2020 2920 2d3e 204e 6f6e  ol,.    ) -> Non
+00013450: 653a 0a20 2020 2020 2020 2069 6620 6f62  e:.        if ob
+00013460: 6a5f 746f 5f6d 6f64 206e 6f74 2069 6e20  j_to_mod not in 
+00013470: 7365 6c66 2e66 6561 7475 7265 5f66 6c61  self.feature_fla
+00013480: 6773 2e73 6d61 7274 5f64 6574 6563 745f  gs.smart_detect_
+00013490: 7479 7065 733a 0a20 2020 2020 2020 2020  types:.         
+000134a0: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
+000134b0: 6573 7428 6622 4361 6d65 7261 2064 6f65  est(f"Camera doe
+000134c0: 7320 6e6f 7420 7375 7070 6f72 7420 7468  s not support th
+000134d0: 6520 7b6f 626a 5f74 6f5f 6d6f 647d 2064  e {obj_to_mod} d
+000134e0: 6574 6563 7469 6f6e 2074 7970 6522 290a  etection type").
+000134f0: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
+00013500: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
+00013510: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00013520: 662e 7573 655f 676c 6f62 616c 203d 2046  f.use_global = F
+00013530: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00013540: 206f 626a 6563 7473 203d 2073 656c 662e   objects = self.
+00013550: 736d 6172 745f 6465 7465 6374 5f73 6574  smart_detect_set
+00013560: 7469 6e67 732e 6f62 6a65 6374 5f74 7970  tings.object_typ
+00013570: 6573 0a20 2020 2020 2020 2020 2020 2069  es.            i
+00013580: 6620 656e 6162 6c65 643a 0a20 2020 2020  f enabled:.     
+00013590: 2020 2020 2020 2020 2020 2069 6620 6f62             if ob
+000135a0: 6a5f 746f 5f6d 6f64 206e 6f74 2069 6e20  j_to_mod not in 
+000135b0: 6f62 6a65 6374 733a 0a20 2020 2020 2020  objects:.       
+000135c0: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+000135d0: 6563 7473 203d 205b 2a6f 626a 6563 7473  ects = [*objects
+000135e0: 2c20 6f62 6a5f 746f 5f6d 6f64 5d0a 2020  , obj_to_mod].  
+000135f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013600: 2020 6f62 6a65 6374 732e 736f 7274 2829    objects.sort()
+00013610: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00013620: 6620 6f62 6a5f 746f 5f6d 6f64 2069 6e20  f obj_to_mod in 
+00013630: 6f62 6a65 6374 733a 0a20 2020 2020 2020  objects:.       
+00013640: 2020 2020 2020 2020 206f 626a 6563 7473           objects
+00013650: 2e72 656d 6f76 6528 6f62 6a5f 746f 5f6d  .remove(obj_to_m
+00013660: 6f64 290a 2020 2020 2020 2020 2020 2020  od).            
+00013670: 7365 6c66 2e73 6d61 7274 5f64 6574 6563  self.smart_detec
+00013680: 745f 7365 7474 696e 6773 2e6f 626a 6563  t_settings.objec
+00013690: 745f 7479 7065 7320 3d20 6f62 6a65 6374  t_types = object
+000136a0: 730a 0a20 2020 2020 2020 2061 7761 6974  s..        await
+000136b0: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
+000136c0: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
+000136d0: 2020 6173 796e 6320 6465 6620 5f73 6574    async def _set
+000136e0: 5f61 7564 696f 5f64 6574 6563 7428 0a20  _audio_detect(. 
+000136f0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00013700: 2020 2020 206f 626a 5f74 6f5f 6d6f 643a       obj_to_mod:
+00013710: 2053 6d61 7274 4465 7465 6374 4175 6469   SmartDetectAudi
+00013720: 6f54 7970 652c 0a20 2020 2020 2020 2065  oType,.        e
+00013730: 6e61 626c 6564 3a20 626f 6f6c 2c0a 2020  nabled: bool,.  
+00013740: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00013750: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+00013760: 2020 2020 2020 7365 6c66 2e66 6561 7475        self.featu
+00013770: 7265 5f66 6c61 6773 2e73 6d61 7274 5f64  re_flags.smart_d
+00013780: 6574 6563 745f 6175 6469 6f5f 7479 7065  etect_audio_type
+00013790: 7320 6973 204e 6f6e 650a 2020 2020 2020  s is None.      
+000137a0: 2020 2020 2020 6f72 206f 626a 5f74 6f5f        or obj_to_
+000137b0: 6d6f 6420 6e6f 7420 696e 2073 656c 662e  mod not in self.
+000137c0: 6665 6174 7572 655f 666c 6167 732e 736d  feature_flags.sm
+000137d0: 6172 745f 6465 7465 6374 5f61 7564 696f  art_detect_audio
+000137e0: 5f74 7970 6573 0a20 2020 2020 2020 2029  _types.        )
+000137f0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00013800: 6973 6520 4261 6452 6571 7565 7374 2866  ise BadRequest(f
+00013810: 2243 616d 6572 6120 646f 6573 206e 6f74  "Camera does not
+00013820: 2073 7570 706f 7274 2074 6865 207b 6f62   support the {ob
+00013830: 6a5f 746f 5f6d 6f64 7d20 6465 7465 6374  j_to_mod} detect
+00013840: 696f 6e20 7479 7065 2229 0a0a 2020 2020  ion type")..    
+00013850: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
+00013860: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
+00013870: 2020 2020 2020 2020 7365 6c66 2e75 7365          self.use
+00013880: 5f67 6c6f 6261 6c20 3d20 4661 6c73 650a  _global = False.
+00013890: 2020 2020 2020 2020 2020 2020 6f62 6a65              obje
+000138a0: 6374 7320 3d20 7365 6c66 2e73 6d61 7274  cts = self.smart
+000138b0: 5f64 6574 6563 745f 7365 7474 696e 6773  _detect_settings
+000138c0: 2e61 7564 696f 5f74 7970 6573 206f 7220  .audio_types or 
+000138d0: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
+000138e0: 6620 656e 6162 6c65 643a 0a20 2020 2020  f enabled:.     
+000138f0: 2020 2020 2020 2020 2020 2069 6620 6f62             if ob
+00013900: 6a5f 746f 5f6d 6f64 206e 6f74 2069 6e20  j_to_mod not in 
+00013910: 6f62 6a65 6374 733a 0a20 2020 2020 2020  objects:.       
+00013920: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+00013930: 6563 7473 203d 205b 2a6f 626a 6563 7473  ects = [*objects
+00013940: 2c20 6f62 6a5f 746f 5f6d 6f64 5d0a 2020  , obj_to_mod].  
+00013950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013960: 2020 6f62 6a65 6374 732e 736f 7274 2829    objects.sort()
+00013970: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00013980: 6620 6f62 6a5f 746f 5f6d 6f64 2069 6e20  f obj_to_mod in 
+00013990: 6f62 6a65 6374 733a 0a20 2020 2020 2020  objects:.       
+000139a0: 2020 2020 2020 2020 206f 626a 6563 7473           objects
+000139b0: 2e72 656d 6f76 6528 6f62 6a5f 746f 5f6d  .remove(obj_to_m
+000139c0: 6f64 290a 2020 2020 2020 2020 2020 2020  od).            
+000139d0: 7365 6c66 2e73 6d61 7274 5f64 6574 6563  self.smart_detec
+000139e0: 745f 7365 7474 696e 6773 2e61 7564 696f  t_settings.audio
+000139f0: 5f74 7970 6573 203d 206f 626a 6563 7473  _types = objects
+00013a00: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+00013a10: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+00013a20: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+00013a30: 2061 7379 6e63 2064 6566 2073 6574 5f70   async def set_p
+00013a40: 7269 7661 6379 280a 2020 2020 2020 2020  rivacy(.        
+00013a50: 7365 6c66 2c0a 2020 2020 2020 2020 656e  self,.        en
+00013a60: 6162 6c65 643a 2062 6f6f 6c2c 0a20 2020  abled: bool,.   
+00013a70: 2020 2020 206d 6963 5f6c 6576 656c 3a20       mic_level: 
+00013a80: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
+00013a90: 4e6f 6e65 2c0a 2020 2020 2020 2020 7265  None,.        re
+00013aa0: 636f 7264 696e 675f 6d6f 6465 3a20 4f70  cording_mode: Op
+00013ab0: 7469 6f6e 616c 5b52 6563 6f72 6469 6e67  tional[Recording
+00013ac0: 4d6f 6465 5d20 3d20 4e6f 6e65 2c0a 2020  Mode] = None,.  
+00013ad0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00013ae0: 2020 2020 2022 2222 4164 6473 2f72 656d       """Adds/rem
+00013af0: 6f76 6573 2061 2070 7269 7661 6379 207a  oves a privacy z
+00013b00: 6f6e 6520 7468 6174 2062 6c61 636b 7320  one that blacks 
+00013b10: 6f75 7420 7468 6520 7768 6f6c 6520 6361  out the whole ca
+00013b20: 6d65 7261 2e22 2222 0a0a 2020 2020 2020  mera."""..      
+00013b30: 2020 6966 206e 6f74 2073 656c 662e 6665    if not self.fe
+00013b40: 6174 7572 655f 666c 6167 732e 6861 735f  ature_flags.has_
+00013b50: 7072 6976 6163 795f 6d61 736b 3a0a 2020  privacy_mask:.  
+00013b60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00013b70: 4261 6452 6571 7565 7374 2822 4361 6d65  BadRequest("Came
+00013b80: 7261 2064 6f65 7320 6e6f 7420 616c 6c6f  ra does not allo
+00013b90: 7720 7072 6976 6163 7920 7a6f 6e65 7322  w privacy zones"
+00013ba0: 290a 0a20 2020 2020 2020 2064 6566 2063  )..        def c
+00013bb0: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
+00013bc0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00013bd0: 656c 662e 7573 655f 676c 6f62 616c 203d  elf.use_global =
+00013be0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00013bf0: 2020 2069 6620 656e 6162 6c65 643a 0a20     if enabled:. 
+00013c00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013c10: 656c 662e 6164 645f 7072 6976 6163 795f  elf.add_privacy_
+00013c20: 7a6f 6e65 2829 0a20 2020 2020 2020 2020  zone().         
+00013c30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00013c40: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+00013c50: 6d6f 7665 5f70 7269 7661 6379 5f7a 6f6e  move_privacy_zon
+00013c60: 6528 290a 0a20 2020 2020 2020 2020 2020  e()..           
+00013c70: 2069 6620 6d69 635f 6c65 7665 6c20 6973   if mic_level is
+00013c80: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00013c90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00013ca0: 6d69 635f 766f 6c75 6d65 203d 2050 6572  mic_volume = Per
+00013cb0: 6365 6e74 496e 7428 6d69 635f 6c65 7665  centInt(mic_leve
+00013cc0: 6c29 0a0a 2020 2020 2020 2020 2020 2020  l)..            
+00013cd0: 6966 2072 6563 6f72 6469 6e67 5f6d 6f64  if recording_mod
+00013ce0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00013cf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013d00: 656c 662e 7265 636f 7264 696e 675f 7365  elf.recording_se
+00013d10: 7474 696e 6773 2e6d 6f64 6520 3d20 7265  ttings.mode = re
+00013d20: 636f 7264 696e 675f 6d6f 6465 0a0a 2020  cording_mode..  
+00013d30: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+00013d40: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
+00013d50: 6c6c 6261 636b 290a 0a20 2020 2064 6566  llback)..    def
+00013d60: 2063 7265 6174 655f 7461 6c6b 6261 636b   create_talkback
+00013d70: 5f73 7472 6561 6d28 0a20 2020 2020 2020  _stream(.       
+00013d80: 2073 656c 662c 0a20 2020 2020 2020 2063   self,.        c
+00013d90: 6f6e 7465 6e74 5f75 726c 3a20 7374 722c  ontent_url: str,
+00013da0: 0a20 2020 2020 2020 2066 666d 7065 675f  .        ffmpeg_
+00013db0: 7061 7468 3a20 4f70 7469 6f6e 616c 5b50  path: Optional[P
+00013dc0: 6174 685d 203d 204e 6f6e 652c 0a20 2020  ath] = None,.   
+00013dd0: 2029 202d 3e20 5461 6c6b 6261 636b 5374   ) -> TalkbackSt
+00013de0: 7265 616d 3a0a 2020 2020 2020 2020 2222  ream:.        ""
+00013df0: 2243 7265 6174 6573 2061 2073 7562 7072  "Creates a subpr
+00013e00: 6f63 6573 7320 746f 2070 6c61 7920 6175  ocess to play au
+00013e10: 6469 6f20 746f 2061 2063 616d 6572 6120  dio to a camera 
+00013e20: 7468 726f 7567 6820 6974 7320 7370 6561  through its spea
+00013e30: 6b65 722e 0a0a 2020 2020 2020 2020 5265  ker...        Re
+00013e40: 7175 6972 6573 2066 666d 7065 6720 746f  quires ffmpeg to
+00013e50: 2075 7365 2e0a 0a20 2020 2020 2020 2041   use...        A
+00013e60: 7267 733a 0a20 2020 2020 2020 202d 2d2d  rgs:.        ---
+00013e70: 2d0a 2020 2020 2020 2020 2020 2020 636f  -.            co
+00013e80: 6e74 656e 745f 7572 6c3a 2045 6974 6865  ntent_url: Eithe
+00013e90: 7220 6120 5552 4c20 6163 6365 7373 6962  r a URL accessib
+00013ea0: 6c65 2062 7920 7079 7468 6f6e 206f 7220  le by python or 
+00013eb0: 6120 7061 7468 2074 6f20 6120 6669 6c65  a path to a file
+00013ec0: 2028 6666 6d65 7067 2773 2060 2d69 6020   (ffmepg's `-i` 
+00013ed0: 7061 7261 6d65 7465 7229 0a20 2020 2020  parameter).     
+00013ee0: 2020 2020 2020 2066 666d 7065 675f 7061         ffmpeg_pa
+00013ef0: 7468 3a20 4f70 7469 6f6e 616c 2070 6174  th: Optional pat
+00013f00: 6820 746f 2066 666d 7065 6720 6269 6e61  h to ffmpeg bina
+00013f10: 7279 0a0a 2020 2020 2020 2020 5573 6520  ry..        Use 
+00013f20: 6569 7468 6572 2060 6177 6169 7420 7374  either `await st
+00013f30: 7265 616d 2e72 756e 5f75 6e74 696c 5f63  ream.run_until_c
+00013f40: 6f6d 706c 6574 6528 2960 206f 7220 6061  omplete()` or `a
+00013f50: 7761 6974 2073 7472 6561 6d2e 7374 6172  wait stream.star
+00013f60: 7428 2960 2074 6f20 7374 6172 7420 7375  t()` to start su
+00013f70: 6270 726f 6365 7373 2063 6f6d 6d61 6e64  bprocess command
+00013f80: 0a20 2020 2020 2020 2061 6674 6572 2067  .        after g
+00013f90: 6574 7469 6e67 2074 6865 2073 7472 6561  etting the strea
+00013fa0: 6d2e 0a0a 2020 2020 2020 2020 602e 706c  m...        `.pl
+00013fb0: 6179 5f61 7564 696f 2829 6020 6973 2061  ay_audio()` is a
+00013fc0: 2068 656c 7065 7220 7468 6174 2077 7261   helper that wra
+00013fd0: 7073 2074 6869 7320 6d65 7468 6f64 2061  ps this method a
+00013fe0: 6e64 2061 7574 6f6d 6174 6963 616c 6c79  nd automatically
+00013ff0: 2072 756e 7320 7468 6520 7375 6270 726f   runs the subpro
+00014000: 6365 7373 2061 7320 7765 6c6c 0a20 2020  cess as well.   
+00014010: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00014020: 2020 6966 2073 656c 662e 7461 6c6b 6261    if self.talkba
+00014030: 636b 5f73 7472 6561 6d20 6973 206e 6f74  ck_stream is not
+00014040: 204e 6f6e 6520 616e 6420 7365 6c66 2e74   None and self.t
+00014050: 616c 6b62 6163 6b5f 7374 7265 616d 2e69  alkback_stream.i
+00014060: 735f 7275 6e6e 696e 673a 0a20 2020 2020  s_running:.     
+00014070: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
+00014080: 5265 7175 6573 7428 2243 616d 6572 6120  Request("Camera 
+00014090: 6973 2061 6c72 6561 6479 2070 6c61 7969  is already playi
+000140a0: 6e67 2061 7564 696f 2229 0a0a 2020 2020  ng audio")..    
+000140b0: 2020 2020 7365 6c66 2e74 616c 6b62 6163      self.talkbac
+000140c0: 6b5f 7374 7265 616d 203d 2054 616c 6b62  k_stream = Talkb
+000140d0: 6163 6b53 7472 6561 6d28 7365 6c66 2c20  ackStream(self, 
+000140e0: 636f 6e74 656e 745f 7572 6c2c 2066 666d  content_url, ffm
+000140f0: 7065 675f 7061 7468 290a 2020 2020 2020  peg_path).      
+00014100: 2020 7265 7475 726e 2073 656c 662e 7461    return self.ta
+00014110: 6c6b 6261 636b 5f73 7472 6561 6d0a 0a20  lkback_stream.. 
+00014120: 2020 2061 7379 6e63 2064 6566 2070 6c61     async def pla
+00014130: 795f 6175 6469 6f28 0a20 2020 2020 2020  y_audio(.       
+00014140: 2073 656c 662c 0a20 2020 2020 2020 2063   self,.        c
+00014150: 6f6e 7465 6e74 5f75 726c 3a20 7374 722c  ontent_url: str,
+00014160: 0a20 2020 2020 2020 2066 666d 7065 675f  .        ffmpeg_
+00014170: 7061 7468 3a20 4f70 7469 6f6e 616c 5b50  path: Optional[P
+00014180: 6174 685d 203d 204e 6f6e 652c 0a20 2020  ath] = None,.   
+00014190: 2020 2020 2062 6c6f 636b 696e 673a 2062       blocking: b
+000141a0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
+000141b0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000141c0: 2020 2022 2222 506c 6179 7320 6175 6469     """Plays audi
+000141d0: 6f20 746f 2061 2063 616d 6572 6120 7468  o to a camera th
+000141e0: 726f 7567 6820 6974 7320 7370 6561 6b65  rough its speake
+000141f0: 722e 0a0a 2020 2020 2020 2020 5265 7175  r...        Requ
+00014200: 6972 6573 2066 666d 7065 6720 746f 2075  ires ffmpeg to u
+00014210: 7365 2e0a 0a20 2020 2020 2020 2041 7267  se...        Arg
+00014220: 733a 0a20 2020 2020 2020 202d 2d2d 2d0a  s:.        ----.
+00014230: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+00014240: 656e 745f 7572 6c3a 2045 6974 6865 7220  ent_url: Either 
+00014250: 6120 5552 4c20 6163 6365 7373 6962 6c65  a URL accessible
+00014260: 2062 7920 7079 7468 6f6e 206f 7220 6120   by python or a 
+00014270: 7061 7468 2074 6f20 6120 6669 6c65 2028  path to a file (
+00014280: 6666 6d65 7067 2773 2060 2d69 6020 7061  ffmepg's `-i` pa
+00014290: 7261 6d65 7465 7229 0a20 2020 2020 2020  rameter).       
+000142a0: 2020 2020 2066 666d 7065 675f 7061 7468       ffmpeg_path
+000142b0: 3a20 4f70 7469 6f6e 616c 2070 6174 6820  : Optional path 
+000142c0: 746f 2066 666d 7065 6720 6269 6e61 7279  to ffmpeg binary
+000142d0: 0a20 2020 2020 2020 2020 2020 2062 6c6f  .            blo
+000142e0: 636b 696e 673a 2041 7761 6974 7320 7374  cking: Awaits st
+000142f0: 7265 616d 2063 6f6d 706c 6574 696f 6e20  ream completion 
+00014300: 616e 6420 6c6f 6773 2073 7464 6f75 742f  and logs stdout/
+00014310: 7374 6465 7272 0a20 2020 2020 2020 2022  stderr.        "
+00014320: 2222 0a0a 2020 2020 2020 2020 7374 7265  ""..        stre
+00014330: 616d 203d 2073 656c 662e 6372 6561 7465  am = self.create
+00014340: 5f74 616c 6b62 6163 6b5f 7374 7265 616d  _talkback_stream
+00014350: 2863 6f6e 7465 6e74 5f75 726c 2c20 6666  (content_url, ff
+00014360: 6d70 6567 5f70 6174 6829 0a20 2020 2020  mpeg_path).     
+00014370: 2020 2061 7761 6974 2073 7472 6561 6d2e     await stream.
+00014380: 7374 6172 7428 290a 0a20 2020 2020 2020  start()..       
+00014390: 2069 6620 626c 6f63 6b69 6e67 3a0a 2020   if blocking:.  
+000143a0: 2020 2020 2020 2020 2020 6177 6169 7420            await 
+000143b0: 7365 6c66 2e77 6169 745f 756e 7469 6c5f  self.wait_until_
+000143c0: 6175 6469 6f5f 636f 6d70 6c65 7465 7328  audio_completes(
+000143d0: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
+000143e0: 2077 6169 745f 756e 7469 6c5f 6175 6469   wait_until_audi
+000143f0: 6f5f 636f 6d70 6c65 7465 7328 7365 6c66  o_completes(self
+00014400: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00014410: 2020 2022 2222 4177 6169 7473 2073 7472     """Awaits str
+00014420: 6561 6d20 636f 6d70 6c65 7469 6f6e 206f  eam completion o
+00014430: 6620 6175 6469 6f20 616e 6420 6c6f 6773  f audio and logs
+00014440: 2073 7464 6f75 742f 7374 6465 7272 2e22   stdout/stderr."
+00014450: 2222 0a0a 2020 2020 2020 2020 7374 7265  ""..        stre
+00014460: 616d 203d 2073 656c 662e 7461 6c6b 6261  am = self.talkba
+00014470: 636b 5f73 7472 6561 6d0a 2020 2020 2020  ck_stream.      
+00014480: 2020 6966 2073 7472 6561 6d20 6973 204e    if stream is N
+00014490: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000144a0: 2072 6169 7365 2053 7472 6561 6d45 7272   raise StreamErr
+000144b0: 6f72 2822 4e6f 2061 7564 696f 2070 6c61  or("No audio pla
+000144c0: 7969 6e67 2074 6f20 7761 6974 2066 6f72  ying to wait for
+000144d0: 2229 0a0a 2020 2020 2020 2020 6177 6169  ")..        awai
+000144e0: 7420 7374 7265 616d 2e72 756e 5f75 6e74  t stream.run_unt
+000144f0: 696c 5f63 6f6d 706c 6574 6528 290a 0a20  il_complete().. 
+00014500: 2020 2020 2020 205f 4c4f 4747 4552 2e64         _LOGGER.d
+00014510: 6562 7567 2822 6666 6d70 6567 2073 7464  ebug("ffmpeg std
+00014520: 6f75 743a 5c6e 2573 222c 2022 5c6e 222e  out:\n%s", "\n".
+00014530: 6a6f 696e 2873 7472 6561 6d2e 7374 646f  join(stream.stdo
+00014540: 7574 2929 0a20 2020 2020 2020 205f 4c4f  ut)).        _LO
+00014550: 4747 4552 2e64 6562 7567 2822 6666 6d70  GGER.debug("ffmp
+00014560: 6567 2073 7464 6572 723a 5c6e 2573 222c  eg stderr:\n%s",
+00014570: 2022 5c6e 222e 6a6f 696e 2873 7472 6561   "\n".join(strea
+00014580: 6d2e 7374 6465 7272 2929 0a20 2020 2020  m.stderr)).     
+00014590: 2020 2069 6620 7374 7265 616d 2e69 735f     if stream.is_
+000145a0: 6572 726f 723a 0a20 2020 2020 2020 2020  error:.         
+000145b0: 2020 2065 7272 6f72 203d 2022 5c6e 222e     error = "\n".
+000145c0: 6a6f 696e 2873 7472 6561 6d2e 7374 6465  join(stream.stde
+000145d0: 7272 290a 2020 2020 2020 2020 2020 2020  rr).            
+000145e0: 7261 6973 6520 5374 7265 616d 4572 726f  raise StreamErro
+000145f0: 7228 2245 7272 6f72 2077 6869 6c65 2070  r("Error while p
+00014600: 6c61 7969 6e67 2061 7564 696f 2028 6666  laying audio (ff
+00014610: 6d70 6567 293a 205c 6e22 202b 2065 7272  mpeg): \n" + err
+00014620: 6f72 290a 0a20 2020 2061 7379 6e63 2064  or)..    async d
+00014630: 6566 2073 746f 705f 6175 6469 6f28 7365  ef stop_audio(se
+00014640: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
+00014650: 2020 2020 2022 2222 5374 6f70 2063 7572       """Stop cur
+00014660: 7265 6e74 6c79 2070 6c61 7969 6e67 2061  rently playing a
+00014670: 7564 696f 2e22 2222 0a20 2020 2020 2020  udio.""".       
+00014680: 2073 7472 6561 6d20 3d20 7365 6c66 2e74   stream = self.t
+00014690: 616c 6b62 6163 6b5f 7374 7265 616d 0a20  alkback_stream. 
+000146a0: 2020 2020 2020 2069 6620 7374 7265 616d         if stream
+000146b0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+000146c0: 2020 2020 2020 7261 6973 6520 5374 7265        raise Stre
+000146d0: 616d 4572 726f 7228 224e 6f20 6175 6469  amError("No audi
+000146e0: 6f20 706c 6179 696e 6720 746f 2073 746f  o playing to sto
+000146f0: 7022 290a 0a20 2020 2020 2020 2061 7761  p")..        awa
+00014700: 6974 2073 7472 6561 6d2e 7374 6f70 2829  it stream.stop()
+00014710: 0a0a 2020 2020 6465 6620 6361 6e5f 7265  ..    def can_re
+00014720: 6164 5f6d 6564 6961 2873 656c 662c 2075  ad_media(self, u
+00014730: 7365 723a 2055 7365 7229 202d 3e20 626f  ser: User) -> bo
+00014740: 6f6c 3a0a 2020 2020 2020 2020 6966 2073  ol:.        if s
+00014750: 656c 662e 6d6f 6465 6c20 6973 204e 6f6e  elf.model is Non
+00014760: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00014770: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00014780: 2020 2020 7265 7475 726e 2075 7365 722e      return user.
+00014790: 6361 6e28 7365 6c66 2e6d 6f64 656c 2c20  can(self.model, 
+000147a0: 5065 726d 6973 7369 6f6e 4e6f 6465 2e52  PermissionNode.R
+000147b0: 4541 445f 4d45 4449 412c 2073 656c 6629  EAD_MEDIA, self)
+000147c0: 0a0a 2020 2020 6465 6620 6361 6e5f 6465  ..    def can_de
+000147d0: 6c65 7465 5f6d 6564 6961 2873 656c 662c  lete_media(self,
+000147e0: 2075 7365 723a 2055 7365 7229 202d 3e20   user: User) -> 
+000147f0: 626f 6f6c 3a0a 2020 2020 2020 2020 6966  bool:.        if
+00014800: 2073 656c 662e 6d6f 6465 6c20 6973 204e   self.model is N
+00014810: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00014820: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
+00014830: 2020 2020 2020 7265 7475 726e 2075 7365        return use
+00014840: 722e 6361 6e28 7365 6c66 2e6d 6f64 656c  r.can(self.model
+00014850: 2c20 5065 726d 6973 7369 6f6e 4e6f 6465  , PermissionNode
+00014860: 2e44 454c 4554 455f 4d45 4449 412c 2073  .DELETE_MEDIA, s
+00014870: 656c 6629 0a0a 2020 2020 2320 7265 6769  elf)..    # regi
+00014880: 6f6e 2044 6f6f 7262 656c 6c0a 0a20 2020  on Doorbell..   
+00014890: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000148a0: 6566 2064 6f6f 7262 656c 6c5f 6f70 7469  ef doorbell_opti
+000148b0: 6f6e 7328 7365 6c66 2920 2d3e 206c 6973  ons(self) -> lis
+000148c0: 745b 4c43 444d 6573 7361 6765 5d20 7c20  t[LCDMessage] | 
+000148d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+000148e0: 2247 6574 206c 6973 7420 6f66 2073 6176  "Get list of sav
+000148f0: 6564 2064 6f6f 7262 656c 6c20 6f70 7469  ed doorbell opti
+00014900: 6f6e 732e 0a0a 2020 2020 2020 2020 446f  ons...        Do
+00014910: 6573 206e 6f74 2069 6e63 6c75 6465 2074  es not include t
+00014920: 6865 2064 6566 6175 6c74 206d 6573 7361  he default messa
+00014930: 6765 2028 6c63 645f 6d65 7373 6167 653d  ge (lcd_message=
+00014940: 4e6f 6e65 292e 2222 220a 0a20 2020 2020  None)."""..     
+00014950: 2020 2069 6620 6e6f 7420 7365 6c66 2e66     if not self.f
+00014960: 6561 7475 7265 5f66 6c61 6773 2e68 6173  eature_flags.has
+00014970: 5f6c 6364 5f73 6372 6565 6e3a 0a20 2020  _lcd_screen:.   
+00014980: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00014990: 4e6f 6e65 0a0a 2020 2020 2020 2020 6966  None..        if
+000149a0: 2073 656c 662e 6665 6174 7572 655f 666c   self.feature_fl
+000149b0: 6167 732e 6861 735f 636f 6c6f 725f 6c63  ags.has_color_lc
+000149c0: 645f 7363 7265 656e 3a0a 2020 2020 2020  d_screen:.      
+000149d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000149e0: 662e 6170 692e 626f 6f74 7374 7261 702e  f.api.bootstrap.
+000149f0: 6e76 722e 646f 6f72 6265 6c6c 5f73 6574  nvr.doorbell_set
+00014a00: 7469 6e67 732e 696d 6167 655f 646f 6f72  tings.image_door
+00014a10: 6265 6c6c 5f6f 7074 696f 6e73 0a20 2020  bell_options.   
+00014a20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00014a30: 2e61 7069 2e62 6f6f 7473 7472 6170 2e6e  .api.bootstrap.n
+00014a40: 7672 2e64 6f6f 7262 656c 6c5f 7365 7474  vr.doorbell_sett
+00014a50: 696e 6773 2e64 6f6f 7262 656c 6c5f 6f70  ings.doorbell_op
+00014a60: 7469 6f6e 730a 0a20 2020 2061 7379 6e63  tions..    async
+00014a70: 2064 6566 2073 6574 5f63 6869 6d65 5f74   def set_chime_t
+00014a80: 7970 6528 7365 6c66 2c20 6368 696d 655f  ype(self, chime_
+00014a90: 7479 7065 3a20 4368 696d 6554 7970 6529  type: ChimeType)
+00014aa0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00014ab0: 2020 2222 2253 6574 7320 6368 696d 6520    """Sets chime 
+00014ac0: 7479 7065 2066 6f72 2064 6f6f 7262 656c  type for doorbel
+00014ad0: 6c2e 2052 6571 7569 7265 7320 6361 6d65  l. Requires came
+00014ae0: 7261 2074 6f20 6265 2061 2064 6f6f 7262  ra to be a doorb
+00014af0: 656c 6c22 2222 0a0a 2020 2020 2020 2020  ell"""..        
+00014b00: 6177 6169 7420 7365 6c66 2e73 6574 5f63  await self.set_c
+00014b10: 6869 6d65 5f64 7572 6174 696f 6e28 7469  hime_duration(ti
+00014b20: 6d65 6465 6c74 6128 6d69 6c6c 6973 6563  medelta(millisec
+00014b30: 6f6e 6473 3d63 6869 6d65 5f74 7970 652e  onds=chime_type.
+00014b40: 7661 6c75 6529 290a 0a20 2020 2061 7379  value))..    asy
+00014b50: 6e63 2064 6566 2073 6574 5f63 6869 6d65  nc def set_chime
+00014b60: 5f64 7572 6174 696f 6e28 7365 6c66 2c20  _duration(self, 
+00014b70: 6475 7261 7469 6f6e 3a20 7469 6d65 6465  duration: timede
+00014b80: 6c74 6120 7c20 666c 6f61 7429 202d 3e20  lta | float) -> 
+00014b90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00014ba0: 2253 6574 7320 6368 696d 6520 6475 7261  "Sets chime dura
+00014bb0: 7469 6f6e 2066 6f72 2064 6f6f 7262 656c  tion for doorbel
+00014bc0: 6c2e 2052 6571 7569 7265 7320 6361 6d65  l. Requires came
+00014bd0: 7261 2074 6f20 6265 2061 2064 6f6f 7262  ra to be a doorb
+00014be0: 656c 6c22 2222 0a0a 2020 2020 2020 2020  ell"""..        
+00014bf0: 6966 206e 6f74 2073 656c 662e 6665 6174  if not self.feat
+00014c00: 7572 655f 666c 6167 732e 6861 735f 6368  ure_flags.has_ch
+00014c10: 696d 653a 0a20 2020 2020 2020 2020 2020  ime:.           
+00014c20: 2072 6169 7365 2042 6164 5265 7175 6573   raise BadReques
+00014c30: 7428 2243 616d 6572 6120 646f 6573 206e  t("Camera does n
+00014c40: 6f74 2068 6176 6520 6120 6368 696d 6522  ot have a chime"
+00014c50: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
+00014c60: 696e 7374 616e 6365 2864 7572 6174 696f  instance(duratio
+00014c70: 6e2c 2028 666c 6f61 742c 2069 6e74 2929  n, (float, int))
+00014c80: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00014c90: 2064 7572 6174 696f 6e20 3c20 303a 0a20   duration < 0:. 
+00014ca0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00014cb0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
+00014cc0: 2243 6869 6d65 2064 7572 6174 696f 6e20  "Chime duration 
+00014cd0: 6d75 7374 2062 6520 6120 706f 7369 7469  must be a positi
+00014ce0: 7665 206e 756d 6265 7220 6f66 2073 6563  ve number of sec
+00014cf0: 6f6e 6473 2229 0a20 2020 2020 2020 2020  onds").         
+00014d00: 2020 2064 7572 6174 696f 6e5f 7464 203d     duration_td =
+00014d10: 2074 696d 6564 656c 7461 2873 6563 6f6e   timedelta(secon
+00014d20: 6473 3d64 7572 6174 696f 6e29 0a20 2020  ds=duration).   
+00014d30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00014d40: 2020 2020 2020 2064 7572 6174 696f 6e5f         duration_
+00014d50: 7464 203d 2064 7572 6174 696f 6e0a 0a20  td = duration.. 
+00014d60: 2020 2020 2020 2069 6620 6475 7261 7469         if durati
+00014d70: 6f6e 5f74 642e 746f 7461 6c5f 7365 636f  on_td.total_seco
+00014d80: 6e64 7328 2920 3e20 3130 3a0a 2020 2020  nds() > 10:.    
+00014d90: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
+00014da0: 6452 6571 7565 7374 2822 4368 696d 6520  dRequest("Chime 
+00014db0: 6475 7261 7469 6f6e 2069 7320 746f 6f20  duration is too 
+00014dc0: 6c6f 6e67 2229 0a0a 2020 2020 2020 2020  long")..        
+00014dd0: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
+00014de0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00014df0: 2020 2020 7365 6c66 2e63 6869 6d65 5f64      self.chime_d
+00014e00: 7572 6174 696f 6e20 3d20 6475 7261 7469  uration = durati
+00014e10: 6f6e 5f74 640a 0a20 2020 2020 2020 2061  on_td..        a
+00014e20: 7761 6974 2073 656c 662e 7175 6575 655f  wait self.queue_
+00014e30: 7570 6461 7465 2863 616c 6c62 6163 6b29  update(callback)
+00014e40: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
+00014e50: 7365 745f 6c63 645f 7465 7874 280a 2020  set_lcd_text(.  
+00014e60: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00014e70: 2020 2020 7465 7874 5f74 7970 653a 204f      text_type: O
+00014e80: 7074 696f 6e61 6c5b 446f 6f72 6265 6c6c  ptional[Doorbell
+00014e90: 4d65 7373 6167 6554 7970 655d 2c0a 2020  MessageType],.  
+00014ea0: 2020 2020 2020 7465 7874 3a20 4f70 7469        text: Opti
+00014eb0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+00014ec0: 2c0a 2020 2020 2020 2020 7265 7365 745f  ,.        reset_
+00014ed0: 6174 3a20 556e 696f 6e5b 4e6f 6e65 2c20  at: Union[None, 
+00014ee0: 6461 7465 7469 6d65 2c20 4445 4641 554c  datetime, DEFAUL
+00014ef0: 545f 5459 5045 5d20 3d20 4e6f 6e65 2c0a  T_TYPE] = None,.
+00014f00: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00014f10: 2020 2020 2020 2022 2222 5365 7473 2064         """Sets d
+00014f20: 6f6f 7262 656c 6c20 4c43 4420 7465 7874  oorbell LCD text
+00014f30: 2e20 5265 7175 6972 6573 2063 616d 6572  . Requires camer
+00014f40: 6120 746f 2062 6520 646f 6f72 6265 6c6c  a to be doorbell
+00014f50: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
+00014f60: 6e6f 7420 7365 6c66 2e66 6561 7475 7265  not self.feature
+00014f70: 5f66 6c61 6773 2e68 6173 5f6c 6364 5f73  _flags.has_lcd_s
+00014f80: 6372 6565 6e3a 0a20 2020 2020 2020 2020  creen:.         
+00014f90: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
+00014fa0: 6573 7428 2243 616d 6572 6120 646f 6573  est("Camera does
+00014fb0: 206e 6f74 2068 6176 6520 616e 204c 4344   not have an LCD
+00014fc0: 2073 6372 6565 6e22 290a 0a20 2020 2020   screen")..     
+00014fd0: 2020 2069 6620 7465 7874 5f74 7970 6520     if text_type 
+00014fe0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00014ff0: 2020 2020 2061 7379 6e63 2077 6974 6820       async with 
+00015000: 7365 6c66 2e5f 7570 6461 7465 5f6c 6f63  self._update_loc
+00015010: 6b3a 0a20 2020 2020 2020 2020 2020 2020  k:.             
+00015020: 2020 2061 7761 6974 2061 7379 6e63 696f     await asyncio
+00015030: 2e73 6c65 6570 280a 2020 2020 2020 2020  .sleep(.        
+00015040: 2020 2020 2020 2020 2020 2020 302c 0a20              0,. 
+00015050: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00015060: 2020 2320 7969 656c 6420 746f 2074 6865    # yield to the
+00015070: 2065 7665 6e74 206c 6f6f 7020 6f6e 6365   event loop once
+00015080: 2077 6520 6861 7665 2074 6865 206c 6f63   we have the loc
+00015090: 6b20 746f 2070 726f 6365 7373 2061 6e79  k to process any
+000150a0: 2070 656e 6469 6e67 2075 7064 6174 6573   pending updates
+000150b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000150c0: 2064 6174 615f 6265 666f 7265 5f63 6861   data_before_cha
+000150d0: 6e67 6573 203d 2073 656c 662e 6469 6374  nges = self.dict
+000150e0: 5f77 6974 685f 6578 636c 7564 6573 2829  _with_excludes()
+000150f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015100: 2073 656c 662e 6c63 645f 6d65 7373 6167   self.lcd_messag
+00015110: 6520 3d20 4e6f 6e65 0a20 2020 2020 2020  e = None.       
+00015120: 2020 2020 2020 2020 2023 2055 6e69 4669           # UniFi
+00015130: 2050 726f 7465 6374 2062 7567 3a20 636c   Protect bug: cl
+00015140: 6561 7269 6e67 204c 4344 2074 6578 7420  earing LCD text 
+00015150: 6d65 7373 6167 6520 646f 6573 205f 6e6f  message does _no
+00015160: 745f 2065 6d69 7420 6120 5753 206d 6573  t_ emit a WS mes
+00015170: 7361 6765 0a20 2020 2020 2020 2020 2020  sage.           
+00015180: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
+00015190: 7361 7665 5f64 6576 6963 6528 6461 7461  save_device(data
+000151a0: 5f62 6566 6f72 655f 6368 616e 6765 732c  _before_changes,
+000151b0: 2066 6f72 6365 5f65 6d69 743d 5472 7565   force_emit=True
+000151c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000151d0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+000151e0: 2020 6966 2074 6578 745f 7479 7065 2021    if text_type !
+000151f0: 3d20 446f 6f72 6265 6c6c 4d65 7373 6167  = DoorbellMessag
+00015200: 6554 7970 652e 4355 5354 4f4d 5f4d 4553  eType.CUSTOM_MES
+00015210: 5341 4745 3a0a 2020 2020 2020 2020 2020  SAGE:.          
+00015220: 2020 6966 2074 6578 7420 6973 206e 6f74    if text is not
+00015230: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00015240: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
+00015250: 5265 7175 6573 7428 2243 616e 206f 6e6c  Request("Can onl
+00015260: 7920 7365 7420 7465 7874 2069 6620 7465  y set text if te
+00015270: 7874 5f74 7970 6520 6973 2043 5553 544f  xt_type is CUSTO
+00015280: 4d5f 4d45 5353 4147 4522 290a 2020 2020  M_MESSAGE").    
+00015290: 2020 2020 2020 2020 7465 7874 203d 2074          text = t
+000152a0: 6578 745f 7479 7065 2e76 616c 7565 2e72  ext_type.value.r
+000152b0: 6570 6c61 6365 2822 5f22 2c20 2220 2229  eplace("_", " ")
+000152c0: 0a0a 2020 2020 2020 2020 6966 2072 6573  ..        if res
+000152d0: 6574 5f61 7420 3d3d 2044 4546 4155 4c54  et_at == DEFAULT
+000152e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000152f0: 7365 745f 6174 203d 2028 0a20 2020 2020  set_at = (.     
+00015300: 2020 2020 2020 2020 2020 2075 7463 5f6e             utc_n
+00015310: 6f77 2829 0a20 2020 2020 2020 2020 2020  ow().           
+00015320: 2020 2020 202b 2073 656c 662e 6170 692e       + self.api.
+00015330: 626f 6f74 7374 7261 702e 6e76 722e 646f  bootstrap.nvr.do
+00015340: 6f72 6265 6c6c 5f73 6574 7469 6e67 732e  orbell_settings.
+00015350: 6465 6661 756c 745f 6d65 7373 6167 655f  default_message_
+00015360: 7265 7365 745f 7469 6d65 6f75 740a 2020  reset_timeout.  
+00015370: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00015380: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
+00015390: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
+000153a0: 2020 2020 2020 2020 2073 656c 662e 6c63           self.lc
+000153b0: 645f 6d65 7373 6167 6520 3d20 4c43 444d  d_message = LCDM
+000153c0: 6573 7361 6765 2820 2023 2074 7970 653a  essage(  # type:
+000153d0: 2069 676e 6f72 655b 6361 6c6c 2d61 7267   ignore[call-arg
+000153e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000153f0: 2020 6170 693d 7365 6c66 2e5f 6170 692c    api=self._api,
+00015400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015410: 2074 7970 653d 7465 7874 5f74 7970 652c   type=text_type,
+00015420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015430: 2074 6578 743d 7465 7874 2c20 2023 2074   text=text,  # t
+00015440: 7970 653a 2069 676e 6f72 655b 6172 672d  ype: ignore[arg-
+00015450: 7479 7065 5d0a 2020 2020 2020 2020 2020  type].          
+00015460: 2020 2020 2020 7265 7365 745f 6174 3d72        reset_at=r
+00015470: 6573 6574 5f61 742c 2020 2320 7479 7065  eset_at,  # type
+00015480: 3a20 6967 6e6f 7265 5b61 7267 2d74 7970  : ignore[arg-typ
+00015490: 655d 0a20 2020 2020 2020 2020 2020 2029  e].            )
+000154a0: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+000154b0: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+000154c0: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+000154d0: 2020 2020 2023 2065 6e64 7265 6769 6f6e       # endregion
+000154e0: 0a0a 2020 2020 2320 7265 6769 6f6e 2050  ..    # region P
+000154f0: 545a 0a0a 2020 2020 6173 796e 6320 6465  TZ..    async de
+00015500: 6620 7365 745f 7065 7273 6f6e 5f74 7261  f set_person_tra
+00015510: 636b 2873 656c 662c 2065 6e61 626c 6564  ck(self, enabled
+00015520: 3a20 626f 6f6c 2920 2d3e 204e 6f6e 653a  : bool) -> None:
+00015530: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
+00015540: 2070 6572 736f 6e20 7472 6163 6b69 6e67   person tracking
+00015550: 206f 6e20 6361 6d65 7261 2222 220a 0a20   on camera""".. 
+00015560: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00015570: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
+00015580: 2e69 735f 7074 7a3a 0a20 2020 2020 2020  .is_ptz:.       
+00015590: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
+000155a0: 7175 6573 7428 2243 616d 6572 6120 646f  quest("Camera do
+000155b0: 6573 206e 6f74 2073 7570 706f 7274 2070  es not support p
+000155c0: 6572 736f 6e20 7472 6163 6b69 6e67 2229  erson tracking")
+000155d0: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
+000155e0: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
+000155f0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00015600: 6c66 2e75 7365 5f67 6c6f 6261 6c20 3d20  lf.use_global = 
+00015610: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00015620: 2020 7365 6c66 2e73 6d61 7274 5f64 6574    self.smart_det
+00015630: 6563 745f 7365 7474 696e 6773 2e61 7574  ect_settings.aut
+00015640: 6f5f 7472 6163 6b69 6e67 5f6f 626a 6563  o_tracking_objec
+00015650: 745f 7479 7065 7320 3d20 280a 2020 2020  t_types = (.    
+00015660: 2020 2020 2020 2020 2020 2020 5b53 6d61              [Sma
+00015670: 7274 4465 7465 6374 4f62 6a65 6374 5479  rtDetectObjectTy
+00015680: 7065 2e50 4552 534f 4e5d 2069 6620 656e  pe.PERSON] if en
+00015690: 6162 6c65 6420 656c 7365 205b 5d0a 2020  abled else [].  
+000156a0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000156b0: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
+000156c0: 7175 6575 655f 7570 6461 7465 2863 616c  queue_update(cal
+000156d0: 6c62 6163 6b29 0a0a 2020 2020 6173 796e  lback)..    asyn
+000156e0: 6320 6465 6620 7074 7a5f 7265 6c61 7469  c def ptz_relati
+000156f0: 7665 5f6d 6f76 6528 0a20 2020 2020 2020  ve_move(.       
+00015700: 2073 656c 662c 0a20 2020 2020 2020 202a   self,.        *
+00015710: 2c0a 2020 2020 2020 2020 7061 6e3a 2066  ,.        pan: f
+00015720: 6c6f 6174 2c0a 2020 2020 2020 2020 7469  loat,.        ti
+00015730: 6c74 3a20 666c 6f61 742c 0a20 2020 2020  lt: float,.     
+00015740: 2020 2070 616e 5f73 7065 6564 3a20 696e     pan_speed: in
+00015750: 7420 3d20 3130 2c0a 2020 2020 2020 2020  t = 10,.        
+00015760: 7469 6c74 5f73 7065 6564 3a20 696e 7420  tilt_speed: int 
+00015770: 3d20 3130 2c0a 2020 2020 2020 2020 7363  = 10,.        sc
+00015780: 616c 653a 2069 6e74 203d 2030 2c0a 2020  ale: int = 0,.  
+00015790: 2020 2020 2020 7573 655f 6e61 7469 7665        use_native
+000157a0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+000157b0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+000157c0: 2020 2020 2020 2022 2222 4d6f 7665 2050         """Move P
+000157d0: 545a 2072 656c 6174 6976 6520 746f 2063  TZ relative to c
+000157e0: 7572 7265 6e74 2070 6f73 6974 696f 6e2e  urrent position.
+000157f0: 0a0a 2020 2020 2020 2020 5061 6e2f 7469  ..        Pan/ti
+00015800: 6c74 2076 616c 7565 7320 7661 7279 2066  lt values vary f
+00015810: 726f 6d20 6361 6d65 7261 2074 6f20 6361  rom camera to ca
+00015820: 6d65 7261 2c20 6275 7420 666f 7220 4734  mera, but for G4
+00015830: 2050 545a 3a0a 2020 2020 2020 2020 2020   PTZ:.          
+00015840: 2020 2a20 5061 6e20 7661 6c75 6573 2072    * Pan values r
+00015850: 616e 6765 2066 726f 6d20 30c2 b020 616e  ange from 0.. an
+00015860: 6420 676f 2074 6f20 3336 30c2 b02f 30c2  d go to 360../0.
+00015870: b00a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+00015880: 5469 6c74 2076 616c 7565 7320 7261 6e67  Tilt values rang
+00015890: 6520 6672 6f6d 202d 3230 c2b0 2061 6e64  e from -20.. and
+000158a0: 2067 6f20 746f 2039 30c2 b00a 0a20 2020   go to 90....   
+000158b0: 2020 2020 2052 656c 6174 6976 6520 706f       Relative po
+000158c0: 7369 7469 6f6e 7320 6361 6e6e 6f74 206d  sitions cannot m
+000158d0: 6f76 6520 6d6f 7265 2074 6865 6e20 3430  ove more then 40
+000158e0: 3935 2073 7465 7073 2061 7420 6120 7469  95 steps at a ti
+000158f0: 6d65 2069 6e20 616e 7920 6469 7265 6374  me in any direct
+00015900: 696f 6e2e 0a0a 2020 2020 2020 2020 466f  ion...        Fo
+00015910: 7220 7468 6520 4734 2050 545a 2c20 3430  r the G4 PTZ, 40
+00015920: 3935 2073 7465 7073 2069 7320 7e34 31c2  95 steps is ~41.
+00015930: b020 666f 7220 7061 6e20 616e 6420 7e34  . for pan and ~4
+00015940: 35c2 b020 666f 7220 7469 6c74 2e0a 0a20  5.. for tilt... 
+00015950: 2020 2020 2020 2060 7573 655f 6e61 7469         `use_nati
+00015960: 7665 6020 6c65 7473 2079 6f75 2075 7365  ve` lets you use
+00015970: 2074 6865 206e 6174 6976 6520 7374 6570   the native step
+00015980: 2076 616c 7565 7320 696e 7374 6561 6420   values instead 
+00015990: 6f66 2064 6567 7265 6573 2e0a 2020 2020  of degrees..    
+000159a0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+000159b0: 2069 6620 6e6f 7420 7365 6c66 2e66 6561   if not self.fea
+000159c0: 7475 7265 5f66 6c61 6773 2e69 735f 7074  ture_flags.is_pt
+000159d0: 7a3a 0a20 2020 2020 2020 2020 2020 2072  z:.            r
+000159e0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
+000159f0: 2243 616d 6572 6120 646f 6573 206e 6f74  "Camera does not
+00015a00: 2073 7570 706f 7274 2050 545a 2066 6561   support PTZ fea
+00015a10: 7475 7265 732e 2229 0a0a 2020 2020 2020  tures.")..      
+00015a20: 2020 6966 206e 6f74 2075 7365 5f6e 6174    if not use_nat
+00015a30: 6976 653a 0a20 2020 2020 2020 2020 2020  ive:.           
+00015a40: 2070 616e 203d 2073 656c 662e 6665 6174   pan = self.feat
+00015a50: 7572 655f 666c 6167 732e 7061 6e2e 746f  ure_flags.pan.to
+00015a60: 5f6e 6174 6976 655f 7661 6c75 6528 7061  _native_value(pa
+00015a70: 6e2c 2069 735f 7265 6c61 7469 7665 3d54  n, is_relative=T
+00015a80: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+00015a90: 2074 696c 7420 3d20 7365 6c66 2e66 6561   tilt = self.fea
+00015aa0: 7475 7265 5f66 6c61 6773 2e74 696c 742e  ture_flags.tilt.
+00015ab0: 746f 5f6e 6174 6976 655f 7661 6c75 6528  to_native_value(
+00015ac0: 7469 6c74 2c20 6973 5f72 656c 6174 6976  tilt, is_relativ
+00015ad0: 653d 5472 7565 290a 0a20 2020 2020 2020  e=True)..       
+00015ae0: 2061 7761 6974 2073 656c 662e 6170 692e   await self.api.
+00015af0: 7265 6c61 7469 7665 5f6d 6f76 655f 7074  relative_move_pt
+00015b00: 7a5f 6361 6d65 7261 280a 2020 2020 2020  z_camera(.      
+00015b10: 2020 2020 2020 7365 6c66 2e69 642c 0a20        self.id,. 
+00015b20: 2020 2020 2020 2020 2020 2070 616e 3d70             pan=p
+00015b30: 616e 2c0a 2020 2020 2020 2020 2020 2020  an,.            
+00015b40: 7469 6c74 3d74 696c 742c 0a20 2020 2020  tilt=tilt,.     
+00015b50: 2020 2020 2020 2070 616e 5f73 7065 6564         pan_speed
+00015b60: 3d70 616e 5f73 7065 6564 2c0a 2020 2020  =pan_speed,.    
+00015b70: 2020 2020 2020 2020 7469 6c74 5f73 7065          tilt_spe
+00015b80: 6564 3d74 696c 745f 7370 6565 642c 0a20  ed=tilt_speed,. 
+00015b90: 2020 2020 2020 2020 2020 2073 6361 6c65             scale
+00015ba0: 3d73 6361 6c65 2c0a 2020 2020 2020 2020  =scale,.        
+00015bb0: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
+00015bc0: 2070 747a 5f63 656e 7465 7228 7365 6c66   ptz_center(self
+00015bd0: 2c20 2a2c 2078 3a20 696e 742c 2079 3a20  , *, x: int, y: 
+00015be0: 696e 742c 207a 3a20 696e 7429 202d 3e20  int, z: int) -> 
+00015bf0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00015c00: 2243 656e 7465 7220 5054 5a20 4361 6d65  "Center PTZ Came
+00015c10: 7261 206f 6e20 706f 696e 7420 696e 2076  ra on point in v
+00015c20: 6965 7770 6f72 742e 0a0a 2020 2020 2020  iewport...      
+00015c30: 2020 782c 2079 2c20 7a20 7661 6c75 6573    x, y, z values
+00015c40: 2072 616e 6765 2066 726f 6d20 3020 746f   range from 0 to
+00015c50: 2031 3030 302e 0a0a 2020 2020 2020 2020   1000...        
+00015c60: 782c 2079 2061 7265 2072 656c 6174 6976  x, y are relativ
+00015c70: 6520 636f 6f72 6473 2066 6f72 2074 6865  e coords for the
+00015c80: 2063 7572 7265 6e74 2076 6965 7770 6f72   current viewpor
+00015c90: 743a 0a20 2020 2020 2020 2020 2020 202a  t:.            *
+00015ca0: 2028 302c 2030 2920 6973 2074 6f70 206c   (0, 0) is top l
+00015cb0: 6566 740a 2020 2020 2020 2020 2020 2020  eft.            
+00015cc0: 2a20 2835 3030 2c20 3530 3029 2069 7320  * (500, 500) is 
+00015cd0: 7468 6520 6365 6e74 6572 0a20 2020 2020  the center.     
+00015ce0: 2020 2020 2020 202a 2028 3130 3030 2c20         * (1000, 
+00015cf0: 3130 3030 2920 6973 2074 6865 2062 6f74  1000) is the bot
+00015d00: 746f 6d20 7269 6768 740a 0a20 2020 2020  tom right..     
+00015d10: 2020 207a 2076 616c 7565 2069 7320 7a6f     z value is zo
+00015d20: 6f6d 2c20 6275 7420 7369 6e63 6520 6974  om, but since it
+00015d30: 2069 7320 6361 7070 6564 2061 7420 3130   is capped at 10
+00015d40: 3030 2c20 7072 6f62 6162 6c79 2062 6574  00, probably bet
+00015d50: 7465 7220 746f 2075 7365 2060 7074 7a5f  ter to use `ptz_
+00015d60: 7a6f 6f6d 602e 0a20 2020 2020 2020 2022  zoom`..        "
+00015d70: 2222 0a0a 2020 2020 2020 2020 6177 6169  ""..        awai
+00015d80: 7420 7365 6c66 2e61 7069 2e63 656e 7465  t self.api.cente
+00015d90: 725f 7074 7a5f 6361 6d65 7261 2873 656c  r_ptz_camera(sel
+00015da0: 662e 6964 2c20 783d 782c 2079 3d79 2c20  f.id, x=x, y=y, 
+00015db0: 7a3d 7a29 0a0a 2020 2020 6173 796e 6320  z=z)..    async 
+00015dc0: 6465 6620 7074 7a5f 7a6f 6f6d 280a 2020  def ptz_zoom(.  
+00015dd0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00015de0: 2020 2020 2a2c 0a20 2020 2020 2020 207a      *,.        z
+00015df0: 6f6f 6d3a 2066 6c6f 6174 2c0a 2020 2020  oom: float,.    
+00015e00: 2020 2020 7370 6565 643a 2069 6e74 203d      speed: int =
+00015e10: 2031 3030 2c0a 2020 2020 2020 2020 7573   100,.        us
+00015e20: 655f 6e61 7469 7665 3a20 626f 6f6c 203d  e_native: bool =
+00015e30: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
+00015e40: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+00015e50: 2222 5a6f 6f6d 2050 545a 2043 616d 6572  ""Zoom PTZ Camer
+00015e60: 612e 0a0a 2020 2020 2020 2020 5a6f 6f6d  a...        Zoom
+00015e70: 206c 6576 656c 7320 7661 7279 2066 726f   levels vary fro
+00015e80: 6d20 6361 6d65 7261 2074 6f20 6361 6d65  m camera to came
+00015e90: 7261 2c20 6275 7420 666f 7220 4734 2050  ra, but for G4 P
+00015ea0: 545a 2069 7420 676f 6573 2066 726f 6d20  TZ it goes from 
+00015eb0: 3178 2074 6f20 3232 782e 0a0a 2020 2020  1x to 22x...    
+00015ec0: 2020 2020 5a6f 6f6d 2073 7065 6564 2073      Zoom speed s
+00015ed0: 6565 6d73 2074 6f20 7261 6e67 6520 6672  eems to range fr
+00015ee0: 6f6d 2030 2074 6f20 3130 302e 2041 6e79  om 0 to 100. Any
+00015ef0: 2076 616c 7565 206f 7665 7220 3130 3020   value over 100 
+00015f00: 7265 7375 6c74 7320 696e 2061 2073 7065  results in a spe
+00015f10: 6564 206f 6620 302e 0a20 2020 2020 2020  ed of 0..       
+00015f20: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+00015f30: 206e 6f74 2073 656c 662e 6665 6174 7572   not self.featur
+00015f40: 655f 666c 6167 732e 6973 5f70 747a 3a0a  e_flags.is_ptz:.
+00015f50: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00015f60: 6520 4261 6452 6571 7565 7374 2822 4361  e BadRequest("Ca
+00015f70: 6d65 7261 2064 6f65 7320 6e6f 7420 7375  mera does not su
+00015f80: 7070 6f72 7420 5054 5a20 6665 6174 7572  pport PTZ featur
+00015f90: 6573 2e22 290a 0a20 2020 2020 2020 2069  es.")..        i
+00015fa0: 6620 6e6f 7420 7573 655f 6e61 7469 7665  f not use_native
+00015fb0: 3a0a 2020 2020 2020 2020 2020 2020 7a6f  :.            zo
+00015fc0: 6f6d 203d 2073 656c 662e 6665 6174 7572  om = self.featur
+00015fd0: 655f 666c 6167 732e 7a6f 6f6d 2e74 6f5f  e_flags.zoom.to_
+00015fe0: 6e61 7469 7665 5f76 616c 7565 287a 6f6f  native_value(zoo
+00015ff0: 6d29 0a0a 2020 2020 2020 2020 6177 6169  m)..        awai
+00016000: 7420 7365 6c66 2e61 7069 2e7a 6f6f 6d5f  t self.api.zoom_
+00016010: 7074 7a5f 6361 6d65 7261 2873 656c 662e  ptz_camera(self.
+00016020: 6964 2c20 7a6f 6f6d 3d7a 6f6f 6d2c 2073  id, zoom=zoom, s
+00016030: 7065 6564 3d73 7065 6564 290a 0a20 2020  peed=speed)..   
+00016040: 2061 7379 6e63 2064 6566 2067 6574 5f70   async def get_p
+00016050: 747a 5f70 6f73 6974 696f 6e28 7365 6c66  tz_position(self
+00016060: 2920 2d3e 2050 545a 506f 7369 7469 6f6e  ) -> PTZPosition
+00016070: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+00016080: 2063 7572 7265 6e74 2050 545a 2050 6f73   current PTZ Pos
+00016090: 6974 696f 6e2e 2222 220a 0a20 2020 2020  ition."""..     
+000160a0: 2020 2069 6620 6e6f 7420 7365 6c66 2e66     if not self.f
+000160b0: 6561 7475 7265 5f66 6c61 6773 2e69 735f  eature_flags.is_
+000160c0: 7074 7a3a 0a20 2020 2020 2020 2020 2020  ptz:.           
+000160d0: 2072 6169 7365 2042 6164 5265 7175 6573   raise BadReques
+000160e0: 7428 2243 616d 6572 6120 646f 6573 206e  t("Camera does n
+000160f0: 6f74 2073 7570 706f 7274 2050 545a 2066  ot support PTZ f
+00016100: 6561 7475 7265 732e 2229 0a0a 2020 2020  eatures.")..    
+00016110: 2020 2020 7265 7475 726e 2061 7761 6974      return await
+00016120: 2073 656c 662e 6170 692e 6765 745f 706f   self.api.get_po
+00016130: 7369 7469 6f6e 5f70 747a 5f63 616d 6572  sition_ptz_camer
+00016140: 6128 7365 6c66 2e69 6429 0a0a 2020 2020  a(self.id)..    
+00016150: 6173 796e 6320 6465 6620 676f 746f 5f70  async def goto_p
+00016160: 747a 5f73 6c6f 7428 7365 6c66 2c20 2a2c  tz_slot(self, *,
+00016170: 2073 6c6f 743a 2069 6e74 2920 2d3e 204e   slot: int) -> N
+00016180: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+00016190: 476f 746f 2050 545a 2073 6c6f 7420 706f  Goto PTZ slot po
+000161a0: 7369 7469 6f6e 2e0a 0a20 2020 2020 2020  sition...       
+000161b0: 202d 3120 6973 2048 6f6d 6520 736c 6f74   -1 is Home slot
+000161c0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+000161d0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+000161e0: 6c66 2e66 6561 7475 7265 5f66 6c61 6773  lf.feature_flags
+000161f0: 2e69 735f 7074 7a3a 0a20 2020 2020 2020  .is_ptz:.       
+00016200: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
+00016210: 7175 6573 7428 2243 616d 6572 6120 646f  quest("Camera do
+00016220: 6573 206e 6f74 2073 7570 706f 7274 2050  es not support P
+00016230: 545a 2066 6561 7475 7265 732e 2229 0a0a  TZ features.")..
+00016240: 2020 2020 2020 2020 6177 6169 7420 7365          await se
+00016250: 6c66 2e61 7069 2e67 6f74 6f5f 7074 7a5f  lf.api.goto_ptz_
+00016260: 6361 6d65 7261 2873 656c 662e 6964 2c20  camera(self.id, 
+00016270: 736c 6f74 3d73 6c6f 7429 0a0a 2020 2020  slot=slot)..    
+00016280: 6173 796e 6320 6465 6620 6372 6561 7465  async def create
+00016290: 5f70 747a 5f70 7265 7365 7428 7365 6c66  _ptz_preset(self
+000162a0: 2c20 2a2c 206e 616d 653a 2073 7472 2920  , *, name: str) 
+000162b0: 2d3e 2050 545a 5072 6573 6574 3a0a 2020  -> PTZPreset:.  
+000162c0: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
+000162d0: 5054 5a20 5072 6573 6574 2066 6f72 2063  PTZ Preset for c
+000162e0: 616d 6572 6120 6261 7365 6420 6f6e 2063  amera based on c
+000162f0: 7572 7265 6e74 2063 616d 6572 6120 7365  urrent camera se
+00016300: 7474 696e 6773 2e22 2222 0a0a 2020 2020  ttings."""..    
+00016310: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00016320: 6665 6174 7572 655f 666c 6167 732e 6973  feature_flags.is
+00016330: 5f70 747a 3a0a 2020 2020 2020 2020 2020  _ptz:.          
+00016340: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
+00016350: 7374 2822 4361 6d65 7261 2064 6f65 7320  st("Camera does 
+00016360: 6e6f 7420 7375 7070 6f72 7420 5054 5a20  not support PTZ 
+00016370: 6665 6174 7572 6573 2e22 290a 0a20 2020  features.")..   
+00016380: 2020 2020 2072 6574 7572 6e20 6177 6169       return awai
+00016390: 7420 7365 6c66 2e61 7069 2e63 7265 6174  t self.api.creat
+000163a0: 655f 7072 6573 6574 5f70 747a 5f63 616d  e_preset_ptz_cam
+000163b0: 6572 6128 7365 6c66 2e69 642c 206e 616d  era(self.id, nam
+000163c0: 653d 6e61 6d65 290a 0a20 2020 2061 7379  e=name)..    asy
+000163d0: 6e63 2064 6566 2067 6574 5f70 747a 5f70  nc def get_ptz_p
+000163e0: 7265 7365 7473 2873 656c 6629 202d 3e20  resets(self) -> 
+000163f0: 6c69 7374 5b50 545a 5072 6573 6574 5d3a  list[PTZPreset]:
+00016400: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
+00016410: 5054 5a20 5072 6573 6574 7320 666f 7220  PTZ Presets for 
+00016420: 6361 6d65 7261 2e22 2222 0a0a 2020 2020  camera."""..    
+00016430: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00016440: 6665 6174 7572 655f 666c 6167 732e 6973  feature_flags.is
+00016450: 5f70 747a 3a0a 2020 2020 2020 2020 2020  _ptz:.          
+00016460: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
+00016470: 7374 2822 4361 6d65 7261 2064 6f65 7320  st("Camera does 
+00016480: 6e6f 7420 7375 7070 6f72 7420 5054 5a20  not support PTZ 
+00016490: 6665 6174 7572 6573 2e22 290a 0a20 2020  features.")..   
+000164a0: 2020 2020 2072 6574 7572 6e20 6177 6169       return awai
+000164b0: 7420 7365 6c66 2e61 7069 2e67 6574 5f70  t self.api.get_p
+000164c0: 7265 7365 7473 5f70 747a 5f63 616d 6572  resets_ptz_camer
+000164d0: 6128 7365 6c66 2e69 6429 0a0a 2020 2020  a(self.id)..    
+000164e0: 6173 796e 6320 6465 6620 6465 6c65 7465  async def delete
+000164f0: 5f70 747a 5f70 7265 7365 7428 7365 6c66  _ptz_preset(self
+00016500: 2c20 2a2c 2073 6c6f 743a 2069 6e74 2920  , *, slot: int) 
+00016510: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00016520: 2022 2222 4465 6c65 7465 2050 545a 2070   """Delete PTZ p
+00016530: 7265 7365 7420 666f 7220 6361 6d65 7261  reset for camera
+00016540: 2e22 2222 0a0a 2020 2020 2020 2020 6966  ."""..        if
+00016550: 206e 6f74 2073 656c 662e 6665 6174 7572   not self.featur
+00016560: 655f 666c 6167 732e 6973 5f70 747a 3a0a  e_flags.is_ptz:.
+00016570: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00016580: 6520 4261 6452 6571 7565 7374 2822 4361  e BadRequest("Ca
+00016590: 6d65 7261 2064 6f65 7320 6e6f 7420 7375  mera does not su
+000165a0: 7070 6f72 7420 5054 5a20 6665 6174 7572  pport PTZ featur
+000165b0: 6573 2e22 290a 0a20 2020 2020 2020 2061  es.")..        a
+000165c0: 7761 6974 2073 656c 662e 6170 692e 6465  wait self.api.de
+000165d0: 6c65 7465 5f70 7265 7365 745f 7074 7a5f  lete_preset_ptz_
+000165e0: 6361 6d65 7261 2873 656c 662e 6964 2c20  camera(self.id, 
+000165f0: 736c 6f74 3d73 6c6f 7429 0a0a 2020 2020  slot=slot)..    
+00016600: 6173 796e 6320 6465 6620 6765 745f 7074  async def get_pt
+00016610: 7a5f 686f 6d65 2873 656c 6629 202d 3e20  z_home(self) -> 
+00016620: 5054 5a50 7265 7365 743a 0a20 2020 2020  PTZPreset:.     
+00016630: 2020 2022 2222 4765 7420 5054 5a20 686f     """Get PTZ ho
+00016640: 6d65 2070 7265 7365 7420 282d 3129 2e22  me preset (-1)."
+00016650: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
+00016660: 6f74 2073 656c 662e 6665 6174 7572 655f  ot self.feature_
+00016670: 666c 6167 732e 6973 5f70 747a 3a0a 2020  flags.is_ptz:.  
+00016680: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00016690: 4261 6452 6571 7565 7374 2822 4361 6d65  BadRequest("Came
+000166a0: 7261 2064 6f65 7320 6e6f 7420 7375 7070  ra does not supp
+000166b0: 6f72 7420 5054 5a20 6665 6174 7572 6573  ort PTZ features
+000166c0: 2e22 290a 0a20 2020 2020 2020 2072 6574  .")..        ret
+000166d0: 7572 6e20 6177 6169 7420 7365 6c66 2e61  urn await self.a
+000166e0: 7069 2e67 6574 5f68 6f6d 655f 7074 7a5f  pi.get_home_ptz_
+000166f0: 6361 6d65 7261 2873 656c 662e 6964 290a  camera(self.id).
+00016700: 0a20 2020 2061 7379 6e63 2064 6566 2073  .    async def s
+00016710: 6574 5f70 747a 5f68 6f6d 6528 7365 6c66  et_ptz_home(self
+00016720: 2920 2d3e 2050 545a 5072 6573 6574 3a0a  ) -> PTZPreset:.
+00016730: 2020 2020 2020 2020 2222 2247 6574 2050          """Get P
+00016740: 545a 2068 6f6d 6520 7072 6573 6574 2028  TZ home preset (
+00016750: 2d31 2920 746f 2063 7572 7265 6e74 2070  -1) to current p
+00016760: 6f73 6974 696f 6e2e 2222 220a 0a20 2020  osition."""..   
+00016770: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00016780: 2e66 6561 7475 7265 5f66 6c61 6773 2e69  .feature_flags.i
+00016790: 735f 7074 7a3a 0a20 2020 2020 2020 2020  s_ptz:.         
+000167a0: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
+000167b0: 6573 7428 2243 616d 6572 6120 646f 6573  est("Camera does
+000167c0: 206e 6f74 2073 7570 706f 7274 2050 545a   not support PTZ
+000167d0: 2066 6561 7475 7265 732e 2229 0a0a 2020   features.")..  
+000167e0: 2020 2020 2020 7265 7475 726e 2061 7761        return awa
+000167f0: 6974 2073 656c 662e 6170 692e 7365 745f  it self.api.set_
+00016800: 686f 6d65 5f70 747a 5f63 616d 6572 6128  home_ptz_camera(
+00016810: 7365 6c66 2e69 6429 0a0a 2020 2020 6173  self.id)..    as
+00016820: 796e 6320 6465 6620 6372 6561 7465 5f70  ync def create_p
+00016830: 747a 5f70 6174 726f 6c28 0a20 2020 2020  tz_patrol(.     
+00016840: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00016850: 202a 2c0a 2020 2020 2020 2020 6e61 6d65   *,.        name
+00016860: 3a20 7374 722c 0a20 2020 2020 2020 2070  : str,.        p
+00016870: 7265 7365 745f 736c 6f74 733a 206c 6973  reset_slots: lis
+00016880: 745b 696e 745d 2c0a 2020 2020 2020 2020  t[int],.        
+00016890: 6475 7261 7469 6f6e 3a20 696e 7420 3d20  duration: int = 
+000168a0: 3130 2c0a 2020 2020 2920 2d3e 2050 545a  10,.    ) -> PTZ
+000168b0: 5061 7472 6f6c 3a0a 2020 2020 2020 2020  Patrol:.        
+000168c0: 2222 2243 7265 6174 6520 5054 5a20 5061  """Create PTZ Pa
+000168d0: 7472 6f6c 2e0a 0a20 2020 2020 2020 2044  trol...        D
+000168e0: 7572 6174 696f 6e20 6973 2068 6f77 206c  uration is how l
+000168f0: 6f6e 6720 6361 6d65 7261 2077 6169 7473  ong camera waits
+00016900: 2061 7420 6561 6368 2070 7265 7365 7420   at each preset 
+00016910: 696e 2073 6563 6f6e 6473 2e20 4d75 7374  in seconds. Must
+00016920: 2062 6520 6265 7477 6565 6e20 3130 2061   be between 10 a
+00016930: 6e64 2036 302e 0a20 2020 2020 2020 2022  nd 60..        "
+00016940: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
+00016950: 6f74 2073 656c 662e 6665 6174 7572 655f  ot self.feature_
+00016960: 666c 6167 732e 6973 5f70 747a 3a0a 2020  flags.is_ptz:.  
+00016970: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00016980: 4261 6452 6571 7565 7374 2822 4361 6d65  BadRequest("Came
+00016990: 7261 2064 6f65 7320 6e6f 7420 7375 7070  ra does not supp
+000169a0: 6f72 7420 5054 5a20 6665 6174 7572 6573  ort PTZ features
+000169b0: 2e22 290a 0a20 2020 2020 2020 2072 6574  .")..        ret
+000169c0: 7572 6e20 6177 6169 7420 7365 6c66 2e61  urn await self.a
+000169d0: 7069 2e63 7265 6174 655f 7061 7472 6f6c  pi.create_patrol
+000169e0: 5f70 747a 5f63 616d 6572 6128 0a20 2020  _ptz_camera(.   
+000169f0: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
+00016a00: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+00016a10: 6d65 3d6e 616d 652c 0a20 2020 2020 2020  me=name,.       
+00016a20: 2020 2020 2070 7265 7365 745f 736c 6f74       preset_slot
+00016a30: 733d 7072 6573 6574 5f73 6c6f 7473 2c0a  s=preset_slots,.
+00016a40: 2020 2020 2020 2020 2020 2020 6475 7261              dura
+00016a50: 7469 6f6e 3d64 7572 6174 696f 6e2c 0a20  tion=duration,. 
+00016a60: 2020 2020 2020 2029 0a0a 2020 2020 6173         )..    as
+00016a70: 796e 6320 6465 6620 6765 745f 7074 7a5f  ync def get_ptz_
+00016a80: 7061 7472 6f6c 7328 7365 6c66 2920 2d3e  patrols(self) ->
+00016a90: 206c 6973 745b 5054 5a50 6174 726f 6c5d   list[PTZPatrol]
+00016aa0: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+00016ab0: 2050 545a 2050 6174 726f 6c73 2e22 2222   PTZ Patrols."""
+00016ac0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00016ad0: 2073 656c 662e 6665 6174 7572 655f 666c   self.feature_fl
+00016ae0: 6167 732e 6973 5f70 747a 3a0a 2020 2020  ags.is_ptz:.    
+00016af0: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
+00016b00: 6452 6571 7565 7374 2822 4361 6d65 7261  dRequest("Camera
+00016b10: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
+00016b20: 7420 5054 5a20 6665 6174 7572 6573 2e22  t PTZ features."
+00016b30: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00016b40: 6e20 6177 6169 7420 7365 6c66 2e61 7069  n await self.api
+00016b50: 2e67 6574 5f70 6174 726f 6c73 5f70 747a  .get_patrols_ptz
+00016b60: 5f63 616d 6572 6128 7365 6c66 2e69 6429  _camera(self.id)
+00016b70: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
+00016b80: 6465 6c65 7465 5f70 747a 5f70 6174 726f  delete_ptz_patro
+00016b90: 6c28 7365 6c66 2c20 736c 6f74 3a20 696e  l(self, slot: in
+00016ba0: 7429 202d 3e20 4e6f 6e65 3a0a 2020 2020  t) -> None:.    
+00016bb0: 2020 2020 2222 2244 656c 6574 6520 5054      """Delete PT
+00016bc0: 5a20 5061 7472 6f6c 2e22 2222 0a0a 2020  Z Patrol."""..  
+00016bd0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00016be0: 662e 6665 6174 7572 655f 666c 6167 732e  f.feature_flags.
+00016bf0: 6973 5f70 747a 3a0a 2020 2020 2020 2020  is_ptz:.        
+00016c00: 2020 2020 7261 6973 6520 4261 6452 6571      raise BadReq
+00016c10: 7565 7374 2822 4361 6d65 7261 2064 6f65  uest("Camera doe
+00016c20: 7320 6e6f 7420 7375 7070 6f72 7420 5054  s not support PT
+00016c30: 5a20 6665 6174 7572 6573 2e22 290a 0a20  Z features.").. 
+00016c40: 2020 2020 2020 2072 6574 7572 6e20 6177         return aw
+00016c50: 6169 7420 7365 6c66 2e61 7069 2e64 656c  ait self.api.del
+00016c60: 6574 655f 7061 7472 6f6c 5f70 747a 5f63  ete_patrol_ptz_c
+00016c70: 616d 6572 6128 7365 6c66 2e69 642c 2073  amera(self.id, s
+00016c80: 6c6f 7429 0a0a 2020 2020 6173 796e 6320  lot)..    async 
+00016c90: 6465 6620 6765 745f 6163 7469 7665 5f70  def get_active_p
+00016ca0: 747a 5f70 6174 726f 6c28 7365 6c66 2920  tz_patrol(self) 
+00016cb0: 2d3e 2050 545a 5061 7472 6f6c 207c 204e  -> PTZPatrol | N
+00016cc0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+00016cd0: 4765 7420 7468 6520 6375 7272 656e 7420  Get the current 
+00016ce0: 6163 7469 7665 2050 545a 2050 6174 726f  active PTZ Patro
+00016cf0: 6c2e 2222 220a 0a20 2020 2020 2020 2069  l."""..        i
+00016d00: 6620 6e6f 7420 7365 6c66 2e66 6561 7475  f not self.featu
+00016d10: 7265 5f66 6c61 6773 2e69 735f 7074 7a3a  re_flags.is_ptz:
+00016d20: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00016d30: 7365 2042 6164 5265 7175 6573 7428 2243  se BadRequest("C
+00016d40: 616d 6572 6120 646f 6573 206e 6f74 2073  amera does not s
+00016d50: 7570 706f 7274 2050 545a 2066 6561 7475  upport PTZ featu
+00016d60: 7265 732e 2229 0a0a 2020 2020 2020 2020  res.")..        
+00016d70: 7265 7475 726e 2061 7761 6974 2073 656c  return await sel
+00016d80: 662e 6170 692e 6765 745f 6163 7469 7665  f.api.get_active
+00016d90: 5f70 747a 5f70 6174 726f 6c28 7365 6c66  _ptz_patrol(self
+00016da0: 2e69 6429 0a0a 2020 2020 6173 796e 6320  .id)..    async 
+00016db0: 6465 6620 7374 6172 745f 7061 7472 6f6c  def start_patrol
+00016dc0: 5f70 747a 5f63 616d 6572 6128 7365 6c66  _ptz_camera(self
+00016dd0: 2c20 736c 6f74 3a20 696e 7429 202d 3e20  , slot: int) -> 
+00016de0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00016df0: 2253 7461 7274 2061 2050 545a 2050 6174  "Start a PTZ Pat
+00016e00: 726f 6c2e 2222 220a 0a20 2020 2020 2020  rol."""..       
+00016e10: 2069 6620 6e6f 7420 7365 6c66 2e66 6561   if not self.fea
+00016e20: 7475 7265 5f66 6c61 6773 2e69 735f 7074  ture_flags.is_pt
+00016e30: 7a3a 0a20 2020 2020 2020 2020 2020 2072  z:.            r
+00016e40: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
+00016e50: 2243 616d 6572 6120 646f 6573 206e 6f74  "Camera does not
+00016e60: 2073 7570 706f 7274 2050 545a 2066 6561   support PTZ fea
+00016e70: 7475 7265 732e 2229 0a0a 2020 2020 2020  tures.")..      
+00016e80: 2020 6177 6169 7420 7365 6c66 2e61 7069    await self.api
+00016e90: 2e73 7461 7274 5f70 6174 726f 6c5f 7074  .start_patrol_pt
+00016ea0: 7a5f 6361 6d65 7261 2873 656c 662e 6964  z_camera(self.id
+00016eb0: 2c20 736c 6f74 290a 0a20 2020 2023 2065  , slot)..    # e
+00016ec0: 6e64 7265 6769 6f6e 0a0a 0a63 6c61 7373  ndregion...class
+00016ed0: 2056 6965 7765 7228 5072 6f74 6563 7441   Viewer(ProtectA
+00016ee0: 646f 7074 6162 6c65 4465 7669 6365 4d6f  doptableDeviceMo
+00016ef0: 6465 6c29 3a0a 2020 2020 7374 7265 616d  del):.    stream
+00016f00: 5f6c 696d 6974 3a20 696e 740a 2020 2020  _limit: int.    
+00016f10: 736f 6674 7761 7265 5f76 6572 7369 6f6e  software_version
+00016f20: 3a20 7374 720a 2020 2020 6c69 7665 7669  : str.    livevi
+00016f30: 6577 5f69 643a 2073 7472 0a0a 2020 2020  ew_id: str..    
+00016f40: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+00016f50: 2040 6361 6368 650a 2020 2020 6465 6620   @cache.    def 
+00016f60: 5f67 6574 5f75 6e69 6669 5f72 656d 6170  _get_unifi_remap
+00016f70: 7328 636c 7329 202d 3e20 6469 6374 5b73  s(cls) -> dict[s
+00016f80: 7472 2c20 7374 725d 3a0a 2020 2020 2020  tr, str]:.      
+00016f90: 2020 7265 7475 726e 207b 2a2a 7375 7065    return {**supe
+00016fa0: 7228 292e 5f67 6574 5f75 6e69 6669 5f72  r()._get_unifi_r
+00016fb0: 656d 6170 7328 292c 2022 6c69 7665 7669  emaps(), "livevi
+00016fc0: 6577 223a 2022 6c69 7665 7669 6577 4964  ew": "liveviewId
+00016fd0: 227d 0a0a 2020 2020 4063 6c61 7373 6d65  "}..    @classme
+00016fe0: 7468 6f64 0a20 2020 2040 6361 6368 650a  thod.    @cache.
+00016ff0: 2020 2020 6465 6620 5f67 6574 5f72 6561      def _get_rea
+00017000: 645f 6f6e 6c79 5f66 6965 6c64 7328 636c  d_only_fields(cl
+00017010: 7329 202d 3e20 7365 745b 7374 725d 3a0a  s) -> set[str]:.
+00017020: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00017030: 7570 6572 2829 2e5f 6765 745f 7265 6164  uper()._get_read
+00017040: 5f6f 6e6c 795f 6669 656c 6473 2829 207c  _only_fields() |
+00017050: 207b 2273 6f66 7477 6172 6556 6572 7369   {"softwareVersi
+00017060: 6f6e 227d 0a0a 2020 2020 4070 726f 7065  on"}..    @prope
+00017070: 7274 790a 2020 2020 6465 6620 6c69 7665  rty.    def live
+00017080: 7669 6577 2873 656c 6629 202d 3e20 4f70  view(self) -> Op
+00017090: 7469 6f6e 616c 5b4c 6976 6576 6965 775d  tional[Liveview]
+000170a0: 3a0a 2020 2020 2020 2020 2320 7573 6572  :.        # user
+000170b0: 206d 6179 206e 6f74 2068 6176 6520 7065   may not have pe
+000170c0: 726d 6973 7369 6f6e 2074 6f20 7365 6520  rmission to see 
+000170d0: 7468 6520 6c69 7665 7669 6577 0a20 2020  the liveview.   
+000170e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000170f0: 2e61 7069 2e62 6f6f 7473 7472 6170 2e6c  .api.bootstrap.l
+00017100: 6976 6576 6965 7773 2e67 6574 2873 656c  iveviews.get(sel
+00017110: 662e 6c69 7665 7669 6577 5f69 6429 0a0a  f.liveview_id)..
+00017120: 2020 2020 6173 796e 6320 6465 6620 7365      async def se
+00017130: 745f 6c69 7665 7669 6577 2873 656c 662c  t_liveview(self,
+00017140: 206c 6976 6576 6965 773a 204c 6976 6576   liveview: Livev
+00017150: 6965 7729 202d 3e20 4e6f 6e65 3a0a 2020  iew) -> None:.  
+00017160: 2020 2020 2020 2222 2253 6574 7320 7468        """Sets th
+00017170: 6520 6c69 7665 7669 6577 2063 7572 7265  e liveview curre
+00017180: 6e74 2073 6574 2066 6f72 2074 6865 2076  nt set for the v
+00017190: 6965 7765 720a 0a20 2020 2020 2020 2041  iewer..        A
+000171a0: 7267 733a 0a20 2020 2020 2020 202d 2d2d  rgs:.        ---
+000171b0: 2d0a 2020 2020 2020 2020 2020 2020 6c69  -.            li
+000171c0: 7665 7669 6577 3a20 5468 6520 6c69 7665  veview: The live
+000171d0: 7669 6577 2079 6f75 2077 616e 7420 746f  view you want to
+000171e0: 2073 6574 0a20 2020 2020 2020 2022 2222   set.        """
+000171f0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00017200: 662e 5f61 7069 2069 7320 6e6f 7420 4e6f  f._api is not No
+00017210: 6e65 2061 6e64 206c 6976 6576 6965 772e  ne and liveview.
+00017220: 6964 206e 6f74 2069 6e20 7365 6c66 2e5f  id not in self._
+00017230: 6170 692e 626f 6f74 7374 7261 702e 6c69  api.bootstrap.li
+00017240: 7665 7669 6577 733a 0a20 2020 2020 2020  veviews:.       
+00017250: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
+00017260: 7175 6573 7428 2255 6e6b 6e6f 776e 206c  quest("Unknown l
+00017270: 6976 6576 6965 7722 290a 0a20 2020 2020  iveview")..     
+00017280: 2020 2061 7379 6e63 2077 6974 6820 7365     async with se
+00017290: 6c66 2e5f 7570 6461 7465 5f6c 6f63 6b3a  lf._update_lock:
+000172a0: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
+000172b0: 6974 2061 7379 6e63 696f 2e73 6c65 6570  it asyncio.sleep
+000172c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000172d0: 2020 302c 0a20 2020 2020 2020 2020 2020    0,.           
+000172e0: 2029 2020 2320 7969 656c 6420 746f 2074   )  # yield to t
+000172f0: 6865 2065 7665 6e74 206c 6f6f 7020 6f6e  he event loop on
+00017300: 6365 2077 6520 6861 7665 2074 6865 206c  ce we have the l
+00017310: 6f63 6b20 746f 2070 726f 6365 7373 2061  ock to process a
+00017320: 6e79 2070 656e 6469 6e67 2075 7064 6174  ny pending updat
+00017330: 6573 0a20 2020 2020 2020 2020 2020 2064  es.            d
+00017340: 6174 615f 6265 666f 7265 5f63 6861 6e67  ata_before_chang
+00017350: 6573 203d 2073 656c 662e 6469 6374 5f77  es = self.dict_w
+00017360: 6974 685f 6578 636c 7564 6573 2829 0a20  ith_excludes(). 
+00017370: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00017380: 6c69 7665 7669 6577 5f69 6420 3d20 6c69  liveview_id = li
+00017390: 7665 7669 6577 2e69 640a 2020 2020 2020  veview.id.      
+000173a0: 2020 2020 2020 2320 556e 6946 6920 5072        # UniFi Pr
+000173b0: 6f74 6563 7420 6275 673a 2063 6861 6e67  otect bug: chang
+000173c0: 696e 6720 7468 6520 6c69 7665 7669 6577  ing the liveview
+000173d0: 2064 6f65 7320 5f6e 6f74 5f20 656d 6974   does _not_ emit
+000173e0: 2061 2057 5320 6d65 7373 6167 650a 2020   a WS message.  
+000173f0: 2020 2020 2020 2020 2020 6177 6169 7420            await 
+00017400: 7365 6c66 2e73 6176 655f 6465 7669 6365  self.save_device
+00017410: 2864 6174 615f 6265 666f 7265 5f63 6861  (data_before_cha
+00017420: 6e67 6573 2c20 666f 7263 655f 656d 6974  nges, force_emit
+00017430: 3d54 7275 6529 0a0a 0a63 6c61 7373 2042  =True)...class B
+00017440: 7269 6467 6528 5072 6f74 6563 7441 646f  ridge(ProtectAdo
+00017450: 7074 6162 6c65 4465 7669 6365 4d6f 6465  ptableDeviceMode
+00017460: 6c29 3a0a 2020 2020 706c 6174 666f 726d  l):.    platform
+00017470: 3a20 7374 720a 0a0a 636c 6173 7320 5365  : str...class Se
+00017480: 6e73 6f72 5365 7474 696e 6773 4261 7365  nsorSettingsBase
+00017490: 2850 726f 7465 6374 4261 7365 4f62 6a65  (ProtectBaseObje
+000174a0: 6374 293a 0a20 2020 2069 735f 656e 6162  ct):.    is_enab
+000174b0: 6c65 643a 2062 6f6f 6c0a 0a0a 636c 6173  led: bool...clas
+000174c0: 7320 5365 6e73 6f72 5468 7265 7368 6f6c  s SensorThreshol
+000174d0: 6453 6574 7469 6e67 7328 5365 6e73 6f72  dSettings(Sensor
+000174e0: 5365 7474 696e 6773 4261 7365 293a 0a20  SettingsBase):. 
+000174f0: 2020 206d 6172 6769 6e3a 2066 6c6f 6174     margin: float
+00017500: 2020 2320 7265 6164 206f 6e6c 790a 2020    # read only.  
+00017510: 2020 2320 2273 6166 6522 2074 6872 6573    # "safe" thres
+00017520: 686f 6c64 7320 666f 7220 616c 6572 7469  holds for alerti
+00017530: 6e67 0a20 2020 2023 2061 6e79 7468 696e  ng.    # anythin
+00017540: 6720 6265 6c6f 772f 6162 6f76 6520 7769  g below/above wi
+00017550: 6c6c 2074 7269 6767 6572 2061 6c65 7274  ll trigger alert
+00017560: 0a20 2020 206c 6f77 5f74 6872 6573 686f  .    low_thresho
+00017570: 6c64 3a20 4f70 7469 6f6e 616c 5b66 6c6f  ld: Optional[flo
+00017580: 6174 5d0a 2020 2020 6869 6768 5f74 6872  at].    high_thr
+00017590: 6573 686f 6c64 3a20 4f70 7469 6f6e 616c  eshold: Optional
+000175a0: 5b66 6c6f 6174 5d0a 0a0a 636c 6173 7320  [float]...class 
+000175b0: 5365 6e73 6f72 5365 6e73 6974 6976 6974  SensorSensitivit
+000175c0: 7953 6574 7469 6e67 7328 5365 6e73 6f72  ySettings(Sensor
+000175d0: 5365 7474 696e 6773 4261 7365 293a 0a20  SettingsBase):. 
+000175e0: 2020 2073 656e 7369 7469 7669 7479 3a20     sensitivity: 
+000175f0: 5065 7263 656e 7449 6e74 0a0a 0a63 6c61  PercentInt...cla
+00017600: 7373 2053 656e 736f 7242 6174 7465 7279  ss SensorBattery
+00017610: 5374 6174 7573 2850 726f 7465 6374 4261  Status(ProtectBa
+00017620: 7365 4f62 6a65 6374 293a 0a20 2020 2070  seObject):.    p
+00017630: 6572 6365 6e74 6167 653a 204f 7074 696f  ercentage: Optio
+00017640: 6e61 6c5b 5065 7263 656e 7449 6e74 5d0a  nal[PercentInt].
+00017650: 2020 2020 6973 5f6c 6f77 3a20 626f 6f6c      is_low: bool
+00017660: 0a0a 0a63 6c61 7373 2053 656e 736f 7253  ...class SensorS
+00017670: 7461 7428 5072 6f74 6563 7442 6173 654f  tat(ProtectBaseO
+00017680: 626a 6563 7429 3a0a 2020 2020 7661 6c75  bject):.    valu
+00017690: 653a 204f 7074 696f 6e61 6c5b 666c 6f61  e: Optional[floa
+000176a0: 745d 0a20 2020 2073 7461 7475 733a 2053  t].    status: S
+000176b0: 656e 736f 7253 7461 7475 7354 7970 650a  ensorStatusType.
+000176c0: 0a0a 636c 6173 7320 5365 6e73 6f72 5374  ..class SensorSt
+000176d0: 6174 7328 5072 6f74 6563 7442 6173 654f  ats(ProtectBaseO
+000176e0: 626a 6563 7429 3a0a 2020 2020 6c69 6768  bject):.    ligh
+000176f0: 743a 2053 656e 736f 7253 7461 740a 2020  t: SensorStat.  
+00017700: 2020 6875 6d69 6469 7479 3a20 5365 6e73    humidity: Sens
+00017710: 6f72 5374 6174 0a20 2020 2074 656d 7065  orStat.    tempe
+00017720: 7261 7475 7265 3a20 5365 6e73 6f72 5374  rature: SensorSt
+00017730: 6174 0a0a 0a63 6c61 7373 2053 656e 736f  at...class Senso
+00017740: 7228 5072 6f74 6563 7441 646f 7074 6162  r(ProtectAdoptab
+00017750: 6c65 4465 7669 6365 4d6f 6465 6c29 3a0a  leDeviceModel):.
+00017760: 2020 2020 616c 6172 6d5f 7365 7474 696e      alarm_settin
+00017770: 6773 3a20 5365 6e73 6f72 5365 7474 696e  gs: SensorSettin
+00017780: 6773 4261 7365 0a20 2020 2061 6c61 726d  gsBase.    alarm
+00017790: 5f74 7269 6767 6572 6564 5f61 743a 204f  _triggered_at: O
+000177a0: 7074 696f 6e61 6c5b 6461 7465 7469 6d65  ptional[datetime
+000177b0: 5d0a 2020 2020 6261 7474 6572 795f 7374  ].    battery_st
+000177c0: 6174 7573 3a20 5365 6e73 6f72 4261 7474  atus: SensorBatt
+000177d0: 6572 7953 7461 7475 730a 2020 2020 6361  eryStatus.    ca
+000177e0: 6d65 7261 5f69 643a 204f 7074 696f 6e61  mera_id: Optiona
+000177f0: 6c5b 7374 725d 0a20 2020 2068 756d 6964  l[str].    humid
+00017800: 6974 795f 7365 7474 696e 6773 3a20 5365  ity_settings: Se
+00017810: 6e73 6f72 5468 7265 7368 6f6c 6453 6574  nsorThresholdSet
+00017820: 7469 6e67 730a 2020 2020 6973 5f6d 6f74  tings.    is_mot
+00017830: 696f 6e5f 6465 7465 6374 6564 3a20 626f  ion_detected: bo
+00017840: 6f6c 0a20 2020 2069 735f 6f70 656e 6564  ol.    is_opened
+00017850: 3a20 626f 6f6c 0a20 2020 206c 6561 6b5f  : bool.    leak_
+00017860: 6465 7465 6374 6564 5f61 743a 204f 7074  detected_at: Opt
+00017870: 696f 6e61 6c5b 6461 7465 7469 6d65 5d0a  ional[datetime].
+00017880: 2020 2020 6c65 645f 7365 7474 696e 6773      led_settings
+00017890: 3a20 5365 6e73 6f72 5365 7474 696e 6773  : SensorSettings
+000178a0: 4261 7365 0a20 2020 206c 6967 6874 5f73  Base.    light_s
+000178b0: 6574 7469 6e67 733a 2053 656e 736f 7254  ettings: SensorT
+000178c0: 6872 6573 686f 6c64 5365 7474 696e 6773  hresholdSettings
+000178d0: 0a20 2020 206d 6f74 696f 6e5f 6465 7465  .    motion_dete
+000178e0: 6374 6564 5f61 743a 204f 7074 696f 6e61  cted_at: Optiona
+000178f0: 6c5b 6461 7465 7469 6d65 5d0a 2020 2020  l[datetime].    
+00017900: 6d6f 7469 6f6e 5f73 6574 7469 6e67 733a  motion_settings:
+00017910: 2053 656e 736f 7253 656e 7369 7469 7669   SensorSensitivi
+00017920: 7479 5365 7474 696e 6773 0a20 2020 206f  tySettings.    o
+00017930: 7065 6e5f 7374 6174 7573 5f63 6861 6e67  pen_status_chang
+00017940: 6564 5f61 743a 204f 7074 696f 6e61 6c5b  ed_at: Optional[
+00017950: 6461 7465 7469 6d65 5d0a 2020 2020 7374  datetime].    st
+00017960: 6174 733a 2053 656e 736f 7253 7461 7473  ats: SensorStats
+00017970: 0a20 2020 2074 616d 7065 7269 6e67 5f64  .    tampering_d
+00017980: 6574 6563 7465 645f 6174 3a20 4f70 7469  etected_at: Opti
+00017990: 6f6e 616c 5b64 6174 6574 696d 655d 0a20  onal[datetime]. 
+000179a0: 2020 2074 656d 7065 7261 7475 7265 5f73     temperature_s
+000179b0: 6574 7469 6e67 733a 2053 656e 736f 7254  ettings: SensorT
+000179c0: 6872 6573 686f 6c64 5365 7474 696e 6773  hresholdSettings
+000179d0: 0a20 2020 206d 6f75 6e74 5f74 7970 653a  .    mount_type:
+000179e0: 204d 6f75 6e74 5479 7065 0a0a 2020 2020   MountType..    
+000179f0: 2320 6e6f 7420 6469 7265 6374 6c79 2066  # not directly f
+00017a00: 726f 6d20 556e 6946 690a 2020 2020 6c61  rom UniFi.    la
+00017a10: 7374 5f6d 6f74 696f 6e5f 6576 656e 745f  st_motion_event_
+00017a20: 6964 3a20 4f70 7469 6f6e 616c 5b73 7472  id: Optional[str
+00017a30: 5d20 3d20 4e6f 6e65 0a20 2020 206c 6173  ] = None.    las
+00017a40: 745f 636f 6e74 6163 745f 6576 656e 745f  t_contact_event_
+00017a50: 6964 3a20 4f70 7469 6f6e 616c 5b73 7472  id: Optional[str
+00017a60: 5d20 3d20 4e6f 6e65 0a20 2020 206c 6173  ] = None.    las
+00017a70: 745f 7661 6c75 655f 6576 656e 745f 6964  t_value_event_id
+00017a80: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00017a90: 3d20 4e6f 6e65 0a20 2020 206c 6173 745f  = None.    last_
+00017aa0: 616c 6172 6d5f 6576 656e 745f 6964 3a20  alarm_event_id: 
+00017ab0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00017ac0: 4e6f 6e65 0a20 2020 2065 7874 7265 6d65  None.    extreme
+00017ad0: 5f76 616c 7565 5f64 6574 6563 7465 645f  _value_detected_
+00017ae0: 6174 3a20 4f70 7469 6f6e 616c 5b64 6174  at: Optional[dat
+00017af0: 6574 696d 655d 203d 204e 6f6e 650a 2020  etime] = None.  
+00017b00: 2020 5f74 616d 7065 725f 7469 6d65 6f75    _tamper_timeou
+00017b10: 743a 204f 7074 696f 6e61 6c5b 6461 7465  t: Optional[date
+00017b20: 7469 6d65 5d20 3d20 5072 6976 6174 6541  time] = PrivateA
+00017b30: 7474 7228 4e6f 6e65 290a 2020 2020 5f61  ttr(None).    _a
+00017b40: 6c61 726d 5f74 696d 656f 7574 3a20 4f70  larm_timeout: Op
+00017b50: 7469 6f6e 616c 5b64 6174 6574 696d 655d  tional[datetime]
+00017b60: 203d 2050 7269 7661 7465 4174 7472 284e   = PrivateAttr(N
+00017b70: 6f6e 6529 0a0a 2020 2020 4063 6c61 7373  one)..    @class
+00017b80: 6d65 7468 6f64 0a20 2020 2040 6361 6368  method.    @cach
+00017b90: 650a 2020 2020 6465 6620 5f67 6574 5f75  e.    def _get_u
+00017ba0: 6e69 6669 5f72 656d 6170 7328 636c 7329  nifi_remaps(cls)
+00017bb0: 202d 3e20 6469 6374 5b73 7472 2c20 7374   -> dict[str, st
+00017bc0: 725d 3a0a 2020 2020 2020 2020 7265 7475  r]:.        retu
+00017bd0: 726e 207b 2a2a 7375 7065 7228 292e 5f67  rn {**super()._g
+00017be0: 6574 5f75 6e69 6669 5f72 656d 6170 7328  et_unifi_remaps(
+00017bf0: 292c 2022 6361 6d65 7261 223a 2022 6361  ), "camera": "ca
+00017c00: 6d65 7261 4964 227d 0a0a 2020 2020 4063  meraId"}..    @c
+00017c10: 6c61 7373 6d65 7468 6f64 0a20 2020 2040  lassmethod.    @
+00017c20: 6361 6368 650a 2020 2020 6465 6620 5f67  cache.    def _g
+00017c30: 6574 5f72 6561 645f 6f6e 6c79 5f66 6965  et_read_only_fie
+00017c40: 6c64 7328 636c 7329 202d 3e20 7365 745b  lds(cls) -> set[
+00017c50: 7374 725d 3a0a 2020 2020 2020 2020 7265  str]:.        re
+00017c60: 7475 726e 2073 7570 6572 2829 2e5f 6765  turn super()._ge
+00017c70: 745f 7265 6164 5f6f 6e6c 795f 6669 656c  t_read_only_fiel
+00017c80: 6473 2829 207c 207b 0a20 2020 2020 2020  ds() | {.       
+00017c90: 2020 2020 2022 6261 7474 6572 7953 7461       "batterySta
+00017ca0: 7475 7322 2c0a 2020 2020 2020 2020 2020  tus",.          
+00017cb0: 2020 2269 734d 6f74 696f 6e44 6574 6563    "isMotionDetec
+00017cc0: 7465 6422 2c0a 2020 2020 2020 2020 2020  ted",.          
+00017cd0: 2020 226c 6561 6b44 6574 6563 7465 6441    "leakDetectedA
+00017ce0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00017cf0: 2274 616d 7065 7269 6e67 4465 7465 6374  "tamperingDetect
+00017d00: 6564 4174 222c 0a20 2020 2020 2020 2020  edAt",.         
+00017d10: 2020 2022 6973 4f70 656e 6564 222c 0a20     "isOpened",. 
+00017d20: 2020 2020 2020 2020 2020 2022 6f70 656e             "open
+00017d30: 5374 6174 7573 4368 616e 6765 6441 7422  StatusChangedAt"
+00017d40: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+00017d50: 6c61 726d 5472 6967 6765 7265 6441 7422  larmTriggeredAt"
+00017d60: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00017d70: 6f74 696f 6e44 6574 6563 7465 6441 7422  otionDetectedAt"
+00017d80: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+00017d90: 7461 7473 222c 0a20 2020 2020 2020 207d  tats",.        }
+00017da0: 0a0a 2020 2020 6465 6620 756e 6966 695f  ..    def unifi_
+00017db0: 6469 6374 280a 2020 2020 2020 2020 7365  dict(.        se
+00017dc0: 6c66 2c0a 2020 2020 2020 2020 6461 7461  lf,.        data
+00017dd0: 3a20 4f70 7469 6f6e 616c 5b64 6963 745b  : Optional[dict[
+00017de0: 7374 722c 2041 6e79 5d5d 203d 204e 6f6e  str, Any]] = Non
+00017df0: 652c 0a20 2020 2020 2020 2065 7863 6c75  e,.        exclu
+00017e00: 6465 3a20 4f70 7469 6f6e 616c 5b73 6574  de: Optional[set
+00017e10: 5b73 7472 5d5d 203d 204e 6f6e 652c 0a20  [str]] = None,. 
+00017e20: 2020 2029 202d 3e20 6469 6374 5b73 7472     ) -> dict[str
+00017e30: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
+00017e40: 6461 7461 203d 2073 7570 6572 2829 2e75  data = super().u
+00017e50: 6e69 6669 5f64 6963 7428 6461 7461 3d64  nifi_dict(data=d
+00017e60: 6174 612c 2065 7863 6c75 6465 3d65 7863  ata, exclude=exc
+00017e70: 6c75 6465 290a 0a20 2020 2020 2020 2069  lude)..        i
+00017e80: 6620 226c 6173 744d 6f74 696f 6e45 7665  f "lastMotionEve
+00017e90: 6e74 4964 2220 696e 2064 6174 613a 0a20  ntId" in data:. 
+00017ea0: 2020 2020 2020 2020 2020 2064 656c 2064             del d
+00017eb0: 6174 615b 226c 6173 744d 6f74 696f 6e45  ata["lastMotionE
+00017ec0: 7665 6e74 4964 225d 0a20 2020 2020 2020  ventId"].       
+00017ed0: 2069 6620 226c 6173 7443 6f6e 7461 6374   if "lastContact
+00017ee0: 4576 656e 7449 6422 2069 6e20 6461 7461  EventId" in data
+00017ef0: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+00017f00: 6c20 6461 7461 5b22 6c61 7374 436f 6e74  l data["lastCont
+00017f10: 6163 7445 7665 6e74 4964 225d 0a20 2020  actEventId"].   
+00017f20: 2020 2020 2069 6620 226c 6173 7456 616c       if "lastVal
+00017f30: 7565 4576 656e 7449 6422 2069 6e20 6461  ueEventId" in da
+00017f40: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
+00017f50: 6465 6c20 6461 7461 5b22 6c61 7374 5661  del data["lastVa
+00017f60: 6c75 6545 7665 6e74 4964 225d 0a20 2020  lueEventId"].   
+00017f70: 2020 2020 2069 6620 226c 6173 7441 6c61       if "lastAla
+00017f80: 726d 4576 656e 7449 6422 2069 6e20 6461  rmEventId" in da
+00017f90: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
+00017fa0: 6465 6c20 6461 7461 5b22 6c61 7374 416c  del data["lastAl
+00017fb0: 6172 6d45 7665 6e74 4964 225d 0a20 2020  armEventId"].   
+00017fc0: 2020 2020 2069 6620 2265 7874 7265 6d65       if "extreme
+00017fd0: 5661 6c75 6544 6574 6563 7465 6441 7422  ValueDetectedAt"
+00017fe0: 2069 6e20 6461 7461 3a0a 2020 2020 2020   in data:.      
+00017ff0: 2020 2020 2020 6465 6c20 6461 7461 5b22        del data["
+00018000: 6578 7472 656d 6556 616c 7565 4465 7465  extremeValueDete
+00018010: 6374 6564 4174 225d 0a0a 2020 2020 2020  ctedAt"]..      
+00018020: 2020 7265 7475 726e 2064 6174 610a 0a20    return data.. 
+00018030: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00018040: 2064 6566 2063 616d 6572 6128 7365 6c66   def camera(self
+00018050: 2920 2d3e 204f 7074 696f 6e61 6c5b 4361  ) -> Optional[Ca
+00018060: 6d65 7261 5d3a 0a20 2020 2020 2020 2022  mera]:.        "
+00018070: 2222 5061 6972 6564 2043 616d 6572 6120  ""Paired Camera 
+00018080: 7769 6c6c 2061 6c77 6179 7320 6265 206e  will always be n
+00018090: 6f6e 6520 6966 206e 6f20 6361 6d65 7261  one if no camera
+000180a0: 2069 7320 7061 6972 6564 2222 220a 0a20   is paired""".. 
+000180b0: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+000180c0: 616d 6572 615f 6964 2069 7320 4e6f 6e65  amera_id is None
+000180d0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000180e0: 7475 726e 204e 6f6e 650a 0a20 2020 2020  turn None..     
+000180f0: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
+00018100: 7069 2e62 6f6f 7473 7472 6170 2e63 616d  pi.bootstrap.cam
+00018110: 6572 6173 5b73 656c 662e 6361 6d65 7261  eras[self.camera
+00018120: 5f69 645d 0a0a 2020 2020 4070 726f 7065  _id]..    @prope
+00018130: 7274 790a 2020 2020 6465 6620 6973 5f74  rty.    def is_t
+00018140: 616d 7065 7269 6e67 5f64 6574 6563 7465  ampering_detecte
+00018150: 6428 7365 6c66 2920 2d3e 2062 6f6f 6c3a  d(self) -> bool:
+00018160: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00018170: 7365 6c66 2e74 616d 7065 7269 6e67 5f64  self.tampering_d
+00018180: 6574 6563 7465 645f 6174 2069 7320 6e6f  etected_at is no
+00018190: 7420 4e6f 6e65 0a0a 2020 2020 4070 726f  t None..    @pro
+000181a0: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
+000181b0: 5f61 6c61 726d 5f64 6574 6563 7465 6428  _alarm_detected(
+000181c0: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+000181d0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+000181e0: 616c 6172 6d5f 7469 6d65 6f75 7420 6973  alarm_timeout is
+000181f0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00018200: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+00018210: 2020 2020 2020 2020 7265 7475 726e 2075          return u
+00018220: 7463 5f6e 6f77 2829 203c 2073 656c 662e  tc_now() < self.
+00018230: 5f61 6c61 726d 5f74 696d 656f 7574 0a0a  _alarm_timeout..
+00018240: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00018250: 2020 6465 6620 6973 5f63 6f6e 7461 6374    def is_contact
+00018260: 5f73 656e 736f 725f 656e 6162 6c65 6428  _sensor_enabled(
+00018270: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+00018280: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00018290: 6c66 2e6d 6f75 6e74 5f74 7970 6520 696e  lf.mount_type in
+000182a0: 207b 4d6f 756e 7454 7970 652e 444f 4f52   {MountType.DOOR
+000182b0: 2c20 4d6f 756e 7454 7970 652e 5749 4e44  , MountType.WIND
+000182c0: 4f57 2c20 4d6f 756e 7454 7970 652e 4741  OW, MountType.GA
+000182d0: 5241 4745 7d0a 0a20 2020 2040 7072 6f70  RAGE}..    @prop
+000182e0: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
+000182f0: 6d6f 7469 6f6e 5f73 656e 736f 725f 656e  motion_sensor_en
+00018300: 6162 6c65 6428 7365 6c66 2920 2d3e 2062  abled(self) -> b
+00018310: 6f6f 6c3a 0a20 2020 2020 2020 2072 6574  ool:.        ret
+00018320: 7572 6e20 7365 6c66 2e6d 6f75 6e74 5f74  urn self.mount_t
+00018330: 7970 6520 213d 204d 6f75 6e74 5479 7065  ype != MountType
+00018340: 2e4c 4541 4b20 616e 6420 7365 6c66 2e6d  .LEAK and self.m
+00018350: 6f74 696f 6e5f 7365 7474 696e 6773 2e69  otion_settings.i
+00018360: 735f 656e 6162 6c65 640a 0a20 2020 2040  s_enabled..    @
+00018370: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00018380: 2069 735f 616c 6172 6d5f 7365 6e73 6f72   is_alarm_sensor
+00018390: 5f65 6e61 626c 6564 2873 656c 6629 202d  _enabled(self) -
+000183a0: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
+000183b0: 7265 7475 726e 2073 656c 662e 6d6f 756e  return self.moun
+000183c0: 745f 7479 7065 2021 3d20 4d6f 756e 7454  t_type != MountT
+000183d0: 7970 652e 4c45 414b 2061 6e64 2073 656c  ype.LEAK and sel
+000183e0: 662e 616c 6172 6d5f 7365 7474 696e 6773  f.alarm_settings
+000183f0: 2e69 735f 656e 6162 6c65 640a 0a20 2020  .is_enabled..   
+00018400: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00018410: 6566 2069 735f 6c69 6768 745f 7365 6e73  ef is_light_sens
+00018420: 6f72 5f65 6e61 626c 6564 2873 656c 6629  or_enabled(self)
+00018430: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
+00018440: 2020 7265 7475 726e 2073 656c 662e 6d6f    return self.mo
+00018450: 756e 745f 7479 7065 2021 3d20 4d6f 756e  unt_type != Moun
+00018460: 7454 7970 652e 4c45 414b 2061 6e64 2073  tType.LEAK and s
+00018470: 656c 662e 6c69 6768 745f 7365 7474 696e  elf.light_settin
+00018480: 6773 2e69 735f 656e 6162 6c65 640a 0a20  gs.is_enabled.. 
+00018490: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+000184a0: 2064 6566 2069 735f 7465 6d70 6572 6174   def is_temperat
+000184b0: 7572 655f 7365 6e73 6f72 5f65 6e61 626c  ure_sensor_enabl
+000184c0: 6564 2873 656c 6629 202d 3e20 626f 6f6c  ed(self) -> bool
+000184d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000184e0: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
+000184f0: 656c 662e 6d6f 756e 745f 7479 7065 2021  elf.mount_type !
+00018500: 3d20 4d6f 756e 7454 7970 652e 4c45 414b  = MountType.LEAK
+00018510: 2061 6e64 2073 656c 662e 7465 6d70 6572   and self.temper
+00018520: 6174 7572 655f 7365 7474 696e 6773 2e69  ature_settings.i
+00018530: 735f 656e 6162 6c65 640a 2020 2020 2020  s_enabled.      
+00018540: 2020 290a 0a20 2020 2040 7072 6f70 6572    )..    @proper
+00018550: 7479 0a20 2020 2064 6566 2069 735f 6875  ty.    def is_hu
+00018560: 6d69 6469 7479 5f73 656e 736f 725f 656e  midity_sensor_en
+00018570: 6162 6c65 6428 7365 6c66 2920 2d3e 2062  abled(self) -> b
+00018580: 6f6f 6c3a 0a20 2020 2020 2020 2072 6574  ool:.        ret
+00018590: 7572 6e20 7365 6c66 2e6d 6f75 6e74 5f74  urn self.mount_t
+000185a0: 7970 6520 213d 204d 6f75 6e74 5479 7065  ype != MountType
+000185b0: 2e4c 4541 4b20 616e 6420 7365 6c66 2e68  .LEAK and self.h
+000185c0: 756d 6964 6974 795f 7365 7474 696e 6773  umidity_settings
+000185d0: 2e69 735f 656e 6162 6c65 640a 0a20 2020  .is_enabled..   
+000185e0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000185f0: 6566 2069 735f 6c65 616b 5f73 656e 736f  ef is_leak_senso
+00018600: 725f 656e 6162 6c65 6428 7365 6c66 2920  r_enabled(self) 
+00018610: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+00018620: 2072 6574 7572 6e20 7365 6c66 2e6d 6f75   return self.mou
+00018630: 6e74 5f74 7970 6520 6973 204d 6f75 6e74  nt_type is Mount
+00018640: 5479 7065 2e4c 4541 4b0a 0a20 2020 2064  Type.LEAK..    d
+00018650: 6566 2073 6574 5f61 6c61 726d 5f74 696d  ef set_alarm_tim
+00018660: 656f 7574 2873 656c 6629 202d 3e20 4e6f  eout(self) -> No
+00018670: 6e65 3a0a 2020 2020 2020 2020 7365 6c66  ne:.        self
+00018680: 2e5f 616c 6172 6d5f 7469 6d65 6f75 7420  ._alarm_timeout 
+00018690: 3d20 7574 635f 6e6f 7728 2920 2b20 4556  = utc_now() + EV
+000186a0: 454e 545f 5049 4e47 5f49 4e54 4552 5641  ENT_PING_INTERVA
+000186b0: 4c0a 2020 2020 2020 2020 7365 6c66 2e5f  L.        self._
+000186c0: 6576 656e 745f 6361 6c6c 6261 636b 5f70  event_callback_p
+000186d0: 696e 6728 290a 0a20 2020 2040 7072 6f70  ing()..    @prop
+000186e0: 6572 7479 0a20 2020 2064 6566 206c 6173  erty.    def las
+000186f0: 745f 6d6f 7469 6f6e 5f65 7665 6e74 2873  t_motion_event(s
+00018700: 656c 6629 202d 3e20 4f70 7469 6f6e 616c  elf) -> Optional
+00018710: 5b45 7665 6e74 5d3a 0a20 2020 2020 2020  [Event]:.       
+00018720: 2069 6620 7365 6c66 2e6c 6173 745f 6d6f   if self.last_mo
+00018730: 7469 6f6e 5f65 7665 6e74 5f69 6420 6973  tion_event_id is
+00018740: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00018750: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
+00018760: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00018770: 656c 662e 6170 692e 626f 6f74 7374 7261  elf.api.bootstra
+00018780: 702e 6576 656e 7473 2e67 6574 2873 656c  p.events.get(sel
+00018790: 662e 6c61 7374 5f6d 6f74 696f 6e5f 6576  f.last_motion_ev
+000187a0: 656e 745f 6964 290a 0a20 2020 2040 7072  ent_id)..    @pr
+000187b0: 6f70 6572 7479 0a20 2020 2064 6566 206c  operty.    def l
+000187c0: 6173 745f 636f 6e74 6163 745f 6576 656e  ast_contact_even
+000187d0: 7428 7365 6c66 2920 2d3e 204f 7074 696f  t(self) -> Optio
+000187e0: 6e61 6c5b 4576 656e 745d 3a0a 2020 2020  nal[Event]:.    
+000187f0: 2020 2020 6966 2073 656c 662e 6c61 7374      if self.last
+00018800: 5f63 6f6e 7461 6374 5f65 7665 6e74 5f69  _contact_event_i
+00018810: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
+00018820: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00018830: 6e65 0a0a 2020 2020 2020 2020 7265 7475  ne..        retu
+00018840: 726e 2073 656c 662e 6170 692e 626f 6f74  rn self.api.boot
+00018850: 7374 7261 702e 6576 656e 7473 2e67 6574  strap.events.get
+00018860: 2873 656c 662e 6c61 7374 5f63 6f6e 7461  (self.last_conta
+00018870: 6374 5f65 7665 6e74 5f69 6429 0a0a 2020  ct_event_id)..  
+00018880: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00018890: 6465 6620 6c61 7374 5f76 616c 7565 5f65  def last_value_e
+000188a0: 7665 6e74 2873 656c 6629 202d 3e20 4f70  vent(self) -> Op
+000188b0: 7469 6f6e 616c 5b45 7665 6e74 5d3a 0a20  tional[Event]:. 
+000188c0: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
+000188d0: 6173 745f 7661 6c75 655f 6576 656e 745f  ast_value_event_
+000188e0: 6964 2069 7320 4e6f 6e65 3a0a 2020 2020  id is None:.    
+000188f0: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00018900: 6f6e 650a 0a20 2020 2020 2020 2072 6574  one..        ret
+00018910: 7572 6e20 7365 6c66 2e61 7069 2e62 6f6f  urn self.api.boo
+00018920: 7473 7472 6170 2e65 7665 6e74 732e 6765  tstrap.events.ge
+00018930: 7428 7365 6c66 2e6c 6173 745f 7661 6c75  t(self.last_valu
+00018940: 655f 6576 656e 745f 6964 290a 0a20 2020  e_event_id)..   
+00018950: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00018960: 6566 206c 6173 745f 616c 6172 6d5f 6576  ef last_alarm_ev
+00018970: 656e 7428 7365 6c66 2920 2d3e 204f 7074  ent(self) -> Opt
+00018980: 696f 6e61 6c5b 4576 656e 745d 3a0a 2020  ional[Event]:.  
+00018990: 2020 2020 2020 6966 2073 656c 662e 6c61        if self.la
+000189a0: 7374 5f61 6c61 726d 5f65 7665 6e74 5f69  st_alarm_event_i
+000189b0: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
+000189c0: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+000189d0: 6e65 0a0a 2020 2020 2020 2020 7265 7475  ne..        retu
+000189e0: 726e 2073 656c 662e 6170 692e 626f 6f74  rn self.api.boot
+000189f0: 7374 7261 702e 6576 656e 7473 2e67 6574  strap.events.get
+00018a00: 2873 656c 662e 6c61 7374 5f61 6c61 726d  (self.last_alarm
+00018a10: 5f65 7665 6e74 5f69 6429 0a0a 2020 2020  _event_id)..    
+00018a20: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00018a30: 6620 6973 5f6c 6561 6b5f 6465 7465 6374  f is_leak_detect
+00018a40: 6564 2873 656c 6629 202d 3e20 626f 6f6c  ed(self) -> bool
+00018a50: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00018a60: 2073 656c 662e 6c65 616b 5f64 6574 6563   self.leak_detec
+00018a70: 7465 645f 6174 2069 7320 6e6f 7420 4e6f  ted_at is not No
+00018a80: 6e65 0a0a 2020 2020 6173 796e 6320 6465  ne..    async de
+00018a90: 6620 7365 745f 7374 6174 7573 5f6c 6967  f set_status_lig
+00018aa0: 6874 2873 656c 662c 2065 6e61 626c 6564  ht(self, enabled
+00018ab0: 3a20 626f 6f6c 2920 2d3e 204e 6f6e 653a  : bool) -> None:
+00018ac0: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
+00018ad0: 2074 6865 2073 7461 7475 7320 696e 6469   the status indi
+00018ae0: 6361 746f 7220 6c69 6768 7420 666f 7220  cator light for 
+00018af0: 7468 6520 7365 6e73 6f72 2222 220a 0a20  the sensor""".. 
+00018b00: 2020 2020 2020 2064 6566 2063 616c 6c62         def callb
+00018b10: 6163 6b28 2920 2d3e 204e 6f6e 653a 0a20  ack() -> None:. 
+00018b20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018b30: 6c65 645f 7365 7474 696e 6773 2e69 735f  led_settings.is_
+00018b40: 656e 6162 6c65 6420 3d20 656e 6162 6c65  enabled = enable
+00018b50: 640a 0a20 2020 2020 2020 2061 7761 6974  d..        await
+00018b60: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
+00018b70: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
+00018b80: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
+00018b90: 6d6f 756e 745f 7479 7065 2873 656c 662c  mount_type(self,
+00018ba0: 206d 6f75 6e74 5f74 7970 653a 204d 6f75   mount_type: Mou
+00018bb0: 6e74 5479 7065 2920 2d3e 204e 6f6e 653a  ntType) -> None:
+00018bc0: 0a20 2020 2020 2020 2022 2222 5365 7473  .        """Sets
+00018bd0: 2063 7572 7265 6e74 206d 6f75 6e74 2074   current mount t
+00018be0: 7970 6520 666f 7220 7365 6e73 6f72 2222  ype for sensor""
+00018bf0: 220a 0a20 2020 2020 2020 2064 6566 2063  "..        def c
+00018c00: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
+00018c10: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00018c20: 656c 662e 6d6f 756e 745f 7479 7065 203d  elf.mount_type =
+00018c30: 206d 6f75 6e74 5f74 7970 650a 0a20 2020   mount_type..   
+00018c40: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
+00018c50: 7175 6575 655f 7570 6461 7465 2863 616c  queue_update(cal
+00018c60: 6c62 6163 6b29 0a0a 2020 2020 6173 796e  lback)..    asyn
+00018c70: 6320 6465 6620 7365 745f 6d6f 7469 6f6e  c def set_motion
+00018c80: 5f73 7461 7475 7328 7365 6c66 2c20 656e  _status(self, en
+00018c90: 6162 6c65 643a 2062 6f6f 6c29 202d 3e20  abled: bool) -> 
+00018ca0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00018cb0: 2253 6574 7320 7468 6520 6d6f 7469 6f6e  "Sets the motion
+00018cc0: 2064 6574 6563 7469 6f6e 2074 7970 6520   detection type 
+00018cd0: 666f 7220 7468 6520 7365 6e73 6f72 2222  for the sensor""
+00018ce0: 220a 0a20 2020 2020 2020 2064 6566 2063  "..        def c
+00018cf0: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
+00018d00: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00018d10: 656c 662e 6d6f 7469 6f6e 5f73 6574 7469  elf.motion_setti
+00018d20: 6e67 732e 6973 5f65 6e61 626c 6564 203d  ngs.is_enabled =
+00018d30: 2065 6e61 626c 6564 0a0a 2020 2020 2020   enabled..      
+00018d40: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
+00018d50: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
+00018d60: 636b 290a 0a20 2020 2061 7379 6e63 2064  ck)..    async d
+00018d70: 6566 2073 6574 5f6d 6f74 696f 6e5f 7365  ef set_motion_se
+00018d80: 6e73 6974 6976 6974 7928 7365 6c66 2c20  nsitivity(self, 
+00018d90: 7365 6e73 6974 6976 6974 793a 2069 6e74  sensitivity: int
+00018da0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00018db0: 2020 2022 2222 5365 7473 2074 6865 206d     """Sets the m
+00018dc0: 6f74 696f 6e20 7365 6e73 6974 6976 6974  otion sensitivit
+00018dd0: 7920 666f 7220 7468 6520 7365 6e73 6f72  y for the sensor
+00018de0: 2222 220a 0a20 2020 2020 2020 2064 6566  """..        def
+00018df0: 2063 616c 6c62 6163 6b28 2920 2d3e 204e   callback() -> N
+00018e00: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00018e10: 2073 656c 662e 6d6f 7469 6f6e 5f73 6574   self.motion_set
+00018e20: 7469 6e67 732e 7365 6e73 6974 6976 6974  tings.sensitivit
+00018e30: 7920 3d20 5065 7263 656e 7449 6e74 2873  y = PercentInt(s
+00018e40: 656e 7369 7469 7669 7479 290a 0a20 2020  ensitivity)..   
+00018e50: 2020 2020 2061 7761 6974 2073 656c 662e       await self.
+00018e60: 7175 6575 655f 7570 6461 7465 2863 616c  queue_update(cal
+00018e70: 6c62 6163 6b29 0a0a 2020 2020 6173 796e  lback)..    asyn
+00018e80: 6320 6465 6620 7365 745f 7465 6d70 6572  c def set_temper
+00018e90: 6174 7572 655f 7374 6174 7573 2873 656c  ature_status(sel
+00018ea0: 662c 2065 6e61 626c 6564 3a20 626f 6f6c  f, enabled: bool
+00018eb0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00018ec0: 2020 2022 2222 5365 7473 2074 6865 2074     """Sets the t
+00018ed0: 656d 7065 7261 7475 7265 2064 6574 6563  emperature detec
+00018ee0: 7469 6f6e 2074 7970 6520 666f 7220 7468  tion type for th
+00018ef0: 6520 7365 6e73 6f72 2222 220a 0a20 2020  e sensor"""..   
+00018f00: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
+00018f10: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
+00018f20: 2020 2020 2020 2020 2073 656c 662e 7465           self.te
+00018f30: 6d70 6572 6174 7572 655f 7365 7474 696e  mperature_settin
+00018f40: 6773 2e69 735f 656e 6162 6c65 6420 3d20  gs.is_enabled = 
+00018f50: 656e 6162 6c65 640a 0a20 2020 2020 2020  enabled..       
+00018f60: 2061 7761 6974 2073 656c 662e 7175 6575   await self.queu
+00018f70: 655f 7570 6461 7465 2863 616c 6c62 6163  e_update(callbac
+00018f80: 6b29 0a0a 2020 2020 6173 796e 6320 6465  k)..    async de
+00018f90: 6620 7365 745f 7465 6d70 6572 6174 7572  f set_temperatur
+00018fa0: 655f 7361 6665 5f72 616e 6765 2873 656c  e_safe_range(sel
+00018fb0: 662c 206c 6f77 3a20 666c 6f61 742c 2068  f, low: float, h
+00018fc0: 6967 683a 2066 6c6f 6174 2920 2d3e 204e  igh: float) -> N
+00018fd0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+00018fe0: 5365 7473 2074 6865 2074 656d 7065 7261  Sets the tempera
+00018ff0: 7475 7265 2073 6166 6520 7261 6e67 6520  ture safe range 
+00019000: 666f 7220 7468 6520 7365 6e73 6f72 2222  for the sensor""
+00019010: 220a 0a20 2020 2020 2020 2069 6620 6c6f  "..        if lo
+00019020: 7720 3c20 302e 303a 0a20 2020 2020 2020  w < 0.0:.       
+00019030: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
+00019040: 7175 6573 7428 224d 696e 696d 756d 2076  quest("Minimum v
+00019050: 616c 7565 2069 7320 30c2 b043 2229 0a20  alue is 0..C"). 
+00019060: 2020 2020 2020 2069 6620 6869 6768 203e         if high >
+00019070: 2034 352e 303a 0a20 2020 2020 2020 2020   45.0:.         
+00019080: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
+00019090: 6573 7428 224d 6178 696d 756d 2076 616c  est("Maximum val
+000190a0: 7565 2069 7320 3435 c2b0 4322 290a 2020  ue is 45..C").  
+000190b0: 2020 2020 2020 6966 2068 6967 6820 3c3d        if high <=
+000190c0: 206c 6f77 3a0a 2020 2020 2020 2020 2020   low:.          
+000190d0: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
+000190e0: 7374 2822 4869 6768 2076 616c 7565 206d  st("High value m
+000190f0: 7573 7420 6265 2061 626f 7665 206c 6f77  ust be above low
+00019100: 2076 616c 7565 2229 0a0a 2020 2020 2020   value")..      
+00019110: 2020 6465 6620 6361 6c6c 6261 636b 2829    def callback()
+00019120: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00019130: 2020 2020 2020 7365 6c66 2e74 656d 7065        self.tempe
+00019140: 7261 7475 7265 5f73 6574 7469 6e67 732e  rature_settings.
+00019150: 6c6f 775f 7468 7265 7368 6f6c 6420 3d20  low_threshold = 
+00019160: 6c6f 770a 2020 2020 2020 2020 2020 2020  low.            
+00019170: 7365 6c66 2e74 656d 7065 7261 7475 7265  self.temperature
+00019180: 5f73 6574 7469 6e67 732e 6869 6768 5f74  _settings.high_t
+00019190: 6872 6573 686f 6c64 203d 2068 6967 680a  hreshold = high.
+000191a0: 0a20 2020 2020 2020 2061 7761 6974 2073  .        await s
+000191b0: 656c 662e 7175 6575 655f 7570 6461 7465  elf.queue_update
+000191c0: 2863 616c 6c62 6163 6b29 0a0a 2020 2020  (callback)..    
+000191d0: 6173 796e 6320 6465 6620 7265 6d6f 7665  async def remove
+000191e0: 5f74 656d 7065 7261 7475 7265 5f73 6166  _temperature_saf
+000191f0: 655f 7261 6e67 6528 7365 6c66 2920 2d3e  e_range(self) ->
+00019200: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+00019210: 2222 5265 6d6f 7665 7320 7468 6520 7465  ""Removes the te
+00019220: 6d70 6572 6174 7572 6520 7361 6665 2072  mperature safe r
+00019230: 616e 6765 2066 6f72 2074 6865 2073 656e  ange for the sen
+00019240: 736f 7222 2222 0a0a 2020 2020 2020 2020  sor"""..        
+00019250: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
 00019260: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00019270: 2222 2253 6574 7320 7468 6520 6c69 6768  """Sets the ligh
-00019280: 7420 7361 6665 2072 616e 6765 2066 6f72  t safe range for
-00019290: 2074 6865 2073 656e 736f 7222 2222 0a0a   the sensor"""..
-000192a0: 2020 2020 2020 2020 6966 206c 6f77 203c          if low <
-000192b0: 2031 2e30 3a0a 2020 2020 2020 2020 2020   1.0:.          
-000192c0: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
-000192d0: 7374 2822 4d69 6e69 6d75 6d20 7661 6c75  st("Minimum valu
-000192e0: 6520 6973 2031 206c 7578 2229 0a20 2020  e is 1 lux").   
-000192f0: 2020 2020 2069 6620 6869 6768 203e 2031       if high > 1
-00019300: 3030 302e 303a 0a20 2020 2020 2020 2020  000.0:.         
-00019310: 2020 2072 6169 7365 2042 6164 5265 7175     raise BadRequ
-00019320: 6573 7428 224d 6178 696d 756d 2076 616c  est("Maximum val
-00019330: 7565 2069 7320 3130 3030 206c 7578 2229  ue is 1000 lux")
-00019340: 0a20 2020 2020 2020 2069 6620 6869 6768  .        if high
-00019350: 203c 3d20 6c6f 773a 0a20 2020 2020 2020   <= low:.       
-00019360: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
-00019370: 7175 6573 7428 2248 6967 6820 7661 6c75  quest("High valu
-00019380: 6520 6d75 7374 2062 6520 6162 6f76 6520  e must be above 
-00019390: 6c6f 7720 7661 6c75 6522 290a 0a20 2020  low value")..   
-000193a0: 2020 2020 2064 6566 2063 616c 6c62 6163       def callbac
-000193b0: 6b28 2920 2d3e 204e 6f6e 653a 0a20 2020  k() -> None:.   
-000193c0: 2020 2020 2020 2020 2073 656c 662e 6c69           self.li
-000193d0: 6768 745f 7365 7474 696e 6773 2e6c 6f77  ght_settings.low
-000193e0: 5f74 6872 6573 686f 6c64 203d 206c 6f77  _threshold = low
-000193f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00019400: 662e 6c69 6768 745f 7365 7474 696e 6773  f.light_settings
-00019410: 2e68 6967 685f 7468 7265 7368 6f6c 6420  .high_threshold 
-00019420: 3d20 6869 6768 0a0a 2020 2020 2020 2020  = high..        
-00019430: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
-00019440: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
-00019450: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
-00019460: 2072 656d 6f76 655f 6c69 6768 745f 7361   remove_light_sa
-00019470: 6665 5f72 616e 6765 2873 656c 6629 202d  fe_range(self) -
-00019480: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00019490: 2222 2252 656d 6f76 6573 2074 6865 206c  """Removes the l
-000194a0: 6967 6874 2073 6166 6520 7261 6e67 6520  ight safe range 
-000194b0: 666f 7220 7468 6520 7365 6e73 6f72 2222  for the sensor""
-000194c0: 220a 0a20 2020 2020 2020 2064 6566 2063  "..        def c
-000194d0: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
-000194e0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000194f0: 656c 662e 6c69 6768 745f 7365 7474 696e  elf.light_settin
-00019500: 6773 2e6c 6f77 5f74 6872 6573 686f 6c64  gs.low_threshold
-00019510: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00019520: 2020 2020 7365 6c66 2e6c 6967 6874 5f73      self.light_s
-00019530: 6574 7469 6e67 732e 6869 6768 5f74 6872  ettings.high_thr
-00019540: 6573 686f 6c64 203d 204e 6f6e 650a 0a20  eshold = None.. 
-00019550: 2020 2020 2020 2061 7761 6974 2073 656c         await sel
-00019560: 662e 7175 6575 655f 7570 6461 7465 2863  f.queue_update(c
-00019570: 616c 6c62 6163 6b29 0a0a 2020 2020 6173  allback)..    as
-00019580: 796e 6320 6465 6620 7365 745f 616c 6172  ync def set_alar
-00019590: 6d5f 7374 6174 7573 2873 656c 662c 2065  m_status(self, e
-000195a0: 6e61 626c 6564 3a20 626f 6f6c 2920 2d3e  nabled: bool) ->
-000195b0: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-000195c0: 2222 5365 7473 2074 6865 2061 6c61 726d  ""Sets the alarm
-000195d0: 2064 6574 6563 7469 6f6e 2074 7970 6520   detection type 
-000195e0: 666f 7220 7468 6520 7365 6e73 6f72 2222  for the sensor""
-000195f0: 220a 0a20 2020 2020 2020 2064 6566 2063  "..        def c
-00019600: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
-00019610: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00019620: 656c 662e 616c 6172 6d5f 7365 7474 696e  elf.alarm_settin
-00019630: 6773 2e69 735f 656e 6162 6c65 6420 3d20  gs.is_enabled = 
-00019640: 656e 6162 6c65 640a 0a20 2020 2020 2020  enabled..       
-00019650: 2061 7761 6974 2073 656c 662e 7175 6575   await self.queu
-00019660: 655f 7570 6461 7465 2863 616c 6c62 6163  e_update(callbac
-00019670: 6b29 0a0a 2020 2020 6173 796e 6320 6465  k)..    async de
-00019680: 6620 7365 745f 7061 6972 6564 5f63 616d  f set_paired_cam
-00019690: 6572 6128 7365 6c66 2c20 6361 6d65 7261  era(self, camera
-000196a0: 3a20 4f70 7469 6f6e 616c 5b43 616d 6572  : Optional[Camer
-000196b0: 615d 2920 2d3e 204e 6f6e 653a 0a20 2020  a]) -> None:.   
-000196c0: 2020 2020 2022 2222 5365 7473 2074 6865       """Sets the
-000196d0: 2063 616d 6572 6120 7061 6972 6564 2077   camera paired w
-000196e0: 6974 6820 7468 6520 7365 6e73 6f72 2222  ith the sensor""
-000196f0: 220a 0a20 2020 2020 2020 2064 6566 2063  "..        def c
-00019700: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
-00019710: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-00019720: 6620 6361 6d65 7261 2069 7320 4e6f 6e65  f camera is None
-00019730: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019740: 2020 7365 6c66 2e63 616d 6572 615f 6964    self.camera_id
-00019750: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00019760: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00019770: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-00019780: 616d 6572 615f 6964 203d 2063 616d 6572  amera_id = camer
-00019790: 612e 6964 0a0a 2020 2020 2020 2020 6177  a.id..        aw
-000197a0: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
-000197b0: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
-000197c0: 0a20 2020 2061 7379 6e63 2064 6566 2063  .    async def c
-000197d0: 6c65 6172 5f74 616d 7065 7228 7365 6c66  lear_tamper(self
-000197e0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000197f0: 2020 2022 2222 436c 6561 7273 2074 616d     """Clears tam
-00019800: 7065 7220 7374 6174 7573 2066 6f72 2073  per status for s
-00019810: 656e 736f 7222 2222 0a0a 2020 2020 2020  ensor"""..      
-00019820: 2020 6966 206e 6f74 2073 656c 662e 6170    if not self.ap
-00019830: 692e 626f 6f74 7374 7261 702e 6175 7468  i.bootstrap.auth
-00019840: 5f75 7365 722e 6361 6e28 0a20 2020 2020  _user.can(.     
-00019850: 2020 2020 2020 204d 6f64 656c 5479 7065         ModelType
-00019860: 2e53 454e 534f 522c 0a20 2020 2020 2020  .SENSOR,.       
-00019870: 2020 2020 2050 6572 6d69 7373 696f 6e4e       PermissionN
-00019880: 6f64 652e 5752 4954 452c 0a20 2020 2020  ode.WRITE,.     
-00019890: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000198a0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-000198b0: 2020 2020 7261 6973 6520 4e6f 7441 7574      raise NotAut
-000198c0: 686f 7269 7a65 6428 0a20 2020 2020 2020  horized(.       
-000198d0: 2020 2020 2020 2020 2066 2244 6f20 6e6f           f"Do no
-000198e0: 7420 6861 7665 2070 6572 6d69 7373 696f  t have permissio
-000198f0: 6e20 746f 2063 6c65 6172 2074 616d 7065  n to clear tampe
-00019900: 7220 666f 7220 7365 6e73 6f72 3a20 7b73  r for sensor: {s
-00019910: 656c 662e 6964 7d22 2c0a 2020 2020 2020  elf.id}",.      
-00019920: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00019930: 6177 6169 7420 7365 6c66 2e61 7069 2e63  await self.api.c
-00019940: 6c65 6172 5f74 616d 7065 725f 7365 6e73  lear_tamper_sens
-00019950: 6f72 2873 656c 662e 6964 290a 0a0a 636c  or(self.id)...cl
-00019960: 6173 7320 446f 6f72 6c6f 636b 2850 726f  ass Doorlock(Pro
-00019970: 7465 6374 4164 6f70 7461 626c 6544 6576  tectAdoptableDev
-00019980: 6963 654d 6f64 656c 293a 0a20 2020 2063  iceModel):.    c
-00019990: 7265 6465 6e74 6961 6c73 3a20 4f70 7469  redentials: Opti
-000199a0: 6f6e 616c 5b73 7472 5d0a 2020 2020 6c6f  onal[str].    lo
-000199b0: 636b 5f73 7461 7475 733a 204c 6f63 6b53  ck_status: LockS
-000199c0: 7461 7475 7354 7970 650a 2020 2020 656e  tatusType.    en
-000199d0: 6162 6c65 5f68 6f6d 656b 6974 3a20 626f  able_homekit: bo
-000199e0: 6f6c 0a20 2020 2061 7574 6f5f 636c 6f73  ol.    auto_clos
-000199f0: 655f 7469 6d65 3a20 7469 6d65 6465 6c74  e_time: timedelt
-00019a00: 610a 2020 2020 6c65 645f 7365 7474 696e  a.    led_settin
-00019a10: 6773 3a20 5365 6e73 6f72 5365 7474 696e  gs: SensorSettin
-00019a20: 6773 4261 7365 0a20 2020 2062 6174 7465  gsBase.    batte
-00019a30: 7279 5f73 7461 7475 733a 2053 656e 736f  ry_status: Senso
-00019a40: 7242 6174 7465 7279 5374 6174 7573 0a20  rBatteryStatus. 
-00019a50: 2020 2063 616d 6572 615f 6964 3a20 4f70     camera_id: Op
-00019a60: 7469 6f6e 616c 5b73 7472 5d0a 2020 2020  tional[str].    
-00019a70: 6861 735f 686f 6d65 6b69 743a 2062 6f6f  has_homekit: boo
-00019a80: 6c0a 2020 2020 7072 6976 6174 655f 746f  l.    private_to
-00019a90: 6b65 6e3a 2073 7472 0a0a 2020 2020 4063  ken: str..    @c
-00019aa0: 6c61 7373 6d65 7468 6f64 0a20 2020 2040  lassmethod.    @
-00019ab0: 6361 6368 650a 2020 2020 6465 6620 5f67  cache.    def _g
-00019ac0: 6574 5f75 6e69 6669 5f72 656d 6170 7328  et_unifi_remaps(
-00019ad0: 636c 7329 202d 3e20 6469 6374 5b73 7472  cls) -> dict[str
-00019ae0: 2c20 7374 725d 3a0a 2020 2020 2020 2020  , str]:.        
-00019af0: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
-00019b00: 2020 2020 202a 2a73 7570 6572 2829 2e5f       **super()._
-00019b10: 6765 745f 756e 6966 695f 7265 6d61 7073  get_unifi_remaps
-00019b20: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-00019b30: 2263 616d 6572 6122 3a20 2263 616d 6572  "camera": "camer
-00019b40: 6149 6422 2c0a 2020 2020 2020 2020 2020  aId",.          
-00019b50: 2020 2261 7574 6f43 6c6f 7365 5469 6d65    "autoCloseTime
-00019b60: 4d73 223a 2022 6175 746f 436c 6f73 6554  Ms": "autoCloseT
-00019b70: 696d 6522 2c0a 2020 2020 2020 2020 7d0a  ime",.        }.
-00019b80: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00019b90: 640a 2020 2020 4063 6163 6865 0a20 2020  d.    @cache.   
-00019ba0: 2064 6566 205f 6765 745f 7265 6164 5f6f   def _get_read_o
-00019bb0: 6e6c 795f 6669 656c 6473 2863 6c73 2920  nly_fields(cls) 
-00019bc0: 2d3e 2073 6574 5b73 7472 5d3a 0a20 2020  -> set[str]:.   
-00019bd0: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00019be0: 7228 292e 5f67 6574 5f72 6561 645f 6f6e  r()._get_read_on
-00019bf0: 6c79 5f66 6965 6c64 7328 2920 7c20 7b0a  ly_fields() | {.
-00019c00: 2020 2020 2020 2020 2020 2020 2263 7265              "cre
-00019c10: 6465 6e74 6961 6c73 222c 0a20 2020 2020  dentials",.     
-00019c20: 2020 2020 2020 2022 6c6f 636b 5374 6174         "lockStat
-00019c30: 7573 222c 0a20 2020 2020 2020 2020 2020  us",.           
-00019c40: 2022 6261 7474 6572 7953 7461 7475 7322   "batteryStatus"
-00019c50: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-00019c60: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-00019c70: 2020 6465 6620 756e 6966 695f 6469 6374    def unifi_dict
-00019c80: 5f74 6f5f 6469 6374 2863 6c73 2c20 6461  _to_dict(cls, da
-00019c90: 7461 3a20 6469 6374 5b73 7472 2c20 416e  ta: dict[str, An
-00019ca0: 795d 2920 2d3e 2064 6963 745b 7374 722c  y]) -> dict[str,
-00019cb0: 2041 6e79 5d3a 0a20 2020 2020 2020 2069   Any]:.        i
-00019cc0: 6620 2261 7574 6f43 6c6f 7365 5469 6d65  f "autoCloseTime
-00019cd0: 4d73 2220 696e 2064 6174 6120 616e 6420  Ms" in data and 
-00019ce0: 6e6f 7420 6973 696e 7374 616e 6365 280a  not isinstance(.
-00019cf0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00019d00: 5b22 6175 746f 436c 6f73 6554 696d 654d  ["autoCloseTimeM
-00019d10: 7322 5d2c 0a20 2020 2020 2020 2020 2020  s"],.           
-00019d20: 2074 696d 6564 656c 7461 2c0a 2020 2020   timedelta,.    
-00019d30: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00019d40: 2020 2064 6174 615b 2261 7574 6f43 6c6f     data["autoClo
-00019d50: 7365 5469 6d65 4d73 225d 203d 2074 696d  seTimeMs"] = tim
-00019d60: 6564 656c 7461 286d 696c 6c69 7365 636f  edelta(milliseco
-00019d70: 6e64 733d 6461 7461 5b22 6175 746f 436c  nds=data["autoCl
-00019d80: 6f73 6554 696d 654d 7322 5d29 0a0a 2020  oseTimeMs"])..  
-00019d90: 2020 2020 2020 7265 7475 726e 2073 7570        return sup
-00019da0: 6572 2829 2e75 6e69 6669 5f64 6963 745f  er().unifi_dict_
-00019db0: 746f 5f64 6963 7428 6461 7461 290a 0a20  to_dict(data).. 
-00019dc0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00019dd0: 2064 6566 2063 616d 6572 6128 7365 6c66   def camera(self
-00019de0: 2920 2d3e 204f 7074 696f 6e61 6c5b 4361  ) -> Optional[Ca
-00019df0: 6d65 7261 5d3a 0a20 2020 2020 2020 2022  mera]:.        "
-00019e00: 2222 5061 6972 6564 2043 616d 6572 6120  ""Paired Camera 
-00019e10: 7769 6c6c 2061 6c77 6179 7320 6265 206e  will always be n
-00019e20: 6f6e 6520 6966 206e 6f20 6361 6d65 7261  one if no camera
-00019e30: 2069 7320 7061 6972 6564 2222 220a 0a20   is paired""".. 
-00019e40: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-00019e50: 616d 6572 615f 6964 2069 7320 4e6f 6e65  amera_id is None
-00019e60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00019e70: 7475 726e 204e 6f6e 650a 0a20 2020 2020  turn None..     
-00019e80: 2020 2072 6574 7572 6e20 7365 6c66 2e61     return self.a
-00019e90: 7069 2e62 6f6f 7473 7472 6170 2e63 616d  pi.bootstrap.cam
-00019ea0: 6572 6173 5b73 656c 662e 6361 6d65 7261  eras[self.camera
-00019eb0: 5f69 645d 0a0a 2020 2020 6173 796e 6320  _id]..    async 
-00019ec0: 6465 6620 7365 745f 7061 6972 6564 5f63  def set_paired_c
-00019ed0: 616d 6572 6128 7365 6c66 2c20 6361 6d65  amera(self, came
-00019ee0: 7261 3a20 4f70 7469 6f6e 616c 5b43 616d  ra: Optional[Cam
-00019ef0: 6572 615d 2920 2d3e 204e 6f6e 653a 0a20  era]) -> None:. 
-00019f00: 2020 2020 2020 2022 2222 5365 7473 2074         """Sets t
-00019f10: 6865 2063 616d 6572 6120 7061 6972 6564  he camera paired
-00019f20: 2077 6974 6820 7468 6520 7365 6e73 6f72   with the sensor
-00019f30: 2222 220a 0a20 2020 2020 2020 2064 6566  """..        def
-00019f40: 2063 616c 6c62 6163 6b28 2920 2d3e 204e   callback() -> N
-00019f50: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00019f60: 2069 6620 6361 6d65 7261 2069 7320 4e6f   if camera is No
-00019f70: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00019f80: 2020 2020 7365 6c66 2e63 616d 6572 615f      self.camera_
-00019f90: 6964 203d 204e 6f6e 650a 2020 2020 2020  id = None.      
-00019fa0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00019fb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019fc0: 2e63 616d 6572 615f 6964 203d 2063 616d  .camera_id = cam
-00019fd0: 6572 612e 6964 0a0a 2020 2020 2020 2020  era.id..        
-00019fe0: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
-00019ff0: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
-0001a000: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
-0001a010: 2073 6574 5f73 7461 7475 735f 6c69 6768   set_status_ligh
-0001a020: 7428 7365 6c66 2c20 656e 6162 6c65 643a  t(self, enabled:
-0001a030: 2062 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a   bool) -> None:.
-0001a040: 2020 2020 2020 2020 2222 2253 6574 7320          """Sets 
-0001a050: 7468 6520 7374 6174 7573 2069 6e64 6963  the status indic
-0001a060: 6174 6f72 206c 6967 6874 2066 6f72 2074  ator light for t
-0001a070: 6865 2064 6f6f 726c 6f63 6b22 2222 0a0a  he doorlock"""..
-0001a080: 2020 2020 2020 2020 6465 6620 6361 6c6c          def call
-0001a090: 6261 636b 2829 202d 3e20 4e6f 6e65 3a0a  back() -> None:.
-0001a0a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001a0b0: 2e6c 6564 5f73 6574 7469 6e67 732e 6973  .led_settings.is
-0001a0c0: 5f65 6e61 626c 6564 203d 2065 6e61 626c  _enabled = enabl
-0001a0d0: 6564 0a0a 2020 2020 2020 2020 6177 6169  ed..        awai
-0001a0e0: 7420 7365 6c66 2e71 7565 7565 5f75 7064  t self.queue_upd
-0001a0f0: 6174 6528 6361 6c6c 6261 636b 290a 0a20  ate(callback).. 
-0001a100: 2020 2061 7379 6e63 2064 6566 2073 6574     async def set
-0001a110: 5f61 7574 6f5f 636c 6f73 655f 7469 6d65  _auto_close_time
-0001a120: 2873 656c 662c 2064 7572 6174 696f 6e3a  (self, duration:
-0001a130: 2074 696d 6564 656c 7461 2920 2d3e 204e   timedelta) -> N
-0001a140: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-0001a150: 5365 7473 2074 6865 2061 7574 6f2d 636c  Sets the auto-cl
-0001a160: 6f73 6520 7469 6d65 2066 6f72 2064 6f6f  ose time for doo
-0001a170: 726c 6f63 6b2e 2030 2073 6563 6f6e 6473  rlock. 0 seconds
-0001a180: 203d 2064 6973 6162 6c65 642e 2222 220a   = disabled.""".
-0001a190: 0a20 2020 2020 2020 2069 6620 6475 7261  .        if dura
-0001a1a0: 7469 6f6e 203e 2074 696d 6564 656c 7461  tion > timedelta
-0001a1b0: 2868 6f75 7273 3d31 293a 0a20 2020 2020  (hours=1):.     
-0001a1c0: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
-0001a1d0: 5265 7175 6573 7428 224d 6178 2064 7572  Request("Max dur
-0001a1e0: 6174 696f 6e20 6973 2031 2068 6f75 7222  ation is 1 hour"
-0001a1f0: 290a 0a20 2020 2020 2020 2064 6566 2063  )..        def c
-0001a200: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
-0001a210: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0001a220: 656c 662e 6175 746f 5f63 6c6f 7365 5f74  elf.auto_close_t
-0001a230: 696d 6520 3d20 6475 7261 7469 6f6e 0a0a  ime = duration..
-0001a240: 2020 2020 2020 2020 6177 6169 7420 7365          await se
-0001a250: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
-0001a260: 6361 6c6c 6261 636b 290a 0a20 2020 2061  callback)..    a
-0001a270: 7379 6e63 2064 6566 2063 6c6f 7365 5f6c  sync def close_l
-0001a280: 6f63 6b28 7365 6c66 2920 2d3e 204e 6f6e  ock(self) -> Non
-0001a290: 653a 0a20 2020 2020 2020 2022 2222 436c  e:.        """Cl
-0001a2a0: 6f73 6520 646f 6f72 6c6f 636b 2028 6c6f  ose doorlock (lo
-0001a2b0: 636b 2922 2222 0a0a 2020 2020 2020 2020  ck)"""..        
-0001a2c0: 6966 2073 656c 662e 6c6f 636b 5f73 7461  if self.lock_sta
-0001a2d0: 7475 7320 213d 204c 6f63 6b53 7461 7475  tus != LockStatu
-0001a2e0: 7354 7970 652e 4f50 454e 3a0a 2020 2020  sType.OPEN:.    
-0001a2f0: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
-0001a300: 6452 6571 7565 7374 2822 4c6f 636b 2069  dRequest("Lock i
-0001a310: 7320 6e6f 7420 6f70 656e 2229 0a0a 2020  s not open")..  
-0001a320: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
-0001a330: 2e61 7069 2e63 6c6f 7365 5f6c 6f63 6b28  .api.close_lock(
-0001a340: 7365 6c66 2e69 6429 0a0a 2020 2020 6173  self.id)..    as
-0001a350: 796e 6320 6465 6620 6f70 656e 5f6c 6f63  ync def open_loc
-0001a360: 6b28 7365 6c66 2920 2d3e 204e 6f6e 653a  k(self) -> None:
-0001a370: 0a20 2020 2020 2020 2022 2222 4f70 656e  .        """Open
-0001a380: 2064 6f6f 726c 6f63 6b20 2875 6e6c 6f63   doorlock (unloc
-0001a390: 6b29 2222 220a 0a20 2020 2020 2020 2069  k)"""..        i
-0001a3a0: 6620 7365 6c66 2e6c 6f63 6b5f 7374 6174  f self.lock_stat
-0001a3b0: 7573 2021 3d20 4c6f 636b 5374 6174 7573  us != LockStatus
-0001a3c0: 5479 7065 2e43 4c4f 5345 443a 0a20 2020  Type.CLOSED:.   
-0001a3d0: 2020 2020 2020 2020 2072 6169 7365 2042           raise B
-0001a3e0: 6164 5265 7175 6573 7428 224c 6f63 6b20  adRequest("Lock 
-0001a3f0: 6973 206e 6f74 2063 6c6f 7365 6422 290a  is not closed").
-0001a400: 0a20 2020 2020 2020 2061 7761 6974 2073  .        await s
-0001a410: 656c 662e 6170 692e 6f70 656e 5f6c 6f63  elf.api.open_loc
-0001a420: 6b28 7365 6c66 2e69 6429 0a0a 2020 2020  k(self.id)..    
-0001a430: 6173 796e 6320 6465 6620 6361 6c69 6272  async def calibr
-0001a440: 6174 6528 7365 6c66 2920 2d3e 204e 6f6e  ate(self) -> Non
-0001a450: 653a 0a20 2020 2020 2020 2022 2222 4361  e:.        """Ca
-0001a460: 6c69 6272 6174 6520 7468 6520 646f 6f72  librate the door
-0001a470: 6c6f 636b 2e0a 0a20 2020 2020 2020 2044  lock...        D
-0001a480: 6f6f 7220 6d75 7374 2062 6520 6f70 656e  oor must be open
-0001a490: 2061 6e64 206c 6f63 6b20 756e 6c6f 636b   and lock unlock
-0001a4a0: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
-0001a4b0: 0a20 2020 2020 2020 2061 7761 6974 2073  .        await s
-0001a4c0: 656c 662e 6170 692e 6361 6c69 6272 6174  elf.api.calibrat
-0001a4d0: 655f 6c6f 636b 2873 656c 662e 6964 290a  e_lock(self.id).
-0001a4e0: 0a0a 636c 6173 7320 4368 696d 6546 6561  ..class ChimeFea
-0001a4f0: 7475 7265 466c 6167 7328 5072 6f74 6563  tureFlags(Protec
-0001a500: 7442 6173 654f 626a 6563 7429 3a0a 2020  tBaseObject):.  
-0001a510: 2020 6861 735f 7769 6669 3a20 626f 6f6c    has_wifi: bool
-0001a520: 0a20 2020 2023 2032 2e39 2e32 302b 0a20  .    # 2.9.20+. 
-0001a530: 2020 2068 6173 5f68 7474 7073 5f63 6c69     has_https_cli
-0001a540: 656e 745f 6f74 613a 204f 7074 696f 6e61  ent_ota: Optiona
-0001a550: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 0a0a  l[bool] = None..
-0001a560: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-0001a570: 0a20 2020 2040 6361 6368 650a 2020 2020  .    @cache.    
-0001a580: 6465 6620 5f67 6574 5f75 6e69 6669 5f72  def _get_unifi_r
-0001a590: 656d 6170 7328 636c 7329 202d 3e20 6469  emaps(cls) -> di
-0001a5a0: 6374 5b73 7472 2c20 7374 725d 3a0a 2020  ct[str, str]:.  
-0001a5b0: 2020 2020 2020 7265 7475 726e 207b 2a2a        return {**
-0001a5c0: 7375 7065 7228 292e 5f67 6574 5f75 6e69  super()._get_uni
-0001a5d0: 6669 5f72 656d 6170 7328 292c 2022 6861  fi_remaps(), "ha
-0001a5e0: 7348 7474 7073 436c 6965 6e74 4f54 4122  sHttpsClientOTA"
-0001a5f0: 3a20 2268 6173 4874 7470 7343 6c69 656e  : "hasHttpsClien
-0001a600: 744f 7461 227d 0a0a 0a63 6c61 7373 2052  tOta"}...class R
-0001a610: 696e 6753 6574 7469 6e67 2850 726f 7465  ingSetting(Prote
-0001a620: 6374 4261 7365 4f62 6a65 6374 293a 0a20  ctBaseObject):. 
-0001a630: 2020 2063 616d 6572 615f 6964 3a20 7374     camera_id: st
-0001a640: 720a 2020 2020 7265 7065 6174 5f74 696d  r.    repeat_tim
-0001a650: 6573 3a20 5265 7065 6174 5469 6d65 730a  es: RepeatTimes.
-0001a660: 2020 2020 7472 6163 6b5f 6e6f 3a20 696e      track_no: in
-0001a670: 740a 2020 2020 766f 6c75 6d65 3a20 696e  t.    volume: in
-0001a680: 740a 0a20 2020 2040 636c 6173 736d 6574  t..    @classmet
-0001a690: 686f 640a 2020 2020 4063 6163 6865 0a20  hod.    @cache. 
-0001a6a0: 2020 2064 6566 205f 6765 745f 756e 6966     def _get_unif
-0001a6b0: 695f 7265 6d61 7073 2863 6c73 2920 2d3e  i_remaps(cls) ->
-0001a6c0: 2064 6963 745b 7374 722c 2073 7472 5d3a   dict[str, str]:
-0001a6d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001a6e0: 7b2a 2a73 7570 6572 2829 2e5f 6765 745f  {**super()._get_
-0001a6f0: 756e 6966 695f 7265 6d61 7073 2829 2c20  unifi_remaps(), 
-0001a700: 2263 616d 6572 6122 3a20 2263 616d 6572  "camera": "camer
-0001a710: 6149 6422 7d0a 0a20 2020 2040 7072 6f70  aId"}..    @prop
-0001a720: 6572 7479 0a20 2020 2064 6566 2063 616d  erty.    def cam
-0001a730: 6572 6128 7365 6c66 2920 2d3e 204f 7074  era(self) -> Opt
-0001a740: 696f 6e61 6c5b 4361 6d65 7261 5d3a 0a20  ional[Camera]:. 
-0001a750: 2020 2020 2020 2022 2222 5061 6972 6564         """Paired
-0001a760: 2043 616d 6572 6120 7769 6c6c 2061 6c77   Camera will alw
-0001a770: 6179 7320 6265 206e 6f6e 6520 6966 206e  ays be none if n
-0001a780: 6f20 6361 6d65 7261 2069 7320 7061 6972  o camera is pair
-0001a790: 6564 2222 220a 0a20 2020 2020 2020 2069  ed"""..        i
-0001a7a0: 6620 7365 6c66 2e63 616d 6572 615f 6964  f self.camera_id
-0001a7b0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0001a7c0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-0001a7d0: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-0001a7e0: 6e20 7365 6c66 2e61 7069 2e62 6f6f 7473  n self.api.boots
-0001a7f0: 7472 6170 2e63 616d 6572 6173 5b73 656c  trap.cameras[sel
-0001a800: 662e 6361 6d65 7261 5f69 645d 0a0a 0a63  f.camera_id]...c
-0001a810: 6c61 7373 2043 6869 6d65 5472 6163 6b28  lass ChimeTrack(
-0001a820: 5072 6f74 6563 7442 6173 654f 626a 6563  ProtectBaseObjec
-0001a830: 7429 3a0a 2020 2020 6d64 353a 2073 7472  t):.    md5: str
-0001a840: 0a20 2020 206e 616d 653a 2073 7472 0a20  .    name: str. 
-0001a850: 2020 2073 7461 7465 3a20 7374 720a 2020     state: str.  
-0001a860: 2020 7472 6163 6b5f 6e6f 3a20 696e 740a    track_no: int.
-0001a870: 2020 2020 766f 6c75 6d65 3a20 696e 740a      volume: int.
-0001a880: 2020 2020 7369 7a65 3a20 696e 740a 0a20      size: int.. 
-0001a890: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-0001a8a0: 2020 2020 4063 6163 6865 0a20 2020 2064      @cache.    d
-0001a8b0: 6566 205f 6765 745f 756e 6966 695f 7265  ef _get_unifi_re
-0001a8c0: 6d61 7073 2863 6c73 2920 2d3e 2064 6963  maps(cls) -> dic
-0001a8d0: 745b 7374 722c 2073 7472 5d3a 0a20 2020  t[str, str]:.   
-0001a8e0: 2020 2020 2072 6574 7572 6e20 7b2a 2a73       return {**s
-0001a8f0: 7570 6572 2829 2e5f 6765 745f 756e 6966  uper()._get_unif
-0001a900: 695f 7265 6d61 7073 2829 2c20 2274 7261  i_remaps(), "tra
-0001a910: 636b 5f6e 6f22 3a20 2274 7261 636b 4e6f  ck_no": "trackNo
-0001a920: 227d 0a0a 0a63 6c61 7373 2043 6869 6d65  "}...class Chime
-0001a930: 2850 726f 7465 6374 4164 6f70 7461 626c  (ProtectAdoptabl
-0001a940: 6544 6576 6963 654d 6f64 656c 293a 0a20  eDeviceModel):. 
-0001a950: 2020 2076 6f6c 756d 653a 2050 6572 6365     volume: Perce
-0001a960: 6e74 496e 740a 2020 2020 6973 5f70 726f  ntInt.    is_pro
-0001a970: 6269 6e67 5f66 6f72 5f77 6966 693a 2062  bing_for_wifi: b
-0001a980: 6f6f 6c0a 2020 2020 6c61 7374 5f72 696e  ool.    last_rin
-0001a990: 673a 204f 7074 696f 6e61 6c5b 6461 7465  g: Optional[date
-0001a9a0: 7469 6d65 5d0a 2020 2020 6973 5f77 6972  time].    is_wir
-0001a9b0: 656c 6573 735f 7570 6c69 6e6b 5f65 6e61  eless_uplink_ena
-0001a9c0: 626c 6564 3a20 626f 6f6c 0a20 2020 2063  bled: bool.    c
-0001a9d0: 616d 6572 615f 6964 733a 206c 6973 745b  amera_ids: list[
-0001a9e0: 7374 725d 0a20 2020 2023 2072 6571 7569  str].    # requi
-0001a9f0: 7265 7320 322e 362e 3137 2b0a 2020 2020  res 2.6.17+.    
-0001aa00: 6170 5f6d 676d 745f 6970 3a20 4f70 7469  ap_mgmt_ip: Opti
-0001aa10: 6f6e 616c 5b49 5076 3441 6464 7265 7373  onal[IPv4Address
-0001aa20: 5d20 3d20 4e6f 6e65 0a20 2020 2023 2072  ] = None.    # r
-0001aa30: 6571 7569 7265 7320 322e 372e 3135 2b0a  equires 2.7.15+.
-0001aa40: 2020 2020 6665 6174 7572 655f 666c 6167      feature_flag
-0001aa50: 733a 204f 7074 696f 6e61 6c5b 4368 696d  s: Optional[Chim
-0001aa60: 6546 6561 7475 7265 466c 6167 735d 203d  eFeatureFlags] =
-0001aa70: 204e 6f6e 650a 2020 2020 2320 7265 7175   None.    # requ
-0001aa80: 6972 6573 2032 2e38 2e32 322b 0a20 2020  ires 2.8.22+.   
-0001aa90: 2075 7365 725f 636f 6e66 6967 7572 6564   user_configured
-0001aaa0: 5f61 703a 204f 7074 696f 6e61 6c5b 626f  _ap: Optional[bo
-0001aab0: 6f6c 5d20 3d20 4e6f 6e65 0a20 2020 2023  ol] = None.    #
-0001aac0: 2072 6571 7569 7265 7320 332e 302e 3232   requires 3.0.22
-0001aad0: 2b0a 2020 2020 6861 735f 6874 7470 735f  +.    has_https_
-0001aae0: 636c 6965 6e74 5f6f 7461 3a20 4f70 7469  client_ota: Opti
-0001aaf0: 6f6e 616c 5b62 6f6f 6c5d 203d 204e 6f6e  onal[bool] = Non
-0001ab00: 650a 2020 2020 706c 6174 666f 726d 3a20  e.    platform: 
-0001ab10: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-0001ab20: 4e6f 6e65 0a20 2020 2072 6570 6561 745f  None.    repeat_
-0001ab30: 7469 6d65 733a 204f 7074 696f 6e61 6c5b  times: Optional[
-0001ab40: 5265 7065 6174 5469 6d65 735d 203d 204e  RepeatTimes] = N
-0001ab50: 6f6e 650a 2020 2020 7472 6163 6b5f 6e6f  one.    track_no
-0001ab60: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-0001ab70: 3d20 4e6f 6e65 0a20 2020 2072 696e 675f  = None.    ring_
-0001ab80: 7365 7474 696e 6773 3a20 6c69 7374 5b52  settings: list[R
-0001ab90: 696e 6753 6574 7469 6e67 5d20 3d20 5b5d  ingSetting] = []
-0001aba0: 0a20 2020 2073 7065 616b 6572 5f74 7261  .    speaker_tra
-0001abb0: 636b 5f6c 6973 743a 206c 6973 745b 4368  ck_list: list[Ch
-0001abc0: 696d 6554 7261 636b 5d20 3d20 5b5d 0a0a  imeTrack] = []..
-0001abd0: 2020 2020 2320 544f 444f 3a20 7573 6564      # TODO: used
-0001abe0: 2066 6f72 2061 646f 7074 696f 6e0a 2020   for adoption.  
-0001abf0: 2020 2320 6170 4d61 6320 2072 6561 6420    # apMac  read 
-0001ac00: 6f6e 6c79 0a20 2020 2023 2061 7052 7373  only.    # apRss
-0001ac10: 6920 2072 6561 6420 6f6e 6c79 0a20 2020  i  read only.   
-0001ac20: 2023 2065 6c65 6d65 6e74 496e 666f 2020   # elementInfo  
-0001ac30: 7265 6164 206f 6e6c 790a 0a20 2020 2040  read only..    @
-0001ac40: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-0001ac50: 4063 6163 6865 0a20 2020 2064 6566 205f  @cache.    def _
-0001ac60: 6765 745f 756e 6966 695f 7265 6d61 7073  get_unifi_remaps
-0001ac70: 2863 6c73 2920 2d3e 2064 6963 745b 7374  (cls) -> dict[st
-0001ac80: 722c 2073 7472 5d3a 0a20 2020 2020 2020  r, str]:.       
-0001ac90: 2072 6574 7572 6e20 7b2a 2a73 7570 6572   return {**super
-0001aca0: 2829 2e5f 6765 745f 756e 6966 695f 7265  ()._get_unifi_re
-0001acb0: 6d61 7073 2829 2c20 2268 6173 4874 7470  maps(), "hasHttp
-0001acc0: 7343 6c69 656e 744f 5441 223a 2022 6861  sClientOTA": "ha
-0001acd0: 7348 7474 7073 436c 6965 6e74 4f74 6122  sHttpsClientOta"
-0001ace0: 7d0a 0a20 2020 2040 636c 6173 736d 6574  }..    @classmet
-0001acf0: 686f 640a 2020 2020 4063 6163 6865 0a20  hod.    @cache. 
-0001ad00: 2020 2064 6566 205f 6765 745f 7265 6164     def _get_read
-0001ad10: 5f6f 6e6c 795f 6669 656c 6473 2863 6c73  _only_fields(cls
-0001ad20: 2920 2d3e 2073 6574 5b73 7472 5d3a 0a20  ) -> set[str]:. 
-0001ad30: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-0001ad40: 7065 7228 292e 5f67 6574 5f72 6561 645f  per()._get_read_
-0001ad50: 6f6e 6c79 5f66 6965 6c64 7328 2920 7c20  only_fields() | 
-0001ad60: 7b22 6973 5072 6f62 696e 6746 6f72 5769  {"isProbingForWi
-0001ad70: 6669 222c 2022 6c61 7374 5269 6e67 227d  fi", "lastRing"}
-0001ad80: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0001ad90: 2020 2020 6465 6620 6361 6d65 7261 7328      def cameras(
-0001ada0: 7365 6c66 2920 2d3e 206c 6973 745b 4361  self) -> list[Ca
-0001adb0: 6d65 7261 5d3a 0a20 2020 2020 2020 2022  mera]:.        "
-0001adc0: 2222 5061 6972 6564 2043 616d 6572 6173  ""Paired Cameras
-0001add0: 2066 6f72 2063 6869 6d65 2222 220a 0a20   for chime""".. 
-0001ade0: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-0001adf0: 6c66 2e63 616d 6572 615f 6964 7329 203d  lf.camera_ids) =
-0001ae00: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0001ae10: 2072 6574 7572 6e20 5b5d 0a20 2020 2020   return [].     
-0001ae20: 2020 2072 6574 7572 6e20 5b73 656c 662e     return [self.
-0001ae30: 6170 692e 626f 6f74 7374 7261 702e 6361  api.bootstrap.ca
-0001ae40: 6d65 7261 735b 635d 2066 6f72 2063 2069  meras[c] for c i
-0001ae50: 6e20 7365 6c66 2e63 616d 6572 615f 6964  n self.camera_id
-0001ae60: 735d 0a0a 2020 2020 6173 796e 6320 6465  s]..    async de
-0001ae70: 6620 7365 745f 766f 6c75 6d65 2873 656c  f set_volume(sel
-0001ae80: 662c 206c 6576 656c 3a20 696e 7429 202d  f, level: int) -
-0001ae90: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0001aea0: 2222 2253 6574 2074 6865 2076 6f6c 756d  """Set the volum
-0001aeb0: 6520 6f6e 2063 6869 6d65 2e22 2222 0a0a  e on chime."""..
-0001aec0: 2020 2020 2020 2020 6f6c 645f 7661 6c75          old_valu
-0001aed0: 6520 3d20 7365 6c66 2e76 6f6c 756d 650a  e = self.volume.
-0001aee0: 2020 2020 2020 2020 6e65 775f 7661 6c75          new_valu
-0001aef0: 6520 3d20 5065 7263 656e 7449 6e74 286c  e = PercentInt(l
-0001af00: 6576 656c 290a 0a20 2020 2020 2020 2064  evel)..        d
-0001af10: 6566 2063 616c 6c62 6163 6b28 2920 2d3e  ef callback() ->
-0001af20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001af30: 2020 2073 656c 662e 766f 6c75 6d65 203d     self.volume =
-0001af40: 206e 6577 5f76 616c 7565 0a20 2020 2020   new_value.     
-0001af50: 2020 2020 2020 2066 6f72 2073 6574 7469         for setti
-0001af60: 6e67 2069 6e20 7365 6c66 2e72 696e 675f  ng in self.ring_
-0001af70: 7365 7474 696e 6773 3a0a 2020 2020 2020  settings:.      
-0001af80: 2020 2020 2020 2020 2020 6966 2073 6574            if set
-0001af90: 7469 6e67 2e76 6f6c 756d 6520 3d3d 206f  ting.volume == o
-0001afa0: 6c64 5f76 616c 7565 3a0a 2020 2020 2020  ld_value:.      
-0001afb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001afc0: 7474 696e 672e 766f 6c75 6d65 203d 206e  tting.volume = n
-0001afd0: 6577 5f76 616c 7565 0a0a 2020 2020 2020  ew_value..      
-0001afe0: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
-0001aff0: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
-0001b000: 636b 290a 0a20 2020 2061 7379 6e63 2064  ck)..    async d
-0001b010: 6566 2073 6574 5f76 6f6c 756d 655f 666f  ef set_volume_fo
-0001b020: 725f 6361 6d65 7261 2873 656c 662c 2063  r_camera(self, c
-0001b030: 616d 6572 613a 2043 616d 6572 612c 206c  amera: Camera, l
-0001b040: 6576 656c 3a20 696e 7429 202d 3e20 4e6f  evel: int) -> No
-0001b050: 6e65 3a0a 2020 2020 2020 2020 2222 2253  ne:.        """S
-0001b060: 6574 2074 6865 2076 6f6c 756d 6520 6f6e  et the volume on
-0001b070: 2063 6869 6d65 2066 6f72 2073 7065 6369   chime for speci
-0001b080: 6669 6320 6361 6d65 7261 2e22 2222 0a0a  fic camera."""..
-0001b090: 2020 2020 2020 2020 6465 6620 6361 6c6c          def call
-0001b0a0: 6261 636b 2829 202d 3e20 4e6f 6e65 3a0a  back() -> None:.
-0001b0b0: 2020 2020 2020 2020 2020 2020 6861 6e64              hand
-0001b0c0: 6c65 6420 3d20 4661 6c73 650a 2020 2020  led = False.    
-0001b0d0: 2020 2020 2020 2020 666f 7220 7365 7474          for sett
-0001b0e0: 696e 6720 696e 2073 656c 662e 7269 6e67  ing in self.ring
-0001b0f0: 5f73 6574 7469 6e67 733a 0a20 2020 2020  _settings:.     
-0001b100: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001b110: 7474 696e 672e 6361 6d65 7261 5f69 6420  tting.camera_id 
-0001b120: 3d3d 2063 616d 6572 612e 6964 3a0a 2020  == camera.id:.  
-0001b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b140: 2020 7365 7474 696e 672e 766f 6c75 6d65    setting.volume
-0001b150: 203d 2063 6173 7428 5065 7263 656e 7449   = cast(PercentI
-0001b160: 6e74 2c20 6c65 7665 6c29 0a20 2020 2020  nt, level).     
-0001b170: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-0001b180: 616e 646c 6564 203d 2054 7275 650a 2020  andled = True.  
-0001b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1a0: 2020 6272 6561 6b0a 0a20 2020 2020 2020    break..       
-0001b1b0: 2020 2020 2069 6620 6e6f 7420 6861 6e64       if not hand
-0001b1c0: 6c65 643a 0a20 2020 2020 2020 2020 2020  led:.           
-0001b1d0: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
-0001b1e0: 7175 6573 7428 2243 616d 6572 6120 2573  quest("Camera %s
-0001b1f0: 2069 7320 6e6f 7420 7061 6972 6564 2077   is not paired w
-0001b200: 6974 6820 6368 696d 6522 2c20 6361 6d65  ith chime", came
-0001b210: 7261 2e69 6429 0a0a 2020 2020 2020 2020  ra.id)..        
-0001b220: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
-0001b230: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
-0001b240: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
-0001b250: 2061 6464 5f63 616d 6572 6128 7365 6c66   add_camera(self
-0001b260: 2c20 6361 6d65 7261 3a20 4361 6d65 7261  , camera: Camera
-0001b270: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0001b280: 2020 2022 2222 4164 6473 206e 6577 2070     """Adds new p
-0001b290: 6169 7265 6420 6361 6d65 7261 2074 6f20  aired camera to 
-0001b2a0: 6368 696d 6522 2222 0a0a 2020 2020 2020  chime"""..      
-0001b2b0: 2020 6966 206e 6f74 2063 616d 6572 612e    if not camera.
-0001b2c0: 6665 6174 7572 655f 666c 6167 732e 6973  feature_flags.is
-0001b2d0: 5f64 6f6f 7262 656c 6c3a 0a20 2020 2020  _doorbell:.     
-0001b2e0: 2020 2020 2020 2072 6169 7365 2042 6164         raise Bad
-0001b2f0: 5265 7175 6573 7428 2243 616d 6572 6120  Request("Camera 
-0001b300: 646f 6573 206e 6f74 2068 6176 6520 6120  does not have a 
-0001b310: 6368 696d 6522 290a 0a20 2020 2020 2020  chime")..       
-0001b320: 2069 6620 6361 6d65 7261 2e69 6420 696e   if camera.id in
-0001b330: 2073 656c 662e 6361 6d65 7261 5f69 6473   self.camera_ids
-0001b340: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0001b350: 6973 6520 4261 6452 6571 7565 7374 2822  ise BadRequest("
-0001b360: 4361 6d65 7261 2069 7320 616c 7265 6164  Camera is alread
-0001b370: 7920 7061 6972 6564 2229 0a0a 2020 2020  y paired")..    
-0001b380: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
-0001b390: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
-0001b3a0: 2020 2020 2020 2020 7365 6c66 2e63 616d          self.cam
-0001b3b0: 6572 615f 6964 732e 6170 7065 6e64 2863  era_ids.append(c
-0001b3c0: 616d 6572 612e 6964 290a 0a20 2020 2020  amera.id)..     
-0001b3d0: 2020 2061 7761 6974 2073 656c 662e 7175     await self.qu
-0001b3e0: 6575 655f 7570 6461 7465 2863 616c 6c62  eue_update(callb
-0001b3f0: 6163 6b29 0a0a 2020 2020 6173 796e 6320  ack)..    async 
-0001b400: 6465 6620 7265 6d6f 7665 5f63 616d 6572  def remove_camer
-0001b410: 6128 7365 6c66 2c20 6361 6d65 7261 3a20  a(self, camera: 
-0001b420: 4361 6d65 7261 2920 2d3e 204e 6f6e 653a  Camera) -> None:
-0001b430: 0a20 2020 2020 2020 2022 2222 5265 6d6f  .        """Remo
-0001b440: 7665 7320 7061 6972 6564 2063 616d 6572  ves paired camer
-0001b450: 6120 6672 6f6d 2063 6869 6d65 2222 220a  a from chime""".
-0001b460: 0a20 2020 2020 2020 2069 6620 6361 6d65  .        if came
-0001b470: 7261 2e69 6420 6e6f 7420 696e 2073 656c  ra.id not in sel
-0001b480: 662e 6361 6d65 7261 5f69 6473 3a0a 2020  f.camera_ids:.  
-0001b490: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001b4a0: 4261 6452 6571 7565 7374 2822 4361 6d65  BadRequest("Came
-0001b4b0: 7261 2069 7320 6e6f 7420 7061 6972 6564  ra is not paired
-0001b4c0: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
-0001b4d0: 6361 6c6c 6261 636b 2829 202d 3e20 4e6f  callback() -> No
-0001b4e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0001b4f0: 7365 6c66 2e63 616d 6572 615f 6964 732e  self.camera_ids.
-0001b500: 7265 6d6f 7665 2863 616d 6572 612e 6964  remove(camera.id
-0001b510: 290a 0a20 2020 2020 2020 2061 7761 6974  )..        await
-0001b520: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
-0001b530: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
-0001b540: 2020 6173 796e 6320 6465 6620 706c 6179    async def play
-0001b550: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001b560: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
-0001b570: 2020 2076 6f6c 756d 653a 2069 6e74 207c     volume: int |
-0001b580: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-0001b590: 2020 2020 2020 7265 7065 6174 5f74 696d        repeat_tim
-0001b5a0: 6573 3a20 696e 7420 7c20 4e6f 6e65 203d  es: int | None =
-0001b5b0: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
-0001b5c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-0001b5d0: 2250 6c61 7973 2063 6869 6d65 2074 6f6e  "Plays chime ton
-0001b5e0: 6522 2222 0a0a 2020 2020 2020 2020 6177  e"""..        aw
-0001b5f0: 6169 7420 7365 6c66 2e61 7069 2e70 6c61  ait self.api.pla
-0001b600: 795f 7370 6561 6b65 7228 7365 6c66 2e69  y_speaker(self.i
-0001b610: 642c 2076 6f6c 756d 653d 766f 6c75 6d65  d, volume=volume
-0001b620: 2c20 7265 7065 6174 5f74 696d 6573 3d72  , repeat_times=r
-0001b630: 6570 6561 745f 7469 6d65 7329 0a0a 2020  epeat_times)..  
-0001b640: 2020 6173 796e 6320 6465 6620 706c 6179    async def play
-0001b650: 5f62 757a 7a65 7228 7365 6c66 2920 2d3e  _buzzer(self) ->
-0001b660: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-0001b670: 2222 506c 6179 7320 6368 696d 6520 6275  ""Plays chime bu
-0001b680: 7a7a 6572 2222 220a 0a20 2020 2020 2020  zzer"""..       
-0001b690: 2061 7761 6974 2073 656c 662e 6170 692e   await self.api.
-0001b6a0: 706c 6179 5f62 757a 7a65 7228 7365 6c66  play_buzzer(self
-0001b6b0: 2e69 6429 0a0a 2020 2020 6173 796e 6320  .id)..    async 
-0001b6c0: 6465 6620 7365 745f 7265 7065 6174 5f74  def set_repeat_t
-0001b6d0: 696d 6573 2873 656c 662c 2076 616c 7565  imes(self, value
-0001b6e0: 3a20 696e 7429 202d 3e20 4e6f 6e65 3a0a  : int) -> None:.
-0001b6f0: 2020 2020 2020 2020 2222 2253 6574 2072          """Set r
-0001b700: 6570 6561 7420 7469 6d65 7320 6f6e 2063  epeat times on c
-0001b710: 6869 6d65 2e22 2222 0a0a 2020 2020 2020  hime."""..      
-0001b720: 2020 6f6c 645f 7661 6c75 6520 3d20 7365    old_value = se
-0001b730: 6c66 2e72 6570 6561 745f 7469 6d65 730a  lf.repeat_times.
-0001b740: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
-0001b750: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
-0001b760: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001b770: 662e 7265 7065 6174 5f74 696d 6573 203d  f.repeat_times =
-0001b780: 2063 6173 7428 5265 7065 6174 5469 6d65   cast(RepeatTime
-0001b790: 732c 2076 616c 7565 290a 2020 2020 2020  s, value).      
-0001b7a0: 2020 2020 2020 666f 7220 7365 7474 696e        for settin
-0001b7b0: 6720 696e 2073 656c 662e 7269 6e67 5f73  g in self.ring_s
-0001b7c0: 6574 7469 6e67 733a 0a20 2020 2020 2020  ettings:.       
-0001b7d0: 2020 2020 2020 2020 2069 6620 7365 7474           if sett
-0001b7e0: 696e 672e 7265 7065 6174 5f74 696d 6573  ing.repeat_times
-0001b7f0: 203d 3d20 6f6c 645f 7661 6c75 653a 0a20   == old_value:. 
-0001b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b810: 2020 2073 6574 7469 6e67 2e72 6570 6561     setting.repea
-0001b820: 745f 7469 6d65 7320 3d20 6361 7374 2852  t_times = cast(R
-0001b830: 6570 6561 7454 696d 6573 2c20 7661 6c75  epeatTimes, valu
-0001b840: 6529 0a0a 2020 2020 2020 2020 6177 6169  e)..        awai
-0001b850: 7420 7365 6c66 2e71 7565 7565 5f75 7064  t self.queue_upd
-0001b860: 6174 6528 6361 6c6c 6261 636b 290a 0a20  ate(callback).. 
-0001b870: 2020 2061 7379 6e63 2064 6566 2073 6574     async def set
-0001b880: 5f72 6570 6561 745f 7469 6d65 735f 666f  _repeat_times_fo
-0001b890: 725f 6361 6d65 7261 280a 2020 2020 2020  r_camera(.      
-0001b8a0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001b8b0: 6361 6d65 7261 3a20 4361 6d65 7261 2c0a  camera: Camera,.
-0001b8c0: 2020 2020 2020 2020 7661 6c75 653a 2069          value: i
-0001b8d0: 6e74 2c0a 2020 2020 2920 2d3e 204e 6f6e  nt,.    ) -> Non
-0001b8e0: 653a 0a20 2020 2020 2020 2022 2222 5365  e:.        """Se
-0001b8f0: 7420 7265 7065 6174 2074 696d 6573 206f  t repeat times o
-0001b900: 6e20 6368 696d 6520 666f 7220 7370 6563  n chime for spec
-0001b910: 6966 6963 2063 616d 6572 612e 2222 220a  ific camera.""".
-0001b920: 0a20 2020 2020 2020 2064 6566 2063 616c  .        def cal
-0001b930: 6c62 6163 6b28 2920 2d3e 204e 6f6e 653a  lback() -> None:
-0001b940: 0a20 2020 2020 2020 2020 2020 2068 616e  .            han
-0001b950: 646c 6564 203d 2046 616c 7365 0a20 2020  dled = False.   
-0001b960: 2020 2020 2020 2020 2066 6f72 2073 6574           for set
-0001b970: 7469 6e67 2069 6e20 7365 6c66 2e72 696e  ting in self.rin
-0001b980: 675f 7365 7474 696e 6773 3a0a 2020 2020  g_settings:.    
-0001b990: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001b9a0: 6574 7469 6e67 2e63 616d 6572 615f 6964  etting.camera_id
-0001b9b0: 203d 3d20 6361 6d65 7261 2e69 643a 0a20   == camera.id:. 
-0001b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9d0: 2020 2073 6574 7469 6e67 2e72 6570 6561     setting.repea
-0001b9e0: 745f 7469 6d65 7320 3d20 6361 7374 2852  t_times = cast(R
-0001b9f0: 6570 6561 7454 696d 6573 2c20 7661 6c75  epeatTimes, valu
-0001ba00: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0001ba10: 2020 2020 2020 2068 616e 646c 6564 203d         handled =
-0001ba20: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0001ba30: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-0001ba40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001ba50: 6e6f 7420 6861 6e64 6c65 643a 0a20 2020  not handled:.   
-0001ba60: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001ba70: 7365 2042 6164 5265 7175 6573 7428 2243  se BadRequest("C
-0001ba80: 616d 6572 6120 2573 2069 7320 6e6f 7420  amera %s is not 
-0001ba90: 7061 6972 6564 2077 6974 6820 6368 696d  paired with chim
-0001baa0: 6522 2c20 6361 6d65 7261 2e69 6429 0a0a  e", camera.id)..
-0001bab0: 2020 2020 2020 2020 6177 6169 7420 7365          await se
-0001bac0: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
-0001bad0: 6361 6c6c 6261 636b 290a                 callback).
+00019270: 2020 2020 7365 6c66 2e74 656d 7065 7261      self.tempera
+00019280: 7475 7265 5f73 6574 7469 6e67 732e 6c6f  ture_settings.lo
+00019290: 775f 7468 7265 7368 6f6c 6420 3d20 4e6f  w_threshold = No
+000192a0: 6e65 0a20 2020 2020 2020 2020 2020 2073  ne.            s
+000192b0: 656c 662e 7465 6d70 6572 6174 7572 655f  elf.temperature_
+000192c0: 7365 7474 696e 6773 2e68 6967 685f 7468  settings.high_th
+000192d0: 7265 7368 6f6c 6420 3d20 4e6f 6e65 0a0a  reshold = None..
+000192e0: 2020 2020 2020 2020 6177 6169 7420 7365          await se
+000192f0: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
+00019300: 6361 6c6c 6261 636b 290a 0a20 2020 2061  callback)..    a
+00019310: 7379 6e63 2064 6566 2073 6574 5f68 756d  sync def set_hum
+00019320: 6964 6974 795f 7374 6174 7573 2873 656c  idity_status(sel
+00019330: 662c 2065 6e61 626c 6564 3a20 626f 6f6c  f, enabled: bool
+00019340: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00019350: 2020 2022 2222 5365 7473 2074 6865 2068     """Sets the h
+00019360: 756d 6964 6974 7920 6465 7465 6374 696f  umidity detectio
+00019370: 6e20 7479 7065 2066 6f72 2074 6865 2073  n type for the s
+00019380: 656e 736f 7222 2222 0a0a 2020 2020 2020  ensor"""..      
+00019390: 2020 6465 6620 6361 6c6c 6261 636b 2829    def callback()
+000193a0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000193b0: 2020 2020 2020 7365 6c66 2e68 756d 6964        self.humid
+000193c0: 6974 795f 7365 7474 696e 6773 2e69 735f  ity_settings.is_
+000193d0: 656e 6162 6c65 6420 3d20 656e 6162 6c65  enabled = enable
+000193e0: 640a 0a20 2020 2020 2020 2061 7761 6974  d..        await
+000193f0: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
+00019400: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
+00019410: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
+00019420: 6875 6d69 6469 7479 5f73 6166 655f 7261  humidity_safe_ra
+00019430: 6e67 6528 7365 6c66 2c20 6c6f 773a 2066  nge(self, low: f
+00019440: 6c6f 6174 2c20 6869 6768 3a20 666c 6f61  loat, high: floa
+00019450: 7429 202d 3e20 4e6f 6e65 3a0a 2020 2020  t) -> None:.    
+00019460: 2020 2020 2222 2253 6574 7320 7468 6520      """Sets the 
+00019470: 6875 6d69 6469 7479 2073 6166 6520 7261  humidity safe ra
+00019480: 6e67 6520 666f 7220 7468 6520 7365 6e73  nge for the sens
+00019490: 6f72 2222 220a 0a20 2020 2020 2020 2069  or"""..        i
+000194a0: 6620 6c6f 7720 3c20 312e 303a 0a20 2020  f low < 1.0:.   
+000194b0: 2020 2020 2020 2020 2072 6169 7365 2042           raise B
+000194c0: 6164 5265 7175 6573 7428 224d 696e 696d  adRequest("Minim
+000194d0: 756d 2076 616c 7565 2069 7320 3125 2229  um value is 1%")
+000194e0: 0a20 2020 2020 2020 2069 6620 6869 6768  .        if high
+000194f0: 203e 2039 392e 303a 0a20 2020 2020 2020   > 99.0:.       
+00019500: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
+00019510: 7175 6573 7428 224d 6178 696d 756d 2076  quest("Maximum v
+00019520: 616c 7565 2069 7320 3939 2522 290a 2020  alue is 99%").  
+00019530: 2020 2020 2020 6966 2068 6967 6820 3c3d        if high <=
+00019540: 206c 6f77 3a0a 2020 2020 2020 2020 2020   low:.          
+00019550: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
+00019560: 7374 2822 4869 6768 2076 616c 7565 206d  st("High value m
+00019570: 7573 7420 6265 2061 626f 7665 206c 6f77  ust be above low
+00019580: 2076 616c 7565 2229 0a0a 2020 2020 2020   value")..      
+00019590: 2020 6465 6620 6361 6c6c 6261 636b 2829    def callback()
+000195a0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000195b0: 2020 2020 2020 7365 6c66 2e68 756d 6964        self.humid
+000195c0: 6974 795f 7365 7474 696e 6773 2e6c 6f77  ity_settings.low
+000195d0: 5f74 6872 6573 686f 6c64 203d 206c 6f77  _threshold = low
+000195e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000195f0: 662e 6875 6d69 6469 7479 5f73 6574 7469  f.humidity_setti
+00019600: 6e67 732e 6869 6768 5f74 6872 6573 686f  ngs.high_thresho
+00019610: 6c64 203d 2068 6967 680a 0a20 2020 2020  ld = high..     
+00019620: 2020 2061 7761 6974 2073 656c 662e 7175     await self.qu
+00019630: 6575 655f 7570 6461 7465 2863 616c 6c62  eue_update(callb
+00019640: 6163 6b29 0a0a 2020 2020 6173 796e 6320  ack)..    async 
+00019650: 6465 6620 7265 6d6f 7665 5f68 756d 6964  def remove_humid
+00019660: 6974 795f 7361 6665 5f72 616e 6765 2873  ity_safe_range(s
+00019670: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
+00019680: 2020 2020 2020 2222 2252 656d 6f76 6573        """Removes
+00019690: 2074 6865 2068 756d 6964 6974 7920 7361   the humidity sa
+000196a0: 6665 2072 616e 6765 2066 6f72 2074 6865  fe range for the
+000196b0: 2073 656e 736f 7222 2222 0a0a 2020 2020   sensor"""..    
+000196c0: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
+000196d0: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
+000196e0: 2020 2020 2020 2020 7365 6c66 2e68 756d          self.hum
+000196f0: 6964 6974 795f 7365 7474 696e 6773 2e6c  idity_settings.l
+00019700: 6f77 5f74 6872 6573 686f 6c64 203d 204e  ow_threshold = N
+00019710: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00019720: 7365 6c66 2e68 756d 6964 6974 795f 7365  self.humidity_se
+00019730: 7474 696e 6773 2e68 6967 685f 7468 7265  ttings.high_thre
+00019740: 7368 6f6c 6420 3d20 4e6f 6e65 0a0a 2020  shold = None..  
+00019750: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+00019760: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
+00019770: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
+00019780: 6e63 2064 6566 2073 6574 5f6c 6967 6874  nc def set_light
+00019790: 5f73 7461 7475 7328 7365 6c66 2c20 656e  _status(self, en
+000197a0: 6162 6c65 643a 2062 6f6f 6c29 202d 3e20  abled: bool) -> 
+000197b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+000197c0: 2253 6574 7320 7468 6520 6c69 6768 7420  "Sets the light 
+000197d0: 6465 7465 6374 696f 6e20 7479 7065 2066  detection type f
+000197e0: 6f72 2074 6865 2073 656e 736f 7222 2222  or the sensor"""
+000197f0: 0a0a 2020 2020 2020 2020 6465 6620 6361  ..        def ca
+00019800: 6c6c 6261 636b 2829 202d 3e20 4e6f 6e65  llback() -> None
+00019810: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00019820: 6c66 2e6c 6967 6874 5f73 6574 7469 6e67  lf.light_setting
+00019830: 732e 6973 5f65 6e61 626c 6564 203d 2065  s.is_enabled = e
+00019840: 6e61 626c 6564 0a0a 2020 2020 2020 2020  nabled..        
+00019850: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
+00019860: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
+00019870: 290a 0a20 2020 2061 7379 6e63 2064 6566  )..    async def
+00019880: 2073 6574 5f6c 6967 6874 5f73 6166 655f   set_light_safe_
+00019890: 7261 6e67 6528 7365 6c66 2c20 6c6f 773a  range(self, low:
+000198a0: 2066 6c6f 6174 2c20 6869 6768 3a20 666c   float, high: fl
+000198b0: 6f61 7429 202d 3e20 4e6f 6e65 3a0a 2020  oat) -> None:.  
+000198c0: 2020 2020 2020 2222 2253 6574 7320 7468        """Sets th
+000198d0: 6520 6c69 6768 7420 7361 6665 2072 616e  e light safe ran
+000198e0: 6765 2066 6f72 2074 6865 2073 656e 736f  ge for the senso
+000198f0: 7222 2222 0a0a 2020 2020 2020 2020 6966  r"""..        if
+00019900: 206c 6f77 203c 2031 2e30 3a0a 2020 2020   low < 1.0:.    
+00019910: 2020 2020 2020 2020 7261 6973 6520 4261          raise Ba
+00019920: 6452 6571 7565 7374 2822 4d69 6e69 6d75  dRequest("Minimu
+00019930: 6d20 7661 6c75 6520 6973 2031 206c 7578  m value is 1 lux
+00019940: 2229 0a20 2020 2020 2020 2069 6620 6869  ").        if hi
+00019950: 6768 203e 2031 3030 302e 303a 0a20 2020  gh > 1000.0:.   
+00019960: 2020 2020 2020 2020 2072 6169 7365 2042           raise B
+00019970: 6164 5265 7175 6573 7428 224d 6178 696d  adRequest("Maxim
+00019980: 756d 2076 616c 7565 2069 7320 3130 3030  um value is 1000
+00019990: 206c 7578 2229 0a20 2020 2020 2020 2069   lux").        i
+000199a0: 6620 6869 6768 203c 3d20 6c6f 773a 0a20  f high <= low:. 
+000199b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000199c0: 2042 6164 5265 7175 6573 7428 2248 6967   BadRequest("Hig
+000199d0: 6820 7661 6c75 6520 6d75 7374 2062 6520  h value must be 
+000199e0: 6162 6f76 6520 6c6f 7720 7661 6c75 6522  above low value"
+000199f0: 290a 0a20 2020 2020 2020 2064 6566 2063  )..        def c
+00019a00: 616c 6c62 6163 6b28 2920 2d3e 204e 6f6e  allback() -> Non
+00019a10: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00019a20: 656c 662e 6c69 6768 745f 7365 7474 696e  elf.light_settin
+00019a30: 6773 2e6c 6f77 5f74 6872 6573 686f 6c64  gs.low_threshold
+00019a40: 203d 206c 6f77 0a20 2020 2020 2020 2020   = low.         
+00019a50: 2020 2073 656c 662e 6c69 6768 745f 7365     self.light_se
+00019a60: 7474 696e 6773 2e68 6967 685f 7468 7265  ttings.high_thre
+00019a70: 7368 6f6c 6420 3d20 6869 6768 0a0a 2020  shold = high..  
+00019a80: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+00019a90: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
+00019aa0: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
+00019ab0: 6e63 2064 6566 2072 656d 6f76 655f 6c69  nc def remove_li
+00019ac0: 6768 745f 7361 6665 5f72 616e 6765 2873  ght_safe_range(s
+00019ad0: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
+00019ae0: 2020 2020 2020 2222 2252 656d 6f76 6573        """Removes
+00019af0: 2074 6865 206c 6967 6874 2073 6166 6520   the light safe 
+00019b00: 7261 6e67 6520 666f 7220 7468 6520 7365  range for the se
+00019b10: 6e73 6f72 2222 220a 0a20 2020 2020 2020  nsor"""..       
+00019b20: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+00019b30: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00019b40: 2020 2020 2073 656c 662e 6c69 6768 745f       self.light_
+00019b50: 7365 7474 696e 6773 2e6c 6f77 5f74 6872  settings.low_thr
+00019b60: 6573 686f 6c64 203d 204e 6f6e 650a 2020  eshold = None.  
+00019b70: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00019b80: 6967 6874 5f73 6574 7469 6e67 732e 6869  ight_settings.hi
+00019b90: 6768 5f74 6872 6573 686f 6c64 203d 204e  gh_threshold = N
+00019ba0: 6f6e 650a 0a20 2020 2020 2020 2061 7761  one..        awa
+00019bb0: 6974 2073 656c 662e 7175 6575 655f 7570  it self.queue_up
+00019bc0: 6461 7465 2863 616c 6c62 6163 6b29 0a0a  date(callback)..
+00019bd0: 2020 2020 6173 796e 6320 6465 6620 7365      async def se
+00019be0: 745f 616c 6172 6d5f 7374 6174 7573 2873  t_alarm_status(s
+00019bf0: 656c 662c 2065 6e61 626c 6564 3a20 626f  elf, enabled: bo
+00019c00: 6f6c 2920 2d3e 204e 6f6e 653a 0a20 2020  ol) -> None:.   
+00019c10: 2020 2020 2022 2222 5365 7473 2074 6865       """Sets the
+00019c20: 2061 6c61 726d 2064 6574 6563 7469 6f6e   alarm detection
+00019c30: 2074 7970 6520 666f 7220 7468 6520 7365   type for the se
+00019c40: 6e73 6f72 2222 220a 0a20 2020 2020 2020  nsor"""..       
+00019c50: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+00019c60: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00019c70: 2020 2020 2073 656c 662e 616c 6172 6d5f       self.alarm_
+00019c80: 7365 7474 696e 6773 2e69 735f 656e 6162  settings.is_enab
+00019c90: 6c65 6420 3d20 656e 6162 6c65 640a 0a20  led = enabled.. 
+00019ca0: 2020 2020 2020 2061 7761 6974 2073 656c         await sel
+00019cb0: 662e 7175 6575 655f 7570 6461 7465 2863  f.queue_update(c
+00019cc0: 616c 6c62 6163 6b29 0a0a 2020 2020 6173  allback)..    as
+00019cd0: 796e 6320 6465 6620 7365 745f 7061 6972  ync def set_pair
+00019ce0: 6564 5f63 616d 6572 6128 7365 6c66 2c20  ed_camera(self, 
+00019cf0: 6361 6d65 7261 3a20 4f70 7469 6f6e 616c  camera: Optional
+00019d00: 5b43 616d 6572 615d 2920 2d3e 204e 6f6e  [Camera]) -> Non
+00019d10: 653a 0a20 2020 2020 2020 2022 2222 5365  e:.        """Se
+00019d20: 7473 2074 6865 2063 616d 6572 6120 7061  ts the camera pa
+00019d30: 6972 6564 2077 6974 6820 7468 6520 7365  ired with the se
+00019d40: 6e73 6f72 2222 220a 0a20 2020 2020 2020  nsor"""..       
+00019d50: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+00019d60: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00019d70: 2020 2020 2069 6620 6361 6d65 7261 2069       if camera i
+00019d80: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00019d90: 2020 2020 2020 2020 7365 6c66 2e63 616d          self.cam
+00019da0: 6572 615f 6964 203d 204e 6f6e 650a 2020  era_id = None.  
+00019db0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00019dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019dd0: 7365 6c66 2e63 616d 6572 615f 6964 203d  self.camera_id =
+00019de0: 2063 616d 6572 612e 6964 0a0a 2020 2020   camera.id..    
+00019df0: 2020 2020 6177 6169 7420 7365 6c66 2e71      await self.q
+00019e00: 7565 7565 5f75 7064 6174 6528 6361 6c6c  ueue_update(call
+00019e10: 6261 636b 290a 0a20 2020 2061 7379 6e63  back)..    async
+00019e20: 2064 6566 2063 6c65 6172 5f74 616d 7065   def clear_tampe
+00019e30: 7228 7365 6c66 2920 2d3e 204e 6f6e 653a  r(self) -> None:
+00019e40: 0a20 2020 2020 2020 2022 2222 436c 6561  .        """Clea
+00019e50: 7273 2074 616d 7065 7220 7374 6174 7573  rs tamper status
+00019e60: 2066 6f72 2073 656e 736f 7222 2222 0a0a   for sensor"""..
+00019e70: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00019e80: 656c 662e 6170 692e 626f 6f74 7374 7261  elf.api.bootstra
+00019e90: 702e 6175 7468 5f75 7365 722e 6361 6e28  p.auth_user.can(
+00019ea0: 0a20 2020 2020 2020 2020 2020 204d 6f64  .            Mod
+00019eb0: 656c 5479 7065 2e53 454e 534f 522c 0a20  elType.SENSOR,. 
+00019ec0: 2020 2020 2020 2020 2020 2050 6572 6d69             Permi
+00019ed0: 7373 696f 6e4e 6f64 652e 5752 4954 452c  ssionNode.WRITE,
+00019ee0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019ef0: 662c 0a20 2020 2020 2020 2029 3a0a 2020  f,.        ):.  
+00019f00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019f10: 4e6f 7441 7574 686f 7269 7a65 6428 0a20  NotAuthorized(. 
+00019f20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00019f30: 2244 6f20 6e6f 7420 6861 7665 2070 6572  "Do not have per
+00019f40: 6d69 7373 696f 6e20 746f 2063 6c65 6172  mission to clear
+00019f50: 2074 616d 7065 7220 666f 7220 7365 6e73   tamper for sens
+00019f60: 6f72 3a20 7b73 656c 662e 6964 7d22 2c0a  or: {self.id}",.
+00019f70: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00019f80: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+00019f90: 2e61 7069 2e63 6c65 6172 5f74 616d 7065  .api.clear_tampe
+00019fa0: 725f 7365 6e73 6f72 2873 656c 662e 6964  r_sensor(self.id
+00019fb0: 290a 0a0a 636c 6173 7320 446f 6f72 6c6f  )...class Doorlo
+00019fc0: 636b 2850 726f 7465 6374 4164 6f70 7461  ck(ProtectAdopta
+00019fd0: 626c 6544 6576 6963 654d 6f64 656c 293a  bleDeviceModel):
+00019fe0: 0a20 2020 2063 7265 6465 6e74 6961 6c73  .    credentials
+00019ff0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d0a  : Optional[str].
+0001a000: 2020 2020 6c6f 636b 5f73 7461 7475 733a      lock_status:
+0001a010: 204c 6f63 6b53 7461 7475 7354 7970 650a   LockStatusType.
+0001a020: 2020 2020 656e 6162 6c65 5f68 6f6d 656b      enable_homek
+0001a030: 6974 3a20 626f 6f6c 0a20 2020 2061 7574  it: bool.    aut
+0001a040: 6f5f 636c 6f73 655f 7469 6d65 3a20 7469  o_close_time: ti
+0001a050: 6d65 6465 6c74 610a 2020 2020 6c65 645f  medelta.    led_
+0001a060: 7365 7474 696e 6773 3a20 5365 6e73 6f72  settings: Sensor
+0001a070: 5365 7474 696e 6773 4261 7365 0a20 2020  SettingsBase.   
+0001a080: 2062 6174 7465 7279 5f73 7461 7475 733a   battery_status:
+0001a090: 2053 656e 736f 7242 6174 7465 7279 5374   SensorBatterySt
+0001a0a0: 6174 7573 0a20 2020 2063 616d 6572 615f  atus.    camera_
+0001a0b0: 6964 3a20 4f70 7469 6f6e 616c 5b73 7472  id: Optional[str
+0001a0c0: 5d0a 2020 2020 6861 735f 686f 6d65 6b69  ].    has_homeki
+0001a0d0: 743a 2062 6f6f 6c0a 2020 2020 7072 6976  t: bool.    priv
+0001a0e0: 6174 655f 746f 6b65 6e3a 2073 7472 0a0a  ate_token: str..
+0001a0f0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+0001a100: 0a20 2020 2040 6361 6368 650a 2020 2020  .    @cache.    
+0001a110: 6465 6620 5f67 6574 5f75 6e69 6669 5f72  def _get_unifi_r
+0001a120: 656d 6170 7328 636c 7329 202d 3e20 6469  emaps(cls) -> di
+0001a130: 6374 5b73 7472 2c20 7374 725d 3a0a 2020  ct[str, str]:.  
+0001a140: 2020 2020 2020 7265 7475 726e 207b 0a20        return {. 
+0001a150: 2020 2020 2020 2020 2020 202a 2a73 7570             **sup
+0001a160: 6572 2829 2e5f 6765 745f 756e 6966 695f  er()._get_unifi_
+0001a170: 7265 6d61 7073 2829 2c0a 2020 2020 2020  remaps(),.      
+0001a180: 2020 2020 2020 2263 616d 6572 6122 3a20        "camera": 
+0001a190: 2263 616d 6572 6149 6422 2c0a 2020 2020  "cameraId",.    
+0001a1a0: 2020 2020 2020 2020 2261 7574 6f43 6c6f          "autoClo
+0001a1b0: 7365 5469 6d65 4d73 223a 2022 6175 746f  seTimeMs": "auto
+0001a1c0: 436c 6f73 6554 696d 6522 2c0a 2020 2020  CloseTime",.    
+0001a1d0: 2020 2020 7d0a 0a20 2020 2040 636c 6173      }..    @clas
+0001a1e0: 736d 6574 686f 640a 2020 2020 4063 6163  smethod.    @cac
+0001a1f0: 6865 0a20 2020 2064 6566 205f 6765 745f  he.    def _get_
+0001a200: 7265 6164 5f6f 6e6c 795f 6669 656c 6473  read_only_fields
+0001a210: 2863 6c73 2920 2d3e 2073 6574 5b73 7472  (cls) -> set[str
+0001a220: 5d3a 0a20 2020 2020 2020 2072 6574 7572  ]:.        retur
+0001a230: 6e20 7375 7065 7228 292e 5f67 6574 5f72  n super()._get_r
+0001a240: 6561 645f 6f6e 6c79 5f66 6965 6c64 7328  ead_only_fields(
+0001a250: 2920 7c20 7b0a 2020 2020 2020 2020 2020  ) | {.          
+0001a260: 2020 2263 7265 6465 6e74 6961 6c73 222c    "credentials",
+0001a270: 0a20 2020 2020 2020 2020 2020 2022 6c6f  .            "lo
+0001a280: 636b 5374 6174 7573 222c 0a20 2020 2020  ckStatus",.     
+0001a290: 2020 2020 2020 2022 6261 7474 6572 7953         "batteryS
+0001a2a0: 7461 7475 7322 2c0a 2020 2020 2020 2020  tatus",.        
+0001a2b0: 7d0a 0a20 2020 2040 636c 6173 736d 6574  }..    @classmet
+0001a2c0: 686f 640a 2020 2020 6465 6620 756e 6966  hod.    def unif
+0001a2d0: 695f 6469 6374 5f74 6f5f 6469 6374 2863  i_dict_to_dict(c
+0001a2e0: 6c73 2c20 6461 7461 3a20 6469 6374 5b73  ls, data: dict[s
+0001a2f0: 7472 2c20 416e 795d 2920 2d3e 2064 6963  tr, Any]) -> dic
+0001a300: 745b 7374 722c 2041 6e79 5d3a 0a20 2020  t[str, Any]:.   
+0001a310: 2020 2020 2069 6620 2261 7574 6f43 6c6f       if "autoClo
+0001a320: 7365 5469 6d65 4d73 2220 696e 2064 6174  seTimeMs" in dat
+0001a330: 6120 616e 6420 6e6f 7420 6973 696e 7374  a and not isinst
+0001a340: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
+0001a350: 2020 6461 7461 5b22 6175 746f 436c 6f73    data["autoClos
+0001a360: 6554 696d 654d 7322 5d2c 0a20 2020 2020  eTimeMs"],.     
+0001a370: 2020 2020 2020 2074 696d 6564 656c 7461         timedelta
+0001a380: 2c0a 2020 2020 2020 2020 293a 0a20 2020  ,.        ):.   
+0001a390: 2020 2020 2020 2020 2064 6174 615b 2261           data["a
+0001a3a0: 7574 6f43 6c6f 7365 5469 6d65 4d73 225d  utoCloseTimeMs"]
+0001a3b0: 203d 2074 696d 6564 656c 7461 286d 696c   = timedelta(mil
+0001a3c0: 6c69 7365 636f 6e64 733d 6461 7461 5b22  liseconds=data["
+0001a3d0: 6175 746f 436c 6f73 6554 696d 654d 7322  autoCloseTimeMs"
+0001a3e0: 5d29 0a0a 2020 2020 2020 2020 7265 7475  ])..        retu
+0001a3f0: 726e 2073 7570 6572 2829 2e75 6e69 6669  rn super().unifi
+0001a400: 5f64 6963 745f 746f 5f64 6963 7428 6461  _dict_to_dict(da
+0001a410: 7461 290a 0a20 2020 2040 7072 6f70 6572  ta)..    @proper
+0001a420: 7479 0a20 2020 2064 6566 2063 616d 6572  ty.    def camer
+0001a430: 6128 7365 6c66 2920 2d3e 204f 7074 696f  a(self) -> Optio
+0001a440: 6e61 6c5b 4361 6d65 7261 5d3a 0a20 2020  nal[Camera]:.   
+0001a450: 2020 2020 2022 2222 5061 6972 6564 2043       """Paired C
+0001a460: 616d 6572 6120 7769 6c6c 2061 6c77 6179  amera will alway
+0001a470: 7320 6265 206e 6f6e 6520 6966 206e 6f20  s be none if no 
+0001a480: 6361 6d65 7261 2069 7320 7061 6972 6564  camera is paired
+0001a490: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
+0001a4a0: 7365 6c66 2e63 616d 6572 615f 6964 2069  self.camera_id i
+0001a4b0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001a4c0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+0001a4d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001a4e0: 7365 6c66 2e61 7069 2e62 6f6f 7473 7472  self.api.bootstr
+0001a4f0: 6170 2e63 616d 6572 6173 5b73 656c 662e  ap.cameras[self.
+0001a500: 6361 6d65 7261 5f69 645d 0a0a 2020 2020  camera_id]..    
+0001a510: 6173 796e 6320 6465 6620 7365 745f 7061  async def set_pa
+0001a520: 6972 6564 5f63 616d 6572 6128 7365 6c66  ired_camera(self
+0001a530: 2c20 6361 6d65 7261 3a20 4f70 7469 6f6e  , camera: Option
+0001a540: 616c 5b43 616d 6572 615d 2920 2d3e 204e  al[Camera]) -> N
+0001a550: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+0001a560: 5365 7473 2074 6865 2063 616d 6572 6120  Sets the camera 
+0001a570: 7061 6972 6564 2077 6974 6820 7468 6520  paired with the 
+0001a580: 7365 6e73 6f72 2222 220a 0a20 2020 2020  sensor"""..     
+0001a590: 2020 2064 6566 2063 616c 6c62 6163 6b28     def callback(
+0001a5a0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0001a5b0: 2020 2020 2020 2069 6620 6361 6d65 7261         if camera
+0001a5c0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001a5d0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+0001a5e0: 616d 6572 615f 6964 203d 204e 6f6e 650a  amera_id = None.
+0001a5f0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001a600: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001a610: 2020 7365 6c66 2e63 616d 6572 615f 6964    self.camera_id
+0001a620: 203d 2063 616d 6572 612e 6964 0a0a 2020   = camera.id..  
+0001a630: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+0001a640: 2e71 7565 7565 5f75 7064 6174 6528 6361  .queue_update(ca
+0001a650: 6c6c 6261 636b 290a 0a20 2020 2061 7379  llback)..    asy
+0001a660: 6e63 2064 6566 2073 6574 5f73 7461 7475  nc def set_statu
+0001a670: 735f 6c69 6768 7428 7365 6c66 2c20 656e  s_light(self, en
+0001a680: 6162 6c65 643a 2062 6f6f 6c29 202d 3e20  abled: bool) -> 
+0001a690: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+0001a6a0: 2253 6574 7320 7468 6520 7374 6174 7573  "Sets the status
+0001a6b0: 2069 6e64 6963 6174 6f72 206c 6967 6874   indicator light
+0001a6c0: 2066 6f72 2074 6865 2064 6f6f 726c 6f63   for the doorloc
+0001a6d0: 6b22 2222 0a0a 2020 2020 2020 2020 6465  k"""..        de
+0001a6e0: 6620 6361 6c6c 6261 636b 2829 202d 3e20  f callback() -> 
+0001a6f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001a700: 2020 7365 6c66 2e6c 6564 5f73 6574 7469    self.led_setti
+0001a710: 6e67 732e 6973 5f65 6e61 626c 6564 203d  ngs.is_enabled =
+0001a720: 2065 6e61 626c 6564 0a0a 2020 2020 2020   enabled..      
+0001a730: 2020 6177 6169 7420 7365 6c66 2e71 7565    await self.que
+0001a740: 7565 5f75 7064 6174 6528 6361 6c6c 6261  ue_update(callba
+0001a750: 636b 290a 0a20 2020 2061 7379 6e63 2064  ck)..    async d
+0001a760: 6566 2073 6574 5f61 7574 6f5f 636c 6f73  ef set_auto_clos
+0001a770: 655f 7469 6d65 2873 656c 662c 2064 7572  e_time(self, dur
+0001a780: 6174 696f 6e3a 2074 696d 6564 656c 7461  ation: timedelta
+0001a790: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0001a7a0: 2020 2022 2222 5365 7473 2074 6865 2061     """Sets the a
+0001a7b0: 7574 6f2d 636c 6f73 6520 7469 6d65 2066  uto-close time f
+0001a7c0: 6f72 2064 6f6f 726c 6f63 6b2e 2030 2073  or doorlock. 0 s
+0001a7d0: 6563 6f6e 6473 203d 2064 6973 6162 6c65  econds = disable
+0001a7e0: 642e 2222 220a 0a20 2020 2020 2020 2069  d."""..        i
+0001a7f0: 6620 6475 7261 7469 6f6e 203e 2074 696d  f duration > tim
+0001a800: 6564 656c 7461 2868 6f75 7273 3d31 293a  edelta(hours=1):
+0001a810: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001a820: 7365 2042 6164 5265 7175 6573 7428 224d  se BadRequest("M
+0001a830: 6178 2064 7572 6174 696f 6e20 6973 2031  ax duration is 1
+0001a840: 2068 6f75 7222 290a 0a20 2020 2020 2020   hour")..       
+0001a850: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+0001a860: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001a870: 2020 2020 2073 656c 662e 6175 746f 5f63       self.auto_c
+0001a880: 6c6f 7365 5f74 696d 6520 3d20 6475 7261  lose_time = dura
+0001a890: 7469 6f6e 0a0a 2020 2020 2020 2020 6177  tion..        aw
+0001a8a0: 6169 7420 7365 6c66 2e71 7565 7565 5f75  ait self.queue_u
+0001a8b0: 7064 6174 6528 6361 6c6c 6261 636b 290a  pdate(callback).
+0001a8c0: 0a20 2020 2061 7379 6e63 2064 6566 2063  .    async def c
+0001a8d0: 6c6f 7365 5f6c 6f63 6b28 7365 6c66 2920  lose_lock(self) 
+0001a8e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001a8f0: 2022 2222 436c 6f73 6520 646f 6f72 6c6f   """Close doorlo
+0001a900: 636b 2028 6c6f 636b 2922 2222 0a0a 2020  ck (lock)"""..  
+0001a910: 2020 2020 2020 6966 2073 656c 662e 6c6f        if self.lo
+0001a920: 636b 5f73 7461 7475 7320 213d 204c 6f63  ck_status != Loc
+0001a930: 6b53 7461 7475 7354 7970 652e 4f50 454e  kStatusType.OPEN
+0001a940: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001a950: 6973 6520 4261 6452 6571 7565 7374 2822  ise BadRequest("
+0001a960: 4c6f 636b 2069 7320 6e6f 7420 6f70 656e  Lock is not open
+0001a970: 2229 0a0a 2020 2020 2020 2020 6177 6169  ")..        awai
+0001a980: 7420 7365 6c66 2e61 7069 2e63 6c6f 7365  t self.api.close
+0001a990: 5f6c 6f63 6b28 7365 6c66 2e69 6429 0a0a  _lock(self.id)..
+0001a9a0: 2020 2020 6173 796e 6320 6465 6620 6f70      async def op
+0001a9b0: 656e 5f6c 6f63 6b28 7365 6c66 2920 2d3e  en_lock(self) ->
+0001a9c0: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+0001a9d0: 2222 4f70 656e 2064 6f6f 726c 6f63 6b20  ""Open doorlock 
+0001a9e0: 2875 6e6c 6f63 6b29 2222 220a 0a20 2020  (unlock)"""..   
+0001a9f0: 2020 2020 2069 6620 7365 6c66 2e6c 6f63       if self.loc
+0001aa00: 6b5f 7374 6174 7573 2021 3d20 4c6f 636b  k_status != Lock
+0001aa10: 5374 6174 7573 5479 7065 2e43 4c4f 5345  StatusType.CLOSE
+0001aa20: 443a 0a20 2020 2020 2020 2020 2020 2072  D:.            r
+0001aa30: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
+0001aa40: 224c 6f63 6b20 6973 206e 6f74 2063 6c6f  "Lock is not clo
+0001aa50: 7365 6422 290a 0a20 2020 2020 2020 2061  sed")..        a
+0001aa60: 7761 6974 2073 656c 662e 6170 692e 6f70  wait self.api.op
+0001aa70: 656e 5f6c 6f63 6b28 7365 6c66 2e69 6429  en_lock(self.id)
+0001aa80: 0a0a 2020 2020 6173 796e 6320 6465 6620  ..    async def 
+0001aa90: 6361 6c69 6272 6174 6528 7365 6c66 2920  calibrate(self) 
+0001aaa0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001aab0: 2022 2222 4361 6c69 6272 6174 6520 7468   """Calibrate th
+0001aac0: 6520 646f 6f72 6c6f 636b 2e0a 0a20 2020  e doorlock...   
+0001aad0: 2020 2020 2044 6f6f 7220 6d75 7374 2062       Door must b
+0001aae0: 6520 6f70 656e 2061 6e64 206c 6f63 6b20  e open and lock 
+0001aaf0: 756e 6c6f 636b 6564 2e0a 2020 2020 2020  unlocked..      
+0001ab00: 2020 2222 220a 0a20 2020 2020 2020 2061    """..        a
+0001ab10: 7761 6974 2073 656c 662e 6170 692e 6361  wait self.api.ca
+0001ab20: 6c69 6272 6174 655f 6c6f 636b 2873 656c  librate_lock(sel
+0001ab30: 662e 6964 290a 0a0a 636c 6173 7320 4368  f.id)...class Ch
+0001ab40: 696d 6546 6561 7475 7265 466c 6167 7328  imeFeatureFlags(
+0001ab50: 5072 6f74 6563 7442 6173 654f 626a 6563  ProtectBaseObjec
+0001ab60: 7429 3a0a 2020 2020 6861 735f 7769 6669  t):.    has_wifi
+0001ab70: 3a20 626f 6f6c 0a20 2020 2023 2032 2e39  : bool.    # 2.9
+0001ab80: 2e32 302b 0a20 2020 2068 6173 5f68 7474  .20+.    has_htt
+0001ab90: 7073 5f63 6c69 656e 745f 6f74 613a 204f  ps_client_ota: O
+0001aba0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+0001abb0: 4e6f 6e65 0a0a 2020 2020 4063 6c61 7373  None..    @class
+0001abc0: 6d65 7468 6f64 0a20 2020 2040 6361 6368  method.    @cach
+0001abd0: 650a 2020 2020 6465 6620 5f67 6574 5f75  e.    def _get_u
+0001abe0: 6e69 6669 5f72 656d 6170 7328 636c 7329  nifi_remaps(cls)
+0001abf0: 202d 3e20 6469 6374 5b73 7472 2c20 7374   -> dict[str, st
+0001ac00: 725d 3a0a 2020 2020 2020 2020 7265 7475  r]:.        retu
+0001ac10: 726e 207b 2a2a 7375 7065 7228 292e 5f67  rn {**super()._g
+0001ac20: 6574 5f75 6e69 6669 5f72 656d 6170 7328  et_unifi_remaps(
+0001ac30: 292c 2022 6861 7348 7474 7073 436c 6965  ), "hasHttpsClie
+0001ac40: 6e74 4f54 4122 3a20 2268 6173 4874 7470  ntOTA": "hasHttp
+0001ac50: 7343 6c69 656e 744f 7461 227d 0a0a 0a63  sClientOta"}...c
+0001ac60: 6c61 7373 2052 696e 6753 6574 7469 6e67  lass RingSetting
+0001ac70: 2850 726f 7465 6374 4261 7365 4f62 6a65  (ProtectBaseObje
+0001ac80: 6374 293a 0a20 2020 2063 616d 6572 615f  ct):.    camera_
+0001ac90: 6964 3a20 7374 720a 2020 2020 7265 7065  id: str.    repe
+0001aca0: 6174 5f74 696d 6573 3a20 5265 7065 6174  at_times: Repeat
+0001acb0: 5469 6d65 730a 2020 2020 7472 6163 6b5f  Times.    track_
+0001acc0: 6e6f 3a20 696e 740a 2020 2020 766f 6c75  no: int.    volu
+0001acd0: 6d65 3a20 696e 740a 0a20 2020 2040 636c  me: int..    @cl
+0001ace0: 6173 736d 6574 686f 640a 2020 2020 4063  assmethod.    @c
+0001acf0: 6163 6865 0a20 2020 2064 6566 205f 6765  ache.    def _ge
+0001ad00: 745f 756e 6966 695f 7265 6d61 7073 2863  t_unifi_remaps(c
+0001ad10: 6c73 2920 2d3e 2064 6963 745b 7374 722c  ls) -> dict[str,
+0001ad20: 2073 7472 5d3a 0a20 2020 2020 2020 2072   str]:.        r
+0001ad30: 6574 7572 6e20 7b2a 2a73 7570 6572 2829  eturn {**super()
+0001ad40: 2e5f 6765 745f 756e 6966 695f 7265 6d61  ._get_unifi_rema
+0001ad50: 7073 2829 2c20 2263 616d 6572 6122 3a20  ps(), "camera": 
+0001ad60: 2263 616d 6572 6149 6422 7d0a 0a20 2020  "cameraId"}..   
+0001ad70: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0001ad80: 6566 2063 616d 6572 6128 7365 6c66 2920  ef camera(self) 
+0001ad90: 2d3e 204f 7074 696f 6e61 6c5b 4361 6d65  -> Optional[Came
+0001ada0: 7261 5d3a 0a20 2020 2020 2020 2022 2222  ra]:.        """
+0001adb0: 5061 6972 6564 2043 616d 6572 6120 7769  Paired Camera wi
+0001adc0: 6c6c 2061 6c77 6179 7320 6265 206e 6f6e  ll always be non
+0001add0: 6520 6966 206e 6f20 6361 6d65 7261 2069  e if no camera i
+0001ade0: 7320 7061 6972 6564 2222 220a 0a20 2020  s paired"""..   
+0001adf0: 2020 2020 2069 6620 7365 6c66 2e63 616d       if self.cam
+0001ae00: 6572 615f 6964 2069 7320 4e6f 6e65 3a0a  era_id is None:.
+0001ae10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001ae20: 726e 204e 6f6e 650a 0a20 2020 2020 2020  rn None..       
+0001ae30: 2072 6574 7572 6e20 7365 6c66 2e61 7069   return self.api
+0001ae40: 2e62 6f6f 7473 7472 6170 2e63 616d 6572  .bootstrap.camer
+0001ae50: 6173 5b73 656c 662e 6361 6d65 7261 5f69  as[self.camera_i
+0001ae60: 645d 0a0a 0a63 6c61 7373 2043 6869 6d65  d]...class Chime
+0001ae70: 5472 6163 6b28 5072 6f74 6563 7442 6173  Track(ProtectBas
+0001ae80: 654f 626a 6563 7429 3a0a 2020 2020 6d64  eObject):.    md
+0001ae90: 353a 2073 7472 0a20 2020 206e 616d 653a  5: str.    name:
+0001aea0: 2073 7472 0a20 2020 2073 7461 7465 3a20   str.    state: 
+0001aeb0: 7374 720a 2020 2020 7472 6163 6b5f 6e6f  str.    track_no
+0001aec0: 3a20 696e 740a 2020 2020 766f 6c75 6d65  : int.    volume
+0001aed0: 3a20 696e 740a 2020 2020 7369 7a65 3a20  : int.    size: 
+0001aee0: 696e 740a 0a20 2020 2040 636c 6173 736d  int..    @classm
+0001aef0: 6574 686f 640a 2020 2020 4063 6163 6865  ethod.    @cache
+0001af00: 0a20 2020 2064 6566 205f 6765 745f 756e  .    def _get_un
+0001af10: 6966 695f 7265 6d61 7073 2863 6c73 2920  ifi_remaps(cls) 
+0001af20: 2d3e 2064 6963 745b 7374 722c 2073 7472  -> dict[str, str
+0001af30: 5d3a 0a20 2020 2020 2020 2072 6574 7572  ]:.        retur
+0001af40: 6e20 7b2a 2a73 7570 6572 2829 2e5f 6765  n {**super()._ge
+0001af50: 745f 756e 6966 695f 7265 6d61 7073 2829  t_unifi_remaps()
+0001af60: 2c20 2274 7261 636b 5f6e 6f22 3a20 2274  , "track_no": "t
+0001af70: 7261 636b 4e6f 227d 0a0a 0a63 6c61 7373  rackNo"}...class
+0001af80: 2043 6869 6d65 2850 726f 7465 6374 4164   Chime(ProtectAd
+0001af90: 6f70 7461 626c 6544 6576 6963 654d 6f64  optableDeviceMod
+0001afa0: 656c 293a 0a20 2020 2076 6f6c 756d 653a  el):.    volume:
+0001afb0: 2050 6572 6365 6e74 496e 740a 2020 2020   PercentInt.    
+0001afc0: 6973 5f70 726f 6269 6e67 5f66 6f72 5f77  is_probing_for_w
+0001afd0: 6966 693a 2062 6f6f 6c0a 2020 2020 6c61  ifi: bool.    la
+0001afe0: 7374 5f72 696e 673a 204f 7074 696f 6e61  st_ring: Optiona
+0001aff0: 6c5b 6461 7465 7469 6d65 5d0a 2020 2020  l[datetime].    
+0001b000: 6973 5f77 6972 656c 6573 735f 7570 6c69  is_wireless_upli
+0001b010: 6e6b 5f65 6e61 626c 6564 3a20 626f 6f6c  nk_enabled: bool
+0001b020: 0a20 2020 2063 616d 6572 615f 6964 733a  .    camera_ids:
+0001b030: 206c 6973 745b 7374 725d 0a20 2020 2023   list[str].    #
+0001b040: 2072 6571 7569 7265 7320 322e 362e 3137   requires 2.6.17
+0001b050: 2b0a 2020 2020 6170 5f6d 676d 745f 6970  +.    ap_mgmt_ip
+0001b060: 3a20 4f70 7469 6f6e 616c 5b49 5076 3441  : Optional[IPv4A
+0001b070: 6464 7265 7373 5d20 3d20 4e6f 6e65 0a20  ddress] = None. 
+0001b080: 2020 2023 2072 6571 7569 7265 7320 322e     # requires 2.
+0001b090: 372e 3135 2b0a 2020 2020 6665 6174 7572  7.15+.    featur
+0001b0a0: 655f 666c 6167 733a 204f 7074 696f 6e61  e_flags: Optiona
+0001b0b0: 6c5b 4368 696d 6546 6561 7475 7265 466c  l[ChimeFeatureFl
+0001b0c0: 6167 735d 203d 204e 6f6e 650a 2020 2020  ags] = None.    
+0001b0d0: 2320 7265 7175 6972 6573 2032 2e38 2e32  # requires 2.8.2
+0001b0e0: 322b 0a20 2020 2075 7365 725f 636f 6e66  2+.    user_conf
+0001b0f0: 6967 7572 6564 5f61 703a 204f 7074 696f  igured_ap: Optio
+0001b100: 6e61 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65  nal[bool] = None
+0001b110: 0a20 2020 2023 2072 6571 7569 7265 7320  .    # requires 
+0001b120: 332e 302e 3232 2b0a 2020 2020 6861 735f  3.0.22+.    has_
+0001b130: 6874 7470 735f 636c 6965 6e74 5f6f 7461  https_client_ota
+0001b140: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+0001b150: 203d 204e 6f6e 650a 2020 2020 706c 6174   = None.    plat
+0001b160: 666f 726d 3a20 4f70 7469 6f6e 616c 5b73  form: Optional[s
+0001b170: 7472 5d20 3d20 4e6f 6e65 0a20 2020 2072  tr] = None.    r
+0001b180: 6570 6561 745f 7469 6d65 733a 204f 7074  epeat_times: Opt
+0001b190: 696f 6e61 6c5b 5265 7065 6174 5469 6d65  ional[RepeatTime
+0001b1a0: 735d 203d 204e 6f6e 650a 2020 2020 7472  s] = None.    tr
+0001b1b0: 6163 6b5f 6e6f 3a20 4f70 7469 6f6e 616c  ack_no: Optional
+0001b1c0: 5b69 6e74 5d20 3d20 4e6f 6e65 0a20 2020  [int] = None.   
+0001b1d0: 2072 696e 675f 7365 7474 696e 6773 3a20   ring_settings: 
+0001b1e0: 6c69 7374 5b52 696e 6753 6574 7469 6e67  list[RingSetting
+0001b1f0: 5d20 3d20 5b5d 0a20 2020 2073 7065 616b  ] = [].    speak
+0001b200: 6572 5f74 7261 636b 5f6c 6973 743a 206c  er_track_list: l
+0001b210: 6973 745b 4368 696d 6554 7261 636b 5d20  ist[ChimeTrack] 
+0001b220: 3d20 5b5d 0a20 2020 2023 2072 6571 7569  = [].    # requi
+0001b230: 7265 7320 342e 302e 372b 0a20 2020 2075  res 4.0.7+.    u
+0001b240: 706c 696e 6b5f 6465 7669 6365 3a20 4f70  plink_device: Op
+0001b250: 7469 6f6e 616c 5b41 6e79 5d20 3d20 4e6f  tional[Any] = No
+0001b260: 6e65 0a20 2020 2068 6173 5f77 6966 693a  ne.    has_wifi:
+0001b270: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+0001b280: 3d20 4e6f 6e65 0a0a 2020 2020 2320 544f  = None..    # TO
+0001b290: 444f 3a20 7573 6564 2066 6f72 2061 646f  DO: used for ado
+0001b2a0: 7074 696f 6e0a 2020 2020 2320 6170 4d61  ption.    # apMa
+0001b2b0: 6320 2072 6561 6420 6f6e 6c79 0a20 2020  c  read only.   
+0001b2c0: 2023 2061 7052 7373 6920 2072 6561 6420   # apRssi  read 
+0001b2d0: 6f6e 6c79 0a20 2020 2023 2065 6c65 6d65  only.    # eleme
+0001b2e0: 6e74 496e 666f 2020 7265 6164 206f 6e6c  ntInfo  read onl
+0001b2f0: 790a 0a20 2020 2040 636c 6173 736d 6574  y..    @classmet
+0001b300: 686f 640a 2020 2020 4063 6163 6865 0a20  hod.    @cache. 
+0001b310: 2020 2064 6566 205f 6765 745f 756e 6966     def _get_unif
+0001b320: 695f 7265 6d61 7073 2863 6c73 2920 2d3e  i_remaps(cls) ->
+0001b330: 2064 6963 745b 7374 722c 2073 7472 5d3a   dict[str, str]:
+0001b340: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001b350: 7b2a 2a73 7570 6572 2829 2e5f 6765 745f  {**super()._get_
+0001b360: 756e 6966 695f 7265 6d61 7073 2829 2c20  unifi_remaps(), 
+0001b370: 2268 6173 4874 7470 7343 6c69 656e 744f  "hasHttpsClientO
+0001b380: 5441 223a 2022 6861 7348 7474 7073 436c  TA": "hasHttpsCl
+0001b390: 6965 6e74 4f74 6122 7d0a 0a20 2020 2040  ientOta"}..    @
+0001b3a0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+0001b3b0: 4063 6163 6865 0a20 2020 2064 6566 205f  @cache.    def _
+0001b3c0: 6765 745f 7265 6164 5f6f 6e6c 795f 6669  get_read_only_fi
+0001b3d0: 656c 6473 2863 6c73 2920 2d3e 2073 6574  elds(cls) -> set
+0001b3e0: 5b73 7472 5d3a 0a20 2020 2020 2020 2072  [str]:.        r
+0001b3f0: 6574 7572 6e20 7375 7065 7228 292e 5f67  eturn super()._g
+0001b400: 6574 5f72 6561 645f 6f6e 6c79 5f66 6965  et_read_only_fie
+0001b410: 6c64 7328 2920 7c20 7b22 6973 5072 6f62  lds() | {"isProb
+0001b420: 696e 6746 6f72 5769 6669 222c 2022 6c61  ingForWifi", "la
+0001b430: 7374 5269 6e67 227d 0a0a 2020 2020 4070  stRing"}..    @p
+0001b440: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0001b450: 6361 6d65 7261 7328 7365 6c66 2920 2d3e  cameras(self) ->
+0001b460: 206c 6973 745b 4361 6d65 7261 5d3a 0a20   list[Camera]:. 
+0001b470: 2020 2020 2020 2022 2222 5061 6972 6564         """Paired
+0001b480: 2043 616d 6572 6173 2066 6f72 2063 6869   Cameras for chi
+0001b490: 6d65 2222 220a 0a20 2020 2020 2020 2069  me"""..        i
+0001b4a0: 6620 6c65 6e28 7365 6c66 2e63 616d 6572  f len(self.camer
+0001b4b0: 615f 6964 7329 203d 3d20 303a 0a20 2020  a_ids) == 0:.   
+0001b4c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001b4d0: 5b5d 0a20 2020 2020 2020 2072 6574 7572  [].        retur
+0001b4e0: 6e20 5b73 656c 662e 6170 692e 626f 6f74  n [self.api.boot
+0001b4f0: 7374 7261 702e 6361 6d65 7261 735b 635d  strap.cameras[c]
+0001b500: 2066 6f72 2063 2069 6e20 7365 6c66 2e63   for c in self.c
+0001b510: 616d 6572 615f 6964 735d 0a0a 2020 2020  amera_ids]..    
+0001b520: 6173 796e 6320 6465 6620 7365 745f 766f  async def set_vo
+0001b530: 6c75 6d65 2873 656c 662c 206c 6576 656c  lume(self, level
+0001b540: 3a20 696e 7429 202d 3e20 4e6f 6e65 3a0a  : int) -> None:.
+0001b550: 2020 2020 2020 2020 2222 2253 6574 2074          """Set t
+0001b560: 6865 2076 6f6c 756d 6520 6f6e 2063 6869  he volume on chi
+0001b570: 6d65 2e22 2222 0a0a 2020 2020 2020 2020  me."""..        
+0001b580: 6f6c 645f 7661 6c75 6520 3d20 7365 6c66  old_value = self
+0001b590: 2e76 6f6c 756d 650a 2020 2020 2020 2020  .volume.        
+0001b5a0: 6e65 775f 7661 6c75 6520 3d20 5065 7263  new_value = Perc
+0001b5b0: 656e 7449 6e74 286c 6576 656c 290a 0a20  entInt(level).. 
+0001b5c0: 2020 2020 2020 2064 6566 2063 616c 6c62         def callb
+0001b5d0: 6163 6b28 2920 2d3e 204e 6f6e 653a 0a20  ack() -> None:. 
+0001b5e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001b5f0: 766f 6c75 6d65 203d 206e 6577 5f76 616c  volume = new_val
+0001b600: 7565 0a20 2020 2020 2020 2020 2020 2066  ue.            f
+0001b610: 6f72 2073 6574 7469 6e67 2069 6e20 7365  or setting in se
+0001b620: 6c66 2e72 696e 675f 7365 7474 696e 6773  lf.ring_settings
+0001b630: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001b640: 2020 6966 2073 6574 7469 6e67 2e76 6f6c    if setting.vol
+0001b650: 756d 6520 3d3d 206f 6c64 5f76 616c 7565  ume == old_value
+0001b660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001b670: 2020 2020 2020 7365 7474 696e 672e 766f        setting.vo
+0001b680: 6c75 6d65 203d 206e 6577 5f76 616c 7565  lume = new_value
+0001b690: 0a0a 2020 2020 2020 2020 6177 6169 7420  ..        await 
+0001b6a0: 7365 6c66 2e71 7565 7565 5f75 7064 6174  self.queue_updat
+0001b6b0: 6528 6361 6c6c 6261 636b 290a 0a20 2020  e(callback)..   
+0001b6c0: 2061 7379 6e63 2064 6566 2073 6574 5f76   async def set_v
+0001b6d0: 6f6c 756d 655f 666f 725f 6361 6d65 7261  olume_for_camera
+0001b6e0: 2873 656c 662c 2063 616d 6572 613a 2043  (self, camera: C
+0001b6f0: 616d 6572 612c 206c 6576 656c 3a20 696e  amera, level: in
+0001b700: 7429 202d 3e20 4e6f 6e65 3a0a 2020 2020  t) -> None:.    
+0001b710: 2020 2020 2222 2253 6574 2074 6865 2076      """Set the v
+0001b720: 6f6c 756d 6520 6f6e 2063 6869 6d65 2066  olume on chime f
+0001b730: 6f72 2073 7065 6369 6669 6320 6361 6d65  or specific came
+0001b740: 7261 2e22 2222 0a0a 2020 2020 2020 2020  ra."""..        
+0001b750: 6465 6620 6361 6c6c 6261 636b 2829 202d  def callback() -
+0001b760: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0001b770: 2020 2020 6861 6e64 6c65 6420 3d20 4661      handled = Fa
+0001b780: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+0001b790: 666f 7220 7365 7474 696e 6720 696e 2073  for setting in s
+0001b7a0: 656c 662e 7269 6e67 5f73 6574 7469 6e67  elf.ring_setting
+0001b7b0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0001b7c0: 2020 2069 6620 7365 7474 696e 672e 6361     if setting.ca
+0001b7d0: 6d65 7261 5f69 6420 3d3d 2063 616d 6572  mera_id == camer
+0001b7e0: 612e 6964 3a0a 2020 2020 2020 2020 2020  a.id:.          
+0001b7f0: 2020 2020 2020 2020 2020 7365 7474 696e            settin
+0001b800: 672e 766f 6c75 6d65 203d 2063 6173 7428  g.volume = cast(
+0001b810: 5065 7263 656e 7449 6e74 2c20 6c65 7665  PercentInt, leve
+0001b820: 6c29 0a20 2020 2020 2020 2020 2020 2020  l).             
+0001b830: 2020 2020 2020 2068 616e 646c 6564 203d         handled =
+0001b840: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0001b850: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+0001b860: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001b870: 6e6f 7420 6861 6e64 6c65 643a 0a20 2020  not handled:.   
+0001b880: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001b890: 7365 2042 6164 5265 7175 6573 7428 2243  se BadRequest("C
+0001b8a0: 616d 6572 6120 2573 2069 7320 6e6f 7420  amera %s is not 
+0001b8b0: 7061 6972 6564 2077 6974 6820 6368 696d  paired with chim
+0001b8c0: 6522 2c20 6361 6d65 7261 2e69 6429 0a0a  e", camera.id)..
+0001b8d0: 2020 2020 2020 2020 6177 6169 7420 7365          await se
+0001b8e0: 6c66 2e71 7565 7565 5f75 7064 6174 6528  lf.queue_update(
+0001b8f0: 6361 6c6c 6261 636b 290a 0a20 2020 2061  callback)..    a
+0001b900: 7379 6e63 2064 6566 2061 6464 5f63 616d  sync def add_cam
+0001b910: 6572 6128 7365 6c66 2c20 6361 6d65 7261  era(self, camera
+0001b920: 3a20 4361 6d65 7261 2920 2d3e 204e 6f6e  : Camera) -> Non
+0001b930: 653a 0a20 2020 2020 2020 2022 2222 4164  e:.        """Ad
+0001b940: 6473 206e 6577 2070 6169 7265 6420 6361  ds new paired ca
+0001b950: 6d65 7261 2074 6f20 6368 696d 6522 2222  mera to chime"""
+0001b960: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0001b970: 2063 616d 6572 612e 6665 6174 7572 655f   camera.feature_
+0001b980: 666c 6167 732e 6973 5f64 6f6f 7262 656c  flags.is_doorbel
+0001b990: 6c3a 0a20 2020 2020 2020 2020 2020 2072  l:.            r
+0001b9a0: 6169 7365 2042 6164 5265 7175 6573 7428  aise BadRequest(
+0001b9b0: 2243 616d 6572 6120 646f 6573 206e 6f74  "Camera does not
+0001b9c0: 2068 6176 6520 6120 6368 696d 6522 290a   have a chime").
+0001b9d0: 0a20 2020 2020 2020 2069 6620 6361 6d65  .        if came
+0001b9e0: 7261 2e69 6420 696e 2073 656c 662e 6361  ra.id in self.ca
+0001b9f0: 6d65 7261 5f69 6473 3a0a 2020 2020 2020  mera_ids:.      
+0001ba00: 2020 2020 2020 7261 6973 6520 4261 6452        raise BadR
+0001ba10: 6571 7565 7374 2822 4361 6d65 7261 2069  equest("Camera i
+0001ba20: 7320 616c 7265 6164 7920 7061 6972 6564  s already paired
+0001ba30: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
+0001ba40: 6361 6c6c 6261 636b 2829 202d 3e20 4e6f  callback() -> No
+0001ba50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001ba60: 7365 6c66 2e63 616d 6572 615f 6964 732e  self.camera_ids.
+0001ba70: 6170 7065 6e64 2863 616d 6572 612e 6964  append(camera.id
+0001ba80: 290a 0a20 2020 2020 2020 2061 7761 6974  )..        await
+0001ba90: 2073 656c 662e 7175 6575 655f 7570 6461   self.queue_upda
+0001baa0: 7465 2863 616c 6c62 6163 6b29 0a0a 2020  te(callback)..  
+0001bab0: 2020 6173 796e 6320 6465 6620 7265 6d6f    async def remo
+0001bac0: 7665 5f63 616d 6572 6128 7365 6c66 2c20  ve_camera(self, 
+0001bad0: 6361 6d65 7261 3a20 4361 6d65 7261 2920  camera: Camera) 
+0001bae0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001baf0: 2022 2222 5265 6d6f 7665 7320 7061 6972   """Removes pair
+0001bb00: 6564 2063 616d 6572 6120 6672 6f6d 2063  ed camera from c
+0001bb10: 6869 6d65 2222 220a 0a20 2020 2020 2020  hime"""..       
+0001bb20: 2069 6620 6361 6d65 7261 2e69 6420 6e6f   if camera.id no
+0001bb30: 7420 696e 2073 656c 662e 6361 6d65 7261  t in self.camera
+0001bb40: 5f69 6473 3a0a 2020 2020 2020 2020 2020  _ids:.          
+0001bb50: 2020 7261 6973 6520 4261 6452 6571 7565    raise BadReque
+0001bb60: 7374 2822 4361 6d65 7261 2069 7320 6e6f  st("Camera is no
+0001bb70: 7420 7061 6972 6564 2229 0a0a 2020 2020  t paired")..    
+0001bb80: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
+0001bb90: 2829 202d 3e20 4e6f 6e65 3a0a 2020 2020  () -> None:.    
+0001bba0: 2020 2020 2020 2020 7365 6c66 2e63 616d          self.cam
+0001bbb0: 6572 615f 6964 732e 7265 6d6f 7665 2863  era_ids.remove(c
+0001bbc0: 616d 6572 612e 6964 290a 0a20 2020 2020  amera.id)..     
+0001bbd0: 2020 2061 7761 6974 2073 656c 662e 7175     await self.qu
+0001bbe0: 6575 655f 7570 6461 7465 2863 616c 6c62  eue_update(callb
+0001bbf0: 6163 6b29 0a0a 2020 2020 6173 796e 6320  ack)..    async 
+0001bc00: 6465 6620 706c 6179 280a 2020 2020 2020  def play(.      
+0001bc10: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001bc20: 2a2c 0a20 2020 2020 2020 2076 6f6c 756d  *,.        volum
+0001bc30: 653a 2069 6e74 207c 204e 6f6e 6520 3d20  e: int | None = 
+0001bc40: 4e6f 6e65 2c0a 2020 2020 2020 2020 7265  None,.        re
+0001bc50: 7065 6174 5f74 696d 6573 3a20 696e 7420  peat_times: int 
+0001bc60: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0001bc70: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0001bc80: 2020 2020 2020 2222 2250 6c61 7973 2063        """Plays c
+0001bc90: 6869 6d65 2074 6f6e 6522 2222 0a0a 2020  hime tone"""..  
+0001bca0: 2020 2020 2020 6177 6169 7420 7365 6c66        await self
+0001bcb0: 2e61 7069 2e70 6c61 795f 7370 6561 6b65  .api.play_speake
+0001bcc0: 7228 7365 6c66 2e69 642c 2076 6f6c 756d  r(self.id, volum
+0001bcd0: 653d 766f 6c75 6d65 2c20 7265 7065 6174  e=volume, repeat
+0001bce0: 5f74 696d 6573 3d72 6570 6561 745f 7469  _times=repeat_ti
+0001bcf0: 6d65 7329 0a0a 2020 2020 6173 796e 6320  mes)..    async 
+0001bd00: 6465 6620 706c 6179 5f62 757a 7a65 7228  def play_buzzer(
+0001bd10: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+0001bd20: 2020 2020 2020 2022 2222 506c 6179 7320         """Plays 
+0001bd30: 6368 696d 6520 6275 7a7a 6572 2222 220a  chime buzzer""".
+0001bd40: 0a20 2020 2020 2020 2061 7761 6974 2073  .        await s
+0001bd50: 656c 662e 6170 692e 706c 6179 5f62 757a  elf.api.play_buz
+0001bd60: 7a65 7228 7365 6c66 2e69 6429 0a0a 2020  zer(self.id)..  
+0001bd70: 2020 6173 796e 6320 6465 6620 7365 745f    async def set_
+0001bd80: 7265 7065 6174 5f74 696d 6573 2873 656c  repeat_times(sel
+0001bd90: 662c 2076 616c 7565 3a20 696e 7429 202d  f, value: int) -
+0001bda0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0001bdb0: 2222 2253 6574 2072 6570 6561 7420 7469  """Set repeat ti
+0001bdc0: 6d65 7320 6f6e 2063 6869 6d65 2e22 2222  mes on chime."""
+0001bdd0: 0a0a 2020 2020 2020 2020 6f6c 645f 7661  ..        old_va
+0001bde0: 6c75 6520 3d20 7365 6c66 2e72 6570 6561  lue = self.repea
+0001bdf0: 745f 7469 6d65 730a 0a20 2020 2020 2020  t_times..       
+0001be00: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+0001be10: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001be20: 2020 2020 2073 656c 662e 7265 7065 6174       self.repeat
+0001be30: 5f74 696d 6573 203d 2063 6173 7428 5265  _times = cast(Re
+0001be40: 7065 6174 5469 6d65 732c 2076 616c 7565  peatTimes, value
+0001be50: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0001be60: 7220 7365 7474 696e 6720 696e 2073 656c  r setting in sel
+0001be70: 662e 7269 6e67 5f73 6574 7469 6e67 733a  f.ring_settings:
+0001be80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001be90: 2069 6620 7365 7474 696e 672e 7265 7065   if setting.repe
+0001bea0: 6174 5f74 696d 6573 203d 3d20 6f6c 645f  at_times == old_
+0001beb0: 7661 6c75 653a 0a20 2020 2020 2020 2020  value:.         
+0001bec0: 2020 2020 2020 2020 2020 2073 6574 7469             setti
+0001bed0: 6e67 2e72 6570 6561 745f 7469 6d65 7320  ng.repeat_times 
+0001bee0: 3d20 6361 7374 2852 6570 6561 7454 696d  = cast(RepeatTim
+0001bef0: 6573 2c20 7661 6c75 6529 0a0a 2020 2020  es, value)..    
+0001bf00: 2020 2020 6177 6169 7420 7365 6c66 2e71      await self.q
+0001bf10: 7565 7565 5f75 7064 6174 6528 6361 6c6c  ueue_update(call
+0001bf20: 6261 636b 290a 0a20 2020 2061 7379 6e63  back)..    async
+0001bf30: 2064 6566 2073 6574 5f72 6570 6561 745f   def set_repeat_
+0001bf40: 7469 6d65 735f 666f 725f 6361 6d65 7261  times_for_camera
+0001bf50: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001bf60: 2020 2020 2020 2020 6361 6d65 7261 3a20          camera: 
+0001bf70: 4361 6d65 7261 2c0a 2020 2020 2020 2020  Camera,.        
+0001bf80: 7661 6c75 653a 2069 6e74 2c0a 2020 2020  value: int,.    
+0001bf90: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0001bfa0: 2020 2022 2222 5365 7420 7265 7065 6174     """Set repeat
+0001bfb0: 2074 696d 6573 206f 6e20 6368 696d 6520   times on chime 
+0001bfc0: 666f 7220 7370 6563 6966 6963 2063 616d  for specific cam
+0001bfd0: 6572 612e 2222 220a 0a20 2020 2020 2020  era."""..       
+0001bfe0: 2064 6566 2063 616c 6c62 6163 6b28 2920   def callback() 
+0001bff0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001c000: 2020 2020 2068 616e 646c 6564 203d 2046       handled = F
+0001c010: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+0001c020: 2066 6f72 2073 6574 7469 6e67 2069 6e20   for setting in 
+0001c030: 7365 6c66 2e72 696e 675f 7365 7474 696e  self.ring_settin
+0001c040: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0001c050: 2020 2020 6966 2073 6574 7469 6e67 2e63      if setting.c
+0001c060: 616d 6572 615f 6964 203d 3d20 6361 6d65  amera_id == came
+0001c070: 7261 2e69 643a 0a20 2020 2020 2020 2020  ra.id:.         
+0001c080: 2020 2020 2020 2020 2020 2073 6574 7469             setti
+0001c090: 6e67 2e72 6570 6561 745f 7469 6d65 7320  ng.repeat_times 
+0001c0a0: 3d20 6361 7374 2852 6570 6561 7454 696d  = cast(RepeatTim
+0001c0b0: 6573 2c20 7661 6c75 6529 0a20 2020 2020  es, value).     
+0001c0c0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+0001c0d0: 616e 646c 6564 203d 2054 7275 650a 2020  andled = True.  
+0001c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c0f0: 2020 6272 6561 6b0a 0a20 2020 2020 2020    break..       
+0001c100: 2020 2020 2069 6620 6e6f 7420 6861 6e64       if not hand
+0001c110: 6c65 643a 0a20 2020 2020 2020 2020 2020  led:.           
+0001c120: 2020 2020 2072 6169 7365 2042 6164 5265       raise BadRe
+0001c130: 7175 6573 7428 2243 616d 6572 6120 2573  quest("Camera %s
+0001c140: 2069 7320 6e6f 7420 7061 6972 6564 2077   is not paired w
+0001c150: 6974 6820 6368 696d 6522 2c20 6361 6d65  ith chime", came
+0001c160: 7261 2e69 6429 0a0a 2020 2020 2020 2020  ra.id)..        
+0001c170: 6177 6169 7420 7365 6c66 2e71 7565 7565  await self.queue
+0001c180: 5f75 7064 6174 6528 6361 6c6c 6261 636b  _update(callback
+0001c190: 290a                                     ).
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/nvr.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/nvr.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,24 +11,24 @@
 from typing import TYPE_CHECKING, Any, ClassVar, Literal, Optional, Union
 from uuid import UUID
 import zoneinfo
 
 import aiofiles
 from aiofiles import os as aos
 import orjson
-from pydantic.v1.fields import PrivateAttr
 
 from pyunifiprotect.data.base import (
     ProtectBaseObject,
     ProtectDeviceModel,
     ProtectModelWithId,
 )
 from pyunifiprotect.data.devices import (
     Camera,
     CameraZone,
+    LCDMessage,
     Light,
     OSDSettings,
     RecordingSettings,
     Sensor,
     SmartDetectSettings,
 )
 from pyunifiprotect.data.types import (
@@ -52,18 +52,21 @@
     SensorType,
     SmartDetectObjectType,
     StorageType,
     Version,
 )
 from pyunifiprotect.data.user import User, UserLocation
 from pyunifiprotect.exceptions import BadRequest, NotAuthorized
+from pyunifiprotect.pydantic_compat import PrivateAttr
 from pyunifiprotect.utils import RELEASE_CACHE, process_datetime
 
 if TYPE_CHECKING:
-    from pydantic.v1.typing import SetStr
+    from typing_extensions import Self
+
+    from pyunifiprotect.pydantic_compat import SetStr
 
 
 _LOGGER = logging.getLogger(__name__)
 MAX_SUPPORTED_CAMERAS = 256
 MAX_EVENT_HISTORY_IN_STATE_MACHINE = MAX_SUPPORTED_CAMERAS * 2
 DELETE_KEYS_THUMB = {"color", "vehicleType"}
 DELETE_KEYS_EVENT = {"deletedAt", "category", "subCategory"}
@@ -154,14 +157,15 @@
 
 class EventDetectedThumbnail(ProtectBaseObject):
     clock_best_wall: Optional[datetime] = None
     type: str
     cropped_id: str
     attributes: Optional[EventThumbnailAttributes] = None
     name: Optional[str]
+    object_id: Optional[str] = None
 
     @classmethod
     def unifi_dict_to_dict(cls, data: dict[str, Any]) -> dict[str, Any]:
         if "clockBestWall" in data:
             if data["clockBestWall"]:
                 data["clockBestWall"] = process_datetime(data, "clockBestWall")
             else:
@@ -753,19 +757,30 @@
 
 
 class DoorbellMessage(ProtectBaseObject):
     type: DoorbellMessageType
     text: DoorbellText
 
 
+class CustomImage(ProtectBaseObject):
+    sprite: str
+    preview: str
+
+
 class DoorbellSettings(ProtectBaseObject):
     default_message_text: DoorbellText
     default_message_reset_timeout: timedelta
     all_messages: list[DoorbellMessage]
     custom_messages: list[DoorbellText]
+    # 4.0.7+
+    custom_images: Optional[list[CustomImage]] = None
+
+    # internal
+    _doorbell_options: Optional[list[LCDMessage]] = PrivateAttr(None)
+    _image_doorbell_options: Optional[list[LCDMessage]] = PrivateAttr(None)
 
     @classmethod
     @cache
     def _get_unifi_remaps(cls) -> dict[str, str]:
         return {
             **super()._get_unifi_remaps(),
             "defaultMessageResetTimeoutMs": "defaultMessageResetTimeout",
@@ -776,14 +791,63 @@
         if "defaultMessageResetTimeoutMs" in data:
             data["defaultMessageResetTimeout"] = timedelta(
                 milliseconds=data.pop("defaultMessageResetTimeoutMs"),
             )
 
         return super().unifi_dict_to_dict(data)
 
+    @property
+    def doorbell_options(self) -> list[LCDMessage]:
+        """Get list of saved doorbell options.
+
+        Does not include the default message (lcd_message=None)."""
+
+        if self._doorbell_options is not None:
+            return self._doorbell_options
+
+        self._doorbell_options = [
+            LCDMessage(
+                type=DoorbellMessageType.LEAVE_PACKAGE_AT_DOOR,
+                text=DoorbellMessageType.LEAVE_PACKAGE_AT_DOOR.value,
+            ),
+            LCDMessage(
+                type=DoorbellMessageType.DO_NOT_DISTURB,
+                text=DoorbellMessageType.DO_NOT_DISTURB.value,
+            ),
+        ] + [
+            LCDMessage(type=DoorbellMessageType.CUSTOM_MESSAGE, text=m)
+            for m in self.custom_messages
+        ]
+
+        return self._doorbell_options
+
+    @property
+    def image_doorbell_options(self) -> list[LCDMessage]:
+        """Get list of saved doorbell options for doorbell that support images.
+
+        Does not include the default message (lcd_message=None)."""
+
+        if self._image_doorbell_options is None:
+            self.custom_images = self.custom_images or []
+            self._image_doorbell_options = self.doorbell_options + [
+                LCDMessage(type=DoorbellMessageType.IMAGE, text=i.sprite)
+                for i in self.custom_images
+            ]
+
+        return self._image_doorbell_options
+
+    def update_from_dict(self: Self, data: dict[str, Any]) -> Self:
+        """Updates current object from a cleaned UFP JSON dict"""
+
+        super(data)
+        self._doorbell_options = None
+        self._image_doorbell_options = None
+
+        return self
+
 
 class RecordingTypeDistribution(ProtectBaseObject):
     recording_type: RecordingType
     size: int
     percentage: float
 
 
@@ -971,23 +1035,27 @@
     is_ucore_updatable: Optional[bool] = None
     # requires 2.11.13+
     last_device_fw_updates_checked_at: Optional[datetime] = None
     # requires 3.0.22+
     smart_detection: Optional[NVRSmartDetection] = None
     is_ucore_stacked: Optional[bool] = None
     global_camera_settings: Optional[GlobalRecordingSettings] = None
+    # requires 4.0.7+
+    timelapse_enabled: Optional[bool] = None
+    console_env: Optional[str] = None
 
     # TODO:
     # errorCode   read only
     # wifiSettings
     # smartDetectAgreement
     # dbRecoveryOptions
     # portStatus
     # cameraCapacity
     # deviceFirmwareSettings
+    # agreements
 
     @classmethod
     @cache
     def _get_unifi_remaps(cls) -> dict[str, str]:
         return {
             **super()._get_unifi_remaps(),
             "recordingRetentionDurationMs": "recordingRetentionDuration",
@@ -1044,18 +1112,18 @@
 
     @property
     def is_analytics_enabled(self) -> bool:
         return self.analytics_data != AnalyticsOption.NONE
 
     @property
     def protect_url(self) -> str:
-        return f"{self.api.base_url}/protect/devices/{self.api.bootstrap.nvr.id}"
+        return f"{self.api.protect_url}/devices/{self.api.bootstrap.nvr.id}"
 
     @property
-    def display_name(self) -> str:
+    def device_name(self) -> str:
         return self.name or self.market_name or self.type
 
     @property
     def vault_cameras(self) -> list[Camera]:
         """Vault Cameras for NVR"""
 
         if len(self.vault_camera_ids) == 0:
@@ -1530,8 +1598,8 @@
         Will be none if the user only has read only access and it was not made by their user.
         """
 
         return self.api.bootstrap.users.get(self.owner_id)
 
     @property
     def protect_url(self) -> str:
-        return f"{self.api.base_url}/protect/liveview/{self.id}"
+        return f"{self.api.protect_url}/liveview/{self.id}"
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/types.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/types.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,17 +1,22 @@
 from __future__ import annotations
 
 from collections.abc import Callable, Coroutine
 import enum
 from typing import Any, Literal, Optional, TypeVar, Union
 
 from packaging.version import Version as BaseVersion
-from pydantic.v1 import BaseModel, ConstrainedInt
-from pydantic.v1.color import Color as BaseColor
-from pydantic.v1.types import ConstrainedFloat, ConstrainedStr
+
+from pyunifiprotect.pydantic_compat import BaseModel
+from pyunifiprotect.pydantic_compat import Color as BaseColor
+from pyunifiprotect.pydantic_compat import (
+    ConstrainedFloat,
+    ConstrainedInt,
+    ConstrainedStr,
+)
 
 KT = TypeVar("KT")
 VT = TypeVar("VT")
 
 
 DEFAULT = "DEFAULT_VALUE"
 DEFAULT_TYPE = Literal["DEFAULT_VALUE"]
@@ -87,14 +92,15 @@
     BRIDGE = "bridge"
     SENSOR = "sensor"
     DOORLOCK = "doorlock"
     SCHEDULE = "schedule"
     CHIME = "chime"
     DEVICE_GROUP = "deviceGroup"
     RECORDING_SCHEDULE = "recordingSchedule"
+    PTZ_PATROL = "ptzPatrol"
     UNKNOWN = "unknown"
 
     @staticmethod
     def bootstrap_models() -> tuple[str, ...]:
         # TODO:
         # legacyUFV
         # display
@@ -128,14 +134,16 @@
     MOTION = "motion"
     RECORDING_DELETED = "recordingDeleted"
     SMART_AUDIO_DETECT = "smartAudioDetect"
     SMART_DETECT = "smartDetectZone"
     SMART_DETECT_LINE = "smartDetectLine"
     NO_SCHEDULE = "nonScheduledRecording"
     RECORDING_MODE_CHANGED = "recordingModeChanged"
+    VIDEO_CODEC_CHANGED = "videoCodecChanged"
+    RESOLUTION_CHANGED = "resolutionChanged"
     HOTPLUG = "hotplug"
     FACE_GROUP_DETECTED = "faceGroupDetected"
     CONSOLIDATED_RESOLUTION_LOWERED = "consolidatedResolutionLowered"
     CONSOLIDATED_POOR_CONNECTION = "consolidatedPoorConnection"
     CAMERA_CONNECTED = "cameraConnected"
     CAMERA_REBOOTED = "cameraRebooted"
     CAMERA_DISCONNECTED = "cameraDisconnected"
@@ -292,14 +300,15 @@
 
 
 @enum.unique
 class DoorbellMessageType(str, ValuesEnumMixin, enum.Enum):
     LEAVE_PACKAGE_AT_DOOR = "LEAVE_PACKAGE_AT_DOOR"
     DO_NOT_DISTURB = "DO_NOT_DISTURB"
     CUSTOM_MESSAGE = "CUSTOM_MESSAGE"
+    IMAGE = "IMAGE"
 
 
 @enum.unique
 class LightModeEnableType(str, ValuesEnumMixin, enum.Enum):
     DARK = "dark"
     ALWAYS = "fulltime"
     NIGHT = "night"
@@ -606,14 +615,19 @@
 class PTZPreset(BaseModel):
     id: str
     name: str
     slot: int
     ptz: PTZPresetPosition
 
 
+class PTZPresetDuration(ConstrainedInt):
+    gte = 10
+    lte = 60
+
+
 CoordType = Union[Percent, int, float]
 
 
 # TODO: fix when upgrading to pydantic v2
 class Color(BaseColor):  # noqa: PLW1641
     def __eq__(self, o: object) -> bool:
         if isinstance(o, Color):
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/user.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/user.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,18 +2,17 @@
 
 from __future__ import annotations
 
 from datetime import datetime
 from functools import cache
 from typing import Any, Optional
 
-from pydantic.v1.fields import PrivateAttr
-
 from pyunifiprotect.data.base import ProtectBaseObject, ProtectModel, ProtectModelWithId
 from pyunifiprotect.data.types import ModelType, PermissionNode
+from pyunifiprotect.pydantic_compat import PrivateAttr
 
 
 class Permission(ProtectBaseObject):
     raw_permission: str
     model: ModelType
     nodes: set[PermissionNode]
     obj_ids: Optional[set[str]]
@@ -135,14 +134,15 @@
 
     # TODO:
     # settings
     # alertRules
     # notificationsV2
     # notifications
     # cloudProviders
+    # notificationSnoozeSettings
 
     _groups: Optional[list[Group]] = PrivateAttr(None)
     _perm_cache: dict[str, bool] = PrivateAttr({})
 
     def __init__(self, **data: Any) -> None:
         if "permissions" in data:
             permissions = data.pop("permissions")
```

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/data/websocket.py` & `pyunifiprotect-6.0.0/pyunifiprotect/data/websocket.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/test_util/__init__.py` & `pyunifiprotect-6.0.0/pyunifiprotect/test_util/__init__.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyunifiprotect/test_util/anonymize.py` & `pyunifiprotect-6.0.0/pyunifiprotect/test_util/anonymize.py`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/.gitignore` & `pyunifiprotect-6.0.0/.gitignore`

 * *Files 2% similar despite different names*

```diff
@@ -3,14 +3,16 @@
 test-data
 ufp-data
 *.mp3
 *.mp4
 *.js
 *.json
 *.csv
+*.png
+*.gif
 backup
 .benchmarks
 .ruff_cache
 
 # Byte-compiled / optimized / DLL files
 __pycache__/
 *.py[cod]
```

### Comparing `pyunifiprotect-5.2.0/LICENSE` & `pyunifiprotect-6.0.0/LICENSE.CHANGE`

 * *Files 10% similar despite different names*

```diff
@@ -1,11 +1,9 @@
 MIT License
 
-Copyright (c) 2020 Bjarne Riis
-
 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:
```

### Comparing `pyunifiprotect-5.2.0/README.md` & `pyunifiprotect-6.0.0/README.md`

 * *Files identical despite different names*

### Comparing `pyunifiprotect-5.2.0/pyproject.toml` & `pyunifiprotect-6.0.0/pyproject.toml`

 * *Files 2% similar despite different names*

```diff
@@ -16,21 +16,20 @@
     {name="Bjarne Riis", email="bjarne@briis.com"},
     {name="Christopher Bailey", email="cbailey@mort.is"},
 ]
 maintainers = [
     {name="Christopher Bailey", email="cbailey@mort.is"},
     {name="J. Nick Koston", email="nick@koston.org"},
 ]
-license = {text="MIT"}
+license = {file = "LICENSE"}
 keywords = ["UniFiProtect", "UniFi Protect", "Surveilance", "UniFi", "Home Assistant", "Python"]
 classifiers = [
     "Development Status :: 5 - Production/Stable",
     "Intended Audience :: Developers",
     "Topic :: Software Development :: Build Tools",
-    "License :: OSI Approved :: MIT License",
     "Programming Language :: Python :: 3.9",
     "Programming Language :: Python :: 3.10",
     "Programming Language :: Python :: 3.11",
     "Programming Language :: Python :: 3.12"
 ]
 dynamic = ["version"]
 dependencies = [
@@ -39,15 +38,15 @@
     "aiohttp",
     "aioshutil",
     "dateparser",
     "orjson",
     "packaging",
     "pillow",
     "platformdirs",
-    "pydantic>=1.10.15",
+    "pydantic!=1.9.1",
     "pyjwt",
     "typer[all]>0.6",
     "yarl>=1.9",
 ]
 
 [project.urls]
 "Source Code" = "https://github.com/AngellusMortis/pyunifiprotect/"
```

### Comparing `pyunifiprotect-5.2.0/PKG-INFO` & `pyunifiprotect-6.0.0/PKG-INFO`

 * *Files 16% similar despite different names*

```diff
@@ -1,23 +1,80 @@
 Metadata-Version: 2.3
 Name: pyunifiprotect
-Version: 5.2.0
+Version: 6.0.0
 Summary: Unofficial UniFi Protect Python API and CLI
 Project-URL: Source Code, https://github.com/AngellusMortis/pyunifiprotect/
 Project-URL: Documentation, https://angellusmortis.github.io/pyunifiprotect/latest/
 Project-URL: Bug Reports, https://github.com/AngellusMortis/pyunifiprotect/issues/
 Project-URL: Changelog, https://github.com/AngellusMortis/pyunifiprotect/releases/
 Author-email: Bjarne Riis <bjarne@briis.com>, Christopher Bailey <cbailey@mort.is>
 Maintainer-email: Christopher Bailey <cbailey@mort.is>, "J. Nick Koston" <nick@koston.org>
-License: MIT
+License: Business Source License
+        
+        Copyright (c) 2024 Christopher Bailey
+        
+        Change Date: 6 months from release
+        Change License: MIT
+        
+        The Licensor hereby grants you the right to copy, modify, create derivative
+        works, redistribute, and make non-production use of the Licensed Work. The
+        Licensor may make an Additional Use Grant, above, permitting limited
+        production use.
+        
+        Effective on the Change Date, or six months after the first publicly
+        available distribution of a specific version of the Licensed Work under this
+        License, whichever comes first, the Licensor hereby grants you rights under
+        the terms of the Change License, and the rights granted in the paragraph above terminate.
+        
+        If your use of the Licensed Work does not comply with the requirements
+        currently in effect as described in this License, you must purchase a commercial
+        license from the Licensor, its affiliated entities, or authorized resellers, or
+        you must refrain from using the Licensed Work.
+        
+        All copies of the original and modified Licensed Work, and derivative works of
+        the Licensed Work, are subject to this License. This License applies separately
+        for each version of the Licensed Work and the Change Date may vary for each
+        version of the Licensed Work released by Licensor.
+        
+        You must conspicuously display this License on each original or modified copy of
+        the Licensed Work. If you receive the Licensed Work in original or modified form
+        from a third party, the terms and conditions set forth in this License apply to
+        your use of that work.
+        
+        Any use of the Licensed Work in violation of this License will automatically
+        terminate your rights under this License for the current and all other versions
+        of the Licensed Work.
+        
+        This License does not grant you any right in any trademark or logo of Licensor or
+        its affiliates (provided that you may use a trademark or logo of Licensor as
+        expressly required by this License).
+        
+        TO THE EXTENT PERMITTED BY APPLICABLE LAW, THE LICENSED WORK IS PROVIDED ON AN
+        "AS IS" BASIS. LICENSOR HEREBY DISCLAIMS ALL WARRANTIES AND CONDITIONS, EXPRESS OR
+        IMPLIED, INCLUDING (WITHOUT LIMITATION) WARRANTIES OF MERCHANTABILITY, FITNESS FOR
+        A PARTICULAR PURPOSE, NON-INFRINGEMENT, AND TITLE.
+        
+        
+        Additional Use Grants
+        
+        For all use cases, this software is considered licensed as the Change License
+        and may be used under those terms. There are only two exceptions that are not
+        granted usage:
+        
+        * Ubiquiti may not use the Licensed Work for any "professional" use, including,
+          but not limited to development, tooling or documentation
+        * The Licensed Work may not be forked and used for the purpose of making any
+          kind of add-on, integration or component for Home Assistant. Third party or
+          otherwise. The only version of the Licensed Work that may be used in Home
+          Assistant (before the Change Date) is original one.
 License-File: LICENSE
+License-File: LICENSE.CHANGE
 Keywords: Home Assistant,Python,Surveilance,UniFi,UniFi Protect,UniFiProtect
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
-Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Software Development :: Build Tools
 Requires-Python: >=3.9
 Requires-Dist: aiofiles
@@ -25,15 +82,15 @@
 Requires-Dist: aioshutil
 Requires-Dist: async-timeout; python_version < '3.11'
 Requires-Dist: dateparser
 Requires-Dist: orjson
 Requires-Dist: packaging
 Requires-Dist: pillow
 Requires-Dist: platformdirs
-Requires-Dist: pydantic>=1.10.15
+Requires-Dist: pydantic!=1.9.1
 Requires-Dist: pyjwt
 Requires-Dist: typer[all]>0.6
 Requires-Dist: yarl>=1.9
 Provides-Extra: backup
 Requires-Dist: aiosqlite; extra == 'backup'
 Requires-Dist: asyncify; extra == 'backup'
 Requires-Dist: av; extra == 'backup'
```

